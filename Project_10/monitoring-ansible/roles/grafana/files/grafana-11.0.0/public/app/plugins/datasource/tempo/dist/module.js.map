{"version":3,"file":"module.js","mappings":"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","sources":["webpack://tempo/../../../../../node_modules/hoist-non-react-statics/dist/hoist-non-react-statics.cjs.js","webpack://tempo/../../../../../node_modules/hoist-non-react-statics/node_modules/react-is/cjs/react-is.production.min.js","webpack://tempo/../../../../../node_modules/hoist-non-react-statics/node_modules/react-is/index.js","webpack://tempo/../../../../../node_modules/react-use/lib/useAsync.js","webpack://tempo/../../../../../node_modules/react-use/lib/useAsyncFn.js","webpack://tempo/../../../../../node_modules/react-use/lib/useMountedState.js","webpack://tempo/../../../../../node_modules/semver/classes/comparator.js","webpack://tempo/../../../../../node_modules/semver/classes/range.js","webpack://tempo/../../../../../node_modules/semver/classes/semver.js","webpack://tempo/../../../../../node_modules/semver/functions/clean.js","webpack://tempo/../../../../../node_modules/semver/functions/cmp.js","webpack://tempo/../../../../../node_modules/semver/functions/coerce.js","webpack://tempo/../../../../../node_modules/semver/functions/compare-build.js","webpack://tempo/../../../../../node_modules/semver/functions/compare-loose.js","webpack://tempo/../../../../../node_modules/semver/functions/compare.js","webpack://tempo/../../../../../node_modules/semver/functions/diff.js","webpack://tempo/../../../../../node_modules/semver/functions/eq.js","webpack://tempo/../../../../../node_modules/semver/functions/gt.js","webpack://tempo/../../../../../node_modules/semver/functions/gte.js","webpack://tempo/../../../../../node_modules/semver/functions/inc.js","webpack://tempo/../../../../../node_modules/semver/functions/lt.js","webpack://tempo/../../../../../node_modules/semver/functions/lte.js","webpack://tempo/../../../../../node_modules/semver/functions/major.js","webpack://tempo/../../../../../node_modules/semver/functions/minor.js","webpack://tempo/../../../../../node_modules/semver/functions/neq.js","webpack://tempo/../../../../../node_modules/semver/functions/parse.js","webpack://tempo/../../../../../node_modules/semver/functions/patch.js","webpack://tempo/../../../../../node_modules/semver/functions/prerelease.js","webpack://tempo/../../../../../node_modules/semver/functions/rcompare.js","webpack://tempo/../../../../../node_modules/semver/functions/rsort.js","webpack://tempo/../../../../../node_modules/semver/functions/satisfies.js","webpack://tempo/../../../../../node_modules/semver/functions/sort.js","webpack://tempo/../../../../../node_modules/semver/functions/valid.js","webpack://tempo/../../../../../node_modules/semver/index.js","webpack://tempo/../../../../../node_modules/semver/internal/constants.js","webpack://tempo/../../../../../node_modules/semver/internal/debug.js","webpack://tempo/../../../../../node_modules/semver/internal/identifiers.js","webpack://tempo/../../../../../node_modules/semver/internal/parse-options.js","webpack://tempo/../../../../../node_modules/semver/internal/re.js","webpack://tempo/../../../../../node_modules/semver/node_modules/lru-cache/index.js","webpack://tempo/../../../../../node_modules/semver/ranges/gtr.js","webpack://tempo/../../../../../node_modules/semver/ranges/intersects.js","webpack://tempo/../../../../../node_modules/semver/ranges/ltr.js","webpack://tempo/../../../../../node_modules/semver/ranges/max-satisfying.js","webpack://tempo/../../../../../node_modules/semver/ranges/min-satisfying.js","webpack://tempo/../../../../../node_modules/semver/ranges/min-version.js","webpack://tempo/../../../../../node_modules/semver/ranges/outside.js","webpack://tempo/../../../../../node_modules/semver/ranges/simplify.js","webpack://tempo/../../../../../node_modules/semver/ranges/subset.js","webpack://tempo/../../../../../node_modules/semver/ranges/to-comparators.js","webpack://tempo/../../../../../node_modules/semver/ranges/valid.js","webpack://tempo/../../../../../node_modules/yallist/iterator.js","webpack://tempo/../../../../../node_modules/yallist/yallist.js","webpack://tempo/external amd \"@emotion/css\"","webpack://tempo/external amd \"@grafana/data\"","webpack://tempo/external amd \"@grafana/runtime\"","webpack://tempo/external amd \"@grafana/ui\"","webpack://tempo/external amd \"lodash\"","webpack://tempo/external amd \"prismjs\"","webpack://tempo/external amd \"react\"","webpack://tempo/external amd \"rxjs\"","webpack://tempo/../../../../../node_modules/tslib/tslib.es6.mjs","webpack://tempo/webpack/bootstrap","webpack://tempo/webpack/runtime/compat get default export","webpack://tempo/webpack/runtime/define property getters","webpack://tempo/webpack/runtime/hasOwnProperty shorthand","webpack://tempo/webpack/runtime/make namespace object","webpack://tempo/../../../../../packages/grafana-o11y-ds-frontend/src/TemporaryAlert.tsx","webpack://tempo/../../../../../packages/grafana-ui/src/themes/ThemeContext.tsx","webpack://tempo/./_importedDependencies/datasources/prometheus/RawQuery.tsx","webpack://tempo/./dataquery.gen.ts","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/QueryEditor/Stack.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/QueryEditor/EditorRow.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/QueryEditor/Space.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/QueryEditor/EditorField.js","webpack://tempo/../../../../../node_modules/react-use/esm/useToggle.js","webpack://tempo/./_importedDependencies/datasources/prometheus/QueryOptionGroup.tsx","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/isFunction.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/lift.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/createErrorClass.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/UnsubscriptionError.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/arrRemove.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/Subscription.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/config.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/scheduler/timeoutProvider.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/reportUnhandledError.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/noop.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/NotificationFactories.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/errorContext.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/Subscriber.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/operators/OperatorSubscriber.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/operators/map.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/isArrayLike.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/symbol/observable.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/identity.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/Observable.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/pipe.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/symbol/iterator.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/observable/innerFrom.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/isInteropObservable.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/isPromise.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/isAsyncIterable.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/isIterable.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/isReadableStreamLike.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/util/throwUnobservableError.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/operators/catchError.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/operators/mergeMap.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/operators/mergeInternals.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/operators/concatMap.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/operators/toArray.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/operators/reduce.js","webpack://tempo/../../../../../node_modules/rxjs/dist/esm5/internal/operators/scanInternals.js","webpack://tempo/../../../../../packages/grafana-schema/src/common/common.gen.ts","webpack://tempo/./traceql/traceql.ts","webpack://tempo/./SearchTraceQLEditor/utils.ts","webpack://tempo/./VariableQueryEditor.tsx","webpack://tempo/../../../../../packages/grafana-o11y-ds-frontend/src/utils.ts","webpack://tempo/./graphTransform.ts","webpack://tempo/./language_provider.ts","webpack://tempo/./metricsSummary.ts","webpack://tempo/../../../../../node_modules/@opentelemetry/semantic-conventions/build/esm/resource/SemanticResourceAttributes.js","webpack://tempo/./resultTransformer.ts","webpack://tempo/../../../../../node_modules/uuid/dist/esm-browser/native.js","webpack://tempo/../../../../../node_modules/uuid/dist/esm-browser/rng.js","webpack://tempo/../../../../../node_modules/uuid/dist/esm-browser/stringify.js","webpack://tempo/../../../../../node_modules/uuid/dist/esm-browser/v4.js","webpack://tempo/./streaming.ts","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/QueryEditor/AccessoryButton.js","webpack://tempo/./SearchTraceQLEditor/SearchField.tsx","webpack://tempo/./SearchTraceQLEditor/TagsInput.tsx","webpack://tempo/./utils.ts","webpack://tempo/./variables.ts","webpack://tempo/./datasource.ts","webpack://tempo/./traceql/TempoQueryBuilderOptions.tsx","webpack://tempo/./SearchTraceQLEditor/DurationInput.tsx","webpack://tempo/./SearchTraceQLEditor/InlineSearchField.tsx","webpack://tempo/./SearchTraceQLEditor/GroupByField.tsx","webpack://tempo/./SearchTraceQLEditor/TraceQLSearch.tsx","webpack://tempo/../../../../../node_modules/i18next/dist/esm/i18next.js","webpack://tempo/./_importedDependencies/components/AdHocFilter/AdHocFilterKey.tsx","webpack://tempo/./_importedDependencies/components/AdHocFilter/AdHocFilterValue.tsx","webpack://tempo/./_importedDependencies/components/AdHocFilter/OperatorSegment.tsx","webpack://tempo/./_importedDependencies/components/AdHocFilter/AdHocFilterRenderer.tsx","webpack://tempo/./_importedDependencies/components/AdHocFilter/AdHocFilterBuilder.tsx","webpack://tempo/./_importedDependencies/components/AdHocFilter/ConditionSegment.tsx","webpack://tempo/./_importedDependencies/components/AdHocFilter/AdHocFilter.tsx","webpack://tempo/./ServiceGraphSection.tsx","webpack://tempo/./types.ts","webpack://tempo/../../../../../node_modules/@lezer/common/dist/index.js","webpack://tempo/../../../../../node_modules/@lezer/lr/dist/index.js","webpack://tempo/../../../../../node_modules/@grafana/lezer-traceql/index.es.js","webpack://tempo/./traceql/situation.ts","webpack://tempo/./traceql/autocomplete.ts","webpack://tempo/./traceql/highlighting.ts","webpack://tempo/./traceql/TraceQLEditor.tsx","webpack://tempo/./traceql/QueryEditor.tsx","webpack://tempo/./QueryField.tsx","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/DataSourceDescription.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/ConfigSection/GenericConfigSection.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/ConfigSection/ConfigSection.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Connection/ConnectionSettings.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/common/SecretInput.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/styles.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/auth-method/BasicAuth.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/ConfigSection/ConfigSubSection.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/types.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/auth-method/AuthMethodSettings.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/common/SecretTextarea.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/tls/TLSSettingsSection.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/tls/SelfSignedCertificate.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/tls/TLSClientAuth.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/tls/SkipTLSVerification.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/tls/TLSSettings.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/custom-headers/CustomHeader.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/custom-headers/CustomHeaders.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/Auth.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/utils.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/AdvancedSettings/AdvancedHttpSettings.js","webpack://tempo/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/ConfigSection/ConfigDescriptionLink.js","webpack://tempo/../../../../../packages/grafana-o11y-ds-frontend/src/IntervalInput/validation.ts","webpack://tempo/../../../../../packages/grafana-o11y-ds-frontend/src/IntervalInput/IntervalInput.tsx","webpack://tempo/../../../../../node_modules/react-use/esm/useDebounce.js","webpack://tempo/../../../../../node_modules/react-use/esm/useTimeoutFn.js","webpack://tempo/../../../../../packages/grafana-o11y-ds-frontend/src/TraceToLogs/TagMappingInput.tsx","webpack://tempo/../../../../../packages/grafana-o11y-ds-frontend/src/TraceToLogs/TraceToLogsSettings.tsx","webpack://tempo/../../../../../packages/grafana-o11y-ds-frontend/src/TraceToMetrics/TraceToMetricsSettings.tsx","webpack://tempo/../../../../../node_modules/react-use/esm/useAsync.js","webpack://tempo/../../../../../node_modules/react-use/esm/useAsyncFn.js","webpack://tempo/../../../../../node_modules/react-use/esm/useMountedState.js","webpack://tempo/../../../../../packages/grafana-o11y-ds-frontend/src/pyroscope/ProfileTypesCascader.tsx","webpack://tempo/../../../../../packages/grafana-o11y-ds-frontend/src/TraceToProfiles/TraceToProfilesSettings.tsx","webpack://tempo/../../../../../packages/grafana-o11y-ds-frontend/src/NodeGraph/NodeGraphSettings.tsx","webpack://tempo/../../../../../packages/grafana-o11y-ds-frontend/src/SpanBar/SpanBarSettings.tsx","webpack://tempo/./configuration/QuerySettings.tsx","webpack://tempo/./configuration/ServiceGraphSettings.tsx","webpack://tempo/./configuration/TraceQLSearchTags.tsx","webpack://tempo/./configuration/TraceQLSearchSettings.tsx","webpack://tempo/./configuration/ConfigEditor.tsx","webpack://tempo/./tracking.ts","webpack://tempo/./module.ts","webpack://tempo/./CheatSheet.tsx"],"sourcesContent":["'use strict';\n\nvar reactIs = require('react-is');\n\n/**\n * Copyright 2015, Yahoo! Inc.\n * Copyrights licensed under the New BSD License. See the accompanying LICENSE file for terms.\n */\nvar REACT_STATICS = {\n  childContextTypes: true,\n  contextType: true,\n  contextTypes: true,\n  defaultProps: true,\n  displayName: true,\n  getDefaultProps: true,\n  getDerivedStateFromError: true,\n  getDerivedStateFromProps: true,\n  mixins: true,\n  propTypes: true,\n  type: true\n};\nvar KNOWN_STATICS = {\n  name: true,\n  length: true,\n  prototype: true,\n  caller: true,\n  callee: true,\n  arguments: true,\n  arity: true\n};\nvar FORWARD_REF_STATICS = {\n  '$$typeof': true,\n  render: true,\n  defaultProps: true,\n  displayName: true,\n  propTypes: true\n};\nvar MEMO_STATICS = {\n  '$$typeof': true,\n  compare: true,\n  defaultProps: true,\n  displayName: true,\n  propTypes: true,\n  type: true\n};\nvar TYPE_STATICS = {};\nTYPE_STATICS[reactIs.ForwardRef] = FORWARD_REF_STATICS;\nTYPE_STATICS[reactIs.Memo] = MEMO_STATICS;\n\nfunction getStatics(component) {\n  // React v16.11 and below\n  if (reactIs.isMemo(component)) {\n    return MEMO_STATICS;\n  } // React v16.12 and above\n\n\n  return TYPE_STATICS[component['$$typeof']] || REACT_STATICS;\n}\n\nvar defineProperty = Object.defineProperty;\nvar getOwnPropertyNames = Object.getOwnPropertyNames;\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nvar getPrototypeOf = Object.getPrototypeOf;\nvar objectPrototype = Object.prototype;\nfunction hoistNonReactStatics(targetComponent, sourceComponent, blacklist) {\n  if (typeof sourceComponent !== 'string') {\n    // don't hoist over string (html) components\n    if (objectPrototype) {\n      var inheritedComponent = getPrototypeOf(sourceComponent);\n\n      if (inheritedComponent && inheritedComponent !== objectPrototype) {\n        hoistNonReactStatics(targetComponent, inheritedComponent, blacklist);\n      }\n    }\n\n    var keys = getOwnPropertyNames(sourceComponent);\n\n    if (getOwnPropertySymbols) {\n      keys = keys.concat(getOwnPropertySymbols(sourceComponent));\n    }\n\n    var targetStatics = getStatics(targetComponent);\n    var sourceStatics = getStatics(sourceComponent);\n\n    for (var i = 0; i < keys.length; ++i) {\n      var key = keys[i];\n\n      if (!KNOWN_STATICS[key] && !(blacklist && blacklist[key]) && !(sourceStatics && sourceStatics[key]) && !(targetStatics && targetStatics[key])) {\n        var descriptor = getOwnPropertyDescriptor(sourceComponent, key);\n\n        try {\n          // Avoid failures from read-only properties\n          defineProperty(targetComponent, key, descriptor);\n        } catch (e) {}\n      }\n    }\n  }\n\n  return targetComponent;\n}\n\nmodule.exports = hoistNonReactStatics;\n","/** @license React v16.13.1\n * react-is.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';var b=\"function\"===typeof Symbol&&Symbol.for,c=b?Symbol.for(\"react.element\"):60103,d=b?Symbol.for(\"react.portal\"):60106,e=b?Symbol.for(\"react.fragment\"):60107,f=b?Symbol.for(\"react.strict_mode\"):60108,g=b?Symbol.for(\"react.profiler\"):60114,h=b?Symbol.for(\"react.provider\"):60109,k=b?Symbol.for(\"react.context\"):60110,l=b?Symbol.for(\"react.async_mode\"):60111,m=b?Symbol.for(\"react.concurrent_mode\"):60111,n=b?Symbol.for(\"react.forward_ref\"):60112,p=b?Symbol.for(\"react.suspense\"):60113,q=b?\nSymbol.for(\"react.suspense_list\"):60120,r=b?Symbol.for(\"react.memo\"):60115,t=b?Symbol.for(\"react.lazy\"):60116,v=b?Symbol.for(\"react.block\"):60121,w=b?Symbol.for(\"react.fundamental\"):60117,x=b?Symbol.for(\"react.responder\"):60118,y=b?Symbol.for(\"react.scope\"):60119;\nfunction z(a){if(\"object\"===typeof a&&null!==a){var u=a.$$typeof;switch(u){case c:switch(a=a.type,a){case l:case m:case e:case g:case f:case p:return a;default:switch(a=a&&a.$$typeof,a){case k:case n:case t:case r:case h:return a;default:return u}}case d:return u}}}function A(a){return z(a)===m}exports.AsyncMode=l;exports.ConcurrentMode=m;exports.ContextConsumer=k;exports.ContextProvider=h;exports.Element=c;exports.ForwardRef=n;exports.Fragment=e;exports.Lazy=t;exports.Memo=r;exports.Portal=d;\nexports.Profiler=g;exports.StrictMode=f;exports.Suspense=p;exports.isAsyncMode=function(a){return A(a)||z(a)===l};exports.isConcurrentMode=A;exports.isContextConsumer=function(a){return z(a)===k};exports.isContextProvider=function(a){return z(a)===h};exports.isElement=function(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===c};exports.isForwardRef=function(a){return z(a)===n};exports.isFragment=function(a){return z(a)===e};exports.isLazy=function(a){return z(a)===t};\nexports.isMemo=function(a){return z(a)===r};exports.isPortal=function(a){return z(a)===d};exports.isProfiler=function(a){return z(a)===g};exports.isStrictMode=function(a){return z(a)===f};exports.isSuspense=function(a){return z(a)===p};\nexports.isValidElementType=function(a){return\"string\"===typeof a||\"function\"===typeof a||a===e||a===m||a===g||a===f||a===p||a===q||\"object\"===typeof a&&null!==a&&(a.$$typeof===t||a.$$typeof===r||a.$$typeof===h||a.$$typeof===k||a.$$typeof===n||a.$$typeof===w||a.$$typeof===x||a.$$typeof===y||a.$$typeof===v)};exports.typeOf=z;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-is.production.min.js');\n} else {\n  module.exports = require('./cjs/react-is.development.js');\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar react_1 = require(\"react\");\nvar useAsyncFn_1 = tslib_1.__importDefault(require(\"./useAsyncFn\"));\nfunction useAsync(fn, deps) {\n    if (deps === void 0) { deps = []; }\n    var _a = useAsyncFn_1.default(fn, deps, {\n        loading: true,\n    }), state = _a[0], callback = _a[1];\n    react_1.useEffect(function () {\n        callback();\n    }, [callback]);\n    return state;\n}\nexports.default = useAsync;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar react_1 = require(\"react\");\nvar useMountedState_1 = tslib_1.__importDefault(require(\"./useMountedState\"));\nfunction useAsyncFn(fn, deps, initialState) {\n    if (deps === void 0) { deps = []; }\n    if (initialState === void 0) { initialState = { loading: false }; }\n    var lastCallId = react_1.useRef(0);\n    var isMounted = useMountedState_1.default();\n    var _a = react_1.useState(initialState), state = _a[0], set = _a[1];\n    var callback = react_1.useCallback(function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var callId = ++lastCallId.current;\n        if (!state.loading) {\n            set(function (prevState) { return (tslib_1.__assign(tslib_1.__assign({}, prevState), { loading: true })); });\n        }\n        return fn.apply(void 0, args).then(function (value) {\n            isMounted() && callId === lastCallId.current && set({ value: value, loading: false });\n            return value;\n        }, function (error) {\n            isMounted() && callId === lastCallId.current && set({ error: error, loading: false });\n            return error;\n        });\n    }, deps);\n    return [state, callback];\n}\nexports.default = useAsyncFn;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = require(\"react\");\nfunction useMountedState() {\n    var mountedRef = react_1.useRef(false);\n    var get = react_1.useCallback(function () { return mountedRef.current; }, []);\n    react_1.useEffect(function () {\n        mountedRef.current = true;\n        return function () {\n            mountedRef.current = false;\n        };\n    }, []);\n    return get;\n}\nexports.default = useMountedState;\n","const ANY = Symbol('SemVer ANY')\n// hoisted class for cyclic dependency\nclass Comparator {\n  static get ANY () {\n    return ANY\n  }\n\n  constructor (comp, options) {\n    options = parseOptions(options)\n\n    if (comp instanceof Comparator) {\n      if (comp.loose === !!options.loose) {\n        return comp\n      } else {\n        comp = comp.value\n      }\n    }\n\n    comp = comp.trim().split(/\\s+/).join(' ')\n    debug('comparator', comp, options)\n    this.options = options\n    this.loose = !!options.loose\n    this.parse(comp)\n\n    if (this.semver === ANY) {\n      this.value = ''\n    } else {\n      this.value = this.operator + this.semver.version\n    }\n\n    debug('comp', this)\n  }\n\n  parse (comp) {\n    const r = this.options.loose ? re[t.COMPARATORLOOSE] : re[t.COMPARATOR]\n    const m = comp.match(r)\n\n    if (!m) {\n      throw new TypeError(`Invalid comparator: ${comp}`)\n    }\n\n    this.operator = m[1] !== undefined ? m[1] : ''\n    if (this.operator === '=') {\n      this.operator = ''\n    }\n\n    // if it literally is just '>' or '' then allow anything.\n    if (!m[2]) {\n      this.semver = ANY\n    } else {\n      this.semver = new SemVer(m[2], this.options.loose)\n    }\n  }\n\n  toString () {\n    return this.value\n  }\n\n  test (version) {\n    debug('Comparator.test', version, this.options.loose)\n\n    if (this.semver === ANY || version === ANY) {\n      return true\n    }\n\n    if (typeof version === 'string') {\n      try {\n        version = new SemVer(version, this.options)\n      } catch (er) {\n        return false\n      }\n    }\n\n    return cmp(version, this.operator, this.semver, this.options)\n  }\n\n  intersects (comp, options) {\n    if (!(comp instanceof Comparator)) {\n      throw new TypeError('a Comparator is required')\n    }\n\n    if (this.operator === '') {\n      if (this.value === '') {\n        return true\n      }\n      return new Range(comp.value, options).test(this.value)\n    } else if (comp.operator === '') {\n      if (comp.value === '') {\n        return true\n      }\n      return new Range(this.value, options).test(comp.semver)\n    }\n\n    options = parseOptions(options)\n\n    // Special cases where nothing can possibly be lower\n    if (options.includePrerelease &&\n      (this.value === '<0.0.0-0' || comp.value === '<0.0.0-0')) {\n      return false\n    }\n    if (!options.includePrerelease &&\n      (this.value.startsWith('<0.0.0') || comp.value.startsWith('<0.0.0'))) {\n      return false\n    }\n\n    // Same direction increasing (> or >=)\n    if (this.operator.startsWith('>') && comp.operator.startsWith('>')) {\n      return true\n    }\n    // Same direction decreasing (< or <=)\n    if (this.operator.startsWith('<') && comp.operator.startsWith('<')) {\n      return true\n    }\n    // same SemVer and both sides are inclusive (<= or >=)\n    if (\n      (this.semver.version === comp.semver.version) &&\n      this.operator.includes('=') && comp.operator.includes('=')) {\n      return true\n    }\n    // opposite directions less than\n    if (cmp(this.semver, '<', comp.semver, options) &&\n      this.operator.startsWith('>') && comp.operator.startsWith('<')) {\n      return true\n    }\n    // opposite directions greater than\n    if (cmp(this.semver, '>', comp.semver, options) &&\n      this.operator.startsWith('<') && comp.operator.startsWith('>')) {\n      return true\n    }\n    return false\n  }\n}\n\nmodule.exports = Comparator\n\nconst parseOptions = require('../internal/parse-options')\nconst { safeRe: re, t } = require('../internal/re')\nconst cmp = require('../functions/cmp')\nconst debug = require('../internal/debug')\nconst SemVer = require('./semver')\nconst Range = require('./range')\n","// hoisted class for cyclic dependency\nclass Range {\n  constructor (range, options) {\n    options = parseOptions(options)\n\n    if (range instanceof Range) {\n      if (\n        range.loose === !!options.loose &&\n        range.includePrerelease === !!options.includePrerelease\n      ) {\n        return range\n      } else {\n        return new Range(range.raw, options)\n      }\n    }\n\n    if (range instanceof Comparator) {\n      // just put it in the set and return\n      this.raw = range.value\n      this.set = [[range]]\n      this.format()\n      return this\n    }\n\n    this.options = options\n    this.loose = !!options.loose\n    this.includePrerelease = !!options.includePrerelease\n\n    // First reduce all whitespace as much as possible so we do not have to rely\n    // on potentially slow regexes like \\s*. This is then stored and used for\n    // future error messages as well.\n    this.raw = range\n      .trim()\n      .split(/\\s+/)\n      .join(' ')\n\n    // First, split on ||\n    this.set = this.raw\n      .split('||')\n      // map the range to a 2d array of comparators\n      .map(r => this.parseRange(r.trim()))\n      // throw out any comparator lists that are empty\n      // this generally means that it was not a valid range, which is allowed\n      // in loose mode, but will still throw if the WHOLE range is invalid.\n      .filter(c => c.length)\n\n    if (!this.set.length) {\n      throw new TypeError(`Invalid SemVer Range: ${this.raw}`)\n    }\n\n    // if we have any that are not the null set, throw out null sets.\n    if (this.set.length > 1) {\n      // keep the first one, in case they're all null sets\n      const first = this.set[0]\n      this.set = this.set.filter(c => !isNullSet(c[0]))\n      if (this.set.length === 0) {\n        this.set = [first]\n      } else if (this.set.length > 1) {\n        // if we have any that are *, then the range is just *\n        for (const c of this.set) {\n          if (c.length === 1 && isAny(c[0])) {\n            this.set = [c]\n            break\n          }\n        }\n      }\n    }\n\n    this.format()\n  }\n\n  format () {\n    this.range = this.set\n      .map((comps) => comps.join(' ').trim())\n      .join('||')\n      .trim()\n    return this.range\n  }\n\n  toString () {\n    return this.range\n  }\n\n  parseRange (range) {\n    // memoize range parsing for performance.\n    // this is a very hot path, and fully deterministic.\n    const memoOpts =\n      (this.options.includePrerelease && FLAG_INCLUDE_PRERELEASE) |\n      (this.options.loose && FLAG_LOOSE)\n    const memoKey = memoOpts + ':' + range\n    const cached = cache.get(memoKey)\n    if (cached) {\n      return cached\n    }\n\n    const loose = this.options.loose\n    // `1.2.3 - 1.2.4` => `>=1.2.3 <=1.2.4`\n    const hr = loose ? re[t.HYPHENRANGELOOSE] : re[t.HYPHENRANGE]\n    range = range.replace(hr, hyphenReplace(this.options.includePrerelease))\n    debug('hyphen replace', range)\n\n    // `> 1.2.3 < 1.2.5` => `>1.2.3 <1.2.5`\n    range = range.replace(re[t.COMPARATORTRIM], comparatorTrimReplace)\n    debug('comparator trim', range)\n\n    // `~ 1.2.3` => `~1.2.3`\n    range = range.replace(re[t.TILDETRIM], tildeTrimReplace)\n    debug('tilde trim', range)\n\n    // `^ 1.2.3` => `^1.2.3`\n    range = range.replace(re[t.CARETTRIM], caretTrimReplace)\n    debug('caret trim', range)\n\n    // At this point, the range is completely trimmed and\n    // ready to be split into comparators.\n\n    let rangeList = range\n      .split(' ')\n      .map(comp => parseComparator(comp, this.options))\n      .join(' ')\n      .split(/\\s+/)\n      // >=0.0.0 is equivalent to *\n      .map(comp => replaceGTE0(comp, this.options))\n\n    if (loose) {\n      // in loose mode, throw out any that are not valid comparators\n      rangeList = rangeList.filter(comp => {\n        debug('loose invalid filter', comp, this.options)\n        return !!comp.match(re[t.COMPARATORLOOSE])\n      })\n    }\n    debug('range list', rangeList)\n\n    // if any comparators are the null set, then replace with JUST null set\n    // if more than one comparator, remove any * comparators\n    // also, don't include the same comparator more than once\n    const rangeMap = new Map()\n    const comparators = rangeList.map(comp => new Comparator(comp, this.options))\n    for (const comp of comparators) {\n      if (isNullSet(comp)) {\n        return [comp]\n      }\n      rangeMap.set(comp.value, comp)\n    }\n    if (rangeMap.size > 1 && rangeMap.has('')) {\n      rangeMap.delete('')\n    }\n\n    const result = [...rangeMap.values()]\n    cache.set(memoKey, result)\n    return result\n  }\n\n  intersects (range, options) {\n    if (!(range instanceof Range)) {\n      throw new TypeError('a Range is required')\n    }\n\n    return this.set.some((thisComparators) => {\n      return (\n        isSatisfiable(thisComparators, options) &&\n        range.set.some((rangeComparators) => {\n          return (\n            isSatisfiable(rangeComparators, options) &&\n            thisComparators.every((thisComparator) => {\n              return rangeComparators.every((rangeComparator) => {\n                return thisComparator.intersects(rangeComparator, options)\n              })\n            })\n          )\n        })\n      )\n    })\n  }\n\n  // if ANY of the sets match ALL of its comparators, then pass\n  test (version) {\n    if (!version) {\n      return false\n    }\n\n    if (typeof version === 'string') {\n      try {\n        version = new SemVer(version, this.options)\n      } catch (er) {\n        return false\n      }\n    }\n\n    for (let i = 0; i < this.set.length; i++) {\n      if (testSet(this.set[i], version, this.options)) {\n        return true\n      }\n    }\n    return false\n  }\n}\n\nmodule.exports = Range\n\nconst LRU = require('lru-cache')\nconst cache = new LRU({ max: 1000 })\n\nconst parseOptions = require('../internal/parse-options')\nconst Comparator = require('./comparator')\nconst debug = require('../internal/debug')\nconst SemVer = require('./semver')\nconst {\n  safeRe: re,\n  t,\n  comparatorTrimReplace,\n  tildeTrimReplace,\n  caretTrimReplace,\n} = require('../internal/re')\nconst { FLAG_INCLUDE_PRERELEASE, FLAG_LOOSE } = require('../internal/constants')\n\nconst isNullSet = c => c.value === '<0.0.0-0'\nconst isAny = c => c.value === ''\n\n// take a set of comparators and determine whether there\n// exists a version which can satisfy it\nconst isSatisfiable = (comparators, options) => {\n  let result = true\n  const remainingComparators = comparators.slice()\n  let testComparator = remainingComparators.pop()\n\n  while (result && remainingComparators.length) {\n    result = remainingComparators.every((otherComparator) => {\n      return testComparator.intersects(otherComparator, options)\n    })\n\n    testComparator = remainingComparators.pop()\n  }\n\n  return result\n}\n\n// comprised of xranges, tildes, stars, and gtlt's at this point.\n// already replaced the hyphen ranges\n// turn into a set of JUST comparators.\nconst parseComparator = (comp, options) => {\n  debug('comp', comp, options)\n  comp = replaceCarets(comp, options)\n  debug('caret', comp)\n  comp = replaceTildes(comp, options)\n  debug('tildes', comp)\n  comp = replaceXRanges(comp, options)\n  debug('xrange', comp)\n  comp = replaceStars(comp, options)\n  debug('stars', comp)\n  return comp\n}\n\nconst isX = id => !id || id.toLowerCase() === 'x' || id === '*'\n\n// ~, ~> --> * (any, kinda silly)\n// ~2, ~2.x, ~2.x.x, ~>2, ~>2.x ~>2.x.x --> >=2.0.0 <3.0.0-0\n// ~2.0, ~2.0.x, ~>2.0, ~>2.0.x --> >=2.0.0 <2.1.0-0\n// ~1.2, ~1.2.x, ~>1.2, ~>1.2.x --> >=1.2.0 <1.3.0-0\n// ~1.2.3, ~>1.2.3 --> >=1.2.3 <1.3.0-0\n// ~1.2.0, ~>1.2.0 --> >=1.2.0 <1.3.0-0\n// ~0.0.1 --> >=0.0.1 <0.1.0-0\nconst replaceTildes = (comp, options) => {\n  return comp\n    .trim()\n    .split(/\\s+/)\n    .map((c) => replaceTilde(c, options))\n    .join(' ')\n}\n\nconst replaceTilde = (comp, options) => {\n  const r = options.loose ? re[t.TILDELOOSE] : re[t.TILDE]\n  return comp.replace(r, (_, M, m, p, pr) => {\n    debug('tilde', comp, _, M, m, p, pr)\n    let ret\n\n    if (isX(M)) {\n      ret = ''\n    } else if (isX(m)) {\n      ret = `>=${M}.0.0 <${+M + 1}.0.0-0`\n    } else if (isX(p)) {\n      // ~1.2 == >=1.2.0 <1.3.0-0\n      ret = `>=${M}.${m}.0 <${M}.${+m + 1}.0-0`\n    } else if (pr) {\n      debug('replaceTilde pr', pr)\n      ret = `>=${M}.${m}.${p}-${pr\n      } <${M}.${+m + 1}.0-0`\n    } else {\n      // ~1.2.3 == >=1.2.3 <1.3.0-0\n      ret = `>=${M}.${m}.${p\n      } <${M}.${+m + 1}.0-0`\n    }\n\n    debug('tilde return', ret)\n    return ret\n  })\n}\n\n// ^ --> * (any, kinda silly)\n// ^2, ^2.x, ^2.x.x --> >=2.0.0 <3.0.0-0\n// ^2.0, ^2.0.x --> >=2.0.0 <3.0.0-0\n// ^1.2, ^1.2.x --> >=1.2.0 <2.0.0-0\n// ^1.2.3 --> >=1.2.3 <2.0.0-0\n// ^1.2.0 --> >=1.2.0 <2.0.0-0\n// ^0.0.1 --> >=0.0.1 <0.0.2-0\n// ^0.1.0 --> >=0.1.0 <0.2.0-0\nconst replaceCarets = (comp, options) => {\n  return comp\n    .trim()\n    .split(/\\s+/)\n    .map((c) => replaceCaret(c, options))\n    .join(' ')\n}\n\nconst replaceCaret = (comp, options) => {\n  debug('caret', comp, options)\n  const r = options.loose ? re[t.CARETLOOSE] : re[t.CARET]\n  const z = options.includePrerelease ? '-0' : ''\n  return comp.replace(r, (_, M, m, p, pr) => {\n    debug('caret', comp, _, M, m, p, pr)\n    let ret\n\n    if (isX(M)) {\n      ret = ''\n    } else if (isX(m)) {\n      ret = `>=${M}.0.0${z} <${+M + 1}.0.0-0`\n    } else if (isX(p)) {\n      if (M === '0') {\n        ret = `>=${M}.${m}.0${z} <${M}.${+m + 1}.0-0`\n      } else {\n        ret = `>=${M}.${m}.0${z} <${+M + 1}.0.0-0`\n      }\n    } else if (pr) {\n      debug('replaceCaret pr', pr)\n      if (M === '0') {\n        if (m === '0') {\n          ret = `>=${M}.${m}.${p}-${pr\n          } <${M}.${m}.${+p + 1}-0`\n        } else {\n          ret = `>=${M}.${m}.${p}-${pr\n          } <${M}.${+m + 1}.0-0`\n        }\n      } else {\n        ret = `>=${M}.${m}.${p}-${pr\n        } <${+M + 1}.0.0-0`\n      }\n    } else {\n      debug('no pr')\n      if (M === '0') {\n        if (m === '0') {\n          ret = `>=${M}.${m}.${p\n          }${z} <${M}.${m}.${+p + 1}-0`\n        } else {\n          ret = `>=${M}.${m}.${p\n          }${z} <${M}.${+m + 1}.0-0`\n        }\n      } else {\n        ret = `>=${M}.${m}.${p\n        } <${+M + 1}.0.0-0`\n      }\n    }\n\n    debug('caret return', ret)\n    return ret\n  })\n}\n\nconst replaceXRanges = (comp, options) => {\n  debug('replaceXRanges', comp, options)\n  return comp\n    .split(/\\s+/)\n    .map((c) => replaceXRange(c, options))\n    .join(' ')\n}\n\nconst replaceXRange = (comp, options) => {\n  comp = comp.trim()\n  const r = options.loose ? re[t.XRANGELOOSE] : re[t.XRANGE]\n  return comp.replace(r, (ret, gtlt, M, m, p, pr) => {\n    debug('xRange', comp, ret, gtlt, M, m, p, pr)\n    const xM = isX(M)\n    const xm = xM || isX(m)\n    const xp = xm || isX(p)\n    const anyX = xp\n\n    if (gtlt === '=' && anyX) {\n      gtlt = ''\n    }\n\n    // if we're including prereleases in the match, then we need\n    // to fix this to -0, the lowest possible prerelease value\n    pr = options.includePrerelease ? '-0' : ''\n\n    if (xM) {\n      if (gtlt === '>' || gtlt === '<') {\n        // nothing is allowed\n        ret = '<0.0.0-0'\n      } else {\n        // nothing is forbidden\n        ret = '*'\n      }\n    } else if (gtlt && anyX) {\n      // we know patch is an x, because we have any x at all.\n      // replace X with 0\n      if (xm) {\n        m = 0\n      }\n      p = 0\n\n      if (gtlt === '>') {\n        // >1 => >=2.0.0\n        // >1.2 => >=1.3.0\n        gtlt = '>='\n        if (xm) {\n          M = +M + 1\n          m = 0\n          p = 0\n        } else {\n          m = +m + 1\n          p = 0\n        }\n      } else if (gtlt === '<=') {\n        // <=0.7.x is actually <0.8.0, since any 0.7.x should\n        // pass.  Similarly, <=7.x is actually <8.0.0, etc.\n        gtlt = '<'\n        if (xm) {\n          M = +M + 1\n        } else {\n          m = +m + 1\n        }\n      }\n\n      if (gtlt === '<') {\n        pr = '-0'\n      }\n\n      ret = `${gtlt + M}.${m}.${p}${pr}`\n    } else if (xm) {\n      ret = `>=${M}.0.0${pr} <${+M + 1}.0.0-0`\n    } else if (xp) {\n      ret = `>=${M}.${m}.0${pr\n      } <${M}.${+m + 1}.0-0`\n    }\n\n    debug('xRange return', ret)\n\n    return ret\n  })\n}\n\n// Because * is AND-ed with everything else in the comparator,\n// and '' means \"any version\", just remove the *s entirely.\nconst replaceStars = (comp, options) => {\n  debug('replaceStars', comp, options)\n  // Looseness is ignored here.  star is always as loose as it gets!\n  return comp\n    .trim()\n    .replace(re[t.STAR], '')\n}\n\nconst replaceGTE0 = (comp, options) => {\n  debug('replaceGTE0', comp, options)\n  return comp\n    .trim()\n    .replace(re[options.includePrerelease ? t.GTE0PRE : t.GTE0], '')\n}\n\n// This function is passed to string.replace(re[t.HYPHENRANGE])\n// M, m, patch, prerelease, build\n// 1.2 - 3.4.5 => >=1.2.0 <=3.4.5\n// 1.2.3 - 3.4 => >=1.2.0 <3.5.0-0 Any 3.4.x will do\n// 1.2 - 3.4 => >=1.2.0 <3.5.0-0\nconst hyphenReplace = incPr => ($0,\n  from, fM, fm, fp, fpr, fb,\n  to, tM, tm, tp, tpr, tb) => {\n  if (isX(fM)) {\n    from = ''\n  } else if (isX(fm)) {\n    from = `>=${fM}.0.0${incPr ? '-0' : ''}`\n  } else if (isX(fp)) {\n    from = `>=${fM}.${fm}.0${incPr ? '-0' : ''}`\n  } else if (fpr) {\n    from = `>=${from}`\n  } else {\n    from = `>=${from}${incPr ? '-0' : ''}`\n  }\n\n  if (isX(tM)) {\n    to = ''\n  } else if (isX(tm)) {\n    to = `<${+tM + 1}.0.0-0`\n  } else if (isX(tp)) {\n    to = `<${tM}.${+tm + 1}.0-0`\n  } else if (tpr) {\n    to = `<=${tM}.${tm}.${tp}-${tpr}`\n  } else if (incPr) {\n    to = `<${tM}.${tm}.${+tp + 1}-0`\n  } else {\n    to = `<=${to}`\n  }\n\n  return `${from} ${to}`.trim()\n}\n\nconst testSet = (set, version, options) => {\n  for (let i = 0; i < set.length; i++) {\n    if (!set[i].test(version)) {\n      return false\n    }\n  }\n\n  if (version.prerelease.length && !options.includePrerelease) {\n    // Find the set of versions that are allowed to have prereleases\n    // For example, ^1.2.3-pr.1 desugars to >=1.2.3-pr.1 <2.0.0\n    // That should allow `1.2.3-pr.2` to pass.\n    // However, `1.2.4-alpha.notready` should NOT be allowed,\n    // even though it's within the range set by the comparators.\n    for (let i = 0; i < set.length; i++) {\n      debug(set[i].semver)\n      if (set[i].semver === Comparator.ANY) {\n        continue\n      }\n\n      if (set[i].semver.prerelease.length > 0) {\n        const allowed = set[i].semver\n        if (allowed.major === version.major &&\n            allowed.minor === version.minor &&\n            allowed.patch === version.patch) {\n          return true\n        }\n      }\n    }\n\n    // Version has a -pre, but it's not one of the ones we like.\n    return false\n  }\n\n  return true\n}\n","const debug = require('../internal/debug')\nconst { MAX_LENGTH, MAX_SAFE_INTEGER } = require('../internal/constants')\nconst { safeRe: re, t } = require('../internal/re')\n\nconst parseOptions = require('../internal/parse-options')\nconst { compareIdentifiers } = require('../internal/identifiers')\nclass SemVer {\n  constructor (version, options) {\n    options = parseOptions(options)\n\n    if (version instanceof SemVer) {\n      if (version.loose === !!options.loose &&\n          version.includePrerelease === !!options.includePrerelease) {\n        return version\n      } else {\n        version = version.version\n      }\n    } else if (typeof version !== 'string') {\n      throw new TypeError(`Invalid version. Must be a string. Got type \"${typeof version}\".`)\n    }\n\n    if (version.length > MAX_LENGTH) {\n      throw new TypeError(\n        `version is longer than ${MAX_LENGTH} characters`\n      )\n    }\n\n    debug('SemVer', version, options)\n    this.options = options\n    this.loose = !!options.loose\n    // this isn't actually relevant for versions, but keep it so that we\n    // don't run into trouble passing this.options around.\n    this.includePrerelease = !!options.includePrerelease\n\n    const m = version.trim().match(options.loose ? re[t.LOOSE] : re[t.FULL])\n\n    if (!m) {\n      throw new TypeError(`Invalid Version: ${version}`)\n    }\n\n    this.raw = version\n\n    // these are actually numbers\n    this.major = +m[1]\n    this.minor = +m[2]\n    this.patch = +m[3]\n\n    if (this.major > MAX_SAFE_INTEGER || this.major < 0) {\n      throw new TypeError('Invalid major version')\n    }\n\n    if (this.minor > MAX_SAFE_INTEGER || this.minor < 0) {\n      throw new TypeError('Invalid minor version')\n    }\n\n    if (this.patch > MAX_SAFE_INTEGER || this.patch < 0) {\n      throw new TypeError('Invalid patch version')\n    }\n\n    // numberify any prerelease numeric ids\n    if (!m[4]) {\n      this.prerelease = []\n    } else {\n      this.prerelease = m[4].split('.').map((id) => {\n        if (/^[0-9]+$/.test(id)) {\n          const num = +id\n          if (num >= 0 && num < MAX_SAFE_INTEGER) {\n            return num\n          }\n        }\n        return id\n      })\n    }\n\n    this.build = m[5] ? m[5].split('.') : []\n    this.format()\n  }\n\n  format () {\n    this.version = `${this.major}.${this.minor}.${this.patch}`\n    if (this.prerelease.length) {\n      this.version += `-${this.prerelease.join('.')}`\n    }\n    return this.version\n  }\n\n  toString () {\n    return this.version\n  }\n\n  compare (other) {\n    debug('SemVer.compare', this.version, this.options, other)\n    if (!(other instanceof SemVer)) {\n      if (typeof other === 'string' && other === this.version) {\n        return 0\n      }\n      other = new SemVer(other, this.options)\n    }\n\n    if (other.version === this.version) {\n      return 0\n    }\n\n    return this.compareMain(other) || this.comparePre(other)\n  }\n\n  compareMain (other) {\n    if (!(other instanceof SemVer)) {\n      other = new SemVer(other, this.options)\n    }\n\n    return (\n      compareIdentifiers(this.major, other.major) ||\n      compareIdentifiers(this.minor, other.minor) ||\n      compareIdentifiers(this.patch, other.patch)\n    )\n  }\n\n  comparePre (other) {\n    if (!(other instanceof SemVer)) {\n      other = new SemVer(other, this.options)\n    }\n\n    // NOT having a prerelease is > having one\n    if (this.prerelease.length && !other.prerelease.length) {\n      return -1\n    } else if (!this.prerelease.length && other.prerelease.length) {\n      return 1\n    } else if (!this.prerelease.length && !other.prerelease.length) {\n      return 0\n    }\n\n    let i = 0\n    do {\n      const a = this.prerelease[i]\n      const b = other.prerelease[i]\n      debug('prerelease compare', i, a, b)\n      if (a === undefined && b === undefined) {\n        return 0\n      } else if (b === undefined) {\n        return 1\n      } else if (a === undefined) {\n        return -1\n      } else if (a === b) {\n        continue\n      } else {\n        return compareIdentifiers(a, b)\n      }\n    } while (++i)\n  }\n\n  compareBuild (other) {\n    if (!(other instanceof SemVer)) {\n      other = new SemVer(other, this.options)\n    }\n\n    let i = 0\n    do {\n      const a = this.build[i]\n      const b = other.build[i]\n      debug('prerelease compare', i, a, b)\n      if (a === undefined && b === undefined) {\n        return 0\n      } else if (b === undefined) {\n        return 1\n      } else if (a === undefined) {\n        return -1\n      } else if (a === b) {\n        continue\n      } else {\n        return compareIdentifiers(a, b)\n      }\n    } while (++i)\n  }\n\n  // preminor will bump the version up to the next minor release, and immediately\n  // down to pre-release. premajor and prepatch work the same way.\n  inc (release, identifier, identifierBase) {\n    switch (release) {\n      case 'premajor':\n        this.prerelease.length = 0\n        this.patch = 0\n        this.minor = 0\n        this.major++\n        this.inc('pre', identifier, identifierBase)\n        break\n      case 'preminor':\n        this.prerelease.length = 0\n        this.patch = 0\n        this.minor++\n        this.inc('pre', identifier, identifierBase)\n        break\n      case 'prepatch':\n        // If this is already a prerelease, it will bump to the next version\n        // drop any prereleases that might already exist, since they are not\n        // relevant at this point.\n        this.prerelease.length = 0\n        this.inc('patch', identifier, identifierBase)\n        this.inc('pre', identifier, identifierBase)\n        break\n      // If the input is a non-prerelease version, this acts the same as\n      // prepatch.\n      case 'prerelease':\n        if (this.prerelease.length === 0) {\n          this.inc('patch', identifier, identifierBase)\n        }\n        this.inc('pre', identifier, identifierBase)\n        break\n\n      case 'major':\n        // If this is a pre-major version, bump up to the same major version.\n        // Otherwise increment major.\n        // 1.0.0-5 bumps to 1.0.0\n        // 1.1.0 bumps to 2.0.0\n        if (\n          this.minor !== 0 ||\n          this.patch !== 0 ||\n          this.prerelease.length === 0\n        ) {\n          this.major++\n        }\n        this.minor = 0\n        this.patch = 0\n        this.prerelease = []\n        break\n      case 'minor':\n        // If this is a pre-minor version, bump up to the same minor version.\n        // Otherwise increment minor.\n        // 1.2.0-5 bumps to 1.2.0\n        // 1.2.1 bumps to 1.3.0\n        if (this.patch !== 0 || this.prerelease.length === 0) {\n          this.minor++\n        }\n        this.patch = 0\n        this.prerelease = []\n        break\n      case 'patch':\n        // If this is not a pre-release version, it will increment the patch.\n        // If it is a pre-release it will bump up to the same patch version.\n        // 1.2.0-5 patches to 1.2.0\n        // 1.2.0 patches to 1.2.1\n        if (this.prerelease.length === 0) {\n          this.patch++\n        }\n        this.prerelease = []\n        break\n      // This probably shouldn't be used publicly.\n      // 1.0.0 'pre' would become 1.0.0-0 which is the wrong direction.\n      case 'pre': {\n        const base = Number(identifierBase) ? 1 : 0\n\n        if (!identifier && identifierBase === false) {\n          throw new Error('invalid increment argument: identifier is empty')\n        }\n\n        if (this.prerelease.length === 0) {\n          this.prerelease = [base]\n        } else {\n          let i = this.prerelease.length\n          while (--i >= 0) {\n            if (typeof this.prerelease[i] === 'number') {\n              this.prerelease[i]++\n              i = -2\n            }\n          }\n          if (i === -1) {\n            // didn't increment anything\n            if (identifier === this.prerelease.join('.') && identifierBase === false) {\n              throw new Error('invalid increment argument: identifier already exists')\n            }\n            this.prerelease.push(base)\n          }\n        }\n        if (identifier) {\n          // 1.2.0-beta.1 bumps to 1.2.0-beta.2,\n          // 1.2.0-beta.fooblz or 1.2.0-beta bumps to 1.2.0-beta.0\n          let prerelease = [identifier, base]\n          if (identifierBase === false) {\n            prerelease = [identifier]\n          }\n          if (compareIdentifiers(this.prerelease[0], identifier) === 0) {\n            if (isNaN(this.prerelease[1])) {\n              this.prerelease = prerelease\n            }\n          } else {\n            this.prerelease = prerelease\n          }\n        }\n        break\n      }\n      default:\n        throw new Error(`invalid increment argument: ${release}`)\n    }\n    this.raw = this.format()\n    if (this.build.length) {\n      this.raw += `+${this.build.join('.')}`\n    }\n    return this\n  }\n}\n\nmodule.exports = SemVer\n","const parse = require('./parse')\nconst clean = (version, options) => {\n  const s = parse(version.trim().replace(/^[=v]+/, ''), options)\n  return s ? s.version : null\n}\nmodule.exports = clean\n","const eq = require('./eq')\nconst neq = require('./neq')\nconst gt = require('./gt')\nconst gte = require('./gte')\nconst lt = require('./lt')\nconst lte = require('./lte')\n\nconst cmp = (a, op, b, loose) => {\n  switch (op) {\n    case '===':\n      if (typeof a === 'object') {\n        a = a.version\n      }\n      if (typeof b === 'object') {\n        b = b.version\n      }\n      return a === b\n\n    case '!==':\n      if (typeof a === 'object') {\n        a = a.version\n      }\n      if (typeof b === 'object') {\n        b = b.version\n      }\n      return a !== b\n\n    case '':\n    case '=':\n    case '==':\n      return eq(a, b, loose)\n\n    case '!=':\n      return neq(a, b, loose)\n\n    case '>':\n      return gt(a, b, loose)\n\n    case '>=':\n      return gte(a, b, loose)\n\n    case '<':\n      return lt(a, b, loose)\n\n    case '<=':\n      return lte(a, b, loose)\n\n    default:\n      throw new TypeError(`Invalid operator: ${op}`)\n  }\n}\nmodule.exports = cmp\n","const SemVer = require('../classes/semver')\nconst parse = require('./parse')\nconst { safeRe: re, t } = require('../internal/re')\n\nconst coerce = (version, options) => {\n  if (version instanceof SemVer) {\n    return version\n  }\n\n  if (typeof version === 'number') {\n    version = String(version)\n  }\n\n  if (typeof version !== 'string') {\n    return null\n  }\n\n  options = options || {}\n\n  let match = null\n  if (!options.rtl) {\n    match = version.match(options.includePrerelease ? re[t.COERCEFULL] : re[t.COERCE])\n  } else {\n    // Find the right-most coercible string that does not share\n    // a terminus with a more left-ward coercible string.\n    // Eg, '1.2.3.4' wants to coerce '2.3.4', not '3.4' or '4'\n    // With includePrerelease option set, '1.2.3.4-rc' wants to coerce '2.3.4-rc', not '2.3.4'\n    //\n    // Walk through the string checking with a /g regexp\n    // Manually set the index so as to pick up overlapping matches.\n    // Stop when we get a match that ends at the string end, since no\n    // coercible string can be more right-ward without the same terminus.\n    const coerceRtlRegex = options.includePrerelease ? re[t.COERCERTLFULL] : re[t.COERCERTL]\n    let next\n    while ((next = coerceRtlRegex.exec(version)) &&\n        (!match || match.index + match[0].length !== version.length)\n    ) {\n      if (!match ||\n            next.index + next[0].length !== match.index + match[0].length) {\n        match = next\n      }\n      coerceRtlRegex.lastIndex = next.index + next[1].length + next[2].length\n    }\n    // leave it in a clean state\n    coerceRtlRegex.lastIndex = -1\n  }\n\n  if (match === null) {\n    return null\n  }\n\n  const major = match[2]\n  const minor = match[3] || '0'\n  const patch = match[4] || '0'\n  const prerelease = options.includePrerelease && match[5] ? `-${match[5]}` : ''\n  const build = options.includePrerelease && match[6] ? `+${match[6]}` : ''\n\n  return parse(`${major}.${minor}.${patch}${prerelease}${build}`, options)\n}\nmodule.exports = coerce\n","const SemVer = require('../classes/semver')\nconst compareBuild = (a, b, loose) => {\n  const versionA = new SemVer(a, loose)\n  const versionB = new SemVer(b, loose)\n  return versionA.compare(versionB) || versionA.compareBuild(versionB)\n}\nmodule.exports = compareBuild\n","const compare = require('./compare')\nconst compareLoose = (a, b) => compare(a, b, true)\nmodule.exports = compareLoose\n","const SemVer = require('../classes/semver')\nconst compare = (a, b, loose) =>\n  new SemVer(a, loose).compare(new SemVer(b, loose))\n\nmodule.exports = compare\n","const parse = require('./parse.js')\n\nconst diff = (version1, version2) => {\n  const v1 = parse(version1, null, true)\n  const v2 = parse(version2, null, true)\n  const comparison = v1.compare(v2)\n\n  if (comparison === 0) {\n    return null\n  }\n\n  const v1Higher = comparison > 0\n  const highVersion = v1Higher ? v1 : v2\n  const lowVersion = v1Higher ? v2 : v1\n  const highHasPre = !!highVersion.prerelease.length\n  const lowHasPre = !!lowVersion.prerelease.length\n\n  if (lowHasPre && !highHasPre) {\n    // Going from prerelease -> no prerelease requires some special casing\n\n    // If the low version has only a major, then it will always be a major\n    // Some examples:\n    // 1.0.0-1 -> 1.0.0\n    // 1.0.0-1 -> 1.1.1\n    // 1.0.0-1 -> 2.0.0\n    if (!lowVersion.patch && !lowVersion.minor) {\n      return 'major'\n    }\n\n    // Otherwise it can be determined by checking the high version\n\n    if (highVersion.patch) {\n      // anything higher than a patch bump would result in the wrong version\n      return 'patch'\n    }\n\n    if (highVersion.minor) {\n      // anything higher than a minor bump would result in the wrong version\n      return 'minor'\n    }\n\n    // bumping major/minor/patch all have same result\n    return 'major'\n  }\n\n  // add the `pre` prefix if we are going to a prerelease version\n  const prefix = highHasPre ? 'pre' : ''\n\n  if (v1.major !== v2.major) {\n    return prefix + 'major'\n  }\n\n  if (v1.minor !== v2.minor) {\n    return prefix + 'minor'\n  }\n\n  if (v1.patch !== v2.patch) {\n    return prefix + 'patch'\n  }\n\n  // high and low are preleases\n  return 'prerelease'\n}\n\nmodule.exports = diff\n","const compare = require('./compare')\nconst eq = (a, b, loose) => compare(a, b, loose) === 0\nmodule.exports = eq\n","const compare = require('./compare')\nconst gt = (a, b, loose) => compare(a, b, loose) > 0\nmodule.exports = gt\n","const compare = require('./compare')\nconst gte = (a, b, loose) => compare(a, b, loose) >= 0\nmodule.exports = gte\n","const SemVer = require('../classes/semver')\n\nconst inc = (version, release, options, identifier, identifierBase) => {\n  if (typeof (options) === 'string') {\n    identifierBase = identifier\n    identifier = options\n    options = undefined\n  }\n\n  try {\n    return new SemVer(\n      version instanceof SemVer ? version.version : version,\n      options\n    ).inc(release, identifier, identifierBase).version\n  } catch (er) {\n    return null\n  }\n}\nmodule.exports = inc\n","const compare = require('./compare')\nconst lt = (a, b, loose) => compare(a, b, loose) < 0\nmodule.exports = lt\n","const compare = require('./compare')\nconst lte = (a, b, loose) => compare(a, b, loose) <= 0\nmodule.exports = lte\n","const SemVer = require('../classes/semver')\nconst major = (a, loose) => new SemVer(a, loose).major\nmodule.exports = major\n","const SemVer = require('../classes/semver')\nconst minor = (a, loose) => new SemVer(a, loose).minor\nmodule.exports = minor\n","const compare = require('./compare')\nconst neq = (a, b, loose) => compare(a, b, loose) !== 0\nmodule.exports = neq\n","const SemVer = require('../classes/semver')\nconst parse = (version, options, throwErrors = false) => {\n  if (version instanceof SemVer) {\n    return version\n  }\n  try {\n    return new SemVer(version, options)\n  } catch (er) {\n    if (!throwErrors) {\n      return null\n    }\n    throw er\n  }\n}\n\nmodule.exports = parse\n","const SemVer = require('../classes/semver')\nconst patch = (a, loose) => new SemVer(a, loose).patch\nmodule.exports = patch\n","const parse = require('./parse')\nconst prerelease = (version, options) => {\n  const parsed = parse(version, options)\n  return (parsed && parsed.prerelease.length) ? parsed.prerelease : null\n}\nmodule.exports = prerelease\n","const compare = require('./compare')\nconst rcompare = (a, b, loose) => compare(b, a, loose)\nmodule.exports = rcompare\n","const compareBuild = require('./compare-build')\nconst rsort = (list, loose) => list.sort((a, b) => compareBuild(b, a, loose))\nmodule.exports = rsort\n","const Range = require('../classes/range')\nconst satisfies = (version, range, options) => {\n  try {\n    range = new Range(range, options)\n  } catch (er) {\n    return false\n  }\n  return range.test(version)\n}\nmodule.exports = satisfies\n","const compareBuild = require('./compare-build')\nconst sort = (list, loose) => list.sort((a, b) => compareBuild(a, b, loose))\nmodule.exports = sort\n","const parse = require('./parse')\nconst valid = (version, options) => {\n  const v = parse(version, options)\n  return v ? v.version : null\n}\nmodule.exports = valid\n","// just pre-load all the stuff that index.js lazily exports\nconst internalRe = require('./internal/re')\nconst constants = require('./internal/constants')\nconst SemVer = require('./classes/semver')\nconst identifiers = require('./internal/identifiers')\nconst parse = require('./functions/parse')\nconst valid = require('./functions/valid')\nconst clean = require('./functions/clean')\nconst inc = require('./functions/inc')\nconst diff = require('./functions/diff')\nconst major = require('./functions/major')\nconst minor = require('./functions/minor')\nconst patch = require('./functions/patch')\nconst prerelease = require('./functions/prerelease')\nconst compare = require('./functions/compare')\nconst rcompare = require('./functions/rcompare')\nconst compareLoose = require('./functions/compare-loose')\nconst compareBuild = require('./functions/compare-build')\nconst sort = require('./functions/sort')\nconst rsort = require('./functions/rsort')\nconst gt = require('./functions/gt')\nconst lt = require('./functions/lt')\nconst eq = require('./functions/eq')\nconst neq = require('./functions/neq')\nconst gte = require('./functions/gte')\nconst lte = require('./functions/lte')\nconst cmp = require('./functions/cmp')\nconst coerce = require('./functions/coerce')\nconst Comparator = require('./classes/comparator')\nconst Range = require('./classes/range')\nconst satisfies = require('./functions/satisfies')\nconst toComparators = require('./ranges/to-comparators')\nconst maxSatisfying = require('./ranges/max-satisfying')\nconst minSatisfying = require('./ranges/min-satisfying')\nconst minVersion = require('./ranges/min-version')\nconst validRange = require('./ranges/valid')\nconst outside = require('./ranges/outside')\nconst gtr = require('./ranges/gtr')\nconst ltr = require('./ranges/ltr')\nconst intersects = require('./ranges/intersects')\nconst simplifyRange = require('./ranges/simplify')\nconst subset = require('./ranges/subset')\nmodule.exports = {\n  parse,\n  valid,\n  clean,\n  inc,\n  diff,\n  major,\n  minor,\n  patch,\n  prerelease,\n  compare,\n  rcompare,\n  compareLoose,\n  compareBuild,\n  sort,\n  rsort,\n  gt,\n  lt,\n  eq,\n  neq,\n  gte,\n  lte,\n  cmp,\n  coerce,\n  Comparator,\n  Range,\n  satisfies,\n  toComparators,\n  maxSatisfying,\n  minSatisfying,\n  minVersion,\n  validRange,\n  outside,\n  gtr,\n  ltr,\n  intersects,\n  simplifyRange,\n  subset,\n  SemVer,\n  re: internalRe.re,\n  src: internalRe.src,\n  tokens: internalRe.t,\n  SEMVER_SPEC_VERSION: constants.SEMVER_SPEC_VERSION,\n  RELEASE_TYPES: constants.RELEASE_TYPES,\n  compareIdentifiers: identifiers.compareIdentifiers,\n  rcompareIdentifiers: identifiers.rcompareIdentifiers,\n}\n","// Note: this is the semver.org version of the spec that it implements\n// Not necessarily the package version of this code.\nconst SEMVER_SPEC_VERSION = '2.0.0'\n\nconst MAX_LENGTH = 256\nconst MAX_SAFE_INTEGER = Number.MAX_SAFE_INTEGER ||\n/* istanbul ignore next */ 9007199254740991\n\n// Max safe segment length for coercion.\nconst MAX_SAFE_COMPONENT_LENGTH = 16\n\n// Max safe length for a build identifier. The max length minus 6 characters for\n// the shortest version with a build 0.0.0+BUILD.\nconst MAX_SAFE_BUILD_LENGTH = MAX_LENGTH - 6\n\nconst RELEASE_TYPES = [\n  'major',\n  'premajor',\n  'minor',\n  'preminor',\n  'patch',\n  'prepatch',\n  'prerelease',\n]\n\nmodule.exports = {\n  MAX_LENGTH,\n  MAX_SAFE_COMPONENT_LENGTH,\n  MAX_SAFE_BUILD_LENGTH,\n  MAX_SAFE_INTEGER,\n  RELEASE_TYPES,\n  SEMVER_SPEC_VERSION,\n  FLAG_INCLUDE_PRERELEASE: 0b001,\n  FLAG_LOOSE: 0b010,\n}\n","const debug = (\n  typeof process === 'object' &&\n  process.env &&\n  process.env.NODE_DEBUG &&\n  /\\bsemver\\b/i.test(process.env.NODE_DEBUG)\n) ? (...args) => console.error('SEMVER', ...args)\n  : () => {}\n\nmodule.exports = debug\n","const numeric = /^[0-9]+$/\nconst compareIdentifiers = (a, b) => {\n  const anum = numeric.test(a)\n  const bnum = numeric.test(b)\n\n  if (anum && bnum) {\n    a = +a\n    b = +b\n  }\n\n  return a === b ? 0\n    : (anum && !bnum) ? -1\n    : (bnum && !anum) ? 1\n    : a < b ? -1\n    : 1\n}\n\nconst rcompareIdentifiers = (a, b) => compareIdentifiers(b, a)\n\nmodule.exports = {\n  compareIdentifiers,\n  rcompareIdentifiers,\n}\n","// parse out just the options we care about\nconst looseOption = Object.freeze({ loose: true })\nconst emptyOpts = Object.freeze({ })\nconst parseOptions = options => {\n  if (!options) {\n    return emptyOpts\n  }\n\n  if (typeof options !== 'object') {\n    return looseOption\n  }\n\n  return options\n}\nmodule.exports = parseOptions\n","const {\n  MAX_SAFE_COMPONENT_LENGTH,\n  MAX_SAFE_BUILD_LENGTH,\n  MAX_LENGTH,\n} = require('./constants')\nconst debug = require('./debug')\nexports = module.exports = {}\n\n// The actual regexps go on exports.re\nconst re = exports.re = []\nconst safeRe = exports.safeRe = []\nconst src = exports.src = []\nconst t = exports.t = {}\nlet R = 0\n\nconst LETTERDASHNUMBER = '[a-zA-Z0-9-]'\n\n// Replace some greedy regex tokens to prevent regex dos issues. These regex are\n// used internally via the safeRe object since all inputs in this library get\n// normalized first to trim and collapse all extra whitespace. The original\n// regexes are exported for userland consumption and lower level usage. A\n// future breaking change could export the safer regex only with a note that\n// all input should have extra whitespace removed.\nconst safeRegexReplacements = [\n  ['\\\\s', 1],\n  ['\\\\d', MAX_LENGTH],\n  [LETTERDASHNUMBER, MAX_SAFE_BUILD_LENGTH],\n]\n\nconst makeSafeRegex = (value) => {\n  for (const [token, max] of safeRegexReplacements) {\n    value = value\n      .split(`${token}*`).join(`${token}{0,${max}}`)\n      .split(`${token}+`).join(`${token}{1,${max}}`)\n  }\n  return value\n}\n\nconst createToken = (name, value, isGlobal) => {\n  const safe = makeSafeRegex(value)\n  const index = R++\n  debug(name, index, value)\n  t[name] = index\n  src[index] = value\n  re[index] = new RegExp(value, isGlobal ? 'g' : undefined)\n  safeRe[index] = new RegExp(safe, isGlobal ? 'g' : undefined)\n}\n\n// The following Regular Expressions can be used for tokenizing,\n// validating, and parsing SemVer version strings.\n\n// ## Numeric Identifier\n// A single `0`, or a non-zero digit followed by zero or more digits.\n\ncreateToken('NUMERICIDENTIFIER', '0|[1-9]\\\\d*')\ncreateToken('NUMERICIDENTIFIERLOOSE', '\\\\d+')\n\n// ## Non-numeric Identifier\n// Zero or more digits, followed by a letter or hyphen, and then zero or\n// more letters, digits, or hyphens.\n\ncreateToken('NONNUMERICIDENTIFIER', `\\\\d*[a-zA-Z-]${LETTERDASHNUMBER}*`)\n\n// ## Main Version\n// Three dot-separated numeric identifiers.\n\ncreateToken('MAINVERSION', `(${src[t.NUMERICIDENTIFIER]})\\\\.` +\n                   `(${src[t.NUMERICIDENTIFIER]})\\\\.` +\n                   `(${src[t.NUMERICIDENTIFIER]})`)\n\ncreateToken('MAINVERSIONLOOSE', `(${src[t.NUMERICIDENTIFIERLOOSE]})\\\\.` +\n                        `(${src[t.NUMERICIDENTIFIERLOOSE]})\\\\.` +\n                        `(${src[t.NUMERICIDENTIFIERLOOSE]})`)\n\n// ## Pre-release Version Identifier\n// A numeric identifier, or a non-numeric identifier.\n\ncreateToken('PRERELEASEIDENTIFIER', `(?:${src[t.NUMERICIDENTIFIER]\n}|${src[t.NONNUMERICIDENTIFIER]})`)\n\ncreateToken('PRERELEASEIDENTIFIERLOOSE', `(?:${src[t.NUMERICIDENTIFIERLOOSE]\n}|${src[t.NONNUMERICIDENTIFIER]})`)\n\n// ## Pre-release Version\n// Hyphen, followed by one or more dot-separated pre-release version\n// identifiers.\n\ncreateToken('PRERELEASE', `(?:-(${src[t.PRERELEASEIDENTIFIER]\n}(?:\\\\.${src[t.PRERELEASEIDENTIFIER]})*))`)\n\ncreateToken('PRERELEASELOOSE', `(?:-?(${src[t.PRERELEASEIDENTIFIERLOOSE]\n}(?:\\\\.${src[t.PRERELEASEIDENTIFIERLOOSE]})*))`)\n\n// ## Build Metadata Identifier\n// Any combination of digits, letters, or hyphens.\n\ncreateToken('BUILDIDENTIFIER', `${LETTERDASHNUMBER}+`)\n\n// ## Build Metadata\n// Plus sign, followed by one or more period-separated build metadata\n// identifiers.\n\ncreateToken('BUILD', `(?:\\\\+(${src[t.BUILDIDENTIFIER]\n}(?:\\\\.${src[t.BUILDIDENTIFIER]})*))`)\n\n// ## Full Version String\n// A main version, followed optionally by a pre-release version and\n// build metadata.\n\n// Note that the only major, minor, patch, and pre-release sections of\n// the version string are capturing groups.  The build metadata is not a\n// capturing group, because it should not ever be used in version\n// comparison.\n\ncreateToken('FULLPLAIN', `v?${src[t.MAINVERSION]\n}${src[t.PRERELEASE]}?${\n  src[t.BUILD]}?`)\n\ncreateToken('FULL', `^${src[t.FULLPLAIN]}$`)\n\n// like full, but allows v1.2.3 and =1.2.3, which people do sometimes.\n// also, 1.0.0alpha1 (prerelease without the hyphen) which is pretty\n// common in the npm registry.\ncreateToken('LOOSEPLAIN', `[v=\\\\s]*${src[t.MAINVERSIONLOOSE]\n}${src[t.PRERELEASELOOSE]}?${\n  src[t.BUILD]}?`)\n\ncreateToken('LOOSE', `^${src[t.LOOSEPLAIN]}$`)\n\ncreateToken('GTLT', '((?:<|>)?=?)')\n\n// Something like \"2.*\" or \"1.2.x\".\n// Note that \"x.x\" is a valid xRange identifer, meaning \"any version\"\n// Only the first item is strictly required.\ncreateToken('XRANGEIDENTIFIERLOOSE', `${src[t.NUMERICIDENTIFIERLOOSE]}|x|X|\\\\*`)\ncreateToken('XRANGEIDENTIFIER', `${src[t.NUMERICIDENTIFIER]}|x|X|\\\\*`)\n\ncreateToken('XRANGEPLAIN', `[v=\\\\s]*(${src[t.XRANGEIDENTIFIER]})` +\n                   `(?:\\\\.(${src[t.XRANGEIDENTIFIER]})` +\n                   `(?:\\\\.(${src[t.XRANGEIDENTIFIER]})` +\n                   `(?:${src[t.PRERELEASE]})?${\n                     src[t.BUILD]}?` +\n                   `)?)?`)\n\ncreateToken('XRANGEPLAINLOOSE', `[v=\\\\s]*(${src[t.XRANGEIDENTIFIERLOOSE]})` +\n                        `(?:\\\\.(${src[t.XRANGEIDENTIFIERLOOSE]})` +\n                        `(?:\\\\.(${src[t.XRANGEIDENTIFIERLOOSE]})` +\n                        `(?:${src[t.PRERELEASELOOSE]})?${\n                          src[t.BUILD]}?` +\n                        `)?)?`)\n\ncreateToken('XRANGE', `^${src[t.GTLT]}\\\\s*${src[t.XRANGEPLAIN]}$`)\ncreateToken('XRANGELOOSE', `^${src[t.GTLT]}\\\\s*${src[t.XRANGEPLAINLOOSE]}$`)\n\n// Coercion.\n// Extract anything that could conceivably be a part of a valid semver\ncreateToken('COERCEPLAIN', `${'(^|[^\\\\d])' +\n              '(\\\\d{1,'}${MAX_SAFE_COMPONENT_LENGTH}})` +\n              `(?:\\\\.(\\\\d{1,${MAX_SAFE_COMPONENT_LENGTH}}))?` +\n              `(?:\\\\.(\\\\d{1,${MAX_SAFE_COMPONENT_LENGTH}}))?`)\ncreateToken('COERCE', `${src[t.COERCEPLAIN]}(?:$|[^\\\\d])`)\ncreateToken('COERCEFULL', src[t.COERCEPLAIN] +\n              `(?:${src[t.PRERELEASE]})?` +\n              `(?:${src[t.BUILD]})?` +\n              `(?:$|[^\\\\d])`)\ncreateToken('COERCERTL', src[t.COERCE], true)\ncreateToken('COERCERTLFULL', src[t.COERCEFULL], true)\n\n// Tilde ranges.\n// Meaning is \"reasonably at or greater than\"\ncreateToken('LONETILDE', '(?:~>?)')\n\ncreateToken('TILDETRIM', `(\\\\s*)${src[t.LONETILDE]}\\\\s+`, true)\nexports.tildeTrimReplace = '$1~'\n\ncreateToken('TILDE', `^${src[t.LONETILDE]}${src[t.XRANGEPLAIN]}$`)\ncreateToken('TILDELOOSE', `^${src[t.LONETILDE]}${src[t.XRANGEPLAINLOOSE]}$`)\n\n// Caret ranges.\n// Meaning is \"at least and backwards compatible with\"\ncreateToken('LONECARET', '(?:\\\\^)')\n\ncreateToken('CARETTRIM', `(\\\\s*)${src[t.LONECARET]}\\\\s+`, true)\nexports.caretTrimReplace = '$1^'\n\ncreateToken('CARET', `^${src[t.LONECARET]}${src[t.XRANGEPLAIN]}$`)\ncreateToken('CARETLOOSE', `^${src[t.LONECARET]}${src[t.XRANGEPLAINLOOSE]}$`)\n\n// A simple gt/lt/eq thing, or just \"\" to indicate \"any version\"\ncreateToken('COMPARATORLOOSE', `^${src[t.GTLT]}\\\\s*(${src[t.LOOSEPLAIN]})$|^$`)\ncreateToken('COMPARATOR', `^${src[t.GTLT]}\\\\s*(${src[t.FULLPLAIN]})$|^$`)\n\n// An expression to strip any whitespace between the gtlt and the thing\n// it modifies, so that `> 1.2.3` ==> `>1.2.3`\ncreateToken('COMPARATORTRIM', `(\\\\s*)${src[t.GTLT]\n}\\\\s*(${src[t.LOOSEPLAIN]}|${src[t.XRANGEPLAIN]})`, true)\nexports.comparatorTrimReplace = '$1$2$3'\n\n// Something like `1.2.3 - 1.2.4`\n// Note that these all use the loose form, because they'll be\n// checked against either the strict or loose comparator form\n// later.\ncreateToken('HYPHENRANGE', `^\\\\s*(${src[t.XRANGEPLAIN]})` +\n                   `\\\\s+-\\\\s+` +\n                   `(${src[t.XRANGEPLAIN]})` +\n                   `\\\\s*$`)\n\ncreateToken('HYPHENRANGELOOSE', `^\\\\s*(${src[t.XRANGEPLAINLOOSE]})` +\n                        `\\\\s+-\\\\s+` +\n                        `(${src[t.XRANGEPLAINLOOSE]})` +\n                        `\\\\s*$`)\n\n// Star ranges basically just allow anything at all.\ncreateToken('STAR', '(<|>)?=?\\\\s*\\\\*')\n// >=0.0.0 is like a star\ncreateToken('GTE0', '^\\\\s*>=\\\\s*0\\\\.0\\\\.0\\\\s*$')\ncreateToken('GTE0PRE', '^\\\\s*>=\\\\s*0\\\\.0\\\\.0-0\\\\s*$')\n","'use strict'\n\n// A linked list to keep track of recently-used-ness\nconst Yallist = require('yallist')\n\nconst MAX = Symbol('max')\nconst LENGTH = Symbol('length')\nconst LENGTH_CALCULATOR = Symbol('lengthCalculator')\nconst ALLOW_STALE = Symbol('allowStale')\nconst MAX_AGE = Symbol('maxAge')\nconst DISPOSE = Symbol('dispose')\nconst NO_DISPOSE_ON_SET = Symbol('noDisposeOnSet')\nconst LRU_LIST = Symbol('lruList')\nconst CACHE = Symbol('cache')\nconst UPDATE_AGE_ON_GET = Symbol('updateAgeOnGet')\n\nconst naiveLength = () => 1\n\n// lruList is a yallist where the head is the youngest\n// item, and the tail is the oldest.  the list contains the Hit\n// objects as the entries.\n// Each Hit object has a reference to its Yallist.Node.  This\n// never changes.\n//\n// cache is a Map (or PseudoMap) that matches the keys to\n// the Yallist.Node object.\nclass LRUCache {\n  constructor (options) {\n    if (typeof options === 'number')\n      options = { max: options }\n\n    if (!options)\n      options = {}\n\n    if (options.max && (typeof options.max !== 'number' || options.max < 0))\n      throw new TypeError('max must be a non-negative number')\n    // Kind of weird to have a default max of Infinity, but oh well.\n    const max = this[MAX] = options.max || Infinity\n\n    const lc = options.length || naiveLength\n    this[LENGTH_CALCULATOR] = (typeof lc !== 'function') ? naiveLength : lc\n    this[ALLOW_STALE] = options.stale || false\n    if (options.maxAge && typeof options.maxAge !== 'number')\n      throw new TypeError('maxAge must be a number')\n    this[MAX_AGE] = options.maxAge || 0\n    this[DISPOSE] = options.dispose\n    this[NO_DISPOSE_ON_SET] = options.noDisposeOnSet || false\n    this[UPDATE_AGE_ON_GET] = options.updateAgeOnGet || false\n    this.reset()\n  }\n\n  // resize the cache when the max changes.\n  set max (mL) {\n    if (typeof mL !== 'number' || mL < 0)\n      throw new TypeError('max must be a non-negative number')\n\n    this[MAX] = mL || Infinity\n    trim(this)\n  }\n  get max () {\n    return this[MAX]\n  }\n\n  set allowStale (allowStale) {\n    this[ALLOW_STALE] = !!allowStale\n  }\n  get allowStale () {\n    return this[ALLOW_STALE]\n  }\n\n  set maxAge (mA) {\n    if (typeof mA !== 'number')\n      throw new TypeError('maxAge must be a non-negative number')\n\n    this[MAX_AGE] = mA\n    trim(this)\n  }\n  get maxAge () {\n    return this[MAX_AGE]\n  }\n\n  // resize the cache when the lengthCalculator changes.\n  set lengthCalculator (lC) {\n    if (typeof lC !== 'function')\n      lC = naiveLength\n\n    if (lC !== this[LENGTH_CALCULATOR]) {\n      this[LENGTH_CALCULATOR] = lC\n      this[LENGTH] = 0\n      this[LRU_LIST].forEach(hit => {\n        hit.length = this[LENGTH_CALCULATOR](hit.value, hit.key)\n        this[LENGTH] += hit.length\n      })\n    }\n    trim(this)\n  }\n  get lengthCalculator () { return this[LENGTH_CALCULATOR] }\n\n  get length () { return this[LENGTH] }\n  get itemCount () { return this[LRU_LIST].length }\n\n  rforEach (fn, thisp) {\n    thisp = thisp || this\n    for (let walker = this[LRU_LIST].tail; walker !== null;) {\n      const prev = walker.prev\n      forEachStep(this, fn, walker, thisp)\n      walker = prev\n    }\n  }\n\n  forEach (fn, thisp) {\n    thisp = thisp || this\n    for (let walker = this[LRU_LIST].head; walker !== null;) {\n      const next = walker.next\n      forEachStep(this, fn, walker, thisp)\n      walker = next\n    }\n  }\n\n  keys () {\n    return this[LRU_LIST].toArray().map(k => k.key)\n  }\n\n  values () {\n    return this[LRU_LIST].toArray().map(k => k.value)\n  }\n\n  reset () {\n    if (this[DISPOSE] &&\n        this[LRU_LIST] &&\n        this[LRU_LIST].length) {\n      this[LRU_LIST].forEach(hit => this[DISPOSE](hit.key, hit.value))\n    }\n\n    this[CACHE] = new Map() // hash of items by key\n    this[LRU_LIST] = new Yallist() // list of items in order of use recency\n    this[LENGTH] = 0 // length of items in the list\n  }\n\n  dump () {\n    return this[LRU_LIST].map(hit =>\n      isStale(this, hit) ? false : {\n        k: hit.key,\n        v: hit.value,\n        e: hit.now + (hit.maxAge || 0)\n      }).toArray().filter(h => h)\n  }\n\n  dumpLru () {\n    return this[LRU_LIST]\n  }\n\n  set (key, value, maxAge) {\n    maxAge = maxAge || this[MAX_AGE]\n\n    if (maxAge && typeof maxAge !== 'number')\n      throw new TypeError('maxAge must be a number')\n\n    const now = maxAge ? Date.now() : 0\n    const len = this[LENGTH_CALCULATOR](value, key)\n\n    if (this[CACHE].has(key)) {\n      if (len > this[MAX]) {\n        del(this, this[CACHE].get(key))\n        return false\n      }\n\n      const node = this[CACHE].get(key)\n      const item = node.value\n\n      // dispose of the old one before overwriting\n      // split out into 2 ifs for better coverage tracking\n      if (this[DISPOSE]) {\n        if (!this[NO_DISPOSE_ON_SET])\n          this[DISPOSE](key, item.value)\n      }\n\n      item.now = now\n      item.maxAge = maxAge\n      item.value = value\n      this[LENGTH] += len - item.length\n      item.length = len\n      this.get(key)\n      trim(this)\n      return true\n    }\n\n    const hit = new Entry(key, value, len, now, maxAge)\n\n    // oversized objects fall out of cache automatically.\n    if (hit.length > this[MAX]) {\n      if (this[DISPOSE])\n        this[DISPOSE](key, value)\n\n      return false\n    }\n\n    this[LENGTH] += hit.length\n    this[LRU_LIST].unshift(hit)\n    this[CACHE].set(key, this[LRU_LIST].head)\n    trim(this)\n    return true\n  }\n\n  has (key) {\n    if (!this[CACHE].has(key)) return false\n    const hit = this[CACHE].get(key).value\n    return !isStale(this, hit)\n  }\n\n  get (key) {\n    return get(this, key, true)\n  }\n\n  peek (key) {\n    return get(this, key, false)\n  }\n\n  pop () {\n    const node = this[LRU_LIST].tail\n    if (!node)\n      return null\n\n    del(this, node)\n    return node.value\n  }\n\n  del (key) {\n    del(this, this[CACHE].get(key))\n  }\n\n  load (arr) {\n    // reset the cache\n    this.reset()\n\n    const now = Date.now()\n    // A previous serialized cache has the most recent items first\n    for (let l = arr.length - 1; l >= 0; l--) {\n      const hit = arr[l]\n      const expiresAt = hit.e || 0\n      if (expiresAt === 0)\n        // the item was created without expiration in a non aged cache\n        this.set(hit.k, hit.v)\n      else {\n        const maxAge = expiresAt - now\n        // dont add already expired items\n        if (maxAge > 0) {\n          this.set(hit.k, hit.v, maxAge)\n        }\n      }\n    }\n  }\n\n  prune () {\n    this[CACHE].forEach((value, key) => get(this, key, false))\n  }\n}\n\nconst get = (self, key, doUse) => {\n  const node = self[CACHE].get(key)\n  if (node) {\n    const hit = node.value\n    if (isStale(self, hit)) {\n      del(self, node)\n      if (!self[ALLOW_STALE])\n        return undefined\n    } else {\n      if (doUse) {\n        if (self[UPDATE_AGE_ON_GET])\n          node.value.now = Date.now()\n        self[LRU_LIST].unshiftNode(node)\n      }\n    }\n    return hit.value\n  }\n}\n\nconst isStale = (self, hit) => {\n  if (!hit || (!hit.maxAge && !self[MAX_AGE]))\n    return false\n\n  const diff = Date.now() - hit.now\n  return hit.maxAge ? diff > hit.maxAge\n    : self[MAX_AGE] && (diff > self[MAX_AGE])\n}\n\nconst trim = self => {\n  if (self[LENGTH] > self[MAX]) {\n    for (let walker = self[LRU_LIST].tail;\n      self[LENGTH] > self[MAX] && walker !== null;) {\n      // We know that we're about to delete this one, and also\n      // what the next least recently used key will be, so just\n      // go ahead and set it now.\n      const prev = walker.prev\n      del(self, walker)\n      walker = prev\n    }\n  }\n}\n\nconst del = (self, node) => {\n  if (node) {\n    const hit = node.value\n    if (self[DISPOSE])\n      self[DISPOSE](hit.key, hit.value)\n\n    self[LENGTH] -= hit.length\n    self[CACHE].delete(hit.key)\n    self[LRU_LIST].removeNode(node)\n  }\n}\n\nclass Entry {\n  constructor (key, value, length, now, maxAge) {\n    this.key = key\n    this.value = value\n    this.length = length\n    this.now = now\n    this.maxAge = maxAge || 0\n  }\n}\n\nconst forEachStep = (self, fn, node, thisp) => {\n  let hit = node.value\n  if (isStale(self, hit)) {\n    del(self, node)\n    if (!self[ALLOW_STALE])\n      hit = undefined\n  }\n  if (hit)\n    fn.call(thisp, hit.value, hit.key, self)\n}\n\nmodule.exports = LRUCache\n","// Determine if version is greater than all the versions possible in the range.\nconst outside = require('./outside')\nconst gtr = (version, range, options) => outside(version, range, '>', options)\nmodule.exports = gtr\n","const Range = require('../classes/range')\nconst intersects = (r1, r2, options) => {\n  r1 = new Range(r1, options)\n  r2 = new Range(r2, options)\n  return r1.intersects(r2, options)\n}\nmodule.exports = intersects\n","const outside = require('./outside')\n// Determine if version is less than all the versions possible in the range\nconst ltr = (version, range, options) => outside(version, range, '<', options)\nmodule.exports = ltr\n","const SemVer = require('../classes/semver')\nconst Range = require('../classes/range')\n\nconst maxSatisfying = (versions, range, options) => {\n  let max = null\n  let maxSV = null\n  let rangeObj = null\n  try {\n    rangeObj = new Range(range, options)\n  } catch (er) {\n    return null\n  }\n  versions.forEach((v) => {\n    if (rangeObj.test(v)) {\n      // satisfies(v, range, options)\n      if (!max || maxSV.compare(v) === -1) {\n        // compare(max, v, true)\n        max = v\n        maxSV = new SemVer(max, options)\n      }\n    }\n  })\n  return max\n}\nmodule.exports = maxSatisfying\n","const SemVer = require('../classes/semver')\nconst Range = require('../classes/range')\nconst minSatisfying = (versions, range, options) => {\n  let min = null\n  let minSV = null\n  let rangeObj = null\n  try {\n    rangeObj = new Range(range, options)\n  } catch (er) {\n    return null\n  }\n  versions.forEach((v) => {\n    if (rangeObj.test(v)) {\n      // satisfies(v, range, options)\n      if (!min || minSV.compare(v) === 1) {\n        // compare(min, v, true)\n        min = v\n        minSV = new SemVer(min, options)\n      }\n    }\n  })\n  return min\n}\nmodule.exports = minSatisfying\n","const SemVer = require('../classes/semver')\nconst Range = require('../classes/range')\nconst gt = require('../functions/gt')\n\nconst minVersion = (range, loose) => {\n  range = new Range(range, loose)\n\n  let minver = new SemVer('0.0.0')\n  if (range.test(minver)) {\n    return minver\n  }\n\n  minver = new SemVer('0.0.0-0')\n  if (range.test(minver)) {\n    return minver\n  }\n\n  minver = null\n  for (let i = 0; i < range.set.length; ++i) {\n    const comparators = range.set[i]\n\n    let setMin = null\n    comparators.forEach((comparator) => {\n      // Clone to avoid manipulating the comparator's semver object.\n      const compver = new SemVer(comparator.semver.version)\n      switch (comparator.operator) {\n        case '>':\n          if (compver.prerelease.length === 0) {\n            compver.patch++\n          } else {\n            compver.prerelease.push(0)\n          }\n          compver.raw = compver.format()\n          /* fallthrough */\n        case '':\n        case '>=':\n          if (!setMin || gt(compver, setMin)) {\n            setMin = compver\n          }\n          break\n        case '<':\n        case '<=':\n          /* Ignore maximum versions */\n          break\n        /* istanbul ignore next */\n        default:\n          throw new Error(`Unexpected operation: ${comparator.operator}`)\n      }\n    })\n    if (setMin && (!minver || gt(minver, setMin))) {\n      minver = setMin\n    }\n  }\n\n  if (minver && range.test(minver)) {\n    return minver\n  }\n\n  return null\n}\nmodule.exports = minVersion\n","const SemVer = require('../classes/semver')\nconst Comparator = require('../classes/comparator')\nconst { ANY } = Comparator\nconst Range = require('../classes/range')\nconst satisfies = require('../functions/satisfies')\nconst gt = require('../functions/gt')\nconst lt = require('../functions/lt')\nconst lte = require('../functions/lte')\nconst gte = require('../functions/gte')\n\nconst outside = (version, range, hilo, options) => {\n  version = new SemVer(version, options)\n  range = new Range(range, options)\n\n  let gtfn, ltefn, ltfn, comp, ecomp\n  switch (hilo) {\n    case '>':\n      gtfn = gt\n      ltefn = lte\n      ltfn = lt\n      comp = '>'\n      ecomp = '>='\n      break\n    case '<':\n      gtfn = lt\n      ltefn = gte\n      ltfn = gt\n      comp = '<'\n      ecomp = '<='\n      break\n    default:\n      throw new TypeError('Must provide a hilo val of \"<\" or \">\"')\n  }\n\n  // If it satisfies the range it is not outside\n  if (satisfies(version, range, options)) {\n    return false\n  }\n\n  // From now on, variable terms are as if we're in \"gtr\" mode.\n  // but note that everything is flipped for the \"ltr\" function.\n\n  for (let i = 0; i < range.set.length; ++i) {\n    const comparators = range.set[i]\n\n    let high = null\n    let low = null\n\n    comparators.forEach((comparator) => {\n      if (comparator.semver === ANY) {\n        comparator = new Comparator('>=0.0.0')\n      }\n      high = high || comparator\n      low = low || comparator\n      if (gtfn(comparator.semver, high.semver, options)) {\n        high = comparator\n      } else if (ltfn(comparator.semver, low.semver, options)) {\n        low = comparator\n      }\n    })\n\n    // If the edge version comparator has a operator then our version\n    // isn't outside it\n    if (high.operator === comp || high.operator === ecomp) {\n      return false\n    }\n\n    // If the lowest version comparator has an operator and our version\n    // is less than it then it isn't higher than the range\n    if ((!low.operator || low.operator === comp) &&\n        ltefn(version, low.semver)) {\n      return false\n    } else if (low.operator === ecomp && ltfn(version, low.semver)) {\n      return false\n    }\n  }\n  return true\n}\n\nmodule.exports = outside\n","// given a set of versions and a range, create a \"simplified\" range\n// that includes the same versions that the original range does\n// If the original range is shorter than the simplified one, return that.\nconst satisfies = require('../functions/satisfies.js')\nconst compare = require('../functions/compare.js')\nmodule.exports = (versions, range, options) => {\n  const set = []\n  let first = null\n  let prev = null\n  const v = versions.sort((a, b) => compare(a, b, options))\n  for (const version of v) {\n    const included = satisfies(version, range, options)\n    if (included) {\n      prev = version\n      if (!first) {\n        first = version\n      }\n    } else {\n      if (prev) {\n        set.push([first, prev])\n      }\n      prev = null\n      first = null\n    }\n  }\n  if (first) {\n    set.push([first, null])\n  }\n\n  const ranges = []\n  for (const [min, max] of set) {\n    if (min === max) {\n      ranges.push(min)\n    } else if (!max && min === v[0]) {\n      ranges.push('*')\n    } else if (!max) {\n      ranges.push(`>=${min}`)\n    } else if (min === v[0]) {\n      ranges.push(`<=${max}`)\n    } else {\n      ranges.push(`${min} - ${max}`)\n    }\n  }\n  const simplified = ranges.join(' || ')\n  const original = typeof range.raw === 'string' ? range.raw : String(range)\n  return simplified.length < original.length ? simplified : range\n}\n","const Range = require('../classes/range.js')\nconst Comparator = require('../classes/comparator.js')\nconst { ANY } = Comparator\nconst satisfies = require('../functions/satisfies.js')\nconst compare = require('../functions/compare.js')\n\n// Complex range `r1 || r2 || ...` is a subset of `R1 || R2 || ...` iff:\n// - Every simple range `r1, r2, ...` is a null set, OR\n// - Every simple range `r1, r2, ...` which is not a null set is a subset of\n//   some `R1, R2, ...`\n//\n// Simple range `c1 c2 ...` is a subset of simple range `C1 C2 ...` iff:\n// - If c is only the ANY comparator\n//   - If C is only the ANY comparator, return true\n//   - Else if in prerelease mode, return false\n//   - else replace c with `[>=0.0.0]`\n// - If C is only the ANY comparator\n//   - if in prerelease mode, return true\n//   - else replace C with `[>=0.0.0]`\n// - Let EQ be the set of = comparators in c\n// - If EQ is more than one, return true (null set)\n// - Let GT be the highest > or >= comparator in c\n// - Let LT be the lowest < or <= comparator in c\n// - If GT and LT, and GT.semver > LT.semver, return true (null set)\n// - If any C is a = range, and GT or LT are set, return false\n// - If EQ\n//   - If GT, and EQ does not satisfy GT, return true (null set)\n//   - If LT, and EQ does not satisfy LT, return true (null set)\n//   - If EQ satisfies every C, return true\n//   - Else return false\n// - If GT\n//   - If GT.semver is lower than any > or >= comp in C, return false\n//   - If GT is >=, and GT.semver does not satisfy every C, return false\n//   - If GT.semver has a prerelease, and not in prerelease mode\n//     - If no C has a prerelease and the GT.semver tuple, return false\n// - If LT\n//   - If LT.semver is greater than any < or <= comp in C, return false\n//   - If LT is <=, and LT.semver does not satisfy every C, return false\n//   - If GT.semver has a prerelease, and not in prerelease mode\n//     - If no C has a prerelease and the LT.semver tuple, return false\n// - Else return true\n\nconst subset = (sub, dom, options = {}) => {\n  if (sub === dom) {\n    return true\n  }\n\n  sub = new Range(sub, options)\n  dom = new Range(dom, options)\n  let sawNonNull = false\n\n  OUTER: for (const simpleSub of sub.set) {\n    for (const simpleDom of dom.set) {\n      const isSub = simpleSubset(simpleSub, simpleDom, options)\n      sawNonNull = sawNonNull || isSub !== null\n      if (isSub) {\n        continue OUTER\n      }\n    }\n    // the null set is a subset of everything, but null simple ranges in\n    // a complex range should be ignored.  so if we saw a non-null range,\n    // then we know this isn't a subset, but if EVERY simple range was null,\n    // then it is a subset.\n    if (sawNonNull) {\n      return false\n    }\n  }\n  return true\n}\n\nconst minimumVersionWithPreRelease = [new Comparator('>=0.0.0-0')]\nconst minimumVersion = [new Comparator('>=0.0.0')]\n\nconst simpleSubset = (sub, dom, options) => {\n  if (sub === dom) {\n    return true\n  }\n\n  if (sub.length === 1 && sub[0].semver === ANY) {\n    if (dom.length === 1 && dom[0].semver === ANY) {\n      return true\n    } else if (options.includePrerelease) {\n      sub = minimumVersionWithPreRelease\n    } else {\n      sub = minimumVersion\n    }\n  }\n\n  if (dom.length === 1 && dom[0].semver === ANY) {\n    if (options.includePrerelease) {\n      return true\n    } else {\n      dom = minimumVersion\n    }\n  }\n\n  const eqSet = new Set()\n  let gt, lt\n  for (const c of sub) {\n    if (c.operator === '>' || c.operator === '>=') {\n      gt = higherGT(gt, c, options)\n    } else if (c.operator === '<' || c.operator === '<=') {\n      lt = lowerLT(lt, c, options)\n    } else {\n      eqSet.add(c.semver)\n    }\n  }\n\n  if (eqSet.size > 1) {\n    return null\n  }\n\n  let gtltComp\n  if (gt && lt) {\n    gtltComp = compare(gt.semver, lt.semver, options)\n    if (gtltComp > 0) {\n      return null\n    } else if (gtltComp === 0 && (gt.operator !== '>=' || lt.operator !== '<=')) {\n      return null\n    }\n  }\n\n  // will iterate one or zero times\n  for (const eq of eqSet) {\n    if (gt && !satisfies(eq, String(gt), options)) {\n      return null\n    }\n\n    if (lt && !satisfies(eq, String(lt), options)) {\n      return null\n    }\n\n    for (const c of dom) {\n      if (!satisfies(eq, String(c), options)) {\n        return false\n      }\n    }\n\n    return true\n  }\n\n  let higher, lower\n  let hasDomLT, hasDomGT\n  // if the subset has a prerelease, we need a comparator in the superset\n  // with the same tuple and a prerelease, or it's not a subset\n  let needDomLTPre = lt &&\n    !options.includePrerelease &&\n    lt.semver.prerelease.length ? lt.semver : false\n  let needDomGTPre = gt &&\n    !options.includePrerelease &&\n    gt.semver.prerelease.length ? gt.semver : false\n  // exception: <1.2.3-0 is the same as <1.2.3\n  if (needDomLTPre && needDomLTPre.prerelease.length === 1 &&\n      lt.operator === '<' && needDomLTPre.prerelease[0] === 0) {\n    needDomLTPre = false\n  }\n\n  for (const c of dom) {\n    hasDomGT = hasDomGT || c.operator === '>' || c.operator === '>='\n    hasDomLT = hasDomLT || c.operator === '<' || c.operator === '<='\n    if (gt) {\n      if (needDomGTPre) {\n        if (c.semver.prerelease && c.semver.prerelease.length &&\n            c.semver.major === needDomGTPre.major &&\n            c.semver.minor === needDomGTPre.minor &&\n            c.semver.patch === needDomGTPre.patch) {\n          needDomGTPre = false\n        }\n      }\n      if (c.operator === '>' || c.operator === '>=') {\n        higher = higherGT(gt, c, options)\n        if (higher === c && higher !== gt) {\n          return false\n        }\n      } else if (gt.operator === '>=' && !satisfies(gt.semver, String(c), options)) {\n        return false\n      }\n    }\n    if (lt) {\n      if (needDomLTPre) {\n        if (c.semver.prerelease && c.semver.prerelease.length &&\n            c.semver.major === needDomLTPre.major &&\n            c.semver.minor === needDomLTPre.minor &&\n            c.semver.patch === needDomLTPre.patch) {\n          needDomLTPre = false\n        }\n      }\n      if (c.operator === '<' || c.operator === '<=') {\n        lower = lowerLT(lt, c, options)\n        if (lower === c && lower !== lt) {\n          return false\n        }\n      } else if (lt.operator === '<=' && !satisfies(lt.semver, String(c), options)) {\n        return false\n      }\n    }\n    if (!c.operator && (lt || gt) && gtltComp !== 0) {\n      return false\n    }\n  }\n\n  // if there was a < or >, and nothing in the dom, then must be false\n  // UNLESS it was limited by another range in the other direction.\n  // Eg, >1.0.0 <1.0.1 is still a subset of <2.0.0\n  if (gt && hasDomLT && !lt && gtltComp !== 0) {\n    return false\n  }\n\n  if (lt && hasDomGT && !gt && gtltComp !== 0) {\n    return false\n  }\n\n  // we needed a prerelease range in a specific tuple, but didn't get one\n  // then this isn't a subset.  eg >=1.2.3-pre is not a subset of >=1.0.0,\n  // because it includes prereleases in the 1.2.3 tuple\n  if (needDomGTPre || needDomLTPre) {\n    return false\n  }\n\n  return true\n}\n\n// >=1.2.3 is lower than >1.2.3\nconst higherGT = (a, b, options) => {\n  if (!a) {\n    return b\n  }\n  const comp = compare(a.semver, b.semver, options)\n  return comp > 0 ? a\n    : comp < 0 ? b\n    : b.operator === '>' && a.operator === '>=' ? b\n    : a\n}\n\n// <=1.2.3 is higher than <1.2.3\nconst lowerLT = (a, b, options) => {\n  if (!a) {\n    return b\n  }\n  const comp = compare(a.semver, b.semver, options)\n  return comp < 0 ? a\n    : comp > 0 ? b\n    : b.operator === '<' && a.operator === '<=' ? b\n    : a\n}\n\nmodule.exports = subset\n","const Range = require('../classes/range')\n\n// Mostly just for testing and legacy API reasons\nconst toComparators = (range, options) =>\n  new Range(range, options).set\n    .map(comp => comp.map(c => c.value).join(' ').trim().split(' '))\n\nmodule.exports = toComparators\n","const Range = require('../classes/range')\nconst validRange = (range, options) => {\n  try {\n    // Return '*' instead of '' so that truthiness works.\n    // This will throw if it's invalid anyway\n    return new Range(range, options).range || '*'\n  } catch (er) {\n    return null\n  }\n}\nmodule.exports = validRange\n","'use strict'\nmodule.exports = function (Yallist) {\n  Yallist.prototype[Symbol.iterator] = function* () {\n    for (let walker = this.head; walker; walker = walker.next) {\n      yield walker.value\n    }\n  }\n}\n","'use strict'\nmodule.exports = Yallist\n\nYallist.Node = Node\nYallist.create = Yallist\n\nfunction Yallist (list) {\n  var self = this\n  if (!(self instanceof Yallist)) {\n    self = new Yallist()\n  }\n\n  self.tail = null\n  self.head = null\n  self.length = 0\n\n  if (list && typeof list.forEach === 'function') {\n    list.forEach(function (item) {\n      self.push(item)\n    })\n  } else if (arguments.length > 0) {\n    for (var i = 0, l = arguments.length; i < l; i++) {\n      self.push(arguments[i])\n    }\n  }\n\n  return self\n}\n\nYallist.prototype.removeNode = function (node) {\n  if (node.list !== this) {\n    throw new Error('removing node which does not belong to this list')\n  }\n\n  var next = node.next\n  var prev = node.prev\n\n  if (next) {\n    next.prev = prev\n  }\n\n  if (prev) {\n    prev.next = next\n  }\n\n  if (node === this.head) {\n    this.head = next\n  }\n  if (node === this.tail) {\n    this.tail = prev\n  }\n\n  node.list.length--\n  node.next = null\n  node.prev = null\n  node.list = null\n\n  return next\n}\n\nYallist.prototype.unshiftNode = function (node) {\n  if (node === this.head) {\n    return\n  }\n\n  if (node.list) {\n    node.list.removeNode(node)\n  }\n\n  var head = this.head\n  node.list = this\n  node.next = head\n  if (head) {\n    head.prev = node\n  }\n\n  this.head = node\n  if (!this.tail) {\n    this.tail = node\n  }\n  this.length++\n}\n\nYallist.prototype.pushNode = function (node) {\n  if (node === this.tail) {\n    return\n  }\n\n  if (node.list) {\n    node.list.removeNode(node)\n  }\n\n  var tail = this.tail\n  node.list = this\n  node.prev = tail\n  if (tail) {\n    tail.next = node\n  }\n\n  this.tail = node\n  if (!this.head) {\n    this.head = node\n  }\n  this.length++\n}\n\nYallist.prototype.push = function () {\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    push(this, arguments[i])\n  }\n  return this.length\n}\n\nYallist.prototype.unshift = function () {\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    unshift(this, arguments[i])\n  }\n  return this.length\n}\n\nYallist.prototype.pop = function () {\n  if (!this.tail) {\n    return undefined\n  }\n\n  var res = this.tail.value\n  this.tail = this.tail.prev\n  if (this.tail) {\n    this.tail.next = null\n  } else {\n    this.head = null\n  }\n  this.length--\n  return res\n}\n\nYallist.prototype.shift = function () {\n  if (!this.head) {\n    return undefined\n  }\n\n  var res = this.head.value\n  this.head = this.head.next\n  if (this.head) {\n    this.head.prev = null\n  } else {\n    this.tail = null\n  }\n  this.length--\n  return res\n}\n\nYallist.prototype.forEach = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = this.head, i = 0; walker !== null; i++) {\n    fn.call(thisp, walker.value, i, this)\n    walker = walker.next\n  }\n}\n\nYallist.prototype.forEachReverse = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = this.tail, i = this.length - 1; walker !== null; i--) {\n    fn.call(thisp, walker.value, i, this)\n    walker = walker.prev\n  }\n}\n\nYallist.prototype.get = function (n) {\n  for (var i = 0, walker = this.head; walker !== null && i < n; i++) {\n    // abort out of the list early if we hit a cycle\n    walker = walker.next\n  }\n  if (i === n && walker !== null) {\n    return walker.value\n  }\n}\n\nYallist.prototype.getReverse = function (n) {\n  for (var i = 0, walker = this.tail; walker !== null && i < n; i++) {\n    // abort out of the list early if we hit a cycle\n    walker = walker.prev\n  }\n  if (i === n && walker !== null) {\n    return walker.value\n  }\n}\n\nYallist.prototype.map = function (fn, thisp) {\n  thisp = thisp || this\n  var res = new Yallist()\n  for (var walker = this.head; walker !== null;) {\n    res.push(fn.call(thisp, walker.value, this))\n    walker = walker.next\n  }\n  return res\n}\n\nYallist.prototype.mapReverse = function (fn, thisp) {\n  thisp = thisp || this\n  var res = new Yallist()\n  for (var walker = this.tail; walker !== null;) {\n    res.push(fn.call(thisp, walker.value, this))\n    walker = walker.prev\n  }\n  return res\n}\n\nYallist.prototype.reduce = function (fn, initial) {\n  var acc\n  var walker = this.head\n  if (arguments.length > 1) {\n    acc = initial\n  } else if (this.head) {\n    walker = this.head.next\n    acc = this.head.value\n  } else {\n    throw new TypeError('Reduce of empty list with no initial value')\n  }\n\n  for (var i = 0; walker !== null; i++) {\n    acc = fn(acc, walker.value, i)\n    walker = walker.next\n  }\n\n  return acc\n}\n\nYallist.prototype.reduceReverse = function (fn, initial) {\n  var acc\n  var walker = this.tail\n  if (arguments.length > 1) {\n    acc = initial\n  } else if (this.tail) {\n    walker = this.tail.prev\n    acc = this.tail.value\n  } else {\n    throw new TypeError('Reduce of empty list with no initial value')\n  }\n\n  for (var i = this.length - 1; walker !== null; i--) {\n    acc = fn(acc, walker.value, i)\n    walker = walker.prev\n  }\n\n  return acc\n}\n\nYallist.prototype.toArray = function () {\n  var arr = new Array(this.length)\n  for (var i = 0, walker = this.head; walker !== null; i++) {\n    arr[i] = walker.value\n    walker = walker.next\n  }\n  return arr\n}\n\nYallist.prototype.toArrayReverse = function () {\n  var arr = new Array(this.length)\n  for (var i = 0, walker = this.tail; walker !== null; i++) {\n    arr[i] = walker.value\n    walker = walker.prev\n  }\n  return arr\n}\n\nYallist.prototype.slice = function (from, to) {\n  to = to || this.length\n  if (to < 0) {\n    to += this.length\n  }\n  from = from || 0\n  if (from < 0) {\n    from += this.length\n  }\n  var ret = new Yallist()\n  if (to < from || to < 0) {\n    return ret\n  }\n  if (from < 0) {\n    from = 0\n  }\n  if (to > this.length) {\n    to = this.length\n  }\n  for (var i = 0, walker = this.head; walker !== null && i < from; i++) {\n    walker = walker.next\n  }\n  for (; walker !== null && i < to; i++, walker = walker.next) {\n    ret.push(walker.value)\n  }\n  return ret\n}\n\nYallist.prototype.sliceReverse = function (from, to) {\n  to = to || this.length\n  if (to < 0) {\n    to += this.length\n  }\n  from = from || 0\n  if (from < 0) {\n    from += this.length\n  }\n  var ret = new Yallist()\n  if (to < from || to < 0) {\n    return ret\n  }\n  if (from < 0) {\n    from = 0\n  }\n  if (to > this.length) {\n    to = this.length\n  }\n  for (var i = this.length, walker = this.tail; walker !== null && i > to; i--) {\n    walker = walker.prev\n  }\n  for (; walker !== null && i > from; i--, walker = walker.prev) {\n    ret.push(walker.value)\n  }\n  return ret\n}\n\nYallist.prototype.splice = function (start, deleteCount, ...nodes) {\n  if (start > this.length) {\n    start = this.length - 1\n  }\n  if (start < 0) {\n    start = this.length + start;\n  }\n\n  for (var i = 0, walker = this.head; walker !== null && i < start; i++) {\n    walker = walker.next\n  }\n\n  var ret = []\n  for (var i = 0; walker && i < deleteCount; i++) {\n    ret.push(walker.value)\n    walker = this.removeNode(walker)\n  }\n  if (walker === null) {\n    walker = this.tail\n  }\n\n  if (walker !== this.head && walker !== this.tail) {\n    walker = walker.prev\n  }\n\n  for (var i = 0; i < nodes.length; i++) {\n    walker = insert(this, walker, nodes[i])\n  }\n  return ret;\n}\n\nYallist.prototype.reverse = function () {\n  var head = this.head\n  var tail = this.tail\n  for (var walker = head; walker !== null; walker = walker.prev) {\n    var p = walker.prev\n    walker.prev = walker.next\n    walker.next = p\n  }\n  this.head = tail\n  this.tail = head\n  return this\n}\n\nfunction insert (self, node, value) {\n  var inserted = node === self.head ?\n    new Node(value, null, node, self) :\n    new Node(value, node, node.next, self)\n\n  if (inserted.next === null) {\n    self.tail = inserted\n  }\n  if (inserted.prev === null) {\n    self.head = inserted\n  }\n\n  self.length++\n\n  return inserted\n}\n\nfunction push (self, item) {\n  self.tail = new Node(item, self.tail, null, self)\n  if (!self.head) {\n    self.head = self.tail\n  }\n  self.length++\n}\n\nfunction unshift (self, item) {\n  self.head = new Node(item, null, self.head, self)\n  if (!self.tail) {\n    self.tail = self.head\n  }\n  self.length++\n}\n\nfunction Node (value, prev, next, list) {\n  if (!(this instanceof Node)) {\n    return new Node(value, prev, next, list)\n  }\n\n  this.list = list\n  this.value = value\n\n  if (prev) {\n    prev.next = this\n    this.prev = prev\n  } else {\n    this.prev = null\n  }\n\n  if (next) {\n    next.prev = this\n    this.next = next\n  } else {\n    this.next = null\n  }\n}\n\ntry {\n  // add if support for Symbol.iterator is present\n  require('./iterator.js')(Yallist)\n} catch (er) {}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__6089__;","module.exports = __WEBPACK_EXTERNAL_MODULE__7781__;","module.exports = __WEBPACK_EXTERNAL_MODULE__8531__;","module.exports = __WEBPACK_EXTERNAL_MODULE__2007__;","module.exports = __WEBPACK_EXTERNAL_MODULE__3241__;","module.exports = __WEBPACK_EXTERNAL_MODULE__8146__;","module.exports = __WEBPACK_EXTERNAL_MODULE__5959__;","module.exports = __WEBPACK_EXTERNAL_MODULE__1269__;","/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n  return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose;\n    if (async) {\n        if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n        dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n        if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n        dispose = value[Symbol.dispose];\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  function next() {\n    while (env.stack.length) {\n      var rec = env.stack.pop();\n      try {\n        var result = rec.dispose && rec.dispose.call(rec.value);\n        if (rec.async) return Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n      }\n      catch (e) {\n          fail(e);\n      }\n    }\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { css } from '@emotion/css';\nimport React, { useEffect, useState } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Alert, AlertVariant, useTheme2 } from '@grafana/ui';\n\nenum AlertTimeout {\n  Error = 7000,\n  Info = 3000,\n  Success = 3000,\n  Warning = 5000,\n}\n\nconst getStyle = (theme: GrafanaTheme2) => {\n  return css({\n    position: 'absolute',\n    zIndex: theme.zIndex.portal,\n    top: 0,\n    right: 10,\n  });\n};\n\nconst timeoutMap = {\n  ['error']: AlertTimeout.Error,\n  ['info']: AlertTimeout.Info,\n  ['success']: AlertTimeout.Success,\n  ['warning']: AlertTimeout.Warning,\n};\n\ntype AlertProps = {\n  // Severity of the alert. Controls the style of the alert (e.g., background color)\n  severity: AlertVariant;\n  // Displayed message. If set to empty string, the alert is not displayed\n  text: string;\n};\n\nexport const TemporaryAlert = (props: AlertProps) => {\n  const style = getStyle(useTheme2());\n  const [visible, setVisible] = useState(false);\n  const [timer, setTimer] = useState<NodeJS.Timeout>();\n\n  useEffect(() => {\n    return () => {\n      if (timer) {\n        clearTimeout(timer);\n      }\n    };\n  }, [timer]);\n\n  useEffect(() => {\n    if (props.text !== '') {\n      setVisible(true);\n\n      const timer = setTimeout(() => {\n        setVisible(false);\n      }, timeoutMap[props.severity]);\n      setTimer(timer);\n    }\n  }, [props.severity, props.text]);\n\n  return (\n    <>\n      {visible && (\n        <Alert\n          className={style}\n          elevated={true}\n          onRemove={() => setVisible(false)}\n          severity={props.severity}\n          title={props.text}\n        />\n      )}\n    </>\n  );\n};\n","import hoistNonReactStatics from 'hoist-non-react-statics';\nimport memoize from 'micro-memoize';\nimport React, { useContext } from 'react';\n\nimport { GrafanaTheme, GrafanaTheme2, ThemeContext } from '@grafana/data';\n\nimport { Themeable, Themeable2 } from '../types/theme';\n\nimport { stylesFactory } from './stylesFactory';\n\ntype Omit<T, K> = Pick<T, Exclude<keyof T, K>>;\ntype Subtract<T, K> = Omit<T, keyof K>;\n\n/**\n * Mock used in tests\n */\nlet ThemeContextMock: React.Context<GrafanaTheme2> | null = null;\n\n// Used by useStyles()\nexport const memoizedStyleCreators = new WeakMap();\n\n/** @deprecated use withTheme2 */\n/** @public */\nexport const withTheme = <P extends Themeable, S extends {} = {}>(Component: React.ComponentType<P>) => {\n  const WithTheme: React.FunctionComponent<Subtract<P, Themeable>> = (props) => {\n    /**\n     * If theme context is mocked, let's use it instead of the original context\n     * This is used in tests when mocking theme using mockThemeContext function defined below\n     */\n    const ContextComponent = ThemeContextMock || ThemeContext;\n    return (\n      // @ts-ignore\n      <ContextComponent.Consumer>{(theme) => <Component {...props} theme={theme.v1} />}</ContextComponent.Consumer>\n    );\n  };\n\n  WithTheme.displayName = `WithTheme(${Component.displayName})`;\n  hoistNonReactStatics(WithTheme, Component);\n  type Hoisted = typeof WithTheme & S;\n  return WithTheme as Hoisted;\n};\n\n/** @alpha */\nexport const withTheme2 = <P extends Themeable2, S extends {} = {}>(Component: React.ComponentType<P>) => {\n  const WithTheme: React.FunctionComponent<Subtract<P, Themeable2>> = (props) => {\n    /**\n     * If theme context is mocked, let's use it instead of the original context\n     * This is used in tests when mocking theme using mockThemeContext function defined below\n     */\n    const ContextComponent = ThemeContextMock || ThemeContext;\n    return (\n      // @ts-ignore\n      <ContextComponent.Consumer>{(theme) => <Component {...props} theme={theme} />}</ContextComponent.Consumer>\n    );\n  };\n\n  WithTheme.displayName = `WithTheme(${Component.displayName})`;\n  hoistNonReactStatics(WithTheme, Component);\n  type Hoisted = typeof WithTheme & S;\n  return WithTheme as Hoisted;\n};\n\n/** @deprecated use useTheme2 */\n/** @public */\nexport function useTheme(): GrafanaTheme {\n  return useContext(ThemeContextMock || ThemeContext).v1;\n}\n\n/** @public */\nexport function useTheme2(): GrafanaTheme2 {\n  return useContext(ThemeContextMock || ThemeContext);\n}\n\n/**\n * Hook for using memoized styles with access to the theme.\n *\n * NOTE: For memoization to work, you need to ensure that the function\n * you pass in doesn't change, or only if it needs to. (i.e. declare\n * your style creator outside of a function component or use `useCallback()`.)\n * */\n/** @deprecated use useStyles2 */\n/** @public */\nexport function useStyles<T>(getStyles: (theme: GrafanaTheme) => T) {\n  const theme = useTheme();\n\n  let memoizedStyleCreator: typeof getStyles = memoizedStyleCreators.get(getStyles);\n\n  if (!memoizedStyleCreator) {\n    memoizedStyleCreator = stylesFactory(getStyles);\n    memoizedStyleCreators.set(getStyles, memoizedStyleCreator);\n  }\n\n  return memoizedStyleCreator(theme);\n}\n\n/**\n * Hook for using memoized styles with access to the theme. Pass additional\n * arguments to the getStyles function as additional arguments to this hook.\n *\n * Prefer using primitive values (boolean, number, string, etc) for\n * additional arguments for better performance\n *\n * ```\n * const getStyles = (theme, isDisabled, isOdd) => {css(...)}\n * [...]\n * const styles = useStyles2(getStyles, true, Boolean(index % 2))\n * ```\n *\n * NOTE: For memoization to work, ensure that all arguments don't change\n * across renders (or only change if they need to)\n *\n * @public\n * */\nexport function useStyles2<T extends unknown[], CSSReturnValue>(\n  getStyles: (theme: GrafanaTheme2, ...args: T) => CSSReturnValue,\n  ...additionalArguments: T\n): CSSReturnValue {\n  const theme = useTheme2();\n\n  let memoizedStyleCreator: typeof getStyles = memoizedStyleCreators.get(getStyles);\n\n  if (!memoizedStyleCreator) {\n    memoizedStyleCreator = memoize(getStyles, { maxSize: 10 }); // each getStyles function will memoize 10 different sets of props\n    memoizedStyleCreators.set(getStyles, memoizedStyleCreator);\n  }\n\n  return memoizedStyleCreator(theme, ...additionalArguments);\n}\n\n/**\n * Enables theme context mocking\n */\n/** @public */\nexport const mockThemeContext = (theme: Partial<GrafanaTheme2>) => {\n  ThemeContextMock = React.createContext(theme as GrafanaTheme2);\n\n  return () => {\n    ThemeContextMock = null;\n  };\n};\n","import { css, cx } from '@emotion/css';\nimport Prism, { Grammar } from 'prismjs';\nimport React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data/src';\nimport { useTheme2 } from '@grafana/ui/src';\n\nexport interface Props {\n  query: string;\n  lang: {\n    grammar: Grammar;\n    name: string;\n  };\n  className?: string;\n}\nexport function RawQuery({ query, lang, className }: Props) {\n  const theme = useTheme2();\n  const styles = getStyles(theme);\n  const highlighted = Prism.highlight(query, lang.grammar, lang.name);\n\n  return (\n    <div\n      className={cx(styles.editorField, 'prism-syntax-highlight', className)}\n      aria-label=\"selector\"\n      dangerouslySetInnerHTML={{ __html: highlighted }}\n    />\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    editorField: css({\n      fontFamily: theme.typography.fontFamilyMonospace,\n      fontSize: theme.typography.bodySmall.fontSize,\n    }),\n  };\n};\n","// Code generated - EDITING IS FUTILE. DO NOT EDIT.\n//\n// Generated by:\n//     public/app/plugins/gen.go\n// Using jennies:\n//     TSTypesJenny\n//     PluginTsTypesJenny\n//\n// Run 'make gen-cue' from repository root to regenerate.\n\nimport * as common from '@grafana/schema';\n\nexport interface TempoQuery extends common.DataQuery {\n  filters: Array<TraceqlFilter>;\n  /**\n   * Filters that are used to query the metrics summary\n   */\n  groupBy?: Array<TraceqlFilter>;\n  /**\n   * Defines the maximum number of traces that are returned from Tempo\n   */\n  limit?: number;\n  /**\n   * @deprecated Define the maximum duration to select traces. Use duration format, for example: 1.2s, 100ms\n   */\n  maxDuration?: string;\n  /**\n   * @deprecated Define the minimum duration to select traces. Use duration format, for example: 1.2s, 100ms\n   */\n  minDuration?: string;\n  /**\n   * TraceQL query or trace ID\n   */\n  query?: string;\n  /**\n   * @deprecated Logfmt query to filter traces by their tags. Example: http.status_code=200 error=true\n   */\n  search?: string;\n  /**\n   * Use service.namespace in addition to service.name to uniquely identify a service.\n   */\n  serviceMapIncludeNamespace?: boolean;\n  /**\n   * Filters to be included in a PromQL query to select data for the service graph. Example: {client=\"app\",service=\"app\"}. Providing multiple values will produce union of results for each filter, using PromQL OR operator internally.\n   */\n  serviceMapQuery?: (string | Array<string>);\n  /**\n   * @deprecated Query traces by service name\n   */\n  serviceName?: string;\n  /**\n   * @deprecated Query traces by span name\n   */\n  spanName?: string;\n  /**\n   * Defines the maximum number of spans per spanset that are returned from Tempo\n   */\n  spss?: number;\n  /**\n   * The type of the table that is used to display the search results\n   */\n  tableType?: SearchTableType;\n}\n\nexport const defaultTempoQuery: Partial<TempoQuery> = {\n  filters: [],\n  groupBy: [],\n};\n\nexport type TempoQueryType = ('traceql' | 'traceqlSearch' | 'serviceMap' | 'upload' | 'nativeSearch' | 'traceId' | 'clear');\n\n/**\n * The state of the TraceQL streaming search query\n */\nexport enum SearchStreamingState {\n  Done = 'done',\n  Error = 'error',\n  Pending = 'pending',\n  Streaming = 'streaming',\n}\n\n/**\n * The type of the table that is used to display the search results\n */\nexport enum SearchTableType {\n  Spans = 'spans',\n  Traces = 'traces',\n}\n\n/**\n * static fields are pre-set in the UI, dynamic fields are added by the user\n */\nexport enum TraceqlSearchScope {\n  Intrinsic = 'intrinsic',\n  Resource = 'resource',\n  Span = 'span',\n  Unscoped = 'unscoped',\n}\n\nexport interface TraceqlFilter {\n  /**\n   * Uniquely identify the filter, will not be used in the query generation\n   */\n  id: string;\n  /**\n   * The operator that connects the tag to the value, for example: =, >, !=, =~\n   */\n  operator?: string;\n  /**\n   * The scope of the filter, can either be unscoped/all scopes, resource or span\n   */\n  scope?: TraceqlSearchScope;\n  /**\n   * The tag for the search filter, for example: .http.status_code, .service.name, status\n   */\n  tag?: string;\n  /**\n   * The value for the search filter\n   */\n  value?: (string | Array<string>);\n  /**\n   * The type of the value, used for example to check whether we need to wrap the value in quotes when generating the query\n   */\n  valueType?: string;\n}\n\nexport interface TempoDataQuery {}\n","import { css } from '@emotion/css';\nimport React__default, { useCallback } from 'react';\nimport { useStyles2 } from '@grafana/ui';\n\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nconst Stack = (_a) => {\n  var _b = _a, { children } = _b, props = __objRest(_b, [\"children\"]);\n  const styles = useStyles2(useCallback((theme) => getStyles(theme, props), [props]));\n  return /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.root }, children);\n};\nconst getStyles = (theme, props) => {\n  var _a, _b, _c;\n  return {\n    root: css({\n      display: \"flex\",\n      flexDirection: (_a = props.direction) != null ? _a : \"row\",\n      flexWrap: ((_b = props.wrap) != null ? _b : true) ? \"wrap\" : void 0,\n      alignItems: props.alignItems,\n      gap: theme.spacing((_c = props.gap) != null ? _c : 2),\n      flexGrow: props.flexGrow\n    })\n  };\n};\n\nexport { Stack };\n//# sourceMappingURL=Stack.js.map\n","import { css } from '@emotion/css';\nimport React__default from 'react';\nimport { Stack } from './Stack.js';\nimport { useStyles2 } from '@grafana/ui';\n\nconst EditorRow = ({ children }) => {\n  const styles = useStyles2(getStyles);\n  return /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.root }, /* @__PURE__ */ React__default.createElement(Stack, { gap: 2 }, children));\n};\nconst getStyles = (theme) => {\n  return {\n    root: css({\n      padding: theme.spacing(1),\n      backgroundColor: theme.colors.background.secondary,\n      borderRadius: theme.shape.borderRadius(1)\n    })\n  };\n};\n\nexport { EditorRow };\n//# sourceMappingURL=EditorRow.js.map\n","import { cx, css } from '@emotion/css';\nimport React__default, { useCallback } from 'react';\nimport { useStyles2 } from '@grafana/ui';\n\nconst Space = (props) => {\n  const styles = useStyles2(useCallback((theme) => getStyles(theme, props), [props]));\n  return /* @__PURE__ */ React__default.createElement(\"span\", { className: cx(styles.wrapper) });\n};\nSpace.defaultProps = {\n  v: 0,\n  h: 0,\n  layout: \"block\"\n};\nconst getStyles = (theme, props) => {\n  var _a, _b;\n  return {\n    wrapper: css([\n      {\n        paddingRight: theme.spacing((_a = props.h) != null ? _a : 0),\n        paddingBottom: theme.spacing((_b = props.v) != null ? _b : 0)\n      },\n      props.layout === \"inline\" && {\n        display: \"inline-block\"\n      },\n      props.layout === \"block\" && {\n        display: \"block\"\n      }\n    ])\n  };\n};\n\nexport { Space };\n//# sourceMappingURL=Space.js.map\n","import { css } from '@emotion/css';\nimport React__default, { useCallback } from 'react';\nimport { Space } from './Space.js';\nimport { useStyles2, ReactUtils, Tooltip, Icon, Field } from '@grafana/ui';\n\nvar __defProp = Object.defineProperty;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nconst EditorField = (props) => {\n  var _b;\n  const _a = props, { label, optional, tooltip, tooltipInteractive, children, width } = _a, fieldProps = __objRest(_a, [\"label\", \"optional\", \"tooltip\", \"tooltipInteractive\", \"children\", \"width\"]);\n  const styles = useStyles2(useCallback((theme) => getStyles(theme, width), [width]));\n  const childInputId = (fieldProps == null ? void 0 : fieldProps.htmlFor) || ((_b = ReactUtils) == null ? void 0 : _b.getChildId(children));\n  const labelEl = /* @__PURE__ */ React__default.createElement(React__default.Fragment, null, /* @__PURE__ */ React__default.createElement(\"label\", { className: styles.label, htmlFor: childInputId }, label, optional && /* @__PURE__ */ React__default.createElement(\"span\", { className: styles.optional }, \" - optional\"), tooltip && /* @__PURE__ */ React__default.createElement(Tooltip, { placement: \"top\", content: tooltip, theme: \"info\", interactive: tooltipInteractive }, /* @__PURE__ */ React__default.createElement(Icon, { tabIndex: 0, name: \"info-circle\", size: \"sm\", className: styles.icon }))), /* @__PURE__ */ React__default.createElement(Space, { v: 0.5 }));\n  return /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.root }, /* @__PURE__ */ React__default.createElement(Field, __spreadValues({ className: styles.field, label: labelEl }, fieldProps), children));\n};\nconst getStyles = (theme, width) => {\n  return {\n    root: css({\n      minWidth: theme.spacing(width != null ? width : 0)\n    }),\n    label: css({\n      fontSize: 12,\n      fontWeight: theme.typography.fontWeightMedium\n    }),\n    optional: css({\n      fontStyle: \"italic\",\n      color: theme.colors.text.secondary\n    }),\n    field: css({\n      marginBottom: 0\n      // GrafanaUI/Field has a bottom margin which we must remove\n    }),\n    icon: css({\n      color: theme.colors.text.secondary,\n      marginLeft: theme.spacing(1),\n      \":hover\": {\n        color: theme.colors.text.primary\n      }\n    })\n  };\n};\n\nexport { EditorField };\n//# sourceMappingURL=EditorField.js.map\n","import { useReducer } from 'react';\nvar toggleReducer = function (state, nextValue) {\n    return typeof nextValue === 'boolean' ? nextValue : !state;\n};\nvar useToggle = function (initialValue) {\n    return useReducer(toggleReducer, initialValue);\n};\nexport default useToggle;\n","import { css } from '@emotion/css';\nimport React from 'react';\nimport { useToggle } from 'react-use';\n\nimport { getValueFormat, GrafanaTheme2 } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { Collapse, Icon, Tooltip, useStyles2, Stack } from '@grafana/ui';\n\nimport { QueryStats } from '../loki/types';\n\nexport interface Props {\n  title: string;\n  collapsedInfo: string[];\n  queryStats?: QueryStats | null;\n  children: React.ReactNode;\n}\n\nexport function QueryOptionGroup({ title, children, collapsedInfo, queryStats }: Props) {\n  const [isOpen, toggleOpen] = useToggle(false);\n  const styles = useStyles2(getStyles);\n\n  return (\n    <div className={styles.wrapper}>\n      <Collapse\n        className={styles.collapse}\n        collapsible\n        isOpen={isOpen}\n        onToggle={toggleOpen}\n        label={\n          <Stack gap={0}>\n            <h6 className={styles.title}>{title}</h6>\n            {!isOpen && (\n              <div className={styles.description}>\n                {collapsedInfo.map((x, i) => (\n                  <span key={i}>{x}</span>\n                ))}\n              </div>\n            )}\n          </Stack>\n        }\n      >\n        <div className={styles.body}>{children}</div>\n      </Collapse>\n\n      {queryStats && config.featureToggles.lokiQuerySplitting && (\n        <Tooltip content=\"Note: the query will be split into multiple parts and executed in sequence. Query limits will only apply each individual part.\">\n          <Icon tabIndex={0} name=\"info-circle\" className={styles.tooltip} size=\"sm\" />\n        </Tooltip>\n      )}\n\n      {queryStats && <p className={styles.stats}>{generateQueryStats(queryStats)}</p>}\n    </div>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    collapse: css({\n      backgroundColor: 'unset',\n      border: 'unset',\n      marginBottom: 0,\n\n      ['> button']: {\n        padding: theme.spacing(0, 1),\n      },\n    }),\n    wrapper: css({\n      width: '100%',\n      display: 'flex',\n      justifyContent: 'space-between',\n      alignItems: 'baseline',\n    }),\n    title: css({\n      flexGrow: 1,\n      overflow: 'hidden',\n      fontSize: theme.typography.bodySmall.fontSize,\n      fontWeight: theme.typography.fontWeightMedium,\n      margin: 0,\n    }),\n    description: css({\n      color: theme.colors.text.secondary,\n      fontSize: theme.typography.bodySmall.fontSize,\n      fontWeight: theme.typography.bodySmall.fontWeight,\n      paddingLeft: theme.spacing(2),\n      gap: theme.spacing(2),\n      display: 'flex',\n    }),\n    body: css({\n      display: 'flex',\n      gap: theme.spacing(2),\n      flexWrap: 'wrap',\n    }),\n    stats: css({\n      margin: '0px',\n      color: theme.colors.text.secondary,\n      fontSize: theme.typography.bodySmall.fontSize,\n    }),\n    tooltip: css({\n      marginRight: theme.spacing(0.25),\n    }),\n  };\n};\n\nconst generateQueryStats = (queryStats: QueryStats) => {\n  if (queryStats.message) {\n    return queryStats.message;\n  }\n\n  return `This query will process approximately ${convertUnits(queryStats)}.`;\n};\n\nconst convertUnits = (queryStats: QueryStats): string => {\n  const { text, suffix } = getValueFormat('bytes')(queryStats.bytes, 1);\n  return text + suffix;\n};\n","export function isFunction(value) {\n    return typeof value === 'function';\n}\n//# sourceMappingURL=isFunction.js.map","import { isFunction } from './isFunction';\nexport function hasLift(source) {\n    return isFunction(source === null || source === void 0 ? void 0 : source.lift);\n}\nexport function operate(init) {\n    return function (source) {\n        if (hasLift(source)) {\n            return source.lift(function (liftedSource) {\n                try {\n                    return init(liftedSource, this);\n                }\n                catch (err) {\n                    this.error(err);\n                }\n            });\n        }\n        throw new TypeError('Unable to lift unknown Observable type');\n    };\n}\n//# sourceMappingURL=lift.js.map","export function createErrorClass(createImpl) {\n    var _super = function (instance) {\n        Error.call(instance);\n        instance.stack = new Error().stack;\n    };\n    var ctorFunc = createImpl(_super);\n    ctorFunc.prototype = Object.create(Error.prototype);\n    ctorFunc.prototype.constructor = ctorFunc;\n    return ctorFunc;\n}\n//# sourceMappingURL=createErrorClass.js.map","import { createErrorClass } from './createErrorClass';\nexport var UnsubscriptionError = createErrorClass(function (_super) {\n    return function UnsubscriptionErrorImpl(errors) {\n        _super(this);\n        this.message = errors\n            ? errors.length + \" errors occurred during unsubscription:\\n\" + errors.map(function (err, i) { return i + 1 + \") \" + err.toString(); }).join('\\n  ')\n            : '';\n        this.name = 'UnsubscriptionError';\n        this.errors = errors;\n    };\n});\n//# sourceMappingURL=UnsubscriptionError.js.map","export function arrRemove(arr, item) {\n    if (arr) {\n        var index = arr.indexOf(item);\n        0 <= index && arr.splice(index, 1);\n    }\n}\n//# sourceMappingURL=arrRemove.js.map","import { __read, __spreadArray, __values } from \"tslib\";\nimport { isFunction } from './util/isFunction';\nimport { UnsubscriptionError } from './util/UnsubscriptionError';\nimport { arrRemove } from './util/arrRemove';\nvar Subscription = (function () {\n    function Subscription(initialTeardown) {\n        this.initialTeardown = initialTeardown;\n        this.closed = false;\n        this._parentage = null;\n        this._finalizers = null;\n    }\n    Subscription.prototype.unsubscribe = function () {\n        var e_1, _a, e_2, _b;\n        var errors;\n        if (!this.closed) {\n            this.closed = true;\n            var _parentage = this._parentage;\n            if (_parentage) {\n                this._parentage = null;\n                if (Array.isArray(_parentage)) {\n                    try {\n                        for (var _parentage_1 = __values(_parentage), _parentage_1_1 = _parentage_1.next(); !_parentage_1_1.done; _parentage_1_1 = _parentage_1.next()) {\n                            var parent_1 = _parentage_1_1.value;\n                            parent_1.remove(this);\n                        }\n                    }\n                    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                    finally {\n                        try {\n                            if (_parentage_1_1 && !_parentage_1_1.done && (_a = _parentage_1.return)) _a.call(_parentage_1);\n                        }\n                        finally { if (e_1) throw e_1.error; }\n                    }\n                }\n                else {\n                    _parentage.remove(this);\n                }\n            }\n            var initialFinalizer = this.initialTeardown;\n            if (isFunction(initialFinalizer)) {\n                try {\n                    initialFinalizer();\n                }\n                catch (e) {\n                    errors = e instanceof UnsubscriptionError ? e.errors : [e];\n                }\n            }\n            var _finalizers = this._finalizers;\n            if (_finalizers) {\n                this._finalizers = null;\n                try {\n                    for (var _finalizers_1 = __values(_finalizers), _finalizers_1_1 = _finalizers_1.next(); !_finalizers_1_1.done; _finalizers_1_1 = _finalizers_1.next()) {\n                        var finalizer = _finalizers_1_1.value;\n                        try {\n                            execFinalizer(finalizer);\n                        }\n                        catch (err) {\n                            errors = errors !== null && errors !== void 0 ? errors : [];\n                            if (err instanceof UnsubscriptionError) {\n                                errors = __spreadArray(__spreadArray([], __read(errors)), __read(err.errors));\n                            }\n                            else {\n                                errors.push(err);\n                            }\n                        }\n                    }\n                }\n                catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                finally {\n                    try {\n                        if (_finalizers_1_1 && !_finalizers_1_1.done && (_b = _finalizers_1.return)) _b.call(_finalizers_1);\n                    }\n                    finally { if (e_2) throw e_2.error; }\n                }\n            }\n            if (errors) {\n                throw new UnsubscriptionError(errors);\n            }\n        }\n    };\n    Subscription.prototype.add = function (teardown) {\n        var _a;\n        if (teardown && teardown !== this) {\n            if (this.closed) {\n                execFinalizer(teardown);\n            }\n            else {\n                if (teardown instanceof Subscription) {\n                    if (teardown.closed || teardown._hasParent(this)) {\n                        return;\n                    }\n                    teardown._addParent(this);\n                }\n                (this._finalizers = (_a = this._finalizers) !== null && _a !== void 0 ? _a : []).push(teardown);\n            }\n        }\n    };\n    Subscription.prototype._hasParent = function (parent) {\n        var _parentage = this._parentage;\n        return _parentage === parent || (Array.isArray(_parentage) && _parentage.includes(parent));\n    };\n    Subscription.prototype._addParent = function (parent) {\n        var _parentage = this._parentage;\n        this._parentage = Array.isArray(_parentage) ? (_parentage.push(parent), _parentage) : _parentage ? [_parentage, parent] : parent;\n    };\n    Subscription.prototype._removeParent = function (parent) {\n        var _parentage = this._parentage;\n        if (_parentage === parent) {\n            this._parentage = null;\n        }\n        else if (Array.isArray(_parentage)) {\n            arrRemove(_parentage, parent);\n        }\n    };\n    Subscription.prototype.remove = function (teardown) {\n        var _finalizers = this._finalizers;\n        _finalizers && arrRemove(_finalizers, teardown);\n        if (teardown instanceof Subscription) {\n            teardown._removeParent(this);\n        }\n    };\n    Subscription.EMPTY = (function () {\n        var empty = new Subscription();\n        empty.closed = true;\n        return empty;\n    })();\n    return Subscription;\n}());\nexport { Subscription };\nexport var EMPTY_SUBSCRIPTION = Subscription.EMPTY;\nexport function isSubscription(value) {\n    return (value instanceof Subscription ||\n        (value && 'closed' in value && isFunction(value.remove) && isFunction(value.add) && isFunction(value.unsubscribe)));\n}\nfunction execFinalizer(finalizer) {\n    if (isFunction(finalizer)) {\n        finalizer();\n    }\n    else {\n        finalizer.unsubscribe();\n    }\n}\n//# sourceMappingURL=Subscription.js.map","export var config = {\n    onUnhandledError: null,\n    onStoppedNotification: null,\n    Promise: undefined,\n    useDeprecatedSynchronousErrorHandling: false,\n    useDeprecatedNextContext: false,\n};\n//# sourceMappingURL=config.js.map","import { __read, __spreadArray } from \"tslib\";\nexport var timeoutProvider = {\n    setTimeout: function (handler, timeout) {\n        var args = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            args[_i - 2] = arguments[_i];\n        }\n        var delegate = timeoutProvider.delegate;\n        if (delegate === null || delegate === void 0 ? void 0 : delegate.setTimeout) {\n            return delegate.setTimeout.apply(delegate, __spreadArray([handler, timeout], __read(args)));\n        }\n        return setTimeout.apply(void 0, __spreadArray([handler, timeout], __read(args)));\n    },\n    clearTimeout: function (handle) {\n        var delegate = timeoutProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.clearTimeout) || clearTimeout)(handle);\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=timeoutProvider.js.map","import { config } from '../config';\nimport { timeoutProvider } from '../scheduler/timeoutProvider';\nexport function reportUnhandledError(err) {\n    timeoutProvider.setTimeout(function () {\n        var onUnhandledError = config.onUnhandledError;\n        if (onUnhandledError) {\n            onUnhandledError(err);\n        }\n        else {\n            throw err;\n        }\n    });\n}\n//# sourceMappingURL=reportUnhandledError.js.map","export function noop() { }\n//# sourceMappingURL=noop.js.map","export var COMPLETE_NOTIFICATION = (function () { return createNotification('C', undefined, undefined); })();\nexport function errorNotification(error) {\n    return createNotification('E', undefined, error);\n}\nexport function nextNotification(value) {\n    return createNotification('N', value, undefined);\n}\nexport function createNotification(kind, value, error) {\n    return {\n        kind: kind,\n        value: value,\n        error: error,\n    };\n}\n//# sourceMappingURL=NotificationFactories.js.map","import { config } from '../config';\nvar context = null;\nexport function errorContext(cb) {\n    if (config.useDeprecatedSynchronousErrorHandling) {\n        var isRoot = !context;\n        if (isRoot) {\n            context = { errorThrown: false, error: null };\n        }\n        cb();\n        if (isRoot) {\n            var _a = context, errorThrown = _a.errorThrown, error = _a.error;\n            context = null;\n            if (errorThrown) {\n                throw error;\n            }\n        }\n    }\n    else {\n        cb();\n    }\n}\nexport function captureError(err) {\n    if (config.useDeprecatedSynchronousErrorHandling && context) {\n        context.errorThrown = true;\n        context.error = err;\n    }\n}\n//# sourceMappingURL=errorContext.js.map","import { __extends } from \"tslib\";\nimport { isFunction } from './util/isFunction';\nimport { isSubscription, Subscription } from './Subscription';\nimport { config } from './config';\nimport { reportUnhandledError } from './util/reportUnhandledError';\nimport { noop } from './util/noop';\nimport { nextNotification, errorNotification, COMPLETE_NOTIFICATION } from './NotificationFactories';\nimport { timeoutProvider } from './scheduler/timeoutProvider';\nimport { captureError } from './util/errorContext';\nvar Subscriber = (function (_super) {\n    __extends(Subscriber, _super);\n    function Subscriber(destination) {\n        var _this = _super.call(this) || this;\n        _this.isStopped = false;\n        if (destination) {\n            _this.destination = destination;\n            if (isSubscription(destination)) {\n                destination.add(_this);\n            }\n        }\n        else {\n            _this.destination = EMPTY_OBSERVER;\n        }\n        return _this;\n    }\n    Subscriber.create = function (next, error, complete) {\n        return new SafeSubscriber(next, error, complete);\n    };\n    Subscriber.prototype.next = function (value) {\n        if (this.isStopped) {\n            handleStoppedNotification(nextNotification(value), this);\n        }\n        else {\n            this._next(value);\n        }\n    };\n    Subscriber.prototype.error = function (err) {\n        if (this.isStopped) {\n            handleStoppedNotification(errorNotification(err), this);\n        }\n        else {\n            this.isStopped = true;\n            this._error(err);\n        }\n    };\n    Subscriber.prototype.complete = function () {\n        if (this.isStopped) {\n            handleStoppedNotification(COMPLETE_NOTIFICATION, this);\n        }\n        else {\n            this.isStopped = true;\n            this._complete();\n        }\n    };\n    Subscriber.prototype.unsubscribe = function () {\n        if (!this.closed) {\n            this.isStopped = true;\n            _super.prototype.unsubscribe.call(this);\n            this.destination = null;\n        }\n    };\n    Subscriber.prototype._next = function (value) {\n        this.destination.next(value);\n    };\n    Subscriber.prototype._error = function (err) {\n        try {\n            this.destination.error(err);\n        }\n        finally {\n            this.unsubscribe();\n        }\n    };\n    Subscriber.prototype._complete = function () {\n        try {\n            this.destination.complete();\n        }\n        finally {\n            this.unsubscribe();\n        }\n    };\n    return Subscriber;\n}(Subscription));\nexport { Subscriber };\nvar _bind = Function.prototype.bind;\nfunction bind(fn, thisArg) {\n    return _bind.call(fn, thisArg);\n}\nvar ConsumerObserver = (function () {\n    function ConsumerObserver(partialObserver) {\n        this.partialObserver = partialObserver;\n    }\n    ConsumerObserver.prototype.next = function (value) {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.next) {\n            try {\n                partialObserver.next(value);\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n    };\n    ConsumerObserver.prototype.error = function (err) {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.error) {\n            try {\n                partialObserver.error(err);\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n        else {\n            handleUnhandledError(err);\n        }\n    };\n    ConsumerObserver.prototype.complete = function () {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.complete) {\n            try {\n                partialObserver.complete();\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n    };\n    return ConsumerObserver;\n}());\nvar SafeSubscriber = (function (_super) {\n    __extends(SafeSubscriber, _super);\n    function SafeSubscriber(observerOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        var partialObserver;\n        if (isFunction(observerOrNext) || !observerOrNext) {\n            partialObserver = {\n                next: (observerOrNext !== null && observerOrNext !== void 0 ? observerOrNext : undefined),\n                error: error !== null && error !== void 0 ? error : undefined,\n                complete: complete !== null && complete !== void 0 ? complete : undefined,\n            };\n        }\n        else {\n            var context_1;\n            if (_this && config.useDeprecatedNextContext) {\n                context_1 = Object.create(observerOrNext);\n                context_1.unsubscribe = function () { return _this.unsubscribe(); };\n                partialObserver = {\n                    next: observerOrNext.next && bind(observerOrNext.next, context_1),\n                    error: observerOrNext.error && bind(observerOrNext.error, context_1),\n                    complete: observerOrNext.complete && bind(observerOrNext.complete, context_1),\n                };\n            }\n            else {\n                partialObserver = observerOrNext;\n            }\n        }\n        _this.destination = new ConsumerObserver(partialObserver);\n        return _this;\n    }\n    return SafeSubscriber;\n}(Subscriber));\nexport { SafeSubscriber };\nfunction handleUnhandledError(error) {\n    if (config.useDeprecatedSynchronousErrorHandling) {\n        captureError(error);\n    }\n    else {\n        reportUnhandledError(error);\n    }\n}\nfunction defaultErrorHandler(err) {\n    throw err;\n}\nfunction handleStoppedNotification(notification, subscriber) {\n    var onStoppedNotification = config.onStoppedNotification;\n    onStoppedNotification && timeoutProvider.setTimeout(function () { return onStoppedNotification(notification, subscriber); });\n}\nexport var EMPTY_OBSERVER = {\n    closed: true,\n    next: noop,\n    error: defaultErrorHandler,\n    complete: noop,\n};\n//# sourceMappingURL=Subscriber.js.map","import { __extends } from \"tslib\";\nimport { Subscriber } from '../Subscriber';\nexport function createOperatorSubscriber(destination, onNext, onComplete, onError, onFinalize) {\n    return new OperatorSubscriber(destination, onNext, onComplete, onError, onFinalize);\n}\nvar OperatorSubscriber = (function (_super) {\n    __extends(OperatorSubscriber, _super);\n    function OperatorSubscriber(destination, onNext, onComplete, onError, onFinalize, shouldUnsubscribe) {\n        var _this = _super.call(this, destination) || this;\n        _this.onFinalize = onFinalize;\n        _this.shouldUnsubscribe = shouldUnsubscribe;\n        _this._next = onNext\n            ? function (value) {\n                try {\n                    onNext(value);\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n            }\n            : _super.prototype._next;\n        _this._error = onError\n            ? function (err) {\n                try {\n                    onError(err);\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n                finally {\n                    this.unsubscribe();\n                }\n            }\n            : _super.prototype._error;\n        _this._complete = onComplete\n            ? function () {\n                try {\n                    onComplete();\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n                finally {\n                    this.unsubscribe();\n                }\n            }\n            : _super.prototype._complete;\n        return _this;\n    }\n    OperatorSubscriber.prototype.unsubscribe = function () {\n        var _a;\n        if (!this.shouldUnsubscribe || this.shouldUnsubscribe()) {\n            var closed_1 = this.closed;\n            _super.prototype.unsubscribe.call(this);\n            !closed_1 && ((_a = this.onFinalize) === null || _a === void 0 ? void 0 : _a.call(this));\n        }\n    };\n    return OperatorSubscriber;\n}(Subscriber));\nexport { OperatorSubscriber };\n//# sourceMappingURL=OperatorSubscriber.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function map(project, thisArg) {\n    return operate(function (source, subscriber) {\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            subscriber.next(project.call(thisArg, value, index++));\n        }));\n    });\n}\n//# sourceMappingURL=map.js.map","export var isArrayLike = (function (x) { return x && typeof x.length === 'number' && typeof x !== 'function'; });\n//# sourceMappingURL=isArrayLike.js.map","export var observable = (function () { return (typeof Symbol === 'function' && Symbol.observable) || '@@observable'; })();\n//# sourceMappingURL=observable.js.map","export function identity(x) {\n    return x;\n}\n//# sourceMappingURL=identity.js.map","import { SafeSubscriber, Subscriber } from './Subscriber';\nimport { isSubscription } from './Subscription';\nimport { observable as Symbol_observable } from './symbol/observable';\nimport { pipeFromArray } from './util/pipe';\nimport { config } from './config';\nimport { isFunction } from './util/isFunction';\nimport { errorContext } from './util/errorContext';\nvar Observable = (function () {\n    function Observable(subscribe) {\n        if (subscribe) {\n            this._subscribe = subscribe;\n        }\n    }\n    Observable.prototype.lift = function (operator) {\n        var observable = new Observable();\n        observable.source = this;\n        observable.operator = operator;\n        return observable;\n    };\n    Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n        var _this = this;\n        var subscriber = isSubscriber(observerOrNext) ? observerOrNext : new SafeSubscriber(observerOrNext, error, complete);\n        errorContext(function () {\n            var _a = _this, operator = _a.operator, source = _a.source;\n            subscriber.add(operator\n                ?\n                    operator.call(subscriber, source)\n                : source\n                    ?\n                        _this._subscribe(subscriber)\n                    :\n                        _this._trySubscribe(subscriber));\n        });\n        return subscriber;\n    };\n    Observable.prototype._trySubscribe = function (sink) {\n        try {\n            return this._subscribe(sink);\n        }\n        catch (err) {\n            sink.error(err);\n        }\n    };\n    Observable.prototype.forEach = function (next, promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var subscriber = new SafeSubscriber({\n                next: function (value) {\n                    try {\n                        next(value);\n                    }\n                    catch (err) {\n                        reject(err);\n                        subscriber.unsubscribe();\n                    }\n                },\n                error: reject,\n                complete: resolve,\n            });\n            _this.subscribe(subscriber);\n        });\n    };\n    Observable.prototype._subscribe = function (subscriber) {\n        var _a;\n        return (_a = this.source) === null || _a === void 0 ? void 0 : _a.subscribe(subscriber);\n    };\n    Observable.prototype[Symbol_observable] = function () {\n        return this;\n    };\n    Observable.prototype.pipe = function () {\n        var operations = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            operations[_i] = arguments[_i];\n        }\n        return pipeFromArray(operations)(this);\n    };\n    Observable.prototype.toPromise = function (promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var value;\n            _this.subscribe(function (x) { return (value = x); }, function (err) { return reject(err); }, function () { return resolve(value); });\n        });\n    };\n    Observable.create = function (subscribe) {\n        return new Observable(subscribe);\n    };\n    return Observable;\n}());\nexport { Observable };\nfunction getPromiseCtor(promiseCtor) {\n    var _a;\n    return (_a = promiseCtor !== null && promiseCtor !== void 0 ? promiseCtor : config.Promise) !== null && _a !== void 0 ? _a : Promise;\n}\nfunction isObserver(value) {\n    return value && isFunction(value.next) && isFunction(value.error) && isFunction(value.complete);\n}\nfunction isSubscriber(value) {\n    return (value && value instanceof Subscriber) || (isObserver(value) && isSubscription(value));\n}\n//# sourceMappingURL=Observable.js.map","import { identity } from './identity';\nexport function pipe() {\n    var fns = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        fns[_i] = arguments[_i];\n    }\n    return pipeFromArray(fns);\n}\nexport function pipeFromArray(fns) {\n    if (fns.length === 0) {\n        return identity;\n    }\n    if (fns.length === 1) {\n        return fns[0];\n    }\n    return function piped(input) {\n        return fns.reduce(function (prev, fn) { return fn(prev); }, input);\n    };\n}\n//# sourceMappingURL=pipe.js.map","export function getSymbolIterator() {\n    if (typeof Symbol !== 'function' || !Symbol.iterator) {\n        return '@@iterator';\n    }\n    return Symbol.iterator;\n}\nexport var iterator = getSymbolIterator();\n//# sourceMappingURL=iterator.js.map","import { __asyncValues, __awaiter, __generator, __values } from \"tslib\";\nimport { isArrayLike } from '../util/isArrayLike';\nimport { isPromise } from '../util/isPromise';\nimport { Observable } from '../Observable';\nimport { isInteropObservable } from '../util/isInteropObservable';\nimport { isAsyncIterable } from '../util/isAsyncIterable';\nimport { createInvalidObservableTypeError } from '../util/throwUnobservableError';\nimport { isIterable } from '../util/isIterable';\nimport { isReadableStreamLike, readableStreamLikeToAsyncGenerator } from '../util/isReadableStreamLike';\nimport { isFunction } from '../util/isFunction';\nimport { reportUnhandledError } from '../util/reportUnhandledError';\nimport { observable as Symbol_observable } from '../symbol/observable';\nexport function innerFrom(input) {\n    if (input instanceof Observable) {\n        return input;\n    }\n    if (input != null) {\n        if (isInteropObservable(input)) {\n            return fromInteropObservable(input);\n        }\n        if (isArrayLike(input)) {\n            return fromArrayLike(input);\n        }\n        if (isPromise(input)) {\n            return fromPromise(input);\n        }\n        if (isAsyncIterable(input)) {\n            return fromAsyncIterable(input);\n        }\n        if (isIterable(input)) {\n            return fromIterable(input);\n        }\n        if (isReadableStreamLike(input)) {\n            return fromReadableStreamLike(input);\n        }\n    }\n    throw createInvalidObservableTypeError(input);\n}\nexport function fromInteropObservable(obj) {\n    return new Observable(function (subscriber) {\n        var obs = obj[Symbol_observable]();\n        if (isFunction(obs.subscribe)) {\n            return obs.subscribe(subscriber);\n        }\n        throw new TypeError('Provided object does not correctly implement Symbol.observable');\n    });\n}\nexport function fromArrayLike(array) {\n    return new Observable(function (subscriber) {\n        for (var i = 0; i < array.length && !subscriber.closed; i++) {\n            subscriber.next(array[i]);\n        }\n        subscriber.complete();\n    });\n}\nexport function fromPromise(promise) {\n    return new Observable(function (subscriber) {\n        promise\n            .then(function (value) {\n            if (!subscriber.closed) {\n                subscriber.next(value);\n                subscriber.complete();\n            }\n        }, function (err) { return subscriber.error(err); })\n            .then(null, reportUnhandledError);\n    });\n}\nexport function fromIterable(iterable) {\n    return new Observable(function (subscriber) {\n        var e_1, _a;\n        try {\n            for (var iterable_1 = __values(iterable), iterable_1_1 = iterable_1.next(); !iterable_1_1.done; iterable_1_1 = iterable_1.next()) {\n                var value = iterable_1_1.value;\n                subscriber.next(value);\n                if (subscriber.closed) {\n                    return;\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (iterable_1_1 && !iterable_1_1.done && (_a = iterable_1.return)) _a.call(iterable_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        subscriber.complete();\n    });\n}\nexport function fromAsyncIterable(asyncIterable) {\n    return new Observable(function (subscriber) {\n        process(asyncIterable, subscriber).catch(function (err) { return subscriber.error(err); });\n    });\n}\nexport function fromReadableStreamLike(readableStream) {\n    return fromAsyncIterable(readableStreamLikeToAsyncGenerator(readableStream));\n}\nfunction process(asyncIterable, subscriber) {\n    var asyncIterable_1, asyncIterable_1_1;\n    var e_2, _a;\n    return __awaiter(this, void 0, void 0, function () {\n        var value, e_2_1;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    _b.trys.push([0, 5, 6, 11]);\n                    asyncIterable_1 = __asyncValues(asyncIterable);\n                    _b.label = 1;\n                case 1: return [4, asyncIterable_1.next()];\n                case 2:\n                    if (!(asyncIterable_1_1 = _b.sent(), !asyncIterable_1_1.done)) return [3, 4];\n                    value = asyncIterable_1_1.value;\n                    subscriber.next(value);\n                    if (subscriber.closed) {\n                        return [2];\n                    }\n                    _b.label = 3;\n                case 3: return [3, 1];\n                case 4: return [3, 11];\n                case 5:\n                    e_2_1 = _b.sent();\n                    e_2 = { error: e_2_1 };\n                    return [3, 11];\n                case 6:\n                    _b.trys.push([6, , 9, 10]);\n                    if (!(asyncIterable_1_1 && !asyncIterable_1_1.done && (_a = asyncIterable_1.return))) return [3, 8];\n                    return [4, _a.call(asyncIterable_1)];\n                case 7:\n                    _b.sent();\n                    _b.label = 8;\n                case 8: return [3, 10];\n                case 9:\n                    if (e_2) throw e_2.error;\n                    return [7];\n                case 10: return [7];\n                case 11:\n                    subscriber.complete();\n                    return [2];\n            }\n        });\n    });\n}\n//# sourceMappingURL=innerFrom.js.map","import { observable as Symbol_observable } from '../symbol/observable';\nimport { isFunction } from './isFunction';\nexport function isInteropObservable(input) {\n    return isFunction(input[Symbol_observable]);\n}\n//# sourceMappingURL=isInteropObservable.js.map","import { isFunction } from \"./isFunction\";\nexport function isPromise(value) {\n    return isFunction(value === null || value === void 0 ? void 0 : value.then);\n}\n//# sourceMappingURL=isPromise.js.map","import { isFunction } from './isFunction';\nexport function isAsyncIterable(obj) {\n    return Symbol.asyncIterator && isFunction(obj === null || obj === void 0 ? void 0 : obj[Symbol.asyncIterator]);\n}\n//# sourceMappingURL=isAsyncIterable.js.map","import { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { isFunction } from './isFunction';\nexport function isIterable(input) {\n    return isFunction(input === null || input === void 0 ? void 0 : input[Symbol_iterator]);\n}\n//# sourceMappingURL=isIterable.js.map","import { __asyncGenerator, __await, __generator } from \"tslib\";\nimport { isFunction } from './isFunction';\nexport function readableStreamLikeToAsyncGenerator(readableStream) {\n    return __asyncGenerator(this, arguments, function readableStreamLikeToAsyncGenerator_1() {\n        var reader, _a, value, done;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    reader = readableStream.getReader();\n                    _b.label = 1;\n                case 1:\n                    _b.trys.push([1, , 9, 10]);\n                    _b.label = 2;\n                case 2:\n                    if (!true) return [3, 8];\n                    return [4, __await(reader.read())];\n                case 3:\n                    _a = _b.sent(), value = _a.value, done = _a.done;\n                    if (!done) return [3, 5];\n                    return [4, __await(void 0)];\n                case 4: return [2, _b.sent()];\n                case 5: return [4, __await(value)];\n                case 6: return [4, _b.sent()];\n                case 7:\n                    _b.sent();\n                    return [3, 2];\n                case 8: return [3, 10];\n                case 9:\n                    reader.releaseLock();\n                    return [7];\n                case 10: return [2];\n            }\n        });\n    });\n}\nexport function isReadableStreamLike(obj) {\n    return isFunction(obj === null || obj === void 0 ? void 0 : obj.getReader);\n}\n//# sourceMappingURL=isReadableStreamLike.js.map","export function createInvalidObservableTypeError(input) {\n    return new TypeError(\"You provided \" + (input !== null && typeof input === 'object' ? 'an invalid object' : \"'\" + input + \"'\") + \" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.\");\n}\n//# sourceMappingURL=throwUnobservableError.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { operate } from '../util/lift';\nexport function catchError(selector) {\n    return operate(function (source, subscriber) {\n        var innerSub = null;\n        var syncUnsub = false;\n        var handledResult;\n        innerSub = source.subscribe(createOperatorSubscriber(subscriber, undefined, undefined, function (err) {\n            handledResult = innerFrom(selector(err, catchError(selector)(source)));\n            if (innerSub) {\n                innerSub.unsubscribe();\n                innerSub = null;\n                handledResult.subscribe(subscriber);\n            }\n            else {\n                syncUnsub = true;\n            }\n        }));\n        if (syncUnsub) {\n            innerSub.unsubscribe();\n            innerSub = null;\n            handledResult.subscribe(subscriber);\n        }\n    });\n}\n//# sourceMappingURL=catchError.js.map","import { map } from './map';\nimport { innerFrom } from '../observable/innerFrom';\nimport { operate } from '../util/lift';\nimport { mergeInternals } from './mergeInternals';\nimport { isFunction } from '../util/isFunction';\nexport function mergeMap(project, resultSelector, concurrent) {\n    if (concurrent === void 0) { concurrent = Infinity; }\n    if (isFunction(resultSelector)) {\n        return mergeMap(function (a, i) { return map(function (b, ii) { return resultSelector(a, b, i, ii); })(innerFrom(project(a, i))); }, concurrent);\n    }\n    else if (typeof resultSelector === 'number') {\n        concurrent = resultSelector;\n    }\n    return operate(function (source, subscriber) { return mergeInternals(source, subscriber, project, concurrent); });\n}\n//# sourceMappingURL=mergeMap.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { executeSchedule } from '../util/executeSchedule';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function mergeInternals(source, subscriber, project, concurrent, onBeforeNext, expand, innerSubScheduler, additionalFinalizer) {\n    var buffer = [];\n    var active = 0;\n    var index = 0;\n    var isComplete = false;\n    var checkComplete = function () {\n        if (isComplete && !buffer.length && !active) {\n            subscriber.complete();\n        }\n    };\n    var outerNext = function (value) { return (active < concurrent ? doInnerSub(value) : buffer.push(value)); };\n    var doInnerSub = function (value) {\n        expand && subscriber.next(value);\n        active++;\n        var innerComplete = false;\n        innerFrom(project(value, index++)).subscribe(createOperatorSubscriber(subscriber, function (innerValue) {\n            onBeforeNext === null || onBeforeNext === void 0 ? void 0 : onBeforeNext(innerValue);\n            if (expand) {\n                outerNext(innerValue);\n            }\n            else {\n                subscriber.next(innerValue);\n            }\n        }, function () {\n            innerComplete = true;\n        }, undefined, function () {\n            if (innerComplete) {\n                try {\n                    active--;\n                    var _loop_1 = function () {\n                        var bufferedValue = buffer.shift();\n                        if (innerSubScheduler) {\n                            executeSchedule(subscriber, innerSubScheduler, function () { return doInnerSub(bufferedValue); });\n                        }\n                        else {\n                            doInnerSub(bufferedValue);\n                        }\n                    };\n                    while (buffer.length && active < concurrent) {\n                        _loop_1();\n                    }\n                    checkComplete();\n                }\n                catch (err) {\n                    subscriber.error(err);\n                }\n            }\n        }));\n    };\n    source.subscribe(createOperatorSubscriber(subscriber, outerNext, function () {\n        isComplete = true;\n        checkComplete();\n    }));\n    return function () {\n        additionalFinalizer === null || additionalFinalizer === void 0 ? void 0 : additionalFinalizer();\n    };\n}\n//# sourceMappingURL=mergeInternals.js.map","import { mergeMap } from './mergeMap';\nimport { isFunction } from '../util/isFunction';\nexport function concatMap(project, resultSelector) {\n    return isFunction(resultSelector) ? mergeMap(project, resultSelector, 1) : mergeMap(project, 1);\n}\n//# sourceMappingURL=concatMap.js.map","import { reduce } from './reduce';\nimport { operate } from '../util/lift';\nvar arrReducer = function (arr, value) { return (arr.push(value), arr); };\nexport function toArray() {\n    return operate(function (source, subscriber) {\n        reduce(arrReducer, [])(source).subscribe(subscriber);\n    });\n}\n//# sourceMappingURL=toArray.js.map","import { scanInternals } from './scanInternals';\nimport { operate } from '../util/lift';\nexport function reduce(accumulator, seed) {\n    return operate(scanInternals(accumulator, seed, arguments.length >= 2, false, true));\n}\n//# sourceMappingURL=reduce.js.map","import { createOperatorSubscriber } from './OperatorSubscriber';\nexport function scanInternals(accumulator, seed, hasSeed, emitOnNext, emitBeforeComplete) {\n    return function (source, subscriber) {\n        var hasState = hasSeed;\n        var state = seed;\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var i = index++;\n            state = hasState\n                ?\n                    accumulator(state, value, i)\n                :\n                    ((hasState = true), value);\n            emitOnNext && subscriber.next(state);\n        }, emitBeforeComplete &&\n            (function () {\n                hasState && subscriber.next(state);\n                subscriber.complete();\n            })));\n    };\n}\n//# sourceMappingURL=scanInternals.js.map","// Code generated - EDITING IS FUTILE. DO NOT EDIT.\n//\n// Generated by:\n//     kinds/gen.go\n// Using jennies:\n//     CommonSchemaJenny\n//\n// Run 'make gen-cue' from repository root to regenerate.\n\n\n/**\n * A topic is attached to DataFrame metadata in query results.\n * This specifies where the data should be used.\n */\nexport enum DataTopic {\n  AlertStates = 'alertStates',\n  Annotations = 'annotations',\n  Series = 'series',\n}\n\n/**\n * TODO docs\n */\nexport interface DataSourceJsonData {\n  alertmanagerUid?: string;\n  authType?: string;\n  defaultRegion?: string;\n  manageAlerts?: boolean;\n  profile?: string;\n}\n\n/**\n * These are the common properties available to all queries in all datasources.\n * Specific implementations will *extend* this interface, adding the required\n * properties for the given context.\n */\nexport interface DataQuery {\n  /**\n   * For mixed data sources the selected datasource is on the query level.\n   * For non mixed scenarios this is undefined.\n   * TODO find a better way to do this ^ that's friendly to schema\n   * TODO this shouldn't be unknown but DataSourceRef | null\n   */\n  datasource?: unknown;\n  /**\n   * If hide is set to true, Grafana will filter out the response(s) associated with this query before returning it to the panel.\n   */\n  hide?: boolean;\n  /**\n   * Specify the query flavor\n   * TODO make this required and give it a default\n   */\n  queryType?: string;\n  /**\n   * A unique identifier for the query within the list of targets.\n   * In server side expressions, the refId is used as a variable name to identify results.\n   * By default, the UI will assign A->Z; however setting meaningful names may be useful.\n   */\n  refId: string;\n}\n\nexport interface BaseDimensionConfig {\n  /**\n   * fixed: T -- will be added by each element\n   */\n  field?: string;\n}\n\nexport enum ScaleDimensionMode {\n  Linear = 'linear',\n  Quad = 'quad',\n}\n\nexport interface ScaleDimensionConfig extends BaseDimensionConfig {\n  fixed?: number;\n  max: number;\n  min: number;\n  mode?: ScaleDimensionMode; // | *\"linear\"\n}\n\nexport interface ColorDimensionConfig extends BaseDimensionConfig {\n  fixed?: string; // color value\n}\n\nexport enum ScalarDimensionMode {\n  Clamped = 'clamped',\n  Mod = 'mod',\n}\n\nexport interface ScalarDimensionConfig extends BaseDimensionConfig {\n  fixed?: number;\n  max: number;\n  min: number;\n  mode?: ScalarDimensionMode;\n}\n\nexport enum TextDimensionMode {\n  Field = 'field',\n  Fixed = 'fixed',\n  Template = 'template',\n}\n\nexport interface TextDimensionConfig extends BaseDimensionConfig {\n  fixed?: string;\n  mode: TextDimensionMode;\n}\n\nexport enum ResourceDimensionMode {\n  Field = 'field',\n  Fixed = 'fixed',\n  Mapping = 'mapping',\n}\n\nexport interface MapLayerOptions {\n  /**\n   * Custom options depending on the type\n   */\n  config?: unknown;\n  /**\n   * Defines a frame MatcherConfig that may filter data for the given layer\n   */\n  filterData?: unknown;\n  /**\n   * Common method to define geometry fields\n   */\n  location?: FrameGeometrySource;\n  /**\n   * configured unique display name\n   */\n  name: string;\n  /**\n   * Common properties:\n   * https://openlayers.org/en/latest/apidoc/module-ol_layer_Base-BaseLayer.html\n   * Layer opacity (0-1)\n   */\n  opacity?: number;\n  /**\n   * Check tooltip (defaults to true)\n   */\n  tooltip?: boolean;\n  type: string;\n}\n\nexport enum FrameGeometrySourceMode {\n  Auto = 'auto',\n  Coords = 'coords',\n  Geohash = 'geohash',\n  Lookup = 'lookup',\n}\n\nexport enum HeatmapCalculationMode {\n  Count = 'count',\n  Size = 'size',\n}\n\nexport enum HeatmapCellLayout {\n  auto = 'auto',\n  ge = 'ge',\n  le = 'le',\n  unknown = 'unknown',\n}\n\nexport interface HeatmapCalculationBucketConfig {\n  /**\n   * Sets the bucket calculation mode\n   */\n  mode?: HeatmapCalculationMode;\n  /**\n   * Controls the scale of the buckets\n   */\n  scale?: ScaleDistributionConfig;\n  /**\n   * The number of buckets to use for the axis in the heatmap\n   */\n  value?: string;\n}\n\nexport enum LogsSortOrder {\n  Ascending = 'Ascending',\n  Descending = 'Descending',\n}\n\n/**\n * TODO docs\n */\nexport enum AxisPlacement {\n  Auto = 'auto',\n  Bottom = 'bottom',\n  Hidden = 'hidden',\n  Left = 'left',\n  Right = 'right',\n  Top = 'top',\n}\n\n/**\n * TODO docs\n */\nexport enum AxisColorMode {\n  Series = 'series',\n  Text = 'text',\n}\n\n/**\n * TODO docs\n */\nexport enum VisibilityMode {\n  Always = 'always',\n  Auto = 'auto',\n  Never = 'never',\n}\n\n/**\n * TODO docs\n */\nexport enum GraphDrawStyle {\n  Bars = 'bars',\n  Line = 'line',\n  Points = 'points',\n}\n\n/**\n * TODO docs\n */\nexport enum GraphTransform {\n  Constant = 'constant',\n  NegativeY = 'negative-Y',\n}\n\n/**\n * TODO docs\n */\nexport enum LineInterpolation {\n  Linear = 'linear',\n  Smooth = 'smooth',\n  StepAfter = 'stepAfter',\n  StepBefore = 'stepBefore',\n}\n\n/**\n * TODO docs\n */\nexport enum ScaleDistribution {\n  Linear = 'linear',\n  Log = 'log',\n  Ordinal = 'ordinal',\n  Symlog = 'symlog',\n}\n\n/**\n * TODO docs\n */\nexport enum GraphGradientMode {\n  Hue = 'hue',\n  None = 'none',\n  Opacity = 'opacity',\n  Scheme = 'scheme',\n}\n\n/**\n * TODO docs\n */\nexport enum StackingMode {\n  None = 'none',\n  Normal = 'normal',\n  Percent = 'percent',\n}\n\n/**\n * TODO docs\n */\nexport enum BarAlignment {\n  After = 1,\n  Before = -1,\n  Center = 0,\n}\n\n/**\n * TODO docs\n */\nexport enum ScaleOrientation {\n  Horizontal = 0,\n  Vertical = 1,\n}\n\n/**\n * TODO docs\n */\nexport enum ScaleDirection {\n  Down = -1,\n  Left = -1,\n  Right = 1,\n  Up = 1,\n}\n\n/**\n * TODO docs\n */\nexport interface LineStyle {\n  dash?: Array<number>;\n  fill?: ('solid' | 'dash' | 'dot' | 'square');\n}\n\nexport const defaultLineStyle: Partial<LineStyle> = {\n  dash: [],\n};\n\n/**\n * TODO docs\n */\nexport interface LineConfig {\n  lineColor?: string;\n  lineInterpolation?: LineInterpolation;\n  lineStyle?: LineStyle;\n  lineWidth?: number;\n  /**\n   * Indicate if null values should be treated as gaps or connected.\n   * When the value is a number, it represents the maximum delta in the\n   * X axis that should be considered connected.  For timeseries, this is milliseconds\n   */\n  spanNulls?: (boolean | number);\n}\n\n/**\n * TODO docs\n */\nexport interface BarConfig {\n  barAlignment?: BarAlignment;\n  barMaxWidth?: number;\n  barWidthFactor?: number;\n}\n\n/**\n * TODO docs\n */\nexport interface FillConfig {\n  fillBelowTo?: string;\n  fillColor?: string;\n  fillOpacity?: number;\n}\n\n/**\n * TODO docs\n */\nexport interface PointsConfig {\n  pointColor?: string;\n  pointSize?: number;\n  pointSymbol?: string;\n  showPoints?: VisibilityMode;\n}\n\n/**\n * TODO docs\n */\nexport interface ScaleDistributionConfig {\n  linearThreshold?: number;\n  log?: number;\n  type: ScaleDistribution;\n}\n\n/**\n * TODO docs\n */\nexport interface AxisConfig {\n  axisBorderShow?: boolean;\n  axisCenteredZero?: boolean;\n  axisColorMode?: AxisColorMode;\n  axisGridShow?: boolean;\n  axisLabel?: string;\n  axisPlacement?: AxisPlacement;\n  axisSoftMax?: number;\n  axisSoftMin?: number;\n  axisWidth?: number;\n  scaleDistribution?: ScaleDistributionConfig;\n}\n\n/**\n * TODO docs\n */\nexport interface HideSeriesConfig {\n  legend: boolean;\n  tooltip: boolean;\n  viz: boolean;\n}\n\n/**\n * TODO docs\n */\nexport interface StackingConfig {\n  group?: string;\n  mode?: StackingMode;\n}\n\n/**\n * TODO docs\n */\nexport interface StackableFieldConfig {\n  stacking?: StackingConfig;\n}\n\n/**\n * TODO docs\n */\nexport interface HideableFieldConfig {\n  hideFrom?: HideSeriesConfig;\n}\n\n/**\n * TODO docs\n */\nexport enum GraphThresholdsStyleMode {\n  Area = 'area',\n  Dashed = 'dashed',\n  DashedAndArea = 'dashed+area',\n  Line = 'line',\n  LineAndArea = 'line+area',\n  Off = 'off',\n  Series = 'series',\n}\n\n/**\n * TODO docs\n */\nexport interface GraphThresholdsStyleConfig {\n  mode: GraphThresholdsStyleMode;\n}\n\n/**\n * TODO docs\n */\nexport type LegendPlacement = ('bottom' | 'right');\n\n/**\n * TODO docs\n * Note: \"hidden\" needs to remain as an option for plugins compatibility\n */\nexport enum LegendDisplayMode {\n  Hidden = 'hidden',\n  List = 'list',\n  Table = 'table',\n}\n\n/**\n * TODO docs\n */\nexport interface SingleStatBaseOptions extends OptionsWithTextFormatting {\n  orientation: VizOrientation;\n  reduceOptions: ReduceDataOptions;\n}\n\n/**\n * TODO docs\n */\nexport interface ReduceDataOptions {\n  /**\n   * When !values, pick one value for the whole field\n   */\n  calcs: Array<string>;\n  /**\n   * Which fields to show.  By default this is only numeric fields\n   */\n  fields?: string;\n  /**\n   * if showing all values limit\n   */\n  limit?: number;\n  /**\n   * If true show each row value\n   */\n  values?: boolean;\n}\n\nexport const defaultReduceDataOptions: Partial<ReduceDataOptions> = {\n  calcs: [],\n};\n\n/**\n * TODO docs\n */\nexport enum VizOrientation {\n  Auto = 'auto',\n  Horizontal = 'horizontal',\n  Vertical = 'vertical',\n}\n\n/**\n * TODO docs\n */\nexport interface OptionsWithTooltip {\n  tooltip: VizTooltipOptions;\n}\n\n/**\n * TODO docs\n */\nexport interface OptionsWithLegend {\n  legend: VizLegendOptions;\n}\n\n/**\n * TODO docs\n */\nexport interface OptionsWithTimezones {\n  timezone?: Array<TimeZone>;\n}\n\nexport const defaultOptionsWithTimezones: Partial<OptionsWithTimezones> = {\n  timezone: [],\n};\n\n/**\n * TODO docs\n */\nexport interface OptionsWithTextFormatting {\n  text?: VizTextDisplayOptions;\n}\n\n/**\n * TODO docs\n */\nexport enum BigValueColorMode {\n  Background = 'background',\n  BackgroundSolid = 'background_solid',\n  None = 'none',\n  Value = 'value',\n}\n\n/**\n * TODO docs\n */\nexport enum BigValueGraphMode {\n  Area = 'area',\n  Line = 'line',\n  None = 'none',\n}\n\n/**\n * TODO docs\n */\nexport enum BigValueJustifyMode {\n  Auto = 'auto',\n  Center = 'center',\n}\n\n/**\n * TODO docs\n */\nexport enum BigValueTextMode {\n  Auto = 'auto',\n  Name = 'name',\n  None = 'none',\n  Value = 'value',\n  ValueAndName = 'value_and_name',\n}\n\n/**\n * TODO -- should not be table specific!\n * TODO docs\n */\nexport type FieldTextAlignment = ('auto' | 'left' | 'right' | 'center');\n\n/**\n * Controls the value alignment in the TimelineChart component\n */\nexport type TimelineValueAlignment = ('center' | 'left' | 'right');\n\n/**\n * TODO docs\n */\nexport interface VizTextDisplayOptions {\n  /**\n   * Explicit title text size\n   */\n  titleSize?: number;\n  /**\n   * Explicit value text size\n   */\n  valueSize?: number;\n}\n\n/**\n * TODO docs\n */\nexport enum TooltipDisplayMode {\n  Multi = 'multi',\n  None = 'none',\n  Single = 'single',\n}\n\n/**\n * TODO docs\n */\nexport enum SortOrder {\n  Ascending = 'asc',\n  Descending = 'desc',\n  None = 'none',\n}\n\n/**\n * TODO docs\n */\nexport interface GraphFieldConfig extends LineConfig, FillConfig, PointsConfig, AxisConfig, BarConfig, StackableFieldConfig, HideableFieldConfig {\n  drawStyle?: GraphDrawStyle;\n  gradientMode?: GraphGradientMode;\n  thresholdsStyle?: GraphThresholdsStyleConfig;\n  transform?: GraphTransform;\n}\n\n/**\n * TODO docs\n */\nexport interface VizLegendOptions {\n  asTable?: boolean;\n  calcs: Array<string>;\n  displayMode: LegendDisplayMode;\n  isVisible?: boolean;\n  placement: LegendPlacement;\n  showLegend: boolean;\n  sortBy?: string;\n  sortDesc?: boolean;\n  width?: number;\n}\n\nexport const defaultVizLegendOptions: Partial<VizLegendOptions> = {\n  calcs: [],\n};\n\n/**\n * Enum expressing the possible display modes\n * for the bar gauge component of Grafana UI\n */\nexport enum BarGaugeDisplayMode {\n  Basic = 'basic',\n  Gradient = 'gradient',\n  Lcd = 'lcd',\n}\n\n/**\n * Allows for the table cell gauge display type to set the gauge mode.\n */\nexport enum BarGaugeValueMode {\n  Color = 'color',\n  Hidden = 'hidden',\n  Text = 'text',\n}\n\n/**\n * Allows for the bar gauge name to be placed explicitly\n */\nexport enum BarGaugeNamePlacement {\n  Auto = 'auto',\n  Left = 'left',\n  Top = 'top',\n}\n\n/**\n * Allows for the bar gauge size to be set explicitly\n */\nexport enum BarGaugeSizing {\n  Auto = 'auto',\n  Manual = 'manual',\n}\n\n/**\n * TODO docs\n */\nexport interface VizTooltipOptions {\n  maxHeight?: number;\n  maxWidth?: number;\n  mode: TooltipDisplayMode;\n  sort: SortOrder;\n}\n\nexport interface Labels {}\n\n/**\n * Internally, this is the \"type\" of cell that's being displayed\n * in the table such as colored text, JSON, gauge, etc.\n * The color-background-solid, gradient-gauge, and lcd-gauge\n * modes are deprecated in favor of new cell subOptions\n */\nexport enum TableCellDisplayMode {\n  Auto = 'auto',\n  BasicGauge = 'basic',\n  ColorBackground = 'color-background',\n  ColorBackgroundSolid = 'color-background-solid',\n  ColorText = 'color-text',\n  Custom = 'custom',\n  DataLinks = 'data-links',\n  Gauge = 'gauge',\n  GradientGauge = 'gradient-gauge',\n  Image = 'image',\n  JSONView = 'json-view',\n  LcdGauge = 'lcd-gauge',\n  Sparkline = 'sparkline',\n}\n\n/**\n * Display mode to the \"Colored Background\" display\n * mode for table cells. Either displays a solid color (basic mode)\n * or a gradient.\n */\nexport enum TableCellBackgroundDisplayMode {\n  Basic = 'basic',\n  Gradient = 'gradient',\n}\n\n/**\n * Sort by field state\n */\nexport interface TableSortByFieldState {\n  /**\n   * Flag used to indicate descending sort order\n   */\n  desc?: boolean;\n  /**\n   * Sets the display name of the field to sort by\n   */\n  displayName: string;\n}\n\n/**\n * Footer options\n */\nexport interface TableFooterOptions {\n  countRows?: boolean;\n  enablePagination?: boolean;\n  fields?: Array<string>;\n  reducer: Array<string>; // actually 1 value\n  show: boolean;\n}\n\nexport const defaultTableFooterOptions: Partial<TableFooterOptions> = {\n  fields: [],\n  reducer: [],\n};\n\n/**\n * Auto mode table cell options\n */\nexport interface TableAutoCellOptions {\n  type: TableCellDisplayMode.Auto;\n}\n\n/**\n * Colored text cell options\n */\nexport interface TableColorTextCellOptions {\n  type: TableCellDisplayMode.ColorText;\n}\n\n/**\n * Json view cell options\n */\nexport interface TableJsonViewCellOptions {\n  type: TableCellDisplayMode.JSONView;\n}\n\n/**\n * Json view cell options\n */\nexport interface TableImageCellOptions {\n  type: TableCellDisplayMode.Image;\n}\n\n/**\n * Show data links in the cell\n */\nexport interface TableDataLinksCellOptions {\n  type: TableCellDisplayMode.DataLinks;\n}\n\n/**\n * Gauge cell options\n */\nexport interface TableBarGaugeCellOptions {\n  mode?: BarGaugeDisplayMode;\n  type: TableCellDisplayMode.Gauge;\n  valueDisplayMode?: BarGaugeValueMode;\n}\n\n/**\n * Sparkline cell options\n */\nexport interface TableSparklineCellOptions extends GraphFieldConfig {\n  hideValue?: boolean;\n  type: TableCellDisplayMode.Sparkline;\n}\n\n/**\n * Colored background cell options\n */\nexport interface TableColoredBackgroundCellOptions {\n  applyToRow?: boolean;\n  mode?: TableCellBackgroundDisplayMode;\n  type: TableCellDisplayMode.ColorBackground;\n}\n\n/**\n * Height of a table cell\n */\nexport enum TableCellHeight {\n  Lg = 'lg',\n  Md = 'md',\n  Sm = 'sm',\n}\n\n/**\n * Table cell options. Each cell has a display mode\n * and other potential options for that display.\n */\nexport type TableCellOptions = (TableAutoCellOptions | TableSparklineCellOptions | TableBarGaugeCellOptions | TableColoredBackgroundCellOptions | TableColorTextCellOptions | TableImageCellOptions | TableDataLinksCellOptions | TableJsonViewCellOptions);\n\n/**\n * Use UTC/GMT timezone\n */\nexport type TimeZoneUtc = 'utc';\n\n/**\n * Use the timezone defined by end user web browser\n */\nexport type TimeZoneBrowser = 'browser';\n\n/**\n * Optional formats for the template variable replace functions\n * See also https://grafana.com/docs/grafana/latest/dashboards/variables/variable-syntax/#advanced-variable-format-options\n */\nexport enum VariableFormatID {\n  CSV = 'csv',\n  Date = 'date',\n  Distributed = 'distributed',\n  DoubleQuote = 'doublequote',\n  Glob = 'glob',\n  HTML = 'html',\n  JSON = 'json',\n  Lucene = 'lucene',\n  PercentEncode = 'percentencode',\n  Pipe = 'pipe',\n  QueryParam = 'queryparam',\n  Raw = 'raw',\n  Regex = 'regex',\n  SQLString = 'sqlstring',\n  SingleQuote = 'singlequote',\n  Text = 'text',\n  UriEncode = 'uriencode',\n}\n\nexport interface DataSourceRef {\n  /**\n   * The plugin type-id\n   */\n  type?: string;\n  /**\n   * Specific datasource instance\n   */\n  uid?: string;\n}\n\n/**\n * Links to a resource (image/svg path)\n */\nexport interface ResourceDimensionConfig extends BaseDimensionConfig {\n  fixed?: string;\n  mode: ResourceDimensionMode;\n}\n\nexport interface FrameGeometrySource {\n  /**\n   * Path to Gazetteer\n   */\n  gazetteer?: string;\n  /**\n   * Field mappings\n   */\n  geohash?: string;\n  latitude?: string;\n  longitude?: string;\n  lookup?: string;\n  mode: FrameGeometrySourceMode;\n  wkt?: string;\n}\n\nexport interface HeatmapCalculationOptions {\n  /**\n   * The number of buckets to use for the xAxis in the heatmap\n   */\n  xBuckets?: HeatmapCalculationBucketConfig;\n  /**\n   * The number of buckets to use for the yAxis in the heatmap\n   */\n  yBuckets?: HeatmapCalculationBucketConfig;\n}\n\nexport enum LogsDedupStrategy {\n  exact = 'exact',\n  none = 'none',\n  numbers = 'numbers',\n  signature = 'signature',\n}\n\n/**\n * Compare two values\n */\nexport enum ComparisonOperation {\n  EQ = 'eq',\n  GT = 'gt',\n  GTE = 'gte',\n  LT = 'lt',\n  LTE = 'lte',\n  NEQ = 'neq',\n}\n\n/**\n * Field options for each field within a table (e.g 10, \"The String\", 64.20, etc.)\n * Generally defines alignment, filtering capabilties, display options, etc.\n */\nexport interface TableFieldOptions {\n  align: FieldTextAlignment;\n  cellOptions: TableCellOptions;\n  /**\n   * This field is deprecated in favor of using cellOptions\n   */\n  displayMode?: TableCellDisplayMode;\n  filterable?: boolean;\n  hidden?: boolean; // ?? default is missing or false ??\n  /**\n   * Hides any header for a column, useful for columns that show some static content or buttons.\n   */\n  hideHeader?: boolean;\n  inspect: boolean;\n  minWidth?: number;\n  width?: number;\n}\n\nexport const defaultTableFieldOptions: Partial<TableFieldOptions> = {\n  align: 'auto',\n  inspect: false,\n};\n\n/**\n * A specific timezone from https://en.wikipedia.org/wiki/Tz_database\n */\nexport type TimeZone = (TimeZoneUtc | TimeZoneBrowser | string);\n\nexport const defaultTimeZone: TimeZone = 'browser';\n","import type { languages } from 'monaco-editor';\nimport { Grammar } from 'prismjs';\n\nexport const languageConfiguration: languages.LanguageConfiguration = {\n  // the default separators except `@$`\n  wordPattern: /(-?\\d*\\.\\d\\w*)|([^`~!#%^&*()\\-=+\\[{\\]}\\\\|;:'\",.<>\\/?\\s]+)/g,\n  brackets: [\n    ['{', '}'],\n    ['(', ')'],\n  ],\n  autoClosingPairs: [\n    { open: '{', close: '}' },\n    { open: '(', close: ')' },\n    { open: '\"', close: '\"' },\n    { open: \"'\", close: \"'\" },\n  ],\n  surroundingPairs: [\n    { open: '{', close: '}' },\n    { open: '(', close: ')' },\n    { open: '\"', close: '\"' },\n    { open: \"'\", close: \"'\" },\n  ],\n  folding: {},\n};\n\nexport const operators = ['=', '!=', '>', '<', '>=', '<=', '=~', '!~'];\nexport const keywordOperators = ['=', '!='];\nexport const stringOperators = ['=', '!=', '=~', '!~'];\nexport const numberOperators = ['=', '!=', '>', '<', '>=', '<='];\n\nexport const intrinsics = [\n  'duration',\n  'kind',\n  'name',\n  'rootName',\n  'rootServiceName',\n  'status',\n  'statusMessage',\n  'traceDuration',\n];\nexport const scopes: string[] = ['resource', 'span'];\n\nexport const functions = ['avg', 'min', 'max', 'sum', 'count', 'by'];\n\nconst keywords = intrinsics.concat(scopes);\n\nconst statusValues = ['ok', 'unset', 'error', 'false', 'true'];\n\nconst language: languages.IMonarchLanguage = {\n  ignoreCase: false,\n  defaultToken: '',\n  tokenPostfix: '.traceql',\n\n  keywords,\n  operators,\n  statusValues,\n  functions,\n\n  symbols: /[=><!~?:&|+\\-*\\/^%]+/,\n  escapes: /\\\\(?:[abfnrtv\\\\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,\n  digits: /\\d+(_+\\d+)*/,\n  octaldigits: /[0-7]+(_+[0-7]+)*/,\n  binarydigits: /[0-1]+(_+[0-1]+)*/,\n\n  tokenizer: {\n    root: [\n      // comments\n      [/\\/\\/.*/, 'comment'], // line comment\n      [/\\/\\*.*\\*\\//, 'comment'], // block comment\n\n      // durations\n      [/[0-9]+(.[0-9]+)?(us|s|ns|ms|s|m|h)/, 'number'],\n\n      // trace ID\n      [/^\\s*[0-9A-Fa-f]+\\s*$/, 'tag'],\n\n      // keywords\n      [\n        // match only predefined keywords\n        `(?:${keywords.join('|')})`,\n        {\n          cases: {\n            '@keywords': 'keyword',\n            '@default': 'tag', // fallback, but should never happen\n          },\n        },\n      ],\n\n      // functions and predefined values\n      [\n        // Inside (double) quotes, all characters are allowed, with the exception of `\\` and `\"` that must be escaped (`\\\\` and `\\\"`).\n        // Outside quotes, some more characters are prohibited, such as `!` and `=`.\n        /(?:\\w|^[^{}()=~!<>&|,\" ]|\"(?:\\\\\"|\\\\\\\\|[^\\\\\"])*\")+/,\n        {\n          cases: {\n            '@functions': 'predefined',\n            '@statusValues': 'type',\n            '@default': 'tag', // fallback, used for tag names\n          },\n        },\n      ],\n\n      // strings\n      [/\"([^\"\\\\]|\\\\.)*$/, 'string.invalid'], // non-teminated string\n      [/'([^'\\\\]|\\\\.)*$/, 'string.invalid'], // non-teminated string\n      [/([^\\w])(\")/, [{ token: '' }, { token: 'string', next: '@string_double' }]],\n      [/([^\\w])(')/, [{ token: '' }, { token: 'string', next: '@string_single' }]],\n      [/([^\\w])(`)/, [{ token: '' }, { token: 'string', next: '@string_back' }]],\n\n      // delimiters and operators\n      [/[{}()\\[\\]]/, 'delimiter.bracket'],\n      [\n        /@symbols/,\n        {\n          cases: {\n            '@operators': 'delimiter',\n            '@default': '',\n          },\n        },\n      ],\n\n      // numbers\n      [/(@digits)[eE]([\\-+]?(@digits))?[fFdD]?/, 'number.float'],\n      [/(@digits)\\.(@digits)([eE][\\-+]?(@digits))?[fFdD]?/, 'number.float'],\n      [/0(@octaldigits)[Ll]?/, 'number.octal'],\n      [/0[bB](@binarydigits)[Ll]?/, 'number.binary'],\n      [/(@digits)[fFdD]/, 'number.float'],\n      [/(@digits)[lL]?/, 'number'],\n    ],\n\n    string_double: [\n      [/[^\\\\\"]+/, 'string'],\n      [/@escapes/, 'string.escape'],\n      [/\\\\./, 'string.escape.invalid'],\n      [/\"/, 'string', '@pop'],\n    ],\n\n    string_single: [\n      [/[^\\\\']+/, 'string'],\n      [/@escapes/, 'string.escape'],\n      [/\\\\./, 'string.escape.invalid'],\n      [/'/, 'string', '@pop'],\n    ],\n\n    string_back: [\n      [/[^\\\\`]+/, 'string'],\n      [/@escapes/, 'string.escape'],\n      [/\\\\./, 'string.escape.invalid'],\n      [/`/, 'string', '@pop'],\n    ],\n  },\n};\n\n// For \"TraceQL\" tab (Monarch editor for TraceQL)\nexport const languageDefinition = {\n  id: 'traceql',\n  extensions: ['.traceql'],\n  aliases: ['tempo', 'traceql'],\n  mimetypes: [],\n  def: {\n    language,\n    languageConfiguration,\n  },\n};\n\n// For \"Search\" tab (query builder)\nexport const traceqlGrammar: Grammar = {\n  comment: {\n    pattern: /\\/\\/.*/,\n  },\n  'span-set': {\n    pattern: /\\{[^}]*}/,\n    inside: {\n      filter: {\n        pattern: /([\\w.\\/-]+)?(\\s*)(([!=+\\-<>~]+)\\s*(\"([^\"\\n&]+)?\"?|([^\"\\n\\s&|}]+))?)/g,\n        inside: {\n          comment: {\n            pattern: /#.*/,\n          },\n          'label-key': {\n            pattern: /[a-z_.][\\w./_-]*(?=\\s*(=|!=|>|<|>=|<=|=~|!~))/,\n            alias: 'attr-name',\n          },\n          'label-value': {\n            pattern: /(\"(?:\\\\.|[^\\\\\"])*\")|(\\w+)/,\n            alias: 'attr-value',\n          },\n        },\n      },\n      punctuation: /[}{&|]/,\n    },\n  },\n  number: /\\b-?\\d+((\\.\\d*)?([eE][+-]?\\d+)?)?\\b/,\n  operator: new RegExp(`/[-+*/=%^~]|&&?|\\\\|?\\\\||!=?|<(?:=>?|<|>)?|>[>=]?|`, 'i'),\n  punctuation: /[{};()`,.]/,\n};\n","import { startCase, uniq } from 'lodash';\n\nimport { SelectableValue } from '@grafana/data';\n\nimport { TraceqlFilter, TraceqlSearchScope } from '../dataquery.gen';\nimport { intrinsics } from '../traceql/traceql';\nimport { Scope } from '../types';\n\nexport const generateQueryFromFilters = (filters: TraceqlFilter[]) => {\n  return `{${filters\n    .filter((f) => f.tag && f.operator && f.value?.length)\n    .map((f) => `${scopeHelper(f)}${tagHelper(f, filters)}${f.operator}${valueHelper(f)}`)\n    .join(' && ')}}`;\n};\n\nconst valueHelper = (f: TraceqlFilter) => {\n  if (Array.isArray(f.value) && f.value.length > 1) {\n    return `\"${f.value.join('|')}\"`;\n  }\n  if (f.valueType === 'string') {\n    return `\"${f.value}\"`;\n  }\n  return f.value;\n};\nconst scopeHelper = (f: TraceqlFilter) => {\n  // Intrinsic fields don't have a scope\n  if (intrinsics.find((t) => t === f.tag)) {\n    return '';\n  }\n  return (\n    (f.scope === TraceqlSearchScope.Resource || f.scope === TraceqlSearchScope.Span ? f.scope?.toLowerCase() : '') + '.'\n  );\n};\nconst tagHelper = (f: TraceqlFilter, filters: TraceqlFilter[]) => {\n  if (f.tag === 'duration') {\n    const durationType = filters.find((f) => f.id === 'duration-type');\n    if (durationType) {\n      return durationType.value === 'trace' ? 'traceDuration' : 'duration';\n    }\n    return f.tag;\n  }\n  return f.tag;\n};\n\nexport const filterScopedTag = (f: TraceqlFilter) => {\n  return scopeHelper(f) + f.tag;\n};\n\nexport const filterTitle = (f: TraceqlFilter) => {\n  // Special case for the intrinsic \"name\" since a label called \"Name\" isn't explicit\n  if (f.tag === 'name') {\n    return 'Span Name';\n  }\n  // Special case for the resource service name\n  if (f.tag === 'service.name' && f.scope === TraceqlSearchScope.Resource) {\n    return 'Service Name';\n  }\n  return startCase(filterScopedTag(f));\n};\n\nexport const getFilteredTags = (tags: string[], staticTags: Array<string | undefined>) => {\n  return [...intrinsics, ...tags].filter((t) => !staticTags.includes(t));\n};\n\nexport const getUnscopedTags = (scopes: Scope[]) => {\n  return uniq(\n    scopes.map((scope: Scope) => (scope.name && scope.name !== 'intrinsic' && scope.tags ? scope.tags : [])).flat()\n  );\n};\n\nexport const getAllTags = (scopes: Scope[]) => {\n  return uniq(scopes.map((scope: Scope) => (scope.tags ? scope.tags : [])).flat());\n};\n\nexport const getTagsByScope = (scopes: Scope[], scope: TraceqlSearchScope | string) => {\n  return uniq(scopes.map((s: Scope) => (s.name && s.name === scope && s.tags ? s.tags : [])).flat());\n};\n\nexport function replaceAt<T>(array: T[], index: number, value: T) {\n  const ret = array.slice(0);\n  ret[index] = value;\n  return ret;\n}\n\nexport const operatorSelectableValue = (op: string) => {\n  const result: SelectableValue = { label: op, value: op };\n  switch (op) {\n    case '=':\n      result.description = 'Equals';\n      break;\n    case '!=':\n      result.description = 'Not equals';\n      break;\n    case '>':\n      result.description = 'Greater';\n      break;\n    case '>=':\n      result.description = 'Greater or Equal';\n      break;\n    case '<':\n      result.description = 'Less';\n      break;\n    case '<=':\n      result.description = 'Less or Equal';\n      break;\n    case '=~':\n      result.description = 'Matches regex';\n      break;\n    case '!~':\n      result.description = 'Does not match regex';\n      break;\n  }\n  return result;\n};\n","import React, { useEffect, useState } from 'react';\n\nimport { DataQuery, SelectableValue } from '@grafana/data';\nimport { InlineField, InlineFieldRow, Select } from '@grafana/ui';\n\nimport { TempoDatasource } from './datasource';\n\nexport enum TempoVariableQueryType {\n  LabelNames,\n  LabelValues,\n}\n\nexport interface TempoVariableQuery extends DataQuery {\n  type: TempoVariableQueryType;\n  label?: string;\n  stream?: string;\n}\n\nconst variableOptions = [\n  { label: 'Label names', value: TempoVariableQueryType.LabelNames },\n  { label: 'Label values', value: TempoVariableQueryType.LabelValues },\n];\n\nconst refId = 'TempoDatasourceVariableQueryEditor-VariableQuery';\n\nexport type TempoVariableQueryEditorProps = {\n  onChange: (value: TempoVariableQuery) => void;\n  query: TempoVariableQuery;\n  datasource: TempoDatasource;\n};\n\nexport const TempoVariableQueryEditor = ({ onChange, query, datasource }: TempoVariableQueryEditorProps) => {\n  const [label, setLabel] = useState(query.label || '');\n  const [type, setType] = useState<number | undefined>(query.type);\n  const [labelOptions, setLabelOptions] = useState<Array<SelectableValue<string>>>([]);\n\n  useEffect(() => {\n    if (type === TempoVariableQueryType.LabelValues) {\n      datasource.labelNamesQuery().then((labelNames: Array<{ text: string }>) => {\n        setLabelOptions(labelNames.map(({ text }) => ({ label: text, value: text })));\n      });\n    }\n  }, [datasource, query, type]);\n\n  const onQueryTypeChange = (newType: SelectableValue<TempoVariableQueryType>) => {\n    setType(newType.value);\n    if (newType.value !== undefined) {\n      onChange({\n        type: newType.value,\n        label,\n        refId,\n      });\n    }\n  };\n\n  const onLabelChange = (newLabel: SelectableValue<string>) => {\n    const newLabelValue = newLabel.value || '';\n    setLabel(newLabelValue);\n    if (type !== undefined) {\n      onChange({\n        type,\n        label: newLabelValue,\n        refId,\n      });\n    }\n  };\n\n  const handleBlur = () => {\n    if (type !== undefined) {\n      onChange({ type, label, refId });\n    }\n  };\n\n  return (\n    <>\n      <InlineFieldRow>\n        <InlineField label=\"Query type\" labelWidth={20}>\n          <Select\n            aria-label=\"Query type\"\n            onChange={onQueryTypeChange}\n            onBlur={handleBlur}\n            value={type}\n            options={variableOptions}\n            width={32}\n          />\n        </InlineField>\n      </InlineFieldRow>\n\n      {type === TempoVariableQueryType.LabelValues && (\n        <InlineFieldRow>\n          <InlineField label=\"Label\" labelWidth={20}>\n            <Select\n              aria-label=\"Label\"\n              onChange={onLabelChange}\n              onBlur={handleBlur}\n              value={{ label, value: label }}\n              options={labelOptions}\n              width={32}\n              allowCustomValue\n            />\n          </InlineField>\n        </InlineFieldRow>\n      )}\n    </>\n  );\n};\n","/**\n * Get non overlapping duration of the ranges as they can overlap or have gaps.\n */\nimport { FieldType, MutableDataFrame, NodeGraphDataFrameFieldNames as Fields } from '@grafana/data';\n\nexport function getNonOverlappingDuration(ranges: Array<[number, number]>): number {\n  ranges.sort((a, b) => a[0] - b[0]);\n  const mergedRanges = ranges.reduce<Array<[number, number]>>((acc, range) => {\n    if (!acc.length) {\n      return [range];\n    }\n    const tail = acc.slice(-1)[0];\n    const [prevStart, prevEnd] = tail;\n    const [start, end] = range;\n    if (end < prevEnd) {\n      // In this case the range is completely inside the prev range so we can just ignore it.\n      return acc;\n    }\n\n    if (start > prevEnd) {\n      // There is no overlap so we can just add it to stack\n      return [...acc, range];\n    }\n\n    // We know there is overlap and current range ends later than previous so we can just extend the range\n    return [...acc.slice(0, -1), [prevStart, end]];\n  }, []);\n\n  return mergedRanges.reduce((acc, range) => {\n    return acc + (range[1] - range[0]);\n  }, 0);\n}\n\n/**\n * Returns a map of the spans with children array for easier processing. It will also contain empty spans in case\n * span is missing but other spans are its children. This is more generic because it needs to allow iterating over\n * both arrays and dataframe views.\n */\nexport function makeSpanMap<T>(getSpan: (index: number) => { span: T; id: string; parentIds: string[] } | undefined): {\n  [id: string]: { span: T; children: string[] };\n} {\n  const spanMap: { [id: string]: { span?: T; children: string[] } } = {};\n\n  let span;\n  for (let index = 0; (span = getSpan(index)), !!span; index++) {\n    if (!spanMap[span.id]) {\n      spanMap[span.id] = {\n        span: span.span,\n        children: [],\n      };\n    } else {\n      spanMap[span.id].span = span.span;\n    }\n\n    for (const parentId of span.parentIds) {\n      if (parentId) {\n        if (!spanMap[parentId]) {\n          spanMap[parentId] = {\n            span: undefined,\n            children: [span.id],\n          };\n        } else {\n          spanMap[parentId].children.push(span.id);\n        }\n      }\n    }\n  }\n  // Discussion on this type assertion here: https://github.com/grafana/grafana/pull/80362/files#r1451019375\n  return spanMap as { [id: string]: { span: T; children: string[] } };\n}\n\nexport function getStats(duration: number, traceDuration: number, selfDuration: number) {\n  return {\n    main: `${toFixedNoTrailingZeros(duration)}ms (${toFixedNoTrailingZeros((duration / traceDuration) * 100)}%)`,\n    secondary: `${toFixedNoTrailingZeros(selfDuration)}ms (${toFixedNoTrailingZeros(\n      (selfDuration / duration) * 100\n    )}%)`,\n  };\n}\n\nfunction toFixedNoTrailingZeros(n: number) {\n  return parseFloat(n.toFixed(2));\n}\n\n/**\n * Create default frames used when returning data for node graph.\n */\nexport function makeFrames() {\n  const nodesFrame = new MutableDataFrame({\n    fields: [\n      { name: Fields.id, type: FieldType.string },\n      { name: Fields.title, type: FieldType.string },\n      { name: Fields.subTitle, type: FieldType.string },\n      { name: Fields.mainStat, type: FieldType.string, config: { displayName: 'Total time (% of trace)' } },\n      { name: Fields.secondaryStat, type: FieldType.string, config: { displayName: 'Self time (% of total)' } },\n      {\n        name: Fields.color,\n        type: FieldType.number,\n        config: { color: { mode: 'continuous-GrYlRd' }, displayName: 'Self time / Trace duration' },\n      },\n    ],\n    meta: {\n      preferredVisualisationType: 'nodeGraph',\n    },\n  });\n\n  const edgesFrame = new MutableDataFrame({\n    fields: [\n      { name: Fields.id, type: FieldType.string },\n      { name: Fields.target, type: FieldType.string },\n      { name: Fields.source, type: FieldType.string },\n    ],\n    meta: {\n      preferredVisualisationType: 'nodeGraph',\n    },\n  });\n\n  return [nodesFrame, edgesFrame];\n}\n","import {\n  DataFrame,\n  DataFrameView,\n  DataQueryResponse,\n  FieldColorModeId,\n  FieldDTO,\n  MutableDataFrame,\n  NodeGraphDataFrameFieldNames as Fields,\n  TimeRange,\n  FieldType,\n  toDataFrame,\n} from '@grafana/data';\nimport { getNonOverlappingDuration, getStats, makeFrames, makeSpanMap } from '@grafana/o11y-ds-frontend';\n\n/**\n * Row in a trace dataFrame\n */\ninterface Row {\n  traceID: string;\n  spanID: string;\n  parentSpanID: string;\n  operationName: string;\n  serviceName: string;\n  serviceTags: string;\n  startTime: number;\n  duration: number;\n  logs: string;\n  tags: string;\n}\n\ninterface Node {\n  [Fields.id]: string;\n  [Fields.title]: string;\n  [Fields.subTitle]: string;\n  [Fields.mainStat]: string;\n  [Fields.secondaryStat]: string;\n  [Fields.color]: number;\n}\n\ninterface Edge {\n  [Fields.id]: string;\n  [Fields.target]: string;\n  [Fields.source]: string;\n}\n\nexport function createGraphFrames(data: DataFrame): DataFrame[] {\n  const { nodes, edges } = convertTraceToGraph(data);\n  const [nodesFrame, edgesFrame] = makeFrames();\n\n  for (const node of nodes) {\n    nodesFrame.add(node);\n  }\n  for (const edge of edges) {\n    edgesFrame.add(edge);\n  }\n\n  return [nodesFrame, edgesFrame];\n}\n\nfunction convertTraceToGraph(data: DataFrame): { nodes: Node[]; edges: Edge[] } {\n  const nodes: Node[] = [];\n  const edges: Edge[] = [];\n\n  const view = new DataFrameView<Row>(data);\n\n  const traceDuration = findTraceDuration(view);\n  const spanMap = makeSpanMap((index) => {\n    if (index >= data.length) {\n      return undefined;\n    }\n    const span = view.get(index);\n    return {\n      span: { ...span },\n      id: span.spanID,\n      parentIds: span.parentSpanID ? [span.parentSpanID] : [],\n    };\n  });\n\n  for (let i = 0; i < view.length; i++) {\n    const row = view.get(i);\n\n    const ranges: Array<[number, number]> = spanMap[row.spanID].children.map((c) => {\n      const span = spanMap[c].span;\n      return [span.startTime, span.startTime + span.duration];\n    });\n    const childrenDuration = getNonOverlappingDuration(ranges);\n    const selfDuration = row.duration - childrenDuration;\n    const stats = getStats(row.duration, traceDuration, selfDuration);\n\n    nodes.push({\n      [Fields.id]: row.spanID,\n      [Fields.title]: row.serviceName ?? '',\n      [Fields.subTitle]: row.operationName,\n      [Fields.mainStat]: stats.main,\n      [Fields.secondaryStat]: stats.secondary,\n      [Fields.color]: selfDuration / traceDuration,\n    });\n\n    // Sometimes some span can be missing. Don't add edges for those.\n    if (row.parentSpanID && spanMap[row.parentSpanID].span) {\n      edges.push({\n        [Fields.id]: row.parentSpanID + '--' + row.spanID,\n        [Fields.target]: row.spanID,\n        [Fields.source]: row.parentSpanID,\n      });\n    }\n  }\n\n  return { nodes, edges };\n}\n\n/**\n * Get the duration of the whole trace as it isn't a part of the response data.\n * Note: Seems like this should be the same as just longest span, but this is probably safer.\n */\nfunction findTraceDuration(view: DataFrameView<Row>): number {\n  let traceEndTime = 0;\n  let traceStartTime = Infinity;\n\n  for (let i = 0; i < view.length; i++) {\n    const row = view.get(i);\n\n    if (row.startTime < traceStartTime) {\n      traceStartTime = row.startTime;\n    }\n\n    if (row.startTime + row.duration > traceEndTime) {\n      traceEndTime = row.startTime + row.duration;\n    }\n  }\n\n  return traceEndTime - traceStartTime;\n}\n\nexport const secondsMetric = 'traces_service_graph_request_server_seconds_sum';\nexport const totalsMetric = 'traces_service_graph_request_total';\nexport const failedMetric = 'traces_service_graph_request_failed_total';\nexport const histogramMetric = 'traces_service_graph_request_server_seconds_bucket';\n\nexport const rateMetric = {\n  expr: 'sum(rate(traces_spanmetrics_calls_total{}[$__range])) by (span_name)',\n  topk: 5,\n  params: [],\n};\nexport const errorRateMetric = {\n  expr: 'sum(rate(traces_spanmetrics_calls_total{}[$__range])) by (span_name)',\n  topk: 5,\n  params: ['status_code=\"STATUS_CODE_ERROR\"'],\n};\nexport const durationMetric = {\n  expr: 'histogram_quantile(.9, sum(rate(traces_spanmetrics_latency_bucket{}[$__range])) by (le))',\n  params: [],\n};\nexport const defaultTableFilter = 'span_kind=\"SPAN_KIND_SERVER\"';\n\nexport const serviceMapMetrics = [\n  secondsMetric,\n  totalsMetric,\n  failedMetric,\n  histogramMetric,\n  // These are used for debugging the tempo collection so probably not useful for service map right now.\n  // 'traces_service_graph_unpaired_spans_total',\n  // 'traces_service_graph_untagged_spans_total',\n];\n\n/**\n * Map response from multiple prometheus metrics into a node graph data frames with nodes and edges.\n * @param responses\n * @param range\n */\nexport function mapPromMetricsToServiceMap(\n  responses: DataQueryResponse[],\n  range: TimeRange\n): { nodes: DataFrame; edges: DataFrame } {\n  const frames = getMetricFrames(responses);\n\n  // First just collect data from the metrics into a map with nodes and edges as keys\n  const nodesMap: Record<string, NodeObject> = {};\n  const edgesMap: Record<string, EdgeObject> = {};\n  // At this moment we don't have any error/success or other counts so we just use these 2\n  collectMetricData(frames[totalsMetric], 'total', totalsMetric, nodesMap, edgesMap);\n  collectMetricData(frames[secondsMetric], 'seconds', secondsMetric, nodesMap, edgesMap);\n  collectMetricData(frames[failedMetric], 'failed', failedMetric, nodesMap, edgesMap);\n\n  return convertToDataFrames(nodesMap, edgesMap, range);\n}\n\nfunction createServiceMapDataFrames() {\n  function createDF(name: string, fields: FieldDTO[]) {\n    return new MutableDataFrame({ name, fields, meta: { preferredVisualisationType: 'nodeGraph' } });\n  }\n\n  const nodes = createDF('Nodes', [\n    { name: Fields.id, type: FieldType.string, values: [] },\n    { name: Fields.title, type: FieldType.string, config: { displayName: 'Service name' }, values: [] },\n    { name: Fields.subTitle, type: FieldType.string, config: { displayName: 'Service namespace' }, values: [] },\n    {\n      name: Fields.mainStat,\n      type: FieldType.number,\n      config: { unit: 'ms/r', displayName: 'Average response time' },\n      values: [],\n    },\n    {\n      name: Fields.secondaryStat,\n      type: FieldType.number,\n      config: { unit: 'r/sec', displayName: 'Requests per second' },\n      values: [],\n    },\n    {\n      name: Fields.arc + 'success',\n      type: FieldType.number,\n      config: { displayName: 'Success', color: { fixedColor: 'green', mode: FieldColorModeId.Fixed } },\n      values: [],\n    },\n    {\n      name: Fields.arc + 'failed',\n      type: FieldType.number,\n      config: { displayName: 'Failed', color: { fixedColor: 'red', mode: FieldColorModeId.Fixed } },\n      values: [],\n    },\n  ]);\n  const edges = createDF('Edges', [\n    { name: Fields.id, type: FieldType.string, values: [] },\n    { name: Fields.source, type: FieldType.string, values: [] },\n    { name: AdditionalEdgeFields.sourceName, type: FieldType.string, values: [] },\n    { name: AdditionalEdgeFields.sourceNamespace, type: FieldType.string, values: [] },\n    { name: Fields.target, type: FieldType.string, values: [] },\n    { name: AdditionalEdgeFields.targetName, type: FieldType.string, values: [] },\n    { name: AdditionalEdgeFields.targetNamespace, type: FieldType.string, values: [] },\n    {\n      name: Fields.mainStat,\n      type: FieldType.number,\n      config: { unit: 'ms/r', displayName: 'Average response time' },\n      values: [],\n    },\n    {\n      name: Fields.secondaryStat,\n      type: FieldType.number,\n      config: { unit: 'r/sec', displayName: 'Requests per second' },\n      values: [],\n    },\n  ]);\n\n  return [nodes, edges];\n}\n\n/**\n * Group frames from response based on ref id which is set the same as the metric name so we know which metric is where\n * and also put it into DataFrameView so it's easier to work with.\n * @param responses\n */\nfunction getMetricFrames(responses: DataQueryResponse[]): Record<string, DataFrameView> {\n  return (responses[0]?.data || []).reduce<Record<string, DataFrameView>>((acc, frameDTO) => {\n    const frame = toDataFrame(frameDTO);\n    acc[frame.refId ?? 'A'] = new DataFrameView(frame);\n    return acc;\n  }, {});\n}\n\ntype ServiceMapStatistics = {\n  total?: number;\n  seconds?: number;\n  failed?: number;\n};\n\ntype NodeObject = ServiceMapStatistics & {\n  name: string;\n  namespace?: string;\n};\n\ntype EdgeObject = ServiceMapStatistics & {\n  source: string;\n  sourceName: string;\n  sourceNamespace: string;\n  target: string;\n  targetName: string;\n  targetNamespace: string;\n};\n\n// These fields are not necessary for rendering, so not available from the Fields enum\n// Will be used for linking when namespace is present\nenum AdditionalEdgeFields {\n  sourceName = 'sourceName',\n  sourceNamespace = 'sourceNamespace',\n  targetName = 'targetName',\n  targetNamespace = 'targetNamespace',\n}\n\n/**\n * Collect data from a metric into a map of nodes and edges. The metric data is modeled as counts of metric per edge\n * which is a pair of client-server nodes. This means we convert each row of the metric 1-1 to edges and than we assign\n * the metric also to server. We count the stats for server only as we show requests/transactions that particular node\n * processed not those which it generated and other stats like average transaction time then stem from that.\n * @param frame\n * @param stat\n * @param metric\n * @param nodesMap\n * @param edgesMap\n */\nfunction collectMetricData(\n  frame: DataFrameView | undefined,\n  stat: keyof ServiceMapStatistics,\n  metric: string,\n  nodesMap: Record<string, NodeObject>,\n  edgesMap: Record<string, EdgeObject>\n) {\n  if (!frame) {\n    return;\n  }\n\n  // The name of the value column is in this format\n  // Improvement: figure out if it can be changed\n  const valueName = `Value #${metric}`;\n\n  for (let i = 0; i < frame.length; i++) {\n    const row = frame.get(i);\n    const serverId = row.server_service_namespace ? `${row.server_service_namespace}/${row.server}` : row.server;\n    const clientId = row.client_service_namespace ? `${row.client_service_namespace}/${row.client}` : row.client;\n\n    const edgeId = `${clientId}_${serverId}`;\n\n    if (!edgesMap[edgeId]) {\n      // Create edge as it does not exist yet\n      edgesMap[edgeId] = {\n        target: serverId,\n        targetName: row.server,\n        targetNamespace: row.server_service_namespace,\n        source: clientId,\n        sourceName: row.client,\n        sourceNamespace: row.client_service_namespace,\n        [stat]: row[valueName],\n      };\n    } else {\n      // Add stat to edge\n      // We are adding the values if exists but that should not happen in general as there should be single row for\n      // an edge.\n      edgesMap[edgeId][stat] = (edgesMap[edgeId][stat] || 0) + row[valueName];\n    }\n\n    if (!nodesMap[serverId]) {\n      // Create node for server\n      nodesMap[serverId] = {\n        name: row.server,\n        namespace: row.server_service_namespace,\n        [stat]: row[valueName],\n      };\n    } else {\n      // Add stat to server node. Sum up values if there are multiple edges targeting this server node.\n      nodesMap[serverId][stat] = (nodesMap[serverId][stat] || 0) + row[valueName];\n    }\n\n    if (!nodesMap[clientId]) {\n      // Create the client node but don't add the stat as edge stats are attributed to the server node. This means for\n      // example that the number of requests in a node show how many requests it handled not how many it generated.\n      nodesMap[clientId] = {\n        name: row.client,\n        namespace: row.client_service_namespace,\n        [stat]: 0,\n      };\n    }\n  }\n}\n\nfunction convertToDataFrames(\n  nodesMap: Record<string, NodeObject>,\n  edgesMap: Record<string, EdgeObject>,\n  range: TimeRange\n): { nodes: DataFrame; edges: DataFrame } {\n  const [nodes, edges] = createServiceMapDataFrames();\n  for (const nodeId of Object.keys(nodesMap)) {\n    const node = nodesMap[nodeId];\n    nodes.add({\n      [Fields.id]: nodeId,\n      [Fields.title]: node.name,\n      [Fields.subTitle]: node.namespace,\n      // NaN will not be shown in the node graph. This happens for a root client node which did not process\n      // any requests itself.\n      [Fields.mainStat]: node.total ? (node.seconds! / node.total) * 1000 : Number.NaN, // Average response time\n      [Fields.secondaryStat]: node.total ? Math.round(node.total * 100) / 100 : Number.NaN, // Request per second (to 2 decimals)\n      [Fields.arc + 'success']: node.total ? (node.total - Math.min(node.failed || 0, node.total)) / node.total : 1,\n      [Fields.arc + 'failed']: node.total ? Math.min(node.failed || 0, node.total) / node.total : 0,\n    });\n  }\n  for (const edgeId of Object.keys(edgesMap)) {\n    const edge = edgesMap[edgeId];\n    edges.add({\n      [Fields.id]: edgeId,\n      [Fields.source]: edge.source,\n      [AdditionalEdgeFields.sourceName]: edge.sourceName,\n      [AdditionalEdgeFields.sourceNamespace]: edge.sourceNamespace,\n      [Fields.target]: edge.target,\n      [AdditionalEdgeFields.targetName]: edge.targetName,\n      [AdditionalEdgeFields.targetNamespace]: edge.targetNamespace,\n      [Fields.mainStat]: edge.total ? (edge.seconds! / edge.total) * 1000 : Number.NaN, // Average response time\n      [Fields.secondaryStat]: edge.total ? Math.round(edge.total * 100) / 100 : Number.NaN, // Request per second (to 2 decimals)\n    });\n  }\n\n  return { nodes, edges };\n}\n","import { LanguageProvider, SelectableValue } from '@grafana/data';\n\nimport { getAllTags, getTagsByScope, getUnscopedTags } from './SearchTraceQLEditor/utils';\nimport { TraceqlSearchScope } from './dataquery.gen';\nimport { TempoDatasource } from './datasource';\nimport { Scope } from './types';\n\nexport default class TempoLanguageProvider extends LanguageProvider {\n  datasource: TempoDatasource;\n  tagsV1?: string[];\n  tagsV2?: Scope[];\n  constructor(datasource: TempoDatasource, initialValues?: any) {\n    super();\n\n    this.datasource = datasource;\n    Object.assign(this, initialValues);\n  }\n\n  request = async (url: string, params = {}) => {\n    const res = await this.datasource.metadataRequest(url, params);\n    return res?.data;\n  };\n\n  start = async () => {\n    if (!this.startTask) {\n      this.startTask = this.fetchTags().then(() => {\n        return [];\n      });\n    }\n\n    return this.startTask;\n  };\n\n  async fetchTags() {\n    let v1Resp, v2Resp;\n    try {\n      v2Resp = await this.request('/api/v2/search/tags', []);\n    } catch (error) {\n      v1Resp = await this.request('/api/search/tags', []);\n    }\n\n    if (v2Resp && v2Resp.scopes) {\n      this.setV2Tags(v2Resp.scopes);\n    } else if (v1Resp) {\n      this.setV1Tags(v1Resp.tagNames);\n    }\n  }\n\n  setV1Tags = (tags: string[]) => {\n    this.tagsV1 = tags;\n  };\n\n  setV2Tags = (tags: Scope[]) => {\n    this.tagsV2 = tags;\n  };\n\n  getTags = (scope?: TraceqlSearchScope) => {\n    if (this.tagsV2 && scope) {\n      if (scope === TraceqlSearchScope.Unscoped) {\n        return getUnscopedTags(this.tagsV2);\n      }\n      return getTagsByScope(this.tagsV2, scope);\n    } else if (this.tagsV1) {\n      // This is needed because the /api/v2/search/tag/${tag}/values API expects \"status\" and the v1 API expects \"status.code\"\n      // so Tempo doesn't send anything and we inject it here for the autocomplete\n      if (!this.tagsV1.find((t) => t === 'status')) {\n        this.tagsV1.push('status');\n      }\n      return this.tagsV1;\n    }\n    return [];\n  };\n\n  getMetricsSummaryTags = (scope?: TraceqlSearchScope) => {\n    if (this.tagsV2 && scope) {\n      if (scope === TraceqlSearchScope.Unscoped) {\n        return getUnscopedTags(this.tagsV2);\n      }\n      return getTagsByScope(this.tagsV2, scope);\n    } else if (this.tagsV1) {\n      return this.tagsV1;\n    }\n    return [];\n  };\n\n  getTraceqlAutocompleteTags = (scope?: string) => {\n    if (this.tagsV2) {\n      if (!scope) {\n        // have not typed a scope yet || unscoped (.) typed\n        return getUnscopedTags(this.tagsV2);\n      } else if (scope === TraceqlSearchScope.Unscoped) {\n        return getUnscopedTags(this.tagsV2);\n      }\n      return getTagsByScope(this.tagsV2, scope);\n    } else if (this.tagsV1) {\n      // This is needed because the /api/v2/search/tag/${tag}/values API expects \"status\" and the v1 API expects \"status.code\"\n      // so Tempo doesn't send anything and we inject it here for the autocomplete\n      if (!this.tagsV1.find((t) => t === 'status')) {\n        this.tagsV1.push('status');\n      }\n      return this.tagsV1;\n    }\n    return [];\n  };\n\n  getAutocompleteTags = () => {\n    if (this.tagsV2) {\n      return getAllTags(this.tagsV2);\n    } else if (this.tagsV1) {\n      // This is needed because the /api/search/tag/${tag}/values API expects \"status.code\" and the v2 API expects \"status\"\n      // so Tempo doesn't send anything and we inject it here for the autocomplete\n      if (!this.tagsV1.find((t) => t === 'status.code')) {\n        this.tagsV1.push('status.code');\n      }\n      return this.tagsV1;\n    }\n    return [];\n  };\n\n  async getOptionsV1(tag: string): Promise<Array<SelectableValue<string>>> {\n    const encodedTag = this.encodeTag(tag);\n    const response = await this.request(`/api/search/tag/${encodedTag}/values`);\n    let options: Array<SelectableValue<string>> = [];\n    if (response && response.tagValues) {\n      options = response.tagValues.map((v: string) => ({\n        value: v,\n        label: v,\n      }));\n    }\n    return options;\n  }\n\n  async getOptionsV2(tag: string, query?: string): Promise<Array<SelectableValue<string>>> {\n    const encodedTag = this.encodeTag(tag);\n    const response = await this.request(`/api/v2/search/tag/${encodedTag}/values`, query ? { q: query } : {});\n    let options: Array<SelectableValue<string>> = [];\n    if (response && response.tagValues) {\n      response.tagValues.forEach((v: { type: string; value?: string }) => {\n        if (v.value) {\n          options.push({\n            type: v.type,\n            value: v.value,\n            label: v.value,\n          });\n        }\n      });\n    }\n    return options;\n  }\n\n  /**\n   * Encode (serialize) a given tag for use in a URL.\n   *\n   * @param tag the tag to encode\n   * @returns the encoded tag\n   */\n  private encodeTag = (tag: string): string => {\n    // If we call `encodeURIComponent` only once, we still get an error when issuing a request to the backend\n    // Reference: https://stackoverflow.com/a/37456192\n    return encodeURIComponent(encodeURIComponent(tag));\n  };\n}\n","import {\n  createDataFrame,\n  DataSourceInstanceSettings,\n  FieldDTO,\n  FieldType,\n  MutableDataFrame,\n  sortDataFrame,\n} from '@grafana/data';\n\nexport type MetricsSummary = {\n  spanCount: string;\n  errorSpanCount?: string;\n  p50: string;\n  p90: string;\n  p95: string;\n  p99: string;\n  series: Series[];\n};\n\ntype Series = {\n  key: string;\n  value: {\n    type: number;\n    n?: number;\n    f?: number;\n    s?: string;\n    b?: string;\n    d?: string;\n    status?: number;\n    kind?: number;\n  };\n};\n\ntype MetricsData = {\n  spanCount: number;\n  errorPercentage: number | string;\n  p50: number;\n  p90: number;\n  p95: number;\n  p99: number;\n  [key: string]: string | number;\n};\n\nexport function createTableFrameFromMetricsSummaryQuery(\n  data: MetricsSummary[],\n  targetQuery: string,\n  instanceSettings: DataSourceInstanceSettings\n) {\n  let frame;\n\n  if (!data.length) {\n    return emptyResponse;\n  }\n\n  const dynamicMetrics: Record<string, FieldDTO> = {};\n  data.forEach((res: MetricsSummary) => {\n    const configQuery = getConfigQuery(res.series, targetQuery);\n    res.series.forEach((series: Series) => {\n      dynamicMetrics[series.key] = {\n        name: `${series.key}`,\n        type: FieldType.string,\n        config: getConfig(series, configQuery, instanceSettings),\n        values: [],\n      };\n    });\n  });\n\n  frame = createDataFrame({\n    name: 'Metrics Summary',\n    refId: 'metrics-summary',\n    fields: [\n      ...Object.values(dynamicMetrics).sort((a, b) => a.name.localeCompare(b.name)),\n      {\n        name: 'kind',\n        type: FieldType.string,\n        config: { displayNameFromDS: 'Kind', custom: { width: 150 } },\n      },\n      {\n        name: 'spanCount',\n        type: FieldType.number,\n        config: { displayNameFromDS: 'Span count', custom: { width: 150 } },\n      },\n      {\n        name: 'errorPercentage',\n        type: FieldType.number,\n        config: { displayNameFromDS: 'Error', unit: 'percent', custom: { width: 150 } },\n      },\n      getPercentileRow('p50'),\n      getPercentileRow('p90'),\n      getPercentileRow('p95'),\n      getPercentileRow('p99'),\n    ],\n    meta: {\n      preferredVisualisationType: 'table',\n    },\n  });\n\n  const metricsData = data.map(transformToMetricsData);\n  frame.length = metricsData.length;\n  for (const trace of metricsData) {\n    for (const field of frame.fields) {\n      field.values.push(trace[field.name]);\n    }\n  }\n  frame = sortDataFrame(frame, 0);\n\n  return [frame];\n}\n\nexport const transformToMetricsData = (data: MetricsSummary) => {\n  const errorPercentage = data.errorSpanCount\n    ? (getNumberForMetric(data.errorSpanCount) / getNumberForMetric(data.spanCount)) * 100\n    : '0%';\n\n  const metricsData: MetricsData = {\n    kind: 'server', // so the user knows all results are of kind = server\n    spanCount: getNumberForMetric(data.spanCount),\n    errorPercentage,\n    p50: getNumberForMetric(data.p50),\n    p90: getNumberForMetric(data.p90),\n    p95: getNumberForMetric(data.p95),\n    p99: getNumberForMetric(data.p99),\n  };\n\n  data.series.forEach((series: Series) => {\n    metricsData[`${series.key}`] = getMetricValue(series) || '';\n  });\n\n  return metricsData;\n};\n\nexport const getConfigQuery = (series: Series[], targetQuery: string) => {\n  const queryParts = series.map((x: Series) => {\n    const isNumber = x.value.type === 3 || x.value.type === 4;\n    const isIntrinsic = x.value.type === 8 || x.value.type === 9;\n    const surround = isNumber || isIntrinsic ? '' : '\"';\n    return `${x.key}=${surround}` + '${__data.fields[\"' + x.key + '\"]}' + `${surround}`;\n  });\n\n  let configQuery = '';\n  const closingBracketIndex = targetQuery.indexOf('}');\n\n  if (closingBracketIndex !== -1) {\n    const queryAfterClosingBracket = targetQuery.substring(closingBracketIndex + 1);\n    configQuery = targetQuery.substring(0, closingBracketIndex);\n    if (queryParts.length > 0) {\n      configQuery += targetQuery.replace(/\\s/g, '').includes('{}') ? '' : ' && ';\n      configQuery += `${queryParts.join(' && ')} && kind=server`;\n      configQuery += `}`;\n    }\n    configQuery += `${queryAfterClosingBracket}`;\n  } else {\n    configQuery = `{${queryParts.join(' && ')} && kind=server} | ${targetQuery}`;\n  }\n\n  return configQuery;\n};\n\nconst getConfig = (series: Series, query: string, instanceSettings: DataSourceInstanceSettings) => {\n  const commonConfig = {\n    displayNameFromDS: series.key,\n    noValue: '<no value>',\n    links: [\n      {\n        title: 'Query in explore',\n        url: '',\n        internal: {\n          datasourceUid: instanceSettings.uid,\n          datasourceName: instanceSettings.name,\n          query: {\n            query,\n            queryType: 'traceql',\n          },\n        },\n      },\n    ],\n  };\n\n  if (series.value.type === 7) {\n    return {\n      ...commonConfig,\n      unit: 'ns',\n    };\n  }\n  return { ...commonConfig };\n};\n\nconst NO_VALUE = '';\n\nconst getMetricValue = (series: Series) => {\n  if (!series.value.type) {\n    return NO_VALUE;\n  }\n\n  switch (series.value.type) {\n    case 3:\n      return series.value.n;\n    case 4:\n      return series.value.f;\n    case 5:\n      return series.value.s;\n    case 6:\n      return series.value.b;\n    case 7:\n      return series.value.d;\n    case 8:\n      return getSpanStatusCode(series.value.status);\n    case 9:\n      return getSpanKind(series.value.kind);\n    default:\n      return NO_VALUE;\n  }\n};\n\n// Values set according to Tempo enum: https://github.com/grafana/tempo/blob/main/pkg/traceql/enum_statics.go\nconst getSpanStatusCode = (statusCode: number | undefined) => {\n  if (!statusCode) {\n    return NO_VALUE;\n  }\n\n  switch (statusCode) {\n    case 0:\n      return 'error';\n    case 1:\n      return 'ok';\n    default:\n      return 'unset';\n  }\n};\n\n// Values set according to Tempo enum: https://github.com/grafana/tempo/blob/main/pkg/traceql/enum_statics.go\nconst getSpanKind = (kind: number | undefined) => {\n  if (!kind) {\n    return NO_VALUE;\n  }\n\n  switch (kind) {\n    case 1:\n      return 'internal';\n    case 2:\n      return 'client';\n    case 3:\n      return 'server';\n    case 4:\n      return 'producer';\n    case 5:\n      return 'consumer';\n    default:\n      return 'unspecified';\n  }\n};\n\nconst getPercentileRow = (name: string) => {\n  return {\n    name: name,\n    type: FieldType.number,\n    config: {\n      displayNameFromDS: name,\n      unit: 'ns',\n      custom: {\n        width: 150,\n      },\n    },\n  };\n};\n\nconst getNumberForMetric = (metric: string) => {\n  const number = parseInt(metric, 10);\n  return isNaN(number) ? 0 : number;\n};\n\nexport const emptyResponse = new MutableDataFrame({\n  name: 'Metrics Summary',\n  refId: 'metrics-summary',\n  fields: [],\n  meta: {\n    preferredVisualisationType: 'table',\n  },\n});\n","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// DO NOT EDIT, this is an Auto-generated file from scripts/semconv/templates//templates/SemanticAttributes.ts.j2\nexport var SemanticResourceAttributes = {\n    /**\n     * Name of the cloud provider.\n     */\n    CLOUD_PROVIDER: 'cloud.provider',\n    /**\n     * The cloud account ID the resource is assigned to.\n     */\n    CLOUD_ACCOUNT_ID: 'cloud.account.id',\n    /**\n     * The geographical region the resource is running. Refer to your provider&#39;s docs to see the available regions, for example [Alibaba Cloud regions](https://www.alibabacloud.com/help/doc-detail/40654.htm), [AWS regions](https://aws.amazon.com/about-aws/global-infrastructure/regions_az/), [Azure regions](https://azure.microsoft.com/en-us/global-infrastructure/geographies/), or [Google Cloud regions](https://cloud.google.com/about/locations).\n     */\n    CLOUD_REGION: 'cloud.region',\n    /**\n     * Cloud regions often have multiple, isolated locations known as zones to increase availability. Availability zone represents the zone where the resource is running.\n     *\n     * Note: Availability zones are called &#34;zones&#34; on Alibaba Cloud and Google Cloud.\n     */\n    CLOUD_AVAILABILITY_ZONE: 'cloud.availability_zone',\n    /**\n     * The cloud platform in use.\n     *\n     * Note: The prefix of the service SHOULD match the one specified in `cloud.provider`.\n     */\n    CLOUD_PLATFORM: 'cloud.platform',\n    /**\n     * The Amazon Resource Name (ARN) of an [ECS container instance](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ECS_instances.html).\n     */\n    AWS_ECS_CONTAINER_ARN: 'aws.ecs.container.arn',\n    /**\n     * The ARN of an [ECS cluster](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/clusters.html).\n     */\n    AWS_ECS_CLUSTER_ARN: 'aws.ecs.cluster.arn',\n    /**\n     * The [launch type](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/launch_types.html) for an ECS task.\n     */\n    AWS_ECS_LAUNCHTYPE: 'aws.ecs.launchtype',\n    /**\n     * The ARN of an [ECS task definition](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task_definitions.html).\n     */\n    AWS_ECS_TASK_ARN: 'aws.ecs.task.arn',\n    /**\n     * The task definition family this task definition is a member of.\n     */\n    AWS_ECS_TASK_FAMILY: 'aws.ecs.task.family',\n    /**\n     * The revision for this task definition.\n     */\n    AWS_ECS_TASK_REVISION: 'aws.ecs.task.revision',\n    /**\n     * The ARN of an EKS cluster.\n     */\n    AWS_EKS_CLUSTER_ARN: 'aws.eks.cluster.arn',\n    /**\n     * The name(s) of the AWS log group(s) an application is writing to.\n     *\n     * Note: Multiple log groups must be supported for cases like multi-container applications, where a single application has sidecar containers, and each write to their own log group.\n     */\n    AWS_LOG_GROUP_NAMES: 'aws.log.group.names',\n    /**\n     * The Amazon Resource Name(s) (ARN) of the AWS log group(s).\n     *\n     * Note: See the [log group ARN format documentation](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/iam-access-control-overview-cwl.html#CWL_ARN_Format).\n     */\n    AWS_LOG_GROUP_ARNS: 'aws.log.group.arns',\n    /**\n     * The name(s) of the AWS log stream(s) an application is writing to.\n     */\n    AWS_LOG_STREAM_NAMES: 'aws.log.stream.names',\n    /**\n     * The ARN(s) of the AWS log stream(s).\n     *\n     * Note: See the [log stream ARN format documentation](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/iam-access-control-overview-cwl.html#CWL_ARN_Format). One log group can contain several log streams, so these ARNs necessarily identify both a log group and a log stream.\n     */\n    AWS_LOG_STREAM_ARNS: 'aws.log.stream.arns',\n    /**\n     * Container name.\n     */\n    CONTAINER_NAME: 'container.name',\n    /**\n     * Container ID. Usually a UUID, as for example used to [identify Docker containers](https://docs.docker.com/engine/reference/run/#container-identification). The UUID might be abbreviated.\n     */\n    CONTAINER_ID: 'container.id',\n    /**\n     * The container runtime managing this container.\n     */\n    CONTAINER_RUNTIME: 'container.runtime',\n    /**\n     * Name of the image the container was built on.\n     */\n    CONTAINER_IMAGE_NAME: 'container.image.name',\n    /**\n     * Container image tag.\n     */\n    CONTAINER_IMAGE_TAG: 'container.image.tag',\n    /**\n     * Name of the [deployment environment](https://en.wikipedia.org/wiki/Deployment_environment) (aka deployment tier).\n     */\n    DEPLOYMENT_ENVIRONMENT: 'deployment.environment',\n    /**\n     * A unique identifier representing the device.\n     *\n     * Note: The device identifier MUST only be defined using the values outlined below. This value is not an advertising identifier and MUST NOT be used as such. On iOS (Swift or Objective-C), this value MUST be equal to the [vendor identifier](https://developer.apple.com/documentation/uikit/uidevice/1620059-identifierforvendor). On Android (Java or Kotlin), this value MUST be equal to the Firebase Installation ID or a globally unique UUID which is persisted across sessions in your application. More information can be found [here](https://developer.android.com/training/articles/user-data-ids) on best practices and exact implementation details. Caution should be taken when storing personal data or anything which can identify a user. GDPR and data protection laws may apply, ensure you do your own due diligence.\n     */\n    DEVICE_ID: 'device.id',\n    /**\n     * The model identifier for the device.\n     *\n     * Note: It&#39;s recommended this value represents a machine readable version of the model identifier rather than the market or consumer-friendly name of the device.\n     */\n    DEVICE_MODEL_IDENTIFIER: 'device.model.identifier',\n    /**\n     * The marketing name for the device model.\n     *\n     * Note: It&#39;s recommended this value represents a human readable version of the device model rather than a machine readable alternative.\n     */\n    DEVICE_MODEL_NAME: 'device.model.name',\n    /**\n     * The name of the single function that this runtime instance executes.\n     *\n     * Note: This is the name of the function as configured/deployed on the FaaS platform and is usually different from the name of the callback function (which may be stored in the [`code.namespace`/`code.function`](../../trace/semantic_conventions/span-general.md#source-code-attributes) span attributes).\n     */\n    FAAS_NAME: 'faas.name',\n    /**\n    * The unique ID of the single function that this runtime instance executes.\n    *\n    * Note: Depending on the cloud provider, use:\n  \n  * **AWS Lambda:** The function [ARN](https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html).\n  Take care not to use the &#34;invoked ARN&#34; directly but replace any\n  [alias suffix](https://docs.aws.amazon.com/lambda/latest/dg/configuration-aliases.html) with the resolved function version, as the same runtime instance may be invokable with multiple\n  different aliases.\n  * **GCP:** The [URI of the resource](https://cloud.google.com/iam/docs/full-resource-names)\n  * **Azure:** The [Fully Qualified Resource ID](https://docs.microsoft.com/en-us/rest/api/resources/resources/get-by-id).\n  \n  On some providers, it may not be possible to determine the full ID at startup,\n  which is why this field cannot be made required. For example, on AWS the account ID\n  part of the ARN is not available without calling another AWS API\n  which may be deemed too slow for a short-running lambda function.\n  As an alternative, consider setting `faas.id` as a span attribute instead.\n    */\n    FAAS_ID: 'faas.id',\n    /**\n    * The immutable version of the function being executed.\n    *\n    * Note: Depending on the cloud provider and platform, use:\n  \n  * **AWS Lambda:** The [function version](https://docs.aws.amazon.com/lambda/latest/dg/configuration-versions.html)\n    (an integer represented as a decimal string).\n  * **Google Cloud Run:** The [revision](https://cloud.google.com/run/docs/managing/revisions)\n    (i.e., the function name plus the revision suffix).\n  * **Google Cloud Functions:** The value of the\n    [`K_REVISION` environment variable](https://cloud.google.com/functions/docs/env-var#runtime_environment_variables_set_automatically).\n  * **Azure Functions:** Not applicable. Do not set this attribute.\n    */\n    FAAS_VERSION: 'faas.version',\n    /**\n     * The execution environment ID as a string, that will be potentially reused for other invocations to the same function/function version.\n     *\n     * Note: * **AWS Lambda:** Use the (full) log stream name.\n     */\n    FAAS_INSTANCE: 'faas.instance',\n    /**\n     * The amount of memory available to the serverless function in MiB.\n     *\n     * Note: It&#39;s recommended to set this attribute since e.g. too little memory can easily stop a Java AWS Lambda function from working correctly. On AWS Lambda, the environment variable `AWS_LAMBDA_FUNCTION_MEMORY_SIZE` provides this information.\n     */\n    FAAS_MAX_MEMORY: 'faas.max_memory',\n    /**\n     * Unique host ID. For Cloud, this must be the instance_id assigned by the cloud provider.\n     */\n    HOST_ID: 'host.id',\n    /**\n     * Name of the host. On Unix systems, it may contain what the hostname command returns, or the fully qualified hostname, or another name specified by the user.\n     */\n    HOST_NAME: 'host.name',\n    /**\n     * Type of host. For Cloud, this must be the machine type.\n     */\n    HOST_TYPE: 'host.type',\n    /**\n     * The CPU architecture the host system is running on.\n     */\n    HOST_ARCH: 'host.arch',\n    /**\n     * Name of the VM image or OS install the host was instantiated from.\n     */\n    HOST_IMAGE_NAME: 'host.image.name',\n    /**\n     * VM image ID. For Cloud, this value is from the provider.\n     */\n    HOST_IMAGE_ID: 'host.image.id',\n    /**\n     * The version string of the VM image as defined in [Version SpanAttributes](README.md#version-attributes).\n     */\n    HOST_IMAGE_VERSION: 'host.image.version',\n    /**\n     * The name of the cluster.\n     */\n    K8S_CLUSTER_NAME: 'k8s.cluster.name',\n    /**\n     * The name of the Node.\n     */\n    K8S_NODE_NAME: 'k8s.node.name',\n    /**\n     * The UID of the Node.\n     */\n    K8S_NODE_UID: 'k8s.node.uid',\n    /**\n     * The name of the namespace that the pod is running in.\n     */\n    K8S_NAMESPACE_NAME: 'k8s.namespace.name',\n    /**\n     * The UID of the Pod.\n     */\n    K8S_POD_UID: 'k8s.pod.uid',\n    /**\n     * The name of the Pod.\n     */\n    K8S_POD_NAME: 'k8s.pod.name',\n    /**\n     * The name of the Container in a Pod template.\n     */\n    K8S_CONTAINER_NAME: 'k8s.container.name',\n    /**\n     * The UID of the ReplicaSet.\n     */\n    K8S_REPLICASET_UID: 'k8s.replicaset.uid',\n    /**\n     * The name of the ReplicaSet.\n     */\n    K8S_REPLICASET_NAME: 'k8s.replicaset.name',\n    /**\n     * The UID of the Deployment.\n     */\n    K8S_DEPLOYMENT_UID: 'k8s.deployment.uid',\n    /**\n     * The name of the Deployment.\n     */\n    K8S_DEPLOYMENT_NAME: 'k8s.deployment.name',\n    /**\n     * The UID of the StatefulSet.\n     */\n    K8S_STATEFULSET_UID: 'k8s.statefulset.uid',\n    /**\n     * The name of the StatefulSet.\n     */\n    K8S_STATEFULSET_NAME: 'k8s.statefulset.name',\n    /**\n     * The UID of the DaemonSet.\n     */\n    K8S_DAEMONSET_UID: 'k8s.daemonset.uid',\n    /**\n     * The name of the DaemonSet.\n     */\n    K8S_DAEMONSET_NAME: 'k8s.daemonset.name',\n    /**\n     * The UID of the Job.\n     */\n    K8S_JOB_UID: 'k8s.job.uid',\n    /**\n     * The name of the Job.\n     */\n    K8S_JOB_NAME: 'k8s.job.name',\n    /**\n     * The UID of the CronJob.\n     */\n    K8S_CRONJOB_UID: 'k8s.cronjob.uid',\n    /**\n     * The name of the CronJob.\n     */\n    K8S_CRONJOB_NAME: 'k8s.cronjob.name',\n    /**\n     * The operating system type.\n     */\n    OS_TYPE: 'os.type',\n    /**\n     * Human readable (not intended to be parsed) OS version information, like e.g. reported by `ver` or `lsb_release -a` commands.\n     */\n    OS_DESCRIPTION: 'os.description',\n    /**\n     * Human readable operating system name.\n     */\n    OS_NAME: 'os.name',\n    /**\n     * The version string of the operating system as defined in [Version SpanAttributes](../../resource/semantic_conventions/README.md#version-attributes).\n     */\n    OS_VERSION: 'os.version',\n    /**\n     * Process identifier (PID).\n     */\n    PROCESS_PID: 'process.pid',\n    /**\n     * The name of the process executable. On Linux based systems, can be set to the `Name` in `proc/[pid]/status`. On Windows, can be set to the base name of `GetProcessImageFileNameW`.\n     */\n    PROCESS_EXECUTABLE_NAME: 'process.executable.name',\n    /**\n     * The full path to the process executable. On Linux based systems, can be set to the target of `proc/[pid]/exe`. On Windows, can be set to the result of `GetProcessImageFileNameW`.\n     */\n    PROCESS_EXECUTABLE_PATH: 'process.executable.path',\n    /**\n     * The command used to launch the process (i.e. the command name). On Linux based systems, can be set to the zeroth string in `proc/[pid]/cmdline`. On Windows, can be set to the first parameter extracted from `GetCommandLineW`.\n     */\n    PROCESS_COMMAND: 'process.command',\n    /**\n     * The full command used to launch the process as a single string representing the full command. On Windows, can be set to the result of `GetCommandLineW`. Do not set this if you have to assemble it just for monitoring; use `process.command_args` instead.\n     */\n    PROCESS_COMMAND_LINE: 'process.command_line',\n    /**\n     * All the command arguments (including the command/executable itself) as received by the process. On Linux-based systems (and some other Unixoid systems supporting procfs), can be set according to the list of null-delimited strings extracted from `proc/[pid]/cmdline`. For libc-based executables, this would be the full argv vector passed to `main`.\n     */\n    PROCESS_COMMAND_ARGS: 'process.command_args',\n    /**\n     * The username of the user that owns the process.\n     */\n    PROCESS_OWNER: 'process.owner',\n    /**\n     * The name of the runtime of this process. For compiled native binaries, this SHOULD be the name of the compiler.\n     */\n    PROCESS_RUNTIME_NAME: 'process.runtime.name',\n    /**\n     * The version of the runtime of this process, as returned by the runtime without modification.\n     */\n    PROCESS_RUNTIME_VERSION: 'process.runtime.version',\n    /**\n     * An additional description about the runtime of the process, for example a specific vendor customization of the runtime environment.\n     */\n    PROCESS_RUNTIME_DESCRIPTION: 'process.runtime.description',\n    /**\n     * Logical name of the service.\n     *\n     * Note: MUST be the same for all instances of horizontally scaled services. If the value was not specified, SDKs MUST fallback to `unknown_service:` concatenated with [`process.executable.name`](process.md#process), e.g. `unknown_service:bash`. If `process.executable.name` is not available, the value MUST be set to `unknown_service`.\n     */\n    SERVICE_NAME: 'service.name',\n    /**\n     * A namespace for `service.name`.\n     *\n     * Note: A string value having a meaning that helps to distinguish a group of services, for example the team name that owns a group of services. `service.name` is expected to be unique within the same namespace. If `service.namespace` is not specified in the Resource then `service.name` is expected to be unique for all services that have no explicit namespace defined (so the empty/unspecified namespace is simply one more valid namespace). Zero-length namespace string is assumed equal to unspecified namespace.\n     */\n    SERVICE_NAMESPACE: 'service.namespace',\n    /**\n     * The string ID of the service instance.\n     *\n     * Note: MUST be unique for each instance of the same `service.namespace,service.name` pair (in other words `service.namespace,service.name,service.instance.id` triplet MUST be globally unique). The ID helps to distinguish instances of the same service that exist at the same time (e.g. instances of a horizontally scaled service). It is preferable for the ID to be persistent and stay the same for the lifetime of the service instance, however it is acceptable that the ID is ephemeral and changes during important lifetime events for the service (e.g. service restarts). If the service has no inherent unique ID that can be used as the value of this attribute it is recommended to generate a random Version 1 or Version 4 RFC 4122 UUID (services aiming for reproducible UUIDs may also use Version 5, see RFC 4122 for more recommendations).\n     */\n    SERVICE_INSTANCE_ID: 'service.instance.id',\n    /**\n     * The version string of the service API or implementation.\n     */\n    SERVICE_VERSION: 'service.version',\n    /**\n     * The name of the telemetry SDK as defined above.\n     */\n    TELEMETRY_SDK_NAME: 'telemetry.sdk.name',\n    /**\n     * The language of the telemetry SDK.\n     */\n    TELEMETRY_SDK_LANGUAGE: 'telemetry.sdk.language',\n    /**\n     * The version string of the telemetry SDK.\n     */\n    TELEMETRY_SDK_VERSION: 'telemetry.sdk.version',\n    /**\n     * The version string of the auto instrumentation agent, if used.\n     */\n    TELEMETRY_AUTO_VERSION: 'telemetry.auto.version',\n    /**\n     * The name of the web engine.\n     */\n    WEBENGINE_NAME: 'webengine.name',\n    /**\n     * The version of the web engine.\n     */\n    WEBENGINE_VERSION: 'webengine.version',\n    /**\n     * Additional description of the web engine (e.g. detailed version and edition information).\n     */\n    WEBENGINE_DESCRIPTION: 'webengine.description',\n};\nexport var CloudProviderValues = {\n    /** Alibaba Cloud. */\n    ALIBABA_CLOUD: 'alibaba_cloud',\n    /** Amazon Web Services. */\n    AWS: 'aws',\n    /** Microsoft Azure. */\n    AZURE: 'azure',\n    /** Google Cloud Platform. */\n    GCP: 'gcp',\n};\nexport var CloudPlatformValues = {\n    /** Alibaba Cloud Elastic Compute Service. */\n    ALIBABA_CLOUD_ECS: 'alibaba_cloud_ecs',\n    /** Alibaba Cloud Function Compute. */\n    ALIBABA_CLOUD_FC: 'alibaba_cloud_fc',\n    /** AWS Elastic Compute Cloud. */\n    AWS_EC2: 'aws_ec2',\n    /** AWS Elastic Container Service. */\n    AWS_ECS: 'aws_ecs',\n    /** AWS Elastic Kubernetes Service. */\n    AWS_EKS: 'aws_eks',\n    /** AWS Lambda. */\n    AWS_LAMBDA: 'aws_lambda',\n    /** AWS Elastic Beanstalk. */\n    AWS_ELASTIC_BEANSTALK: 'aws_elastic_beanstalk',\n    /** Azure Virtual Machines. */\n    AZURE_VM: 'azure_vm',\n    /** Azure Container Instances. */\n    AZURE_CONTAINER_INSTANCES: 'azure_container_instances',\n    /** Azure Kubernetes Service. */\n    AZURE_AKS: 'azure_aks',\n    /** Azure Functions. */\n    AZURE_FUNCTIONS: 'azure_functions',\n    /** Azure App Service. */\n    AZURE_APP_SERVICE: 'azure_app_service',\n    /** Google Cloud Compute Engine (GCE). */\n    GCP_COMPUTE_ENGINE: 'gcp_compute_engine',\n    /** Google Cloud Run. */\n    GCP_CLOUD_RUN: 'gcp_cloud_run',\n    /** Google Cloud Kubernetes Engine (GKE). */\n    GCP_KUBERNETES_ENGINE: 'gcp_kubernetes_engine',\n    /** Google Cloud Functions (GCF). */\n    GCP_CLOUD_FUNCTIONS: 'gcp_cloud_functions',\n    /** Google Cloud App Engine (GAE). */\n    GCP_APP_ENGINE: 'gcp_app_engine',\n};\nexport var AwsEcsLaunchtypeValues = {\n    /** ec2. */\n    EC2: 'ec2',\n    /** fargate. */\n    FARGATE: 'fargate',\n};\nexport var HostArchValues = {\n    /** AMD64. */\n    AMD64: 'amd64',\n    /** ARM32. */\n    ARM32: 'arm32',\n    /** ARM64. */\n    ARM64: 'arm64',\n    /** Itanium. */\n    IA64: 'ia64',\n    /** 32-bit PowerPC. */\n    PPC32: 'ppc32',\n    /** 64-bit PowerPC. */\n    PPC64: 'ppc64',\n    /** 32-bit x86. */\n    X86: 'x86',\n};\nexport var OsTypeValues = {\n    /** Microsoft Windows. */\n    WINDOWS: 'windows',\n    /** Linux. */\n    LINUX: 'linux',\n    /** Apple Darwin. */\n    DARWIN: 'darwin',\n    /** FreeBSD. */\n    FREEBSD: 'freebsd',\n    /** NetBSD. */\n    NETBSD: 'netbsd',\n    /** OpenBSD. */\n    OPENBSD: 'openbsd',\n    /** DragonFly BSD. */\n    DRAGONFLYBSD: 'dragonflybsd',\n    /** HP-UX (Hewlett Packard Unix). */\n    HPUX: 'hpux',\n    /** AIX (Advanced Interactive eXecutive). */\n    AIX: 'aix',\n    /** Oracle Solaris. */\n    SOLARIS: 'solaris',\n    /** IBM z/OS. */\n    Z_OS: 'z_os',\n};\nexport var TelemetrySdkLanguageValues = {\n    /** cpp. */\n    CPP: 'cpp',\n    /** dotnet. */\n    DOTNET: 'dotnet',\n    /** erlang. */\n    ERLANG: 'erlang',\n    /** go. */\n    GO: 'go',\n    /** java. */\n    JAVA: 'java',\n    /** nodejs. */\n    NODEJS: 'nodejs',\n    /** php. */\n    PHP: 'php',\n    /** python. */\n    PYTHON: 'python',\n    /** ruby. */\n    RUBY: 'ruby',\n    /** webjs. */\n    WEBJS: 'webjs',\n};\n//# sourceMappingURL=SemanticResourceAttributes.js.map","import { SpanStatus } from '@opentelemetry/api';\nimport { collectorTypes } from '@opentelemetry/exporter-collector';\nimport { SemanticResourceAttributes } from '@opentelemetry/semantic-conventions';\n\nimport {\n  createDataFrame,\n  createTheme,\n  DataFrame,\n  DataLink,\n  DataLinkConfigOrigin,\n  DataQueryResponse,\n  DataSourceInstanceSettings,\n  DataSourceJsonData,\n  Field,\n  FieldDTO,\n  FieldType,\n  getDisplayProcessor,\n  Labels,\n  MutableDataFrame,\n  toDataFrame,\n  TraceKeyValuePair,\n  TraceLog,\n  TraceSpanReference,\n  TraceSpanRow,\n} from '@grafana/data';\nimport { TraceToProfilesData } from '@grafana/o11y-ds-frontend';\nimport { getDataSourceSrv } from '@grafana/runtime';\n\nimport { SearchTableType } from './dataquery.gen';\nimport { createGraphFrames } from './graphTransform';\nimport {\n  ProtoValue,\n  Span,\n  SpanAttributes,\n  Spanset,\n  TempoJsonData,\n  TraceqlMetricsResponse,\n  TraceSearchMetadata,\n} from './types';\n\nfunction getAttributeValue(value: collectorTypes.opentelemetryProto.common.v1.AnyValue): any {\n  if (value.stringValue) {\n    return value.stringValue;\n  }\n\n  if (value.boolValue !== undefined) {\n    return Boolean(value.boolValue);\n  }\n\n  if (value.intValue !== undefined) {\n    return Number.parseInt(value.intValue as any, 10);\n  }\n\n  if (value.doubleValue) {\n    return Number.parseFloat(value.doubleValue as any);\n  }\n\n  if (value.arrayValue) {\n    const arrayValue = [];\n    for (const arValue of value.arrayValue.values) {\n      arrayValue.push(getAttributeValue(arValue));\n    }\n    return arrayValue;\n  }\n\n  return '';\n}\n\nfunction resourceToProcess(resource: collectorTypes.opentelemetryProto.resource.v1.Resource | undefined) {\n  const serviceTags: TraceKeyValuePair[] = [];\n  let serviceName = 'OTLPResourceNoServiceName';\n  if (!resource) {\n    return { serviceName, serviceTags };\n  }\n\n  for (const attribute of resource.attributes) {\n    if (attribute.key === SemanticResourceAttributes.SERVICE_NAME) {\n      serviceName = attribute.value.stringValue || serviceName;\n    }\n    serviceTags.push({ key: attribute.key, value: getAttributeValue(attribute.value) });\n  }\n\n  return { serviceName, serviceTags };\n}\n\nfunction getSpanTags(span: collectorTypes.opentelemetryProto.trace.v1.Span): TraceKeyValuePair[] {\n  const spanTags: TraceKeyValuePair[] = [];\n\n  if (span.attributes) {\n    for (const attribute of span.attributes) {\n      spanTags.push({ key: attribute.key, value: getAttributeValue(attribute.value) });\n    }\n  }\n\n  return spanTags;\n}\n\nfunction getSpanKind(span: collectorTypes.opentelemetryProto.trace.v1.Span) {\n  let kind = undefined;\n  if (span.kind) {\n    const split = span.kind.toString().toLowerCase().split('_');\n    kind = split.length ? split[split.length - 1] : span.kind.toString();\n  }\n  return kind;\n}\n\nfunction getReferences(span: collectorTypes.opentelemetryProto.trace.v1.Span) {\n  const references: TraceSpanReference[] = [];\n  if (span.links) {\n    for (const link of span.links) {\n      const { traceId, spanId } = link;\n      const tags: TraceKeyValuePair[] = [];\n      if (link.attributes) {\n        for (const attribute of link.attributes) {\n          tags.push({ key: attribute.key, value: getAttributeValue(attribute.value) });\n        }\n      }\n      references.push({ traceID: traceId, spanID: spanId, tags });\n    }\n  }\n\n  return references;\n}\n\nfunction getLogs(span: collectorTypes.opentelemetryProto.trace.v1.Span) {\n  const logs: TraceLog[] = [];\n  if (span.events) {\n    for (const event of span.events) {\n      const fields: TraceKeyValuePair[] = [];\n      if (event.attributes) {\n        for (const attribute of event.attributes) {\n          fields.push({ key: attribute.key, value: getAttributeValue(attribute.value) });\n        }\n      }\n      logs.push({ fields, timestamp: event.timeUnixNano / 1000000 });\n    }\n  }\n\n  return logs;\n}\n\nexport function transformFromOTLP(\n  traceData: collectorTypes.opentelemetryProto.trace.v1.ResourceSpans[],\n  nodeGraph = false\n): DataQueryResponse {\n  const frame = new MutableDataFrame({\n    fields: [\n      { name: 'traceID', type: FieldType.string, values: [] },\n      { name: 'spanID', type: FieldType.string, values: [] },\n      { name: 'parentSpanID', type: FieldType.string, values: [] },\n      { name: 'operationName', type: FieldType.string, values: [] },\n      { name: 'serviceName', type: FieldType.string, values: [] },\n      { name: 'kind', type: FieldType.string, values: [] },\n      { name: 'statusCode', type: FieldType.number, values: [] },\n      { name: 'statusMessage', type: FieldType.string, values: [] },\n      { name: 'instrumentationLibraryName', type: FieldType.string, values: [] },\n      { name: 'instrumentationLibraryVersion', type: FieldType.string, values: [] },\n      { name: 'traceState', type: FieldType.string, values: [] },\n      { name: 'serviceTags', type: FieldType.other, values: [] },\n      { name: 'startTime', type: FieldType.number, values: [] },\n      { name: 'duration', type: FieldType.number, values: [] },\n      { name: 'logs', type: FieldType.other, values: [] },\n      { name: 'references', type: FieldType.other, values: [] },\n      { name: 'tags', type: FieldType.other, values: [] },\n    ],\n    meta: {\n      preferredVisualisationType: 'trace',\n      custom: {\n        traceFormat: 'otlp',\n      },\n    },\n  });\n  try {\n    for (const data of traceData) {\n      const { serviceName, serviceTags } = resourceToProcess(data.resource);\n      for (const librarySpan of data.instrumentationLibrarySpans) {\n        for (const span of librarySpan.spans) {\n          frame.add({\n            traceID: span.traceId.length > 16 ? span.traceId.slice(16) : span.traceId,\n            spanID: span.spanId,\n            parentSpanID: span.parentSpanId || '',\n            operationName: span.name || '',\n            serviceName,\n            kind: getSpanKind(span),\n            statusCode: span.status?.code,\n            statusMessage: span.status?.message,\n            instrumentationLibraryName: librarySpan.instrumentationLibrary?.name,\n            instrumentationLibraryVersion: librarySpan.instrumentationLibrary?.version,\n            traceState: span.traceState,\n            serviceTags,\n            startTime: span.startTimeUnixNano! / 1000000,\n            duration: (span.endTimeUnixNano! - span.startTimeUnixNano!) / 1000000,\n            tags: getSpanTags(span),\n            logs: getLogs(span),\n            references: getReferences(span),\n          });\n        }\n      }\n    }\n  } catch (error) {\n    console.error(error);\n    return { error: { message: 'JSON is not valid OpenTelemetry format: ' + error }, data: [] };\n  }\n\n  let data = [frame];\n  if (nodeGraph) {\n    data.push(...(createGraphFrames(frame) as MutableDataFrame[]));\n  }\n\n  return { data };\n}\n\n/**\n * Transforms trace dataframes to the OpenTelemetry format\n */\nexport function transformToOTLP(data: MutableDataFrame): {\n  batches: collectorTypes.opentelemetryProto.trace.v1.ResourceSpans[];\n} {\n  let result: { batches: collectorTypes.opentelemetryProto.trace.v1.ResourceSpans[] } = {\n    batches: [],\n  };\n\n  // Lookup object to see which batch contains spans for which services\n  let services: { [key: string]: number } = {};\n\n  for (let i = 0; i < data.length; i++) {\n    const span = data.get(i);\n\n    // Group spans based on service\n    if (!services[span.serviceName]) {\n      services[span.serviceName] = result.batches.length;\n      result.batches.push({\n        resource: {\n          attributes: [],\n          droppedAttributesCount: 0,\n        },\n        instrumentationLibrarySpans: [\n          {\n            spans: [],\n          },\n        ],\n      });\n    }\n\n    let batchIndex = services[span.serviceName];\n\n    // Populate resource attributes from service tags\n    if (result.batches[batchIndex].resource!.attributes.length === 0) {\n      result.batches[batchIndex].resource!.attributes = tagsToAttributes(span.serviceTags);\n    }\n\n    // Populate instrumentation library if it exists\n    if (!result.batches[batchIndex].instrumentationLibrarySpans[0].instrumentationLibrary) {\n      if (span.instrumentationLibraryName) {\n        result.batches[batchIndex].instrumentationLibrarySpans[0].instrumentationLibrary = {\n          name: span.instrumentationLibraryName,\n          version: span.instrumentationLibraryVersion ? span.instrumentationLibraryVersion : '',\n        };\n      }\n    }\n\n    result.batches[batchIndex].instrumentationLibrarySpans[0].spans.push({\n      traceId: span.traceID.padStart(32, '0'),\n      spanId: span.spanID,\n      parentSpanId: span.parentSpanID || '',\n      traceState: span.traceState || '',\n      name: span.operationName,\n      kind: getOTLPSpanKind(span.kind) as any,\n      startTimeUnixNano: span.startTime * 1000000,\n      endTimeUnixNano: (span.startTime + span.duration) * 1000000,\n      attributes: span.tags ? tagsToAttributes(span.tags) : [],\n      droppedAttributesCount: 0,\n      droppedEventsCount: 0,\n      droppedLinksCount: 0,\n      status: getOTLPStatus(span),\n      events: getOTLPEvents(span.logs),\n      links: getOTLPReferences(span.references),\n    });\n  }\n\n  return result;\n}\n\nfunction getOTLPSpanKind(kind: string): string | undefined {\n  let spanKind = undefined;\n  if (kind) {\n    switch (kind) {\n      case 'server':\n        spanKind = 'SPAN_KIND_SERVER';\n        break;\n      case 'client':\n        spanKind = 'SPAN_KIND_CLIENT';\n        break;\n      case 'producer':\n        spanKind = 'SPAN_KIND_PRODUCER';\n        break;\n      case 'consumer':\n        spanKind = 'SPAN_KIND_CONSUMER';\n        break;\n      case 'internal':\n        spanKind = 'SPAN_KIND_INTERNAL';\n        break;\n    }\n  }\n  return spanKind;\n}\n\n/**\n * Converts key-value tags to OTLP attributes and removes tags added by Grafana\n */\nfunction tagsToAttributes(tags: TraceKeyValuePair[]): collectorTypes.opentelemetryProto.common.v1.KeyValue[] {\n  return tags.reduce<collectorTypes.opentelemetryProto.common.v1.KeyValue[]>(\n    (attributes, tag) => [...attributes, { key: tag.key, value: toAttributeValue(tag) }],\n    []\n  );\n}\n\n/**\n * Returns the correct OTLP AnyValue based on the value of the tag value\n */\nfunction toAttributeValue(tag: TraceKeyValuePair): collectorTypes.opentelemetryProto.common.v1.AnyValue {\n  if (typeof tag.value === 'string') {\n    return { stringValue: tag.value };\n  } else if (typeof tag.value === 'boolean') {\n    return { boolValue: tag.value };\n  } else if (typeof tag.value === 'number') {\n    if (tag.value % 1 === 0) {\n      return { intValue: tag.value };\n    } else {\n      return { doubleValue: tag.value };\n    }\n  } else if (typeof tag.value === 'object') {\n    if (Array.isArray(tag.value)) {\n      const values: collectorTypes.opentelemetryProto.common.v1.AnyValue[] = [];\n      for (const val of tag.value) {\n        values.push(toAttributeValue(val));\n      }\n\n      return { arrayValue: { values } };\n    }\n  }\n  return { stringValue: tag.value };\n}\n\nfunction getOTLPStatus(span: TraceSpanRow): SpanStatus | undefined {\n  let status = undefined;\n  if (span.statusCode !== undefined) {\n    status = {\n      code: span.statusCode,\n      message: span.statusMessage ? span.statusMessage : '',\n    };\n  }\n  return status;\n}\n\nfunction getOTLPEvents(logs: TraceLog[]): collectorTypes.opentelemetryProto.trace.v1.Span.Event[] | undefined {\n  if (!logs || !logs.length) {\n    return undefined;\n  }\n\n  let events: collectorTypes.opentelemetryProto.trace.v1.Span.Event[] = [];\n  for (const log of logs) {\n    let event: collectorTypes.opentelemetryProto.trace.v1.Span.Event = {\n      timeUnixNano: log.timestamp * 1000000,\n      attributes: [],\n      droppedAttributesCount: 0,\n      name: '',\n    };\n    for (const field of log.fields) {\n      event.attributes!.push({\n        key: field.key,\n        value: toAttributeValue(field),\n      });\n    }\n    events.push(event);\n  }\n  return events;\n}\n\nfunction getOTLPReferences(\n  references: TraceSpanReference[]\n): collectorTypes.opentelemetryProto.trace.v1.Span.Link[] | undefined {\n  if (!references || !references.length) {\n    return undefined;\n  }\n\n  let links: collectorTypes.opentelemetryProto.trace.v1.Span.Link[] = [];\n  for (const ref of references) {\n    let link: collectorTypes.opentelemetryProto.trace.v1.Span.Link = {\n      traceId: ref.traceID,\n      spanId: ref.spanID,\n      attributes: [],\n      droppedAttributesCount: 0,\n    };\n    if (ref.tags?.length) {\n      for (const tag of ref.tags) {\n        link.attributes?.push({\n          key: tag.key,\n          value: toAttributeValue(tag),\n        });\n      }\n    }\n    links.push(link);\n  }\n  return links;\n}\n\nexport const RelatedProfilesTitle = 'Related profiles';\n\nexport function transformTrace(\n  response: DataQueryResponse,\n  instanceSettings: DataSourceInstanceSettings<TempoJsonData>,\n  nodeGraph = false\n): DataQueryResponse {\n  const frame = response.data[0];\n\n  if (!frame) {\n    return emptyDataQueryResponse;\n  }\n\n  // Get profiles links\n  const traceToProfilesData: TraceToProfilesData | undefined = instanceSettings?.jsonData;\n  const traceToProfilesOptions = traceToProfilesData?.tracesToProfiles;\n  let profilesDataSourceSettings: DataSourceInstanceSettings<DataSourceJsonData> | undefined;\n  if (traceToProfilesOptions?.datasourceUid) {\n    profilesDataSourceSettings = getDataSourceSrv().getInstanceSettings(traceToProfilesOptions.datasourceUid);\n  }\n\n  if (traceToProfilesOptions && profilesDataSourceSettings) {\n    const customQuery = traceToProfilesOptions.customQuery ? traceToProfilesOptions.query : undefined;\n    const dataLink: DataLink = {\n      title: RelatedProfilesTitle,\n      url: '',\n      internal: {\n        datasourceUid: profilesDataSourceSettings.uid,\n        datasourceName: profilesDataSourceSettings.name,\n        query: {\n          labelSelector: customQuery ? customQuery : '{${__tags}}',\n          groupBy: [],\n          profileTypeId: traceToProfilesOptions.profileTypeId ?? '',\n          queryType: 'profile',\n          spanSelector: ['${__span.tags[\"pyroscope.profile.id\"]}'],\n          refId: 'profile',\n        },\n      },\n      origin: DataLinkConfigOrigin.Datasource,\n    };\n\n    frame.fields.forEach((field: Field) => {\n      if (field.name === 'tags') {\n        field.config.links = [dataLink];\n      }\n    });\n  }\n\n  let data = [...response.data];\n  if (nodeGraph) {\n    data.push(...createGraphFrames(toDataFrame(frame)));\n  }\n\n  return {\n    ...response,\n    data,\n  };\n}\n\nfunction transformToTraceData(data: TraceSearchMetadata) {\n  return {\n    traceID: data.traceID,\n    startTime: parseInt(data.startTimeUnixNano!, 10) / 1000000,\n    traceDuration: data.durationMs || '<1ms',\n    traceService: data.rootServiceName || '',\n    traceName: data.rootTraceName || '',\n  };\n}\n\nconst metricsValueToString = (value: ProtoValue): string => {\n  if (value.stringValue) {\n    return `\"${value.stringValue}\"`;\n  }\n  return '' + (value.intValue || value.doubleValue || value.boolValue || '\"\"');\n};\n\nexport function formatTraceQLMetrics(query: string, data: TraceqlMetricsResponse) {\n  const frames = data.series.map((series, index) => {\n    const labels: Labels = {};\n    series.labels?.forEach((label) => {\n      labels[label.key] = metricsValueToString(label.value);\n    });\n    // If it's a single series, use the query as the displayName fallback\n    let name = data.series.length === 1 ? query : '';\n    if (series.labels) {\n      if (series.labels.length === 1) {\n        // For single label series, use the label value as the displayName to improve readability\n        name = metricsValueToString(series.labels[0].value);\n      } else {\n        // otherwise build a string using the label keys and values\n        name = `{${series.labels.map((label) => `${label.key}=${metricsValueToString(label.value)}`).join(', ')}}`;\n      }\n    }\n    return createDataFrame({\n      refId: name || `A${index}`,\n      fields: [\n        {\n          name: 'time',\n          type: FieldType.time,\n          values: series.samples.map((sample) => parseInt(sample.timestampMs, 10)),\n        },\n        {\n          name: name,\n          labels,\n          type: FieldType.number,\n          values: series.samples.map((sample) => sample.value),\n          config: {\n            displayNameFromDS: name,\n          },\n        },\n      ],\n      meta: {\n        preferredVisualisationType: 'graph',\n      },\n    });\n  });\n  return frames;\n}\n\nexport function formatTraceQLResponse(\n  data: TraceSearchMetadata[],\n  instanceSettings: DataSourceInstanceSettings,\n  tableType?: SearchTableType\n) {\n  if (tableType === SearchTableType.Spans) {\n    return createTableFrameFromTraceQlQueryAsSpans(data, instanceSettings);\n  }\n  return createTableFrameFromTraceQlQuery(data, instanceSettings);\n}\n\n/**\n * Create data frame while adding spans for each trace into a subtable.\n * @param data\n * @param instanceSettings\n */\nexport function createTableFrameFromTraceQlQuery(\n  data: TraceSearchMetadata[],\n  instanceSettings: DataSourceInstanceSettings\n): DataFrame[] {\n  const frame = createDataFrame({\n    name: 'Traces',\n    refId: 'traces',\n    fields: [\n      {\n        name: 'traceID',\n        type: FieldType.string,\n        config: {\n          unit: 'string',\n          displayNameFromDS: 'Trace ID',\n          custom: {\n            width: 200,\n          },\n          links: [\n            {\n              title: 'Trace: ${__value.raw}',\n              url: '',\n              internal: {\n                datasourceUid: instanceSettings.uid,\n                datasourceName: instanceSettings.name,\n                query: {\n                  query: '${__value.raw}',\n                  queryType: 'traceql',\n                },\n              },\n            },\n          ],\n        },\n      },\n      {\n        name: 'startTime',\n        type: FieldType.time,\n        config: {\n          displayNameFromDS: 'Start time',\n          custom: {\n            width: 200,\n          },\n        },\n      },\n      { name: 'traceService', type: FieldType.string, config: { displayNameFromDS: 'Service' } },\n      { name: 'traceName', type: FieldType.string, config: { displayNameFromDS: 'Name' } },\n      {\n        name: 'traceDuration',\n        type: FieldType.number,\n        config: {\n          displayNameFromDS: 'Duration',\n          unit: 'ms',\n          custom: {\n            width: 120,\n          },\n        },\n      },\n      {\n        name: 'nested',\n        type: FieldType.nestedFrames,\n      },\n    ],\n    meta: {\n      preferredVisualisationType: 'table',\n      uniqueRowIdFields: [0],\n    },\n  });\n\n  if (!data?.length) {\n    return [frame];\n  }\n  frame.length = data.length;\n\n  data\n    // Show the most recent traces\n    .sort((a, b) => parseInt(b?.startTimeUnixNano!, 10) / 1000000 - parseInt(a?.startTimeUnixNano!, 10) / 1000000)\n    .forEach((trace) => {\n      const traceData: TraceTableData = transformToTraceData(trace);\n      frame.fields[0].values.push(traceData.traceID);\n      frame.fields[1].values.push(traceData.startTime);\n      frame.fields[2].values.push(traceData.traceService);\n      frame.fields[3].values.push(traceData.traceName);\n      frame.fields[4].values.push(traceData.traceDuration);\n\n      if (trace.spanSets) {\n        frame.fields[5].values.push(\n          trace.spanSets.map((spanSet: Spanset) => {\n            return traceSubFrame(trace, spanSet, instanceSettings);\n          })\n        );\n      } else if (trace.spanSet) {\n        frame.fields[5].values.push([traceSubFrame(trace, trace.spanSet, instanceSettings)]);\n      }\n    });\n\n  return [frame];\n}\n\nexport function createTableFrameFromTraceQlQueryAsSpans(\n  data: TraceSearchMetadata[] | undefined,\n  instanceSettings: DataSourceInstanceSettings\n): DataFrame[] {\n  const spanDynamicAttrs: Record<string, FieldDTO> = {};\n  let hasNameAttribute = false;\n\n  data?.forEach((trace) =>\n    getSpanSets(trace).forEach((ss) => {\n      ss.attributes?.forEach((attr) => {\n        spanDynamicAttrs[attr.key] = {\n          name: attr.key,\n          type: FieldType.string,\n          config: { displayNameFromDS: attr.key },\n        };\n      });\n      ss.spans.forEach((span) => {\n        if (span.name) {\n          hasNameAttribute = true;\n        }\n        span.attributes?.forEach((attr) => {\n          spanDynamicAttrs[attr.key] = {\n            name: attr.key,\n            type: FieldType.string,\n            config: { displayNameFromDS: attr.key },\n          };\n        });\n      });\n    })\n  );\n\n  const frame = new MutableDataFrame({\n    name: 'Spans',\n    refId: 'traces',\n    fields: [\n      {\n        name: 'traceIdHidden',\n        type: FieldType.string,\n        config: {\n          custom: { hidden: true },\n        },\n      },\n      {\n        name: 'traceService',\n        type: FieldType.string,\n        config: {\n          displayNameFromDS: 'Trace Service',\n          custom: {\n            width: 200,\n          },\n        },\n      },\n      {\n        name: 'traceName',\n        type: FieldType.string,\n        config: {\n          displayNameFromDS: 'Trace Name',\n          custom: {\n            width: 200,\n          },\n        },\n      },\n      {\n        name: 'spanID',\n        type: FieldType.string,\n        config: {\n          unit: 'string',\n          displayNameFromDS: 'Span ID',\n          custom: {\n            width: 200,\n          },\n          links: [\n            {\n              title: 'Span: ${__value.raw}',\n              url: '',\n              internal: {\n                datasourceUid: instanceSettings.uid,\n                datasourceName: instanceSettings.name,\n                query: {\n                  query: '${__data.fields.traceIdHidden}',\n                  queryType: 'traceql',\n                },\n                panelsState: {\n                  trace: {\n                    spanId: '${__value.raw}',\n                  },\n                },\n              },\n            },\n          ],\n        },\n      },\n      {\n        name: 'time',\n        type: FieldType.time,\n        config: {\n          displayNameFromDS: 'Start time',\n        },\n      },\n      {\n        name: 'name',\n        type: FieldType.string,\n        config: { displayNameFromDS: 'Name', custom: { hidden: !hasNameAttribute } },\n      },\n      ...Object.values(spanDynamicAttrs).sort((a, b) => a.name.localeCompare(b.name)),\n      {\n        name: 'duration',\n        type: FieldType.number,\n        config: {\n          displayNameFromDS: 'Duration',\n          unit: 'ns',\n          custom: {\n            width: 120,\n          },\n        },\n      },\n    ],\n    meta: {\n      preferredVisualisationType: 'table',\n    },\n  });\n\n  if (!data || !data.length) {\n    return [frame];\n  }\n\n  data\n    // Show the most recent traces\n    .sort((a, b) => parseInt(b?.startTimeUnixNano!, 10) / 1000000 - parseInt(a?.startTimeUnixNano!, 10) / 1000000)\n    .forEach((trace) => {\n      getSpanSets(trace).forEach((spanSet) => {\n        spanSet.spans.forEach((span) => {\n          frame.add(transformSpanToTraceData(span, spanSet, trace));\n        });\n      });\n    });\n\n  return [frame];\n}\n\n/**\n * Get the spansets of a trace.\n *\n * Field `spanSets` is preferred to `spanSet` since the latter is deprecated in Tempo, but we\n * support both for backward compatibility.\n *\n * @param trace a trace\n * @returns the spansets of the trace, if existing\n */\nconst getSpanSets = (trace: TraceSearchMetadata): Spanset[] => {\n  return trace.spanSets || (trace.spanSet ? [trace.spanSet] : []);\n};\n\nconst traceSubFrame = (\n  trace: TraceSearchMetadata,\n  spanSet: Spanset,\n  instanceSettings: DataSourceInstanceSettings\n): DataFrame => {\n  const spanDynamicAttrs: Record<string, FieldDTO> = {};\n  let hasNameAttribute = false;\n\n  spanSet.attributes?.map((attr) => {\n    spanDynamicAttrs[attr.key] = {\n      name: attr.key,\n      type: FieldType.string,\n      config: { displayNameFromDS: attr.key },\n      values: [],\n    };\n  });\n  spanSet.spans.forEach((span) => {\n    if (span.name) {\n      hasNameAttribute = true;\n    }\n    span.attributes?.forEach((attr) => {\n      spanDynamicAttrs[attr.key] = {\n        name: attr.key,\n        type: FieldType.string,\n        config: { displayNameFromDS: attr.key },\n        values: [],\n      };\n    });\n  });\n\n  const subFrame = new MutableDataFrame({\n    fields: [\n      {\n        name: 'traceIdHidden',\n        type: FieldType.string,\n        config: {\n          custom: { hidden: true },\n        },\n        values: [],\n      },\n      {\n        name: 'spanID',\n        type: FieldType.string,\n        values: [],\n        config: {\n          unit: 'string',\n          displayNameFromDS: 'Span ID',\n          custom: {\n            width: 200,\n          },\n          links: [\n            {\n              title: 'Span: ${__value.raw}',\n              url: '',\n              internal: {\n                datasourceUid: instanceSettings.uid,\n                datasourceName: instanceSettings.name,\n                query: {\n                  query: '${__data.fields.traceIdHidden}',\n                  queryType: 'traceql',\n                },\n                panelsState: {\n                  trace: {\n                    spanId: '${__value.raw}',\n                  },\n                },\n              },\n            },\n          ],\n        },\n      },\n      {\n        name: 'time',\n        type: FieldType.time,\n        config: {\n          displayNameFromDS: 'Start time',\n          custom: {\n            width: 200,\n          },\n        },\n      },\n      {\n        name: 'name',\n        type: FieldType.string,\n        values: [],\n        config: { displayNameFromDS: 'Name', custom: { hidden: !hasNameAttribute } },\n      },\n      ...Object.values(spanDynamicAttrs).sort((a, b) => a.name.localeCompare(b.name)),\n      {\n        name: 'duration',\n        type: FieldType.number,\n        values: [],\n        config: {\n          displayNameFromDS: 'Duration',\n          unit: 'ns',\n          custom: {\n            width: 120,\n          },\n        },\n      },\n    ],\n    meta: {\n      preferredVisualisationType: 'table',\n    },\n  });\n\n  // TODO: this should be done in `applyFieldOverrides` instead recursively for the nested `DataFrames`\n  const theme = createTheme();\n  for (const field of subFrame.fields) {\n    field.display = getDisplayProcessor({ field, theme });\n  }\n\n  spanSet.spans.forEach((span) => {\n    subFrame.add(transformSpanToTraceData(span, spanSet, trace));\n  });\n\n  return subFrame;\n};\n\ninterface TraceTableData {\n  [key: string]: string | number | boolean | undefined; // dynamic attribute name\n  traceID?: string;\n  spanID?: string;\n  startTime?: number;\n  name?: string;\n  traceDuration?: number | string;\n}\n\nfunction transformSpanToTraceData(span: Span, spanSet: Spanset, trace: TraceSearchMetadata): TraceTableData {\n  const spanStartTimeUnixMs = parseInt(span.startTimeUnixNano, 10) / 1000000;\n\n  const data: TraceTableData = {\n    traceIdHidden: trace.traceID,\n    traceService: trace.rootServiceName || '',\n    traceName: trace.rootTraceName || '',\n    spanID: span.spanID,\n    time: spanStartTimeUnixMs,\n    duration: parseInt(span.durationNanos, 10),\n    name: span.name,\n  };\n\n  let attrs: SpanAttributes[] = [];\n  if (spanSet.attributes) {\n    attrs = attrs.concat(spanSet.attributes);\n  }\n  if (span.attributes) {\n    attrs = attrs.concat(span.attributes);\n  }\n\n  attrs.forEach((attr) => {\n    if (attr.value.boolValue || attr.value.Value?.bool_value) {\n      data[attr.key] = attr.value.boolValue || attr.value.Value?.bool_value;\n    }\n    if (attr.value.doubleValue || attr.value.Value?.double_value) {\n      data[attr.key] = attr.value.doubleValue || attr.value.Value?.double_value;\n    }\n    if (attr.value.intValue || attr.value.Value?.int_value) {\n      data[attr.key] = attr.value.intValue || attr.value.Value?.int_value;\n    }\n    if (attr.value.stringValue || attr.value.Value?.string_value) {\n      data[attr.key] = attr.value.stringValue || attr.value.Value?.string_value;\n    }\n  });\n\n  return data;\n}\n\nconst emptyDataQueryResponse = {\n  data: [\n    new MutableDataFrame({\n      fields: [\n        {\n          name: 'trace',\n          type: FieldType.trace,\n          values: [],\n        },\n      ],\n      meta: {\n        preferredVisualisationType: 'trace',\n        custom: {\n          traceFormat: 'otlp',\n        },\n      },\n    }),\n  ],\n};\n","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;","import { capitalize } from 'lodash';\nimport { map, Observable, takeWhile } from 'rxjs';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport {\n  DataFrame,\n  DataQueryRequest,\n  DataQueryResponse,\n  DataSourceInstanceSettings,\n  FieldType,\n  LiveChannelScope,\n  LoadingState,\n  MutableDataFrame,\n  ThresholdsConfig,\n  ThresholdsMode,\n} from '@grafana/data';\nimport { getGrafanaLiveSrv } from '@grafana/runtime';\n\nimport { SearchStreamingState } from './dataquery.gen';\nimport { DEFAULT_SPSS, TempoDatasource } from './datasource';\nimport { formatTraceQLResponse } from './resultTransformer';\nimport { SearchMetrics, TempoJsonData, TempoQuery } from './types';\nfunction getLiveStreamKey(): string {\n  return uuidv4();\n}\n\nexport function doTempoChannelStream(\n  query: TempoQuery,\n  ds: TempoDatasource,\n  options: DataQueryRequest<TempoQuery>,\n  instanceSettings: DataSourceInstanceSettings<TempoJsonData>\n): Observable<DataQueryResponse> {\n  const range = options.range;\n\n  let frames: DataFrame[] | undefined = undefined;\n  let state: LoadingState = LoadingState.NotStarted;\n  const requestTime = performance.now();\n\n  return getGrafanaLiveSrv()\n    .getStream<MutableDataFrame>({\n      scope: LiveChannelScope.DataSource,\n      namespace: ds.uid,\n      path: `search/${getLiveStreamKey()}`,\n      data: {\n        ...query,\n        SpansPerSpanSet: query.spss ?? DEFAULT_SPSS,\n        timeRange: {\n          from: range.from.toISOString(),\n          to: range.to.toISOString(),\n        },\n      },\n    })\n    .pipe(\n      takeWhile((evt) => {\n        if ('message' in evt && evt?.message) {\n          const frameState: SearchStreamingState = evt.message.data.values[2][0];\n          if (frameState === SearchStreamingState.Done || frameState === SearchStreamingState.Error) {\n            return false;\n          }\n        }\n        return true;\n      }, true)\n    )\n    .pipe(\n      map((evt) => {\n        if ('message' in evt && evt?.message) {\n          const currentTime = performance.now();\n          const elapsedTime = currentTime - requestTime;\n          // Schema should be [traces, metrics, state, error]\n          const traces = evt.message.data.values[0][0];\n          const metrics = evt.message.data.values[1][0];\n          const frameState: SearchStreamingState = evt.message.data.values[2][0];\n          const error = evt.message.data.values[3][0];\n\n          switch (frameState) {\n            case SearchStreamingState.Done:\n              state = LoadingState.Done;\n              break;\n            case SearchStreamingState.Streaming:\n              state = LoadingState.Streaming;\n              break;\n            case SearchStreamingState.Error:\n              throw new Error(error);\n          }\n\n          frames = [\n            metricsDataFrame(metrics, frameState, elapsedTime),\n            ...formatTraceQLResponse(traces, instanceSettings, query.tableType),\n          ];\n        }\n        return {\n          data: frames || [],\n          state,\n        };\n      })\n    );\n}\n\nfunction metricsDataFrame(metrics: SearchMetrics, state: SearchStreamingState, elapsedTime: number) {\n  const progressThresholds: ThresholdsConfig = {\n    steps: [\n      {\n        color: 'blue',\n        value: -Infinity,\n      },\n      {\n        color: 'green',\n        value: 75,\n      },\n    ],\n    mode: ThresholdsMode.Absolute,\n  };\n\n  const frame: DataFrame = {\n    refId: 'streaming-progress',\n    name: 'Streaming Progress',\n    length: 1,\n    fields: [\n      {\n        name: 'state',\n        type: FieldType.string,\n        values: [capitalize(state.toString())],\n        config: {\n          displayNameFromDS: 'State',\n        },\n      },\n      {\n        name: 'elapsedTime',\n        type: FieldType.number,\n        values: [elapsedTime],\n        config: {\n          unit: 'ms',\n          displayNameFromDS: 'Elapsed Time',\n        },\n      },\n      {\n        name: 'totalBlocks',\n        type: FieldType.number,\n        values: [metrics.totalBlocks],\n        config: {\n          displayNameFromDS: 'Total Blocks',\n        },\n      },\n      {\n        name: 'completedJobs',\n        type: FieldType.number,\n        values: [metrics.completedJobs],\n        config: {\n          displayNameFromDS: 'Completed Jobs',\n        },\n      },\n      {\n        name: 'totalJobs',\n        type: FieldType.number,\n        values: [metrics.totalJobs],\n        config: {\n          displayNameFromDS: 'Total Jobs',\n        },\n      },\n      {\n        name: 'progress',\n        type: FieldType.number,\n        values: [\n          state === SearchStreamingState.Done ? 100 : ((metrics.completedJobs || 0) / (metrics.totalJobs || 1)) * 100,\n        ],\n        config: {\n          displayNameFromDS: 'Progress',\n          unit: 'percent',\n          min: 0,\n          max: 100,\n          custom: {\n            cellOptions: {\n              type: 'gauge',\n              mode: 'gradient',\n            },\n          },\n          thresholds: progressThresholds,\n        },\n      },\n    ],\n    meta: {\n      preferredVisualisationType: 'table',\n    },\n  };\n  return frame;\n}\n","import { cx, css } from '@emotion/css';\nimport { useStyles2, Button } from '@grafana/ui';\nimport React__default from 'react';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nconst AccessoryButton = (_a) => {\n  var _b = _a, { className } = _b, props = __objRest(_b, [\"className\"]);\n  const styles = useStyles2(getButtonStyles);\n  return /* @__PURE__ */ React__default.createElement(Button, __spreadProps(__spreadValues({}, props), { className: cx(className, styles.button) }));\n};\nconst getButtonStyles = (theme) => ({\n  button: css({\n    paddingLeft: theme.spacing(3 / 2),\n    paddingRight: theme.spacing(3 / 2)\n  })\n});\n\nexport { AccessoryButton };\n//# sourceMappingURL=AccessoryButton.js.map\n","import { css } from '@emotion/css';\nimport { uniq } from 'lodash';\nimport React, { useState, useEffect, useMemo } from 'react';\nimport useAsync from 'react-use/lib/useAsync';\n\nimport { SelectableValue } from '@grafana/data';\nimport { TemporaryAlert } from '@grafana/o11y-ds-frontend';\nimport { FetchError, getTemplateSrv, isFetchError } from '@grafana/runtime';\nimport { Select, HorizontalGroup, useStyles2 } from '@grafana/ui';\n\nimport { TraceqlFilter, TraceqlSearchScope } from '../dataquery.gen';\nimport { TempoDatasource } from '../datasource';\nimport { operators as allOperators, stringOperators, numberOperators, keywordOperators } from '../traceql/traceql';\n\nimport { filterScopedTag, operatorSelectableValue } from './utils';\n\nconst getStyles = () => ({\n  dropdown: css({\n    boxShadow: 'none',\n  }),\n});\n\ninterface Props {\n  filter: TraceqlFilter;\n  datasource: TempoDatasource;\n  updateFilter: (f: TraceqlFilter) => void;\n  deleteFilter?: (f: TraceqlFilter) => void;\n  setError: (error: FetchError | null) => void;\n  isTagsLoading?: boolean;\n  tags: string[];\n  hideScope?: boolean;\n  hideTag?: boolean;\n  hideValue?: boolean;\n  query: string;\n  isMulti?: boolean;\n  allowCustomValue?: boolean;\n}\nconst SearchField = ({\n  filter,\n  datasource,\n  updateFilter,\n  isTagsLoading,\n  tags,\n  setError,\n  hideScope,\n  hideTag,\n  hideValue,\n  query,\n  isMulti = true,\n  allowCustomValue = true,\n}: Props) => {\n  const styles = useStyles2(getStyles);\n  const [alertText, setAlertText] = useState<string>();\n  const scopedTag = useMemo(() => filterScopedTag(filter), [filter]);\n  // We automatically change the operator to the regex op when users select 2 or more values\n  // However, they expect this to be automatically rolled back to the previous operator once\n  // there's only one value selected, so we store the previous operator and value\n  const [prevOperator, setPrevOperator] = useState(filter.operator);\n  const [prevValue, setPrevValue] = useState(filter.value);\n\n  const updateOptions = async () => {\n    try {\n      const result = filter.tag ? await datasource.languageProvider.getOptionsV2(scopedTag, query) : [];\n      setAlertText(undefined);\n      setError(null);\n      return result;\n    } catch (error) {\n      // Display message if Tempo is connected but search 404's\n      if (isFetchError(error) && error?.status === 404) {\n        setError(error);\n      } else if (error instanceof Error) {\n        setAlertText(`Error: ${error.message}`);\n      }\n    }\n    return [];\n  };\n\n  const { loading: isLoadingValues, value: options } = useAsync(updateOptions, [\n    scopedTag,\n    datasource.languageProvider,\n    setError,\n    query,\n  ]);\n\n  // Add selected option if it doesn't exist in the current list of options\n  if (filter.value && !Array.isArray(filter.value) && options && !options.find((o) => o.value === filter.value)) {\n    options.push({ label: filter.value.toString(), value: filter.value.toString(), type: filter.valueType });\n  }\n\n  useEffect(() => {\n    if (\n      Array.isArray(filter.value) &&\n      filter.value.length > 1 &&\n      filter.operator !== '=~' &&\n      filter.operator !== '!~'\n    ) {\n      setPrevOperator(filter.operator);\n      updateFilter({ ...filter, operator: '=~' });\n    }\n    if (Array.isArray(filter.value) && filter.value.length <= 1 && (prevValue?.length || 0) > 1) {\n      updateFilter({ ...filter, operator: prevOperator, value: filter.value[0] });\n    }\n  }, [prevValue, prevOperator, updateFilter, filter]);\n\n  useEffect(() => {\n    setPrevValue(filter.value);\n  }, [filter.value]);\n\n  const scopeOptions = Object.values(TraceqlSearchScope)\n    .filter((s) => s !== TraceqlSearchScope.Intrinsic)\n    .map((t) => ({ label: t, value: t }));\n\n  // If all values have type string or int/float use a focused list of operators instead of all operators\n  const optionsOfFirstType = options?.filter((o) => o.type === options[0]?.type);\n  const uniqueOptionType = options?.length === optionsOfFirstType?.length ? options?.[0]?.type : undefined;\n  let operatorList = allOperators;\n  switch (uniqueOptionType) {\n    case 'keyword':\n      operatorList = keywordOperators;\n      break;\n    case 'string':\n      operatorList = stringOperators;\n      break;\n    case 'int':\n    case 'float':\n      operatorList = numberOperators;\n  }\n\n  /**\n   * Add to a list of options the current template variables.\n   *\n   * @param options a list of options\n   * @returns the list of given options plus the template variables\n   */\n  const withTemplateVariableOptions = (options: SelectableValue[] | undefined) => {\n    const templateVariables = getTemplateSrv().getVariables();\n    return [...(options || []), ...templateVariables.map((v) => ({ label: `$${v.name}`, value: `$${v.name}` }))];\n  };\n\n  return (\n    <>\n      <HorizontalGroup spacing={'none'} width={'auto'}>\n        {!hideScope && (\n          <Select\n            className={styles.dropdown}\n            inputId={`${filter.id}-scope`}\n            options={withTemplateVariableOptions(scopeOptions)}\n            value={filter.scope}\n            onChange={(v) => {\n              updateFilter({ ...filter, scope: v?.value });\n            }}\n            placeholder=\"Select scope\"\n            aria-label={`select ${filter.id} scope`}\n          />\n        )}\n        {!hideTag && (\n          <Select\n            className={styles.dropdown}\n            inputId={`${filter.id}-tag`}\n            isLoading={isTagsLoading}\n            // Add the current tag to the list if it doesn't exist in the tags prop, otherwise the field will be empty even though the state has a value\n            options={withTemplateVariableOptions(\n              (filter.tag !== undefined ? uniq([filter.tag, ...tags]) : tags).map((t) => ({\n                label: t,\n                value: t,\n              }))\n            )}\n            value={filter.tag}\n            onChange={(v) => {\n              updateFilter({ ...filter, tag: v?.value, value: [] });\n            }}\n            placeholder=\"Select tag\"\n            isClearable\n            aria-label={`select ${filter.id} tag`}\n            allowCustomValue={true}\n          />\n        )}\n        <Select\n          className={styles.dropdown}\n          inputId={`${filter.id}-operator`}\n          options={withTemplateVariableOptions(operatorList.map(operatorSelectableValue))}\n          value={filter.operator}\n          onChange={(v) => {\n            updateFilter({ ...filter, operator: v?.value });\n          }}\n          isClearable={false}\n          aria-label={`select ${filter.id} operator`}\n          allowCustomValue={true}\n          width={8}\n        />\n        {!hideValue && (\n          <Select\n            className={styles.dropdown}\n            inputId={`${filter.id}-value`}\n            isLoading={isLoadingValues}\n            options={withTemplateVariableOptions(options)}\n            value={filter.value}\n            onChange={(val) => {\n              if (Array.isArray(val)) {\n                updateFilter({\n                  ...filter,\n                  value: val.map((v) => v.value),\n                  valueType: val[0]?.type || uniqueOptionType,\n                });\n              } else {\n                updateFilter({ ...filter, value: val?.value, valueType: val?.type || uniqueOptionType });\n              }\n            }}\n            placeholder=\"Select value\"\n            isClearable={true}\n            aria-label={`select ${filter.id} value`}\n            allowCustomValue={allowCustomValue}\n            isMulti={isMulti}\n            allowCreateWhileLoading\n          />\n        )}\n      </HorizontalGroup>\n      {alertText && <TemporaryAlert severity=\"error\" text={alertText} />}\n    </>\n  );\n};\n\nexport default SearchField;\n","import { css } from '@emotion/css';\nimport React, { useCallback, useEffect } from 'react';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { AccessoryButton } from '@grafana/experimental';\nimport { FetchError } from '@grafana/runtime';\nimport { useStyles2 } from '@grafana/ui';\n\nimport { TraceqlFilter, TraceqlSearchScope } from '../dataquery.gen';\nimport { TempoDatasource } from '../datasource';\n\nimport SearchField from './SearchField';\nimport { getFilteredTags } from './utils';\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  vertical: css({\n    display: 'flex',\n    flexDirection: 'column',\n    gap: theme.spacing(0.25),\n  }),\n  horizontal: css({\n    display: 'flex',\n    flexDirection: 'row',\n    gap: theme.spacing(1),\n  }),\n  addTag: css({\n    marginLeft: theme.spacing(1),\n  }),\n});\n\ninterface Props {\n  updateFilter: (f: TraceqlFilter) => void;\n  deleteFilter: (f: TraceqlFilter) => void;\n  filters: TraceqlFilter[];\n  datasource: TempoDatasource;\n  setError: (error: FetchError | null) => void;\n  staticTags: Array<string | undefined>;\n  isTagsLoading: boolean;\n  hideValues?: boolean;\n  requireTagAndValue?: boolean;\n  query: string;\n}\nconst TagsInput = ({\n  updateFilter,\n  deleteFilter,\n  filters,\n  datasource,\n  setError,\n  staticTags,\n  isTagsLoading,\n  hideValues,\n  requireTagAndValue,\n  query,\n}: Props) => {\n  const styles = useStyles2(getStyles);\n  const handleOnAdd = useCallback(\n    () => updateFilter({ id: generateId(), operator: '=', scope: TraceqlSearchScope.Span }),\n    [updateFilter]\n  );\n\n  useEffect(() => {\n    if (!filters?.length) {\n      handleOnAdd();\n    }\n  }, [filters, handleOnAdd]);\n\n  const getTags = (f: TraceqlFilter) => {\n    const tags = datasource.languageProvider.getTags(f.scope);\n    return getFilteredTags(tags, staticTags);\n  };\n\n  const validInput = (f: TraceqlFilter) => {\n    // If value is removed from the filter, it can be set as an empty array\n    return requireTagAndValue ? f.tag && f.value && f.value.length > 0 : f.tag;\n  };\n\n  return (\n    <div className={styles.vertical}>\n      {filters?.map((f, i) => (\n        <div className={styles.horizontal} key={f.id}>\n          <SearchField\n            filter={f}\n            datasource={datasource}\n            setError={setError}\n            updateFilter={updateFilter}\n            tags={getTags(f)}\n            isTagsLoading={isTagsLoading}\n            hideValue={hideValues}\n            query={query}\n          />\n          {(validInput(f) || filters.length > 1) && (\n            <AccessoryButton\n              aria-label={`Remove tag with ID ${f.id}`}\n              variant={'secondary'}\n              icon={'times'}\n              onClick={() => deleteFilter?.(f)}\n              tooltip={'Remove tag'}\n            />\n          )}\n          {validInput(f) && i === filters.length - 1 && (\n            <span className={styles.addTag}>\n              <AccessoryButton\n                aria-label=\"Add tag\"\n                variant={'secondary'}\n                icon={'plus'}\n                onClick={handleOnAdd}\n                tooltip={'Add tag'}\n              />\n            </span>\n          )}\n        </div>\n      ))}\n    </div>\n  );\n};\n\nexport default TagsInput;\n\nexport const generateId = () => uuidv4().slice(0, 8);\n","import { DataSourceApi } from '@grafana/data';\nimport { getDataSourceSrv } from '@grafana/runtime';\n\nimport { generateId } from './SearchTraceQLEditor/TagsInput';\nimport { TraceqlFilter, TraceqlSearchScope } from './dataquery.gen';\nimport { TempoQuery } from './types';\n\nexport const getErrorMessage = (message: string | undefined, prefix?: string) => {\n  const err = message ? ` (${message})` : '';\n  let errPrefix = prefix ? prefix : 'Error';\n  return `${errPrefix}${err}. Please check the server logs for more details.`;\n};\n\nexport async function getDS(uid?: string): Promise<DataSourceApi | undefined> {\n  if (!uid) {\n    return undefined;\n  }\n\n  const dsSrv = getDataSourceSrv();\n  try {\n    return await dsSrv.get(uid);\n  } catch (error) {\n    console.error('Failed to load data source', error);\n    return undefined;\n  }\n}\n\nexport const migrateFromSearchToTraceQLSearch = (query: TempoQuery) => {\n  let filters: TraceqlFilter[] = [];\n  if (query.spanName) {\n    filters.push({\n      id: 'span-name',\n      scope: TraceqlSearchScope.Span,\n      tag: 'name',\n      operator: '=',\n      value: [query.spanName],\n      valueType: 'string',\n    });\n  }\n  if (query.serviceName) {\n    filters.push({\n      id: 'service-name',\n      scope: TraceqlSearchScope.Resource,\n      tag: 'service.name',\n      operator: '=',\n      value: [query.serviceName],\n      valueType: 'string',\n    });\n  }\n  if (query.minDuration || query.maxDuration) {\n    filters.push({\n      id: 'duration-type',\n      value: 'trace',\n    });\n  }\n  if (query.minDuration) {\n    filters.push({\n      id: 'min-duration',\n      tag: 'duration',\n      operator: '>',\n      value: [query.minDuration],\n      valueType: 'duration',\n    });\n  }\n  if (query.maxDuration) {\n    filters.push({\n      id: 'max-duration',\n      tag: 'duration',\n      operator: '<',\n      value: [query.maxDuration],\n      valueType: 'duration',\n    });\n  }\n  if (query.search) {\n    const tags = query.search.split(' ');\n    for (const tag of tags) {\n      const [key, value] = tag.split('=');\n      if (key && value) {\n        filters.push({\n          id: generateId(),\n          scope: TraceqlSearchScope.Unscoped,\n          tag: key,\n          operator: '=',\n          value: [value.replace(/(^\"|\"$)/g, '')], // remove quotes at start and end of string\n          valueType: value.startsWith('\"') && value.endsWith('\"') ? 'string' : undefined,\n        });\n      }\n    }\n  }\n\n  const migratedQuery: TempoQuery = {\n    datasource: query.datasource,\n    filters,\n    groupBy: query.groupBy,\n    limit: query.limit,\n    query: query.query,\n    queryType: 'traceqlSearch',\n    refId: query.refId,\n  };\n  return migratedQuery;\n};\n","import { from, Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nimport { DataQueryRequest, CustomVariableSupport, MetricFindValue } from '@grafana/data';\n\nimport { TempoVariableQuery, TempoVariableQueryEditor } from './VariableQueryEditor';\nimport { TempoDatasource } from './datasource';\n\nexport class TempoVariableSupport extends CustomVariableSupport<TempoDatasource, TempoVariableQuery> {\n  editor = TempoVariableQueryEditor;\n\n  constructor(private datasource: TempoDatasource) {\n    super();\n  }\n\n  query(request: DataQueryRequest<TempoVariableQuery>): Observable<{ data: MetricFindValue[] }> {\n    if (!this.datasource) {\n      throw new Error('Datasource not initialized');\n    }\n\n    const result = this.datasource.executeVariableQuery(request.targets[0]);\n    return from(result).pipe(map((data) => ({ data })));\n  }\n}\n","import { groupBy, startCase } from 'lodash';\nimport { EMPTY, from, lastValueFrom, merge, Observable, of } from 'rxjs';\nimport { catchError, concatMap, map, mergeMap, toArray } from 'rxjs/operators';\nimport semver from 'semver';\n\nimport {\n  CoreApp,\n  DataFrame,\n  DataFrameDTO,\n  DataQueryRequest,\n  DataQueryResponse,\n  DataQueryResponseData,\n  DataSourceGetTagValuesOptions,\n  DataSourceInstanceSettings,\n  dateTime,\n  FieldType,\n  LoadingState,\n  rangeUtil,\n  ScopedVars,\n  SelectableValue,\n  TestDataSourceResponse,\n  urlUtil,\n} from '@grafana/data';\nimport { NodeGraphOptions, SpanBarOptions, TraceToLogsOptions } from '@grafana/o11y-ds-frontend';\nimport {\n  BackendSrvRequest,\n  config,\n  DataSourceWithBackend,\n  getBackendSrv,\n  getDataSourceSrv,\n  getTemplateSrv,\n  reportInteraction,\n  TemplateSrv,\n} from '@grafana/runtime';\nimport { BarGaugeDisplayMode, TableCellDisplayMode, VariableFormatID } from '@grafana/schema';\n\nimport { generateQueryFromFilters } from './SearchTraceQLEditor/utils';\nimport { TempoVariableQuery, TempoVariableQueryType } from './VariableQueryEditor';\nimport { PrometheusDatasource, PromQuery } from './_importedDependencies/datasources/prometheus/types';\nimport { TraceqlFilter, TraceqlSearchScope } from './dataquery.gen';\nimport {\n  defaultTableFilter,\n  durationMetric,\n  errorRateMetric,\n  failedMetric,\n  histogramMetric,\n  mapPromMetricsToServiceMap,\n  rateMetric,\n  serviceMapMetrics,\n  totalsMetric,\n} from './graphTransform';\nimport TempoLanguageProvider from './language_provider';\nimport { createTableFrameFromMetricsSummaryQuery, emptyResponse, MetricsSummary } from './metricsSummary';\nimport {\n  formatTraceQLMetrics,\n  formatTraceQLResponse,\n  transformFromOTLP as transformFromOTEL,\n  transformTrace,\n} from './resultTransformer';\nimport { doTempoChannelStream } from './streaming';\nimport { TempoJsonData, TempoQuery } from './types';\nimport { getErrorMessage, migrateFromSearchToTraceQLSearch } from './utils';\nimport { TempoVariableSupport } from './variables';\n\nexport const DEFAULT_LIMIT = 20;\nexport const DEFAULT_SPSS = 3; // spans per span set\n\nenum FeatureName {\n  streaming = 'streaming',\n}\n\n/* Map, for each feature (e.g., streaming), the minimum Tempo version required to have that\n ** feature available. If the running Tempo instance on the user's backend is older than the\n ** target version, the feature is disabled in Grafana (frontend).\n */\nconst featuresToTempoVersion = {\n  [FeatureName.streaming]: '2.2.0',\n};\n\n// The version that we use as default in case we cannot retrieve it from the backend.\n// This is the last minor version of Tempo that does not expose the endpoint for build information.\nconst defaultTempoVersion = '2.1.0';\n\ninterface ServiceMapQueryResponse {\n  nodes: DataFrame;\n  edges: DataFrame;\n}\n\ninterface ServiceMapQueryResponseWithRates {\n  rates: Array<DataFrame | DataFrameDTO>;\n  nodes: DataFrame;\n  edges: DataFrame;\n}\n\nexport class TempoDatasource extends DataSourceWithBackend<TempoQuery, TempoJsonData> {\n  tracesToLogs?: TraceToLogsOptions;\n  serviceMap?: {\n    datasourceUid?: string;\n  };\n  search?: {\n    hide?: boolean;\n    filters?: TraceqlFilter[];\n  };\n  nodeGraph?: NodeGraphOptions;\n  traceQuery?: {\n    timeShiftEnabled?: boolean;\n    spanStartTimeShift?: string;\n    spanEndTimeShift?: string;\n  };\n  uploadedJson?: string | null = null;\n  spanBar?: SpanBarOptions;\n  languageProvider: TempoLanguageProvider;\n\n  // The version of Tempo running on the backend. `null` if we cannot retrieve it for whatever reason\n  tempoVersion?: string | null;\n\n  constructor(\n    private instanceSettings: DataSourceInstanceSettings<TempoJsonData>,\n    private readonly templateSrv: TemplateSrv = getTemplateSrv()\n  ) {\n    super(instanceSettings);\n\n    this.tracesToLogs = instanceSettings.jsonData.tracesToLogs;\n    this.serviceMap = instanceSettings.jsonData.serviceMap;\n    this.search = instanceSettings.jsonData.search;\n    this.nodeGraph = instanceSettings.jsonData.nodeGraph;\n    this.traceQuery = instanceSettings.jsonData.traceQuery;\n    this.languageProvider = new TempoLanguageProvider(this);\n\n    if (!this.search?.filters) {\n      this.search = {\n        ...this.search,\n        filters: [\n          {\n            id: 'service-name',\n            tag: 'service.name',\n            operator: '=',\n            scope: TraceqlSearchScope.Resource,\n          },\n          { id: 'span-name', tag: 'name', operator: '=', scope: TraceqlSearchScope.Span },\n        ],\n      };\n    }\n\n    this.variables = new TempoVariableSupport(this);\n  }\n\n  async executeVariableQuery(query: TempoVariableQuery) {\n    // Avoid failing if the user did not select the query type (label names, label values, etc.)\n    if (query.type === undefined) {\n      return new Promise<Array<{ text: string }>>(() => []);\n    }\n\n    switch (query.type) {\n      case TempoVariableQueryType.LabelNames: {\n        return await this.labelNamesQuery();\n      }\n      case TempoVariableQueryType.LabelValues: {\n        return this.labelValuesQuery(query.label);\n      }\n      default: {\n        throw Error('Invalid query type: ' + query.type);\n      }\n    }\n  }\n\n  async labelNamesQuery(): Promise<Array<{ text: string }>> {\n    await this.languageProvider.fetchTags();\n    const tags = this.languageProvider.getAutocompleteTags();\n    return tags.filter((tag) => tag !== undefined).map((tag) => ({ text: tag }));\n  }\n\n  async labelValuesQuery(labelName?: string): Promise<Array<{ text: string }>> {\n    if (!labelName) {\n      return [];\n    }\n\n    let options;\n    try {\n      // Retrieve the scope of the tag\n      // Example: given `http.status_code`, we want scope `span`\n      // Note that we ignore possible name clashes, e.g., `http.status_code` in both `span` and `resource`\n      const scope: string | undefined = (this.languageProvider.tagsV2 || [])\n        // flatten the Scope objects\n        .flatMap((tagV2) => tagV2.tags.map((tag) => ({ scope: tagV2.name, name: tag })))\n        // find associated scope\n        .find((tag) => tag.name === labelName)?.scope;\n      if (!scope) {\n        throw Error(`Scope for tag ${labelName} not found`);\n      }\n\n      // For V2, we need to send scope and tag name, e.g. `span.http.status_code`,\n      // unless the tag has intrinsic scope\n      const scopeAndTag = scope === 'intrinsic' ? labelName : `${scope}.${labelName}`;\n      options = await this.languageProvider.getOptionsV2(scopeAndTag);\n    } catch {\n      // For V1, the tag name (e.g. `http.status_code`) is enough\n      options = await this.languageProvider.getOptionsV1(labelName);\n    }\n\n    return options.flatMap((option: SelectableValue<string>) =>\n      option.value !== undefined ? [{ text: option.value }] : []\n    );\n  }\n\n  // Allows to retrieve the list of tags for ad-hoc filters\n  async getTagKeys(): Promise<Array<{ text: string }>> {\n    await this.languageProvider.fetchTags();\n    const tags = this.languageProvider.tagsV2 || [];\n    return tags\n      .map(({ name, tags }) =>\n        tags.filter((tag) => tag !== undefined).map((t) => (name !== 'intrinsic' ? `${name}.${t}` : `${t}`))\n      )\n      .flat()\n      .map((tag) => ({ text: tag }));\n  }\n\n  // Allows to retrieve the list of tag values for ad-hoc filters\n  getTagValues(options: DataSourceGetTagValuesOptions): Promise<Array<{ text: string }>> {\n    return this.labelValuesQuery(options.key.replace(/^(resource|span)\\./, ''));\n  }\n\n  init = async () => {\n    const response = await lastValueFrom(\n      this._request('/api/status/buildinfo').pipe(\n        map((response) => response),\n        catchError((error) => {\n          console.error('Failure in retrieving build information', error.data.message);\n          return of({ error, data: { version: null } }); // unknown version\n        })\n      )\n    );\n    this.tempoVersion = response.data.version;\n  };\n\n  /**\n   * Check, for the given feature, whether it is available in Grafana.\n   *\n   * The check is done based on the version of the Tempo instance running on the backend and\n   * the minimum version required by the given feature to work.\n   *\n   * @param featureName - the name of the feature to consider\n   * @return true if the feature is available, false otherwise\n   */\n  isFeatureAvailable(featureName: FeatureName) {\n    // We know for old Tempo instances we don't know their version, so resort to default\n    const actualVersion = this.tempoVersion ?? defaultTempoVersion;\n\n    try {\n      return semver.gte(actualVersion, featuresToTempoVersion[featureName]);\n    } catch {\n      // We assume we are on a development and recent branch, thus we enable all features\n      return true;\n    }\n  }\n\n  query(options: DataQueryRequest<TempoQuery>): Observable<DataQueryResponse> {\n    const subQueries: Array<Observable<DataQueryResponse>> = [];\n    const filteredTargets = options.targets.filter((target) => !target.hide);\n    const targets: { [type: string]: TempoQuery[] } = groupBy(filteredTargets, (t) => t.queryType || 'traceql');\n\n    if (targets.clear) {\n      return of({ data: [], state: LoadingState.Done });\n    }\n\n    // Migrate user to new query type if they are using the old search query type\n    if (targets.nativeSearch?.length) {\n      if (\n        targets.nativeSearch[0].spanName ||\n        targets.nativeSearch[0].serviceName ||\n        targets.nativeSearch[0].search ||\n        targets.nativeSearch[0].maxDuration ||\n        targets.nativeSearch[0].minDuration ||\n        targets.nativeSearch[0].queryType === 'nativeSearch'\n      ) {\n        const migratedQuery = migrateFromSearchToTraceQLSearch(targets.nativeSearch[0]);\n        if (targets.traceqlSearch?.length) {\n          targets.traceqlSearch.push(migratedQuery);\n        } else {\n          targets.traceqlSearch = [migratedQuery];\n        }\n      }\n    }\n\n    if (targets.traceql?.length) {\n      try {\n        const appliedQuery = this.applyVariables(targets.traceql[0], options.scopedVars);\n        const queryValue = appliedQuery?.query || '';\n        // Check whether this is a trace ID or traceQL query by checking if it only contains hex characters\n        if (this.isTraceIdQuery(queryValue)) {\n          // There's only hex characters so let's assume that this is a trace ID\n          reportInteraction('grafana_traces_traceID_queried', {\n            datasourceType: 'tempo',\n            app: options.app ?? '',\n            grafana_version: config.buildInfo.version,\n            hasQuery: queryValue !== '' ? true : false,\n          });\n\n          subQueries.push(this.handleTraceIdQuery(options, targets.traceql));\n        } else {\n          if (this.isTraceQlMetricsQuery(queryValue)) {\n            reportInteraction('grafana_traces_traceql_metrics_queried', {\n              datasourceType: 'tempo',\n              app: options.app ?? '',\n              grafana_version: config.buildInfo.version,\n              query: queryValue ?? '',\n            });\n            subQueries.push(this.handleTraceQlMetricsQuery(options, queryValue));\n          } else {\n            reportInteraction('grafana_traces_traceql_queried', {\n              datasourceType: 'tempo',\n              app: options.app ?? '',\n              grafana_version: config.buildInfo.version,\n              query: queryValue ?? '',\n              streaming: config.featureToggles.traceQLStreaming,\n            });\n            subQueries.push(this.handleTraceQlQuery(options, targets, queryValue));\n          }\n        }\n      } catch (error) {\n        return of({ error: { message: error instanceof Error ? error.message : 'Unknown error occurred' }, data: [] });\n      }\n    }\n\n    if (targets.traceqlSearch?.length) {\n      try {\n        if (config.featureToggles.metricsSummary) {\n          const target = targets.traceqlSearch.find((t) => this.hasGroupBy(t));\n          if (target) {\n            const appliedQuery = this.applyVariables(target, options.scopedVars);\n            subQueries.push(\n              this.handleMetricsSummary(appliedQuery, generateQueryFromFilters(appliedQuery.filters), options)\n            );\n          }\n        }\n\n        const traceqlSearchTargets = config.featureToggles.metricsSummary\n          ? targets.traceqlSearch.filter((t) => !this.hasGroupBy(t))\n          : targets.traceqlSearch;\n        if (traceqlSearchTargets.length > 0) {\n          const appliedQuery = this.applyVariables(traceqlSearchTargets[0], options.scopedVars);\n          const queryValueFromFilters = generateQueryFromFilters(appliedQuery.filters);\n\n          reportInteraction('grafana_traces_traceql_search_queried', {\n            datasourceType: 'tempo',\n            app: options.app ?? '',\n            grafana_version: config.buildInfo.version,\n            query: queryValueFromFilters ?? '',\n            streaming: config.featureToggles.traceQLStreaming,\n          });\n\n          if (\n            config.featureToggles.traceQLStreaming &&\n            this.isFeatureAvailable(FeatureName.streaming) &&\n            config.liveEnabled\n          ) {\n            subQueries.push(this.handleStreamingSearch(options, traceqlSearchTargets, queryValueFromFilters));\n          } else {\n            subQueries.push(\n              this._request('/api/search', {\n                q: queryValueFromFilters,\n                limit: options.targets[0].limit ?? DEFAULT_LIMIT,\n                spss: options.targets[0].spss ?? DEFAULT_SPSS,\n                start: options.range.from.unix(),\n                end: options.range.to.unix(),\n              }).pipe(\n                map((response) => {\n                  return {\n                    data: formatTraceQLResponse(\n                      response.data.traces,\n                      this.instanceSettings,\n                      targets.traceqlSearch[0].tableType\n                    ),\n                  };\n                }),\n                catchError((err) => {\n                  return of({ error: { message: getErrorMessage(err.data.message) }, data: [] });\n                })\n              )\n            );\n          }\n        }\n      } catch (error) {\n        return of({ error: { message: error instanceof Error ? error.message : 'Unknown error occurred' }, data: [] });\n      }\n    }\n\n    if (targets.upload?.length) {\n      if (this.uploadedJson) {\n        reportInteraction('grafana_traces_json_file_uploaded', {\n          datasourceType: 'tempo',\n          app: options.app ?? '',\n          grafana_version: config.buildInfo.version,\n        });\n\n        const jsonData = JSON.parse(this.uploadedJson);\n        const isTraceData = jsonData.batches;\n        const isServiceGraphData =\n          Array.isArray(jsonData) && jsonData.some((df) => df?.meta?.preferredVisualisationType === 'nodeGraph');\n\n        if (isTraceData) {\n          subQueries.push(of(transformFromOTEL(jsonData.batches, this.nodeGraph?.enabled)));\n        } else if (isServiceGraphData) {\n          subQueries.push(of({ data: jsonData, state: LoadingState.Done }));\n        } else {\n          subQueries.push(of({ error: { message: 'Unable to parse uploaded data.' }, data: [] }));\n        }\n      } else {\n        subQueries.push(of({ data: [], state: LoadingState.Done }));\n      }\n    }\n\n    if (this.serviceMap?.datasourceUid && targets.serviceMap?.length > 0) {\n      reportInteraction('grafana_traces_service_graph_queried', {\n        datasourceType: 'tempo',\n        app: options.app ?? '',\n        grafana_version: config.buildInfo.version,\n        hasServiceMapQuery: targets.serviceMap[0].serviceMapQuery ? true : false,\n      });\n\n      const dsId = this.serviceMap.datasourceUid;\n      const tempoDsUid = this.uid;\n      subQueries.push(\n        serviceMapQuery(options, dsId, tempoDsUid).pipe(\n          concatMap((result) =>\n            rateQuery(options, result, dsId).pipe(\n              concatMap((result) => errorAndDurationQuery(options, result, dsId, tempoDsUid))\n            )\n          )\n        )\n      );\n    }\n\n    return merge(...subQueries);\n  }\n\n  isTraceQlMetricsQuery(query: string): boolean {\n    // Check whether this is a metrics query by checking if it contains a metrics function\n    const metricsFnRegex =\n      /\\|\\s*(rate|count_over_time|avg_over_time|max_over_time|min_over_time|quantile_over_time)\\s*\\(/;\n    return !!query.trim().match(metricsFnRegex);\n  }\n\n  isTraceIdQuery(query: string): boolean {\n    const hexOnlyRegex = /^[0-9A-Fa-f]*$/;\n    // Check whether this is a trace ID or traceQL query by checking if it only contains hex characters\n    return !!query.trim().match(hexOnlyRegex);\n  }\n\n  applyTemplateVariables(query: TempoQuery, scopedVars: ScopedVars) {\n    return this.applyVariables(query, scopedVars);\n  }\n\n  interpolateVariablesInQueries(queries: TempoQuery[], scopedVars: ScopedVars): TempoQuery[] {\n    if (!queries || queries.length === 0) {\n      return [];\n    }\n\n    return queries.map((query) => {\n      return {\n        ...query,\n        datasource: this.getRef(),\n        ...this.applyVariables(query, scopedVars),\n      };\n    });\n  }\n\n  applyVariables(query: TempoQuery, scopedVars: ScopedVars) {\n    const expandedQuery = { ...query };\n\n    if (query.filters) {\n      expandedQuery.filters = query.filters.map((filter) => {\n        const updatedFilter = {\n          ...filter,\n          tag: this.templateSrv.replace(filter.tag ?? '', scopedVars),\n        };\n\n        if (filter.value) {\n          updatedFilter.value =\n            typeof filter.value === 'string'\n              ? this.templateSrv.replace(filter.value ?? '', scopedVars, VariableFormatID.Pipe)\n              : filter.value.map((v) => this.templateSrv.replace(v ?? '', scopedVars, VariableFormatID.Pipe));\n        }\n\n        return updatedFilter;\n      });\n    }\n\n    return {\n      ...expandedQuery,\n      query: this.templateSrv.replace(query.query ?? '', scopedVars, VariableFormatID.Pipe),\n      serviceMapQuery: Array.isArray(query.serviceMapQuery)\n        ? query.serviceMapQuery.map((query) => this.templateSrv.replace(query, scopedVars))\n        : this.templateSrv.replace(query.serviceMapQuery ?? '', scopedVars),\n    };\n  }\n\n  handleMetricsSummary = (target: TempoQuery, query: string, options: DataQueryRequest<TempoQuery>) => {\n    reportInteraction('grafana_traces_metrics_summary_queried', {\n      datasourceType: 'tempo',\n      app: options.app ?? '',\n      grafana_version: config.buildInfo.version,\n      filterCount: target.groupBy?.length ?? 0,\n    });\n\n    if (query === '{}') {\n      return of({\n        error: {\n          message:\n            'Please ensure you do not have an empty query. This is so filters are applied and the metrics summary is not generated from all spans.',\n        },\n        data: emptyResponse,\n      });\n    }\n\n    const groupBy = target.groupBy ? this.formatGroupBy(target.groupBy) : '';\n    return this._request('/api/metrics/summary', {\n      q: query,\n      groupBy,\n      start: options.range.from.unix(),\n      end: options.range.to.unix(),\n    }).pipe(\n      map((response) => {\n        if (!response.data.summaries) {\n          return {\n            error: {\n              message: getErrorMessage(\n                `No summary data for '${groupBy}'. Note: the metrics summary API only considers spans of kind = server. You can check if the attributes exist by running a TraceQL query like { attr_key = attr_value && kind = server }`\n              ),\n            },\n            data: emptyResponse,\n          };\n        }\n        // Check if any of the results have series data as older versions of Tempo placed the series data in a different structure\n        const hasSeries = response.data.summaries.some((summary: MetricsSummary) => summary.series.length > 0);\n        if (!hasSeries) {\n          return {\n            error: {\n              message: getErrorMessage(`No series data. Ensure you are using an up to date version of Tempo`),\n            },\n            data: emptyResponse,\n          };\n        }\n        return {\n          data: createTableFrameFromMetricsSummaryQuery(response.data.summaries, query, this.instanceSettings),\n        };\n      }),\n      catchError((error) => {\n        return of({\n          error: { message: getErrorMessage(error.data.message) },\n          data: emptyResponse,\n        });\n      })\n    );\n  };\n\n  formatGroupBy = (groupBy: TraceqlFilter[]) => {\n    return groupBy\n      ?.filter((f) => f.tag)\n      .map((f) => {\n        if (f.scope === TraceqlSearchScope.Unscoped) {\n          return `.${f.tag}`;\n        }\n        return f.scope !== TraceqlSearchScope.Intrinsic ? `${f.scope}.${f.tag}` : f.tag;\n      })\n      .join(', ');\n  };\n\n  hasGroupBy = (query: TempoQuery) => {\n    return query.groupBy?.find((gb) => gb.tag);\n  };\n\n  /**\n   * Handles the simplest of the queries where we have just a trace id and return trace data for it.\n   * @param options\n   * @param targets\n   * @private\n   */\n  handleTraceIdQuery(options: DataQueryRequest<TempoQuery>, targets: TempoQuery[]): Observable<DataQueryResponse> {\n    const validTargets = targets\n      .filter((t) => t.query)\n      .map((t): TempoQuery => ({ ...t, query: t.query?.trim(), queryType: 'traceId' }));\n    if (!validTargets.length) {\n      return EMPTY;\n    }\n\n    const traceRequest = this.traceIdQueryRequest(options, validTargets);\n\n    return super.query(traceRequest).pipe(\n      map((response) => {\n        if (response.error) {\n          return response;\n        }\n        return transformTrace(response, this.instanceSettings, this.nodeGraph?.enabled);\n      })\n    );\n  }\n\n  handleTraceQlQuery = (\n    options: DataQueryRequest<TempoQuery>,\n    targets: {\n      [type: string]: TempoQuery[];\n    },\n    queryValue: string\n  ): Observable<DataQueryResponse> => {\n    if (\n      config.featureToggles.traceQLStreaming &&\n      this.isFeatureAvailable(FeatureName.streaming) &&\n      config.liveEnabled\n    ) {\n      return this.handleStreamingSearch(options, targets.traceql, queryValue);\n    } else {\n      return this._request('/api/search', {\n        q: queryValue,\n        limit: options.targets[0].limit ?? DEFAULT_LIMIT,\n        spss: options.targets[0].spss ?? DEFAULT_SPSS,\n        start: options.range.from.unix(),\n        end: options.range.to.unix(),\n      }).pipe(\n        map((response) => {\n          return {\n            data: formatTraceQLResponse(response.data.traces, this.instanceSettings, targets.traceql[0].tableType),\n          };\n        }),\n        catchError((err) => {\n          return of({ error: { message: getErrorMessage(err.data.message) }, data: [] });\n        })\n      );\n    }\n  };\n\n  handleTraceQlMetricsQuery = (\n    options: DataQueryRequest<TempoQuery>,\n    queryValue: string\n  ): Observable<DataQueryResponse> => {\n    return this._request('/api/metrics/query_range', {\n      query: queryValue,\n      start: options.range.from.unix(),\n      end: options.range.to.unix(),\n    }).pipe(\n      map((response) => {\n        return {\n          data: formatTraceQLMetrics(queryValue, response.data),\n        };\n      }),\n      catchError((err) => {\n        return of({ error: { message: getErrorMessage(err.data.message) }, data: [] });\n      })\n    );\n  };\n\n  traceIdQueryRequest(options: DataQueryRequest<TempoQuery>, targets: TempoQuery[]): DataQueryRequest<TempoQuery> {\n    const request = {\n      ...options,\n      targets,\n    };\n\n    if (this.traceQuery?.timeShiftEnabled) {\n      request.range = options.range && {\n        ...options.range,\n        from: options.range.from.subtract(\n          rangeUtil.intervalToMs(this.traceQuery?.spanStartTimeShift || '30m'),\n          'milliseconds'\n        ),\n        to: options.range.to.add(rangeUtil.intervalToMs(this.traceQuery?.spanEndTimeShift || '30m'), 'milliseconds'),\n      };\n    } else {\n      request.range = { from: dateTime(0), to: dateTime(0), raw: { from: dateTime(0), to: dateTime(0) } };\n    }\n\n    return request;\n  }\n\n  // This function can probably be simplified by avoiding passing both `targets` and `query`,\n  // since `query` is built from `targets`, if you look at how this function is currently called\n  handleStreamingSearch(\n    options: DataQueryRequest<TempoQuery>,\n    targets: TempoQuery[],\n    query: string\n  ): Observable<DataQueryResponse> {\n    if (query === '') {\n      return EMPTY;\n    }\n\n    return merge(\n      ...targets.map((target) =>\n        doTempoChannelStream(\n          { ...target, query },\n          this, // the datasource\n          options,\n          this.instanceSettings\n        )\n      )\n    );\n  }\n\n  async metadataRequest(url: string, params = {}) {\n    return await lastValueFrom(this._request(url, params, { method: 'GET', hideFromInspector: true }));\n  }\n\n  _request(apiUrl: string, data?: unknown, options?: Partial<BackendSrvRequest>): Observable<Record<string, any>> {\n    const params = data ? urlUtil.serializeParams(data) : '';\n    const url = `${this.instanceSettings.url}${apiUrl}${params.length ? `?${params}` : ''}`;\n    const req = { ...options, url };\n\n    return getBackendSrv().fetch(req);\n  }\n\n  async testDatasource(): Promise<TestDataSourceResponse> {\n    const options: BackendSrvRequest = {\n      headers: {},\n      method: 'GET',\n      url: `${this.instanceSettings.url}/api/echo`,\n    };\n\n    return await lastValueFrom(\n      getBackendSrv()\n        .fetch(options)\n        .pipe(\n          mergeMap(() => {\n            return of({ status: 'success', message: 'Data source successfully connected.' });\n          }),\n          catchError((err) => {\n            return of({ status: 'error', message: getErrorMessage(err.data.message, 'Unable to connect with Tempo') });\n          })\n        )\n    );\n  }\n\n  getQueryDisplayText(query: TempoQuery) {\n    if (query.queryType !== 'nativeSearch') {\n      return query.query ?? '';\n    }\n\n    const keys: Array<\n      keyof Pick<TempoQuery, 'serviceName' | 'spanName' | 'search' | 'minDuration' | 'maxDuration' | 'limit'>\n    > = ['serviceName', 'spanName', 'search', 'minDuration', 'maxDuration', 'limit'];\n    return keys\n      .filter((key) => query[key])\n      .map((key) => `${startCase(key)}: ${query[key]}`)\n      .join(', ');\n  }\n}\n\nfunction queryPrometheus(request: DataQueryRequest<PromQuery>, datasourceUid: string) {\n  return from(getDataSourceSrv().get(datasourceUid)).pipe(\n    mergeMap((ds) => {\n      return (ds as PrometheusDatasource).query(request);\n    })\n  );\n}\n\nfunction serviceMapQuery(\n  request: DataQueryRequest<TempoQuery>,\n  datasourceUid: string,\n  tempoDatasourceUid: string\n): Observable<ServiceMapQueryResponse> {\n  const serviceMapRequest = makePromServiceMapRequest(request);\n\n  return queryPrometheus(serviceMapRequest, datasourceUid).pipe(\n    // Just collect all the responses first before processing into node graph data\n    toArray(),\n    map((responses: DataQueryResponse[]) => {\n      const errorRes = responses.find((res) => !!res.error);\n      if (errorRes) {\n        throw new Error(getErrorMessage(errorRes.error?.message));\n      }\n\n      const { nodes, edges } = mapPromMetricsToServiceMap(responses, request.range);\n      if (nodes.fields.length > 0 && edges.fields.length > 0) {\n        const nodeLength = nodes.fields[0].values.length;\n        const edgeLength = edges.fields[0].values.length;\n\n        reportInteraction('grafana_traces_service_graph_size', {\n          datasourceType: 'tempo',\n          grafana_version: config.buildInfo.version,\n          nodeLength,\n          edgeLength,\n        });\n      }\n\n      // No handling of multiple targets assume just one. NodeGraph does not support it anyway, but still should be\n      // fixed at some point.\n      const { serviceMapIncludeNamespace, refId } = request.targets[0];\n      nodes.refId = refId;\n      edges.refId = refId;\n\n      if (serviceMapIncludeNamespace) {\n        nodes.fields[0].config = getFieldConfig(\n          datasourceUid, // datasourceUid\n          tempoDatasourceUid, // tempoDatasourceUid\n          '__data.fields.title', // targetField\n          '__data.fields[0]', // tempoField\n          undefined, // sourceField\n          { targetNamespace: '__data.fields.subtitle' }\n        );\n\n        edges.fields[0].config = getFieldConfig(\n          datasourceUid, // datasourceUid\n          tempoDatasourceUid, // tempoDatasourceUid\n          '__data.fields.targetName', // targetField\n          '__data.fields.target', // tempoField\n          '__data.fields.sourceName', // sourceField\n          { targetNamespace: '__data.fields.targetNamespace', sourceNamespace: '__data.fields.sourceNamespace' }\n        );\n      } else {\n        nodes.fields[0].config = getFieldConfig(\n          datasourceUid,\n          tempoDatasourceUid,\n          '__data.fields.id',\n          '__data.fields[0]'\n        );\n        edges.fields[0].config = getFieldConfig(\n          datasourceUid,\n          tempoDatasourceUid,\n          '__data.fields.target',\n          '__data.fields.target',\n          '__data.fields.source'\n        );\n      }\n\n      return {\n        nodes,\n        edges,\n        state: LoadingState.Done,\n      };\n    })\n  );\n}\n\nfunction rateQuery(\n  request: DataQueryRequest<TempoQuery>,\n  serviceMapResponse: ServiceMapQueryResponse,\n  datasourceUid: string\n): Observable<ServiceMapQueryResponseWithRates> {\n  const serviceMapRequest = makePromServiceMapRequest(request);\n  serviceMapRequest.targets = makeServiceGraphViewRequest([buildExpr(rateMetric, defaultTableFilter, request)]);\n\n  return queryPrometheus(serviceMapRequest, datasourceUid).pipe(\n    toArray(),\n    map((responses: DataQueryResponse[]) => {\n      const errorRes = responses.find((res) => !!res.error);\n      if (errorRes) {\n        throw new Error(getErrorMessage(errorRes.error?.message));\n      }\n      return {\n        rates: responses[0]?.data ?? [],\n        nodes: serviceMapResponse.nodes,\n        edges: serviceMapResponse.edges,\n      };\n    })\n  );\n}\n\n// we need the response from the rate query to get the rate span_name(s),\n// -> which determine the errorRate/duration span_name(s) we need to query\nfunction errorAndDurationQuery(\n  request: DataQueryRequest<TempoQuery>,\n  rateResponse: ServiceMapQueryResponseWithRates,\n  datasourceUid: string,\n  tempoDatasourceUid: string\n) {\n  let serviceGraphViewMetrics = [];\n  let errorRateBySpanName = '';\n  let durationsBySpanName: string[] = [];\n\n  let labels = [];\n  if (rateResponse.rates[0] && request.app === CoreApp.Explore) {\n    const spanNameField = rateResponse.rates[0].fields.find((field) => field.name === 'span_name');\n    if (spanNameField && spanNameField.values) {\n      labels = spanNameField.values;\n    }\n  } else if (rateResponse.rates) {\n    rateResponse.rates.map((df: DataFrame | DataFrameDTO) => {\n      const spanNameLabels = df.fields.find((field) => field.labels?.['span_name']);\n      if (spanNameLabels) {\n        labels.push(spanNameLabels.labels?.['span_name']);\n      }\n    });\n  }\n  const spanNames = getEscapedSpanNames(labels);\n\n  if (spanNames.length > 0) {\n    errorRateBySpanName = buildExpr(errorRateMetric, 'span_name=~\"' + spanNames.join('|') + '\"', request);\n    serviceGraphViewMetrics.push(errorRateBySpanName);\n    spanNames.map((name: string) => {\n      const metric = buildExpr(durationMetric, 'span_name=~\"' + name + '\"', request);\n      durationsBySpanName.push(metric);\n      serviceGraphViewMetrics.push(metric);\n    });\n  }\n\n  const serviceMapRequest = makePromServiceMapRequest(request);\n  serviceMapRequest.targets = makeServiceGraphViewRequest(serviceGraphViewMetrics);\n\n  return queryPrometheus(serviceMapRequest, datasourceUid).pipe(\n    // Just collect all the responses first before processing into node graph data\n    toArray(),\n    map((errorAndDurationResponse: DataQueryResponse[]) => {\n      const errorRes = errorAndDurationResponse.find((res) => !!res.error);\n      if (errorRes) {\n        throw new Error(getErrorMessage(errorRes.error?.message));\n      }\n\n      const serviceGraphView = getServiceGraphView(\n        request,\n        rateResponse,\n        errorAndDurationResponse[0],\n        errorRateBySpanName,\n        durationsBySpanName,\n        datasourceUid,\n        tempoDatasourceUid\n      );\n\n      if (serviceGraphView.fields.length === 0) {\n        return {\n          data: [rateResponse.nodes, rateResponse.edges],\n          state: LoadingState.Done,\n        };\n      }\n\n      return {\n        data: [serviceGraphView, rateResponse.nodes, rateResponse.edges],\n        state: LoadingState.Done,\n      };\n    })\n  );\n}\n\nfunction makePromLink(title: string, expr: string, datasourceUid: string, instant: boolean) {\n  return {\n    url: '',\n    title,\n    internal: {\n      query: {\n        expr: expr,\n        range: !instant,\n        exemplar: !instant,\n        instant: instant,\n      },\n      datasourceUid,\n      datasourceName: getDataSourceSrv().getInstanceSettings(datasourceUid)?.name ?? '',\n    },\n  };\n}\n\nexport function getEscapedSpanNames(values: string[]) {\n  return values.map((value: string) => value.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\\\\\$&'));\n}\n\nexport function getFieldConfig(\n  datasourceUid: string,\n  tempoDatasourceUid: string,\n  targetField: string,\n  tempoField: string,\n  sourceField?: string,\n  namespaceFields?: { targetNamespace: string; sourceNamespace?: string }\n) {\n  let source = sourceField ? `client=\"\\${${sourceField}}\",` : '';\n  let target = `server=\"\\${${targetField}}\"`;\n  let serverSumBy = 'server';\n\n  if (namespaceFields !== undefined) {\n    const { targetNamespace } = namespaceFields;\n    target += `,server_service_namespace=\"\\${${targetNamespace}}\"`;\n    serverSumBy += ', server_service_namespace';\n\n    if (source) {\n      const { sourceNamespace } = namespaceFields;\n      source += `client_service_namespace=\"\\${${sourceNamespace}}\",`;\n      serverSumBy += ', client_service_namespace';\n    }\n  }\n\n  return {\n    links: [\n      makePromLink(\n        'Request rate',\n        `sum by (client, ${serverSumBy})(rate(${totalsMetric}{${source}${target}}[$__rate_interval]))`,\n        datasourceUid,\n        false\n      ),\n      makePromLink(\n        'Request histogram',\n        `histogram_quantile(0.9, sum(rate(${histogramMetric}{${source}${target}}[$__rate_interval])) by (le, client, ${serverSumBy}))`,\n        datasourceUid,\n        false\n      ),\n      makePromLink(\n        'Failed request rate',\n        `sum by (client, ${serverSumBy})(rate(${failedMetric}{${source}${target}}[$__rate_interval]))`,\n        datasourceUid,\n        false\n      ),\n      makeTempoLink(\n        'View traces',\n        namespaceFields !== undefined ? `\\${${namespaceFields.targetNamespace}}` : '',\n        `\\${${targetField}}`,\n        '',\n        tempoDatasourceUid\n      ),\n    ],\n  };\n}\n\nexport function makeTempoLink(\n  title: string,\n  serviceNamespace: string | undefined,\n  serviceName: string,\n  spanName: string,\n  datasourceUid: string\n) {\n  let query: TempoQuery = { refId: 'A', queryType: 'traceqlSearch', filters: [] };\n  if (serviceNamespace !== undefined && serviceNamespace !== '') {\n    query.filters.push({\n      id: 'service-namespace',\n      scope: TraceqlSearchScope.Resource,\n      tag: 'service.namespace',\n      value: serviceNamespace,\n      operator: '=',\n      valueType: 'string',\n    });\n  }\n  if (serviceName !== '') {\n    query.filters.push({\n      id: 'service-name',\n      scope: TraceqlSearchScope.Resource,\n      tag: 'service.name',\n      value: serviceName,\n      operator: '=',\n      valueType: 'string',\n    });\n  }\n  if (spanName !== '') {\n    query.filters.push({\n      id: 'span-name',\n      scope: TraceqlSearchScope.Span,\n      tag: 'name',\n      value: spanName,\n      operator: '=',\n      valueType: 'string',\n    });\n  }\n\n  return {\n    url: '',\n    title,\n    internal: {\n      query,\n      datasourceUid,\n      datasourceName: getDataSourceSrv().getInstanceSettings(datasourceUid)?.name ?? '',\n    },\n  };\n}\n\nfunction makePromServiceMapRequest(options: DataQueryRequest<TempoQuery>): DataQueryRequest<PromQuery> {\n  return {\n    ...options,\n    targets: serviceMapMetrics.map((metric) => {\n      const { serviceMapQuery, serviceMapIncludeNamespace: serviceMapIncludeNamespace } = options.targets[0];\n      const extraSumByFields = serviceMapIncludeNamespace ? ', client_service_namespace, server_service_namespace' : '';\n      const queries = Array.isArray(serviceMapQuery) ? serviceMapQuery : [serviceMapQuery];\n      const subExprs = queries.map(\n        (query) => `sum by (client, server${extraSumByFields}) (rate(${metric}${query || ''}[$__range]))`\n      );\n      return {\n        format: 'table',\n        refId: metric,\n        // options.targets[0] is not correct here, but not sure what should happen if you have multiple queries for\n        // service map at the same time anyway\n        expr: subExprs.join(' OR '),\n        instant: true,\n      };\n    }),\n  };\n}\n\nfunction getServiceGraphView(\n  request: DataQueryRequest<TempoQuery>,\n  rateResponse: ServiceMapQueryResponseWithRates,\n  secondResponse: DataQueryResponse,\n  errorRateBySpanName: string,\n  durationsBySpanName: string[],\n  datasourceUid: string,\n  tempoDatasourceUid: string\n) {\n  let df: any = { fields: [] };\n\n  const rate = rateResponse.rates.filter((x) => {\n    return x.refId === buildExpr(rateMetric, defaultTableFilter, request);\n  });\n  const errorRate = secondResponse.data.filter((x) => {\n    return x.refId === errorRateBySpanName;\n  });\n  const duration = secondResponse.data.filter((x) => {\n    return durationsBySpanName.includes(x.refId ?? '');\n  });\n\n  if (rate.length > 0 && rate[0].fields?.length > 2) {\n    df.fields.push({\n      ...rate[0].fields[1],\n      name: 'Name',\n      config: {\n        filterable: false,\n      },\n    });\n\n    df.fields.push({\n      ...rate[0].fields[2],\n      name: 'Rate',\n      config: {\n        links: [\n          makePromLink(\n            'Rate',\n            buildLinkExpr(buildExpr(rateMetric, 'span_name=\"${__data.fields[0]}\"', request)),\n            datasourceUid,\n            false\n          ),\n        ],\n        decimals: 2,\n      },\n    });\n\n    df.fields.push({\n      ...rate[0].fields[2],\n      name: '  ',\n      labels: null,\n      config: {\n        color: {\n          mode: 'continuous-BlPu',\n        },\n        custom: {\n          cellOptions: {\n            mode: BarGaugeDisplayMode.Lcd,\n            type: TableCellDisplayMode.Gauge,\n          },\n        },\n        decimals: 3,\n      },\n    });\n  }\n\n  if (errorRate.length > 0 && errorRate[0].fields?.length > 2) {\n    const errorRateNames = errorRate[0].fields[1]?.values ?? [];\n    const errorRateValues = errorRate[0].fields[2]?.values ?? [];\n    let errorRateObj: any = {};\n    errorRateNames.map((name: string, index: number) => {\n      errorRateObj[name] = { value: errorRateValues[index] };\n    });\n\n    const values = getRateAlignedValues({ ...rate }, errorRateObj);\n\n    df.fields.push({\n      ...errorRate[0].fields[2],\n      name: 'Error Rate',\n      values: values,\n      config: {\n        links: [\n          makePromLink(\n            'Error Rate',\n            buildLinkExpr(buildExpr(errorRateMetric, 'span_name=\"${__data.fields[0]}\"', request)),\n            datasourceUid,\n            false\n          ),\n        ],\n        decimals: 2,\n      },\n    });\n\n    df.fields.push({\n      ...errorRate[0].fields[2],\n      name: '   ',\n      values: values,\n      labels: null,\n      config: {\n        color: {\n          mode: 'continuous-RdYlGr',\n        },\n        custom: {\n          cellOptions: {\n            mode: BarGaugeDisplayMode.Lcd,\n            type: TableCellDisplayMode.Gauge,\n          },\n        },\n        decimals: 3,\n      },\n    });\n  }\n\n  if (duration.length > 0) {\n    let durationObj: any = {};\n    duration.forEach((d) => {\n      if (d.fields.length > 1) {\n        const delimiter = d.refId?.includes('span_name=~\"') ? 'span_name=~\"' : 'span_name=\"';\n        const name = d.refId?.split(delimiter)[1].split('\"}')[0];\n        durationObj[name!] = { value: d.fields[1].values[0] };\n      }\n    });\n    if (Object.keys(durationObj).length > 0) {\n      df.fields.push({\n        ...duration[0].fields[1],\n        name: 'Duration (p90)',\n        values: getRateAlignedValues({ ...rate }, durationObj),\n        config: {\n          links: [\n            makePromLink(\n              'Duration',\n              buildLinkExpr(buildExpr(durationMetric, 'span_name=\"${__data.fields[0]}\"', request)),\n              datasourceUid,\n              false\n            ),\n          ],\n          unit: 's',\n        },\n      });\n    }\n  }\n\n  if (df.fields.length > 0 && df.fields[0].values) {\n    df.fields.push({\n      name: 'Links',\n      type: FieldType.string,\n      values: df.fields[0].values.map(() => {\n        return 'Tempo';\n      }),\n      config: {\n        links: [makeTempoLink('Tempo', undefined, '', `\\${__data.fields[0]}`, tempoDatasourceUid)],\n      },\n    });\n  }\n\n  return df;\n}\n\nexport function buildExpr(\n  metric: { expr: string; params: string[]; topk?: number },\n  extraParams: string,\n  request: DataQueryRequest<TempoQuery>\n): string {\n  let serviceMapQuery = request.targets[0]?.serviceMapQuery ?? '';\n  const serviceMapQueries = Array.isArray(serviceMapQuery) ? serviceMapQuery : [serviceMapQuery];\n  const metricParamsArray = serviceMapQueries.map((query) => {\n    // remove surrounding curly braces from serviceMapQuery\n    const serviceMapQueryMatch = query.match(/^{(.*)}$/);\n    if (serviceMapQueryMatch?.length) {\n      query = serviceMapQueryMatch[1];\n    }\n    // map serviceGraph metric tags to serviceGraphView metric tags\n    query = query.replace('client', 'service').replace('server', 'service');\n    return query.includes('span_name')\n      ? metric.params.concat(query)\n      : metric.params\n          .concat(query)\n          .concat(extraParams)\n          .filter((item: string) => item);\n  });\n  const exprs = metricParamsArray.map((params) => metric.expr.replace('{}', '{' + params.join(',') + '}'));\n  const expr = exprs.join(' OR ');\n  if (metric.topk) {\n    return `topk(${metric.topk}, ${expr})`;\n  }\n  return expr;\n}\n\nexport function buildLinkExpr(expr: string) {\n  // don't want top 5 or by span name in links\n  expr = expr.replace('topk(5, ', '').replace(' by (span_name))', '');\n  return expr.replace('__range', '__rate_interval');\n}\n\n// query result frames can come back in any order\n// here we align the table col values to the same row name (rateName) across the table\nexport function getRateAlignedValues(\n  rateResp: DataQueryResponseData[],\n  objToAlign: { [x: string]: { value: string } }\n) {\n  const rateNames = rateResp[0]?.fields[1]?.values ?? [];\n  let values: string[] = [];\n\n  for (let i = 0; i < rateNames.length; i++) {\n    if (Object.keys(objToAlign).includes(rateNames[i])) {\n      values.push(objToAlign[rateNames[i]].value);\n    } else {\n      values.push('0');\n    }\n  }\n\n  return values;\n}\n\nexport function makeServiceGraphViewRequest(metrics: string[]): PromQuery[] {\n  return metrics.map((metric) => {\n    return {\n      refId: metric,\n      expr: metric,\n      instant: true,\n    };\n  });\n}\n","import React from 'react';\n\nimport { EditorField, EditorRow } from '@grafana/experimental';\nimport { AutoSizeInput, RadioButtonGroup } from '@grafana/ui';\n\nimport { QueryOptionGroup } from '../_importedDependencies/datasources/prometheus/QueryOptionGroup';\nimport { SearchTableType } from '../dataquery.gen';\nimport { DEFAULT_LIMIT, DEFAULT_SPSS } from '../datasource';\nimport { TempoQuery } from '../types';\n\ninterface Props {\n  onChange: (value: TempoQuery) => void;\n  query: Partial<TempoQuery> & TempoQuery;\n}\n\n/**\n * Parse a string value to integer. If the conversion fails, for example because we are prosessing an empty value for\n * a field, return a fallback (default) value.\n *\n * @param val the value to be parsed to an integer\n * @param fallback the fallback value\n * @returns the converted value or the fallback value if the conversion fails\n */\nconst parseIntWithFallback = (val: string, fallback: number) => {\n  const parsed = parseInt(val, 10);\n  return isNaN(parsed) ? fallback : parsed;\n};\n\nexport const TempoQueryBuilderOptions = React.memo<Props>(({ onChange, query }) => {\n  if (!query.hasOwnProperty('limit')) {\n    query.limit = DEFAULT_LIMIT;\n  }\n\n  if (!query.hasOwnProperty('tableType')) {\n    query.tableType = SearchTableType.Traces;\n  }\n\n  const onLimitChange = (e: React.FormEvent<HTMLInputElement>) => {\n    onChange({ ...query, limit: parseIntWithFallback(e.currentTarget.value, DEFAULT_LIMIT) });\n  };\n  const onSpssChange = (e: React.FormEvent<HTMLInputElement>) => {\n    onChange({ ...query, spss: parseIntWithFallback(e.currentTarget.value, DEFAULT_SPSS) });\n  };\n  const onTableTypeChange = (val: SearchTableType) => {\n    onChange({ ...query, tableType: val });\n  };\n\n  const collapsedInfoList = [\n    `Limit: ${query.limit || DEFAULT_LIMIT}`,\n    `Spans Limit: ${query.spss || DEFAULT_SPSS}`,\n    `Table Format: ${query.tableType === SearchTableType.Traces ? 'Traces' : 'Spans'}`,\n  ];\n\n  return (\n    <>\n      <EditorRow>\n        <QueryOptionGroup title=\"Options\" collapsedInfo={collapsedInfoList}>\n          <EditorField label=\"Limit\" tooltip=\"Maximum number of traces to return.\">\n            <AutoSizeInput\n              className=\"width-4\"\n              placeholder=\"auto\"\n              type=\"number\"\n              min={1}\n              defaultValue={query.limit || DEFAULT_LIMIT}\n              onCommitChange={onLimitChange}\n              value={query.limit}\n            />\n          </EditorField>\n          <EditorField label=\"Span Limit\" tooltip=\"Maximum number of spans to return for each span set.\">\n            <AutoSizeInput\n              className=\"width-4\"\n              placeholder=\"auto\"\n              type=\"number\"\n              min={1}\n              defaultValue={query.spss || DEFAULT_SPSS}\n              onCommitChange={onSpssChange}\n              value={query.spss}\n            />\n          </EditorField>\n          <EditorField label=\"Table Format\" tooltip=\"How the query data should be displayed in the results table\">\n            <RadioButtonGroup\n              options={[\n                { label: 'Traces', value: SearchTableType.Traces },\n                { label: 'Spans', value: SearchTableType.Spans },\n              ]}\n              value={query.tableType}\n              onChange={onTableTypeChange}\n            />\n          </EditorField>\n        </QueryOptionGroup>\n      </EditorRow>\n    </>\n  );\n});\n\nTempoQueryBuilderOptions.displayName = 'TempoQueryBuilderOptions';\n","import { css } from '@emotion/css';\nimport React from 'react';\n\nimport { Select, HorizontalGroup, Input, useStyles2 } from '@grafana/ui';\n\nimport { TraceqlFilter } from '../dataquery.gen';\n\nimport { operatorSelectableValue } from './utils';\n\ninterface Props {\n  filter: TraceqlFilter;\n  updateFilter: (f: TraceqlFilter) => void;\n  isTagsLoading?: boolean;\n  operators: string[];\n}\n\n// Support template variables (e.g., `$dur`, `$v_1`) and durations (e.g., `300s`, `1.2ms`)\nconst validationRegex = /^(\\$\\w+)|(\\d+(?:\\.\\d)?\\d*(?:us|s|ns|ms|s|m|h))$/;\n\nconst getStyles = () => ({\n  noBoxShadow: css({\n    boxShadow: 'none',\n    '*:focus': {\n      boxShadow: 'none',\n    },\n  }),\n});\n\nconst DurationInput = ({ filter, operators, updateFilter }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  let invalid = false;\n  if (typeof filter.value === 'string') {\n    invalid = filter.value ? !validationRegex.test(filter.value.concat('')) : false;\n  }\n\n  return (\n    <HorizontalGroup spacing={'none'}>\n      <Select\n        className={styles.noBoxShadow}\n        inputId={`${filter.id}-operator`}\n        options={operators.map(operatorSelectableValue)}\n        value={filter.operator}\n        onChange={(v) => {\n          updateFilter({ ...filter, operator: v?.value });\n        }}\n        isClearable={false}\n        aria-label={`select ${filter.id} operator`}\n        allowCustomValue={true}\n        width={8}\n      />\n      <Input\n        className={styles.noBoxShadow}\n        value={filter.value}\n        onChange={(v) => {\n          updateFilter({ ...filter, value: v.currentTarget.value });\n        }}\n        placeholder=\"e.g. 100ms, 1.2s\"\n        aria-label={`select ${filter.id} value`}\n        invalid={invalid}\n        width={18}\n      />\n    </HorizontalGroup>\n  );\n};\n\nexport default DurationInput;\n","import React from 'react';\n\nimport { InlineFieldRow, InlineField } from '@grafana/ui';\n\ninterface Props {\n  label: string;\n  tooltip?: string;\n  children: React.ReactElement;\n}\nconst SearchField = ({ label, tooltip, children }: Props) => {\n  return (\n    <InlineFieldRow>\n      <InlineField label={label} labelWidth={28} grow tooltip={tooltip}>\n        {children}\n      </InlineField>\n    </InlineFieldRow>\n  );\n};\n\nexport default SearchField;\n","import { css } from '@emotion/css';\nimport React, { useEffect } from 'react';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { AccessoryButton } from '@grafana/experimental';\nimport { HorizontalGroup, Select, useStyles2 } from '@grafana/ui';\n\nimport { TraceqlFilter, TraceqlSearchScope } from '../dataquery.gen';\nimport { TempoDatasource } from '../datasource';\nimport { TempoQuery } from '../types';\n\nimport InlineSearchField from './InlineSearchField';\nimport { replaceAt } from './utils';\n\ninterface Props {\n  datasource: TempoDatasource;\n  onChange: (value: TempoQuery) => void;\n  query: Partial<TempoQuery> & TempoQuery;\n  isTagsLoading: boolean;\n}\n\nexport const GroupByField = (props: Props) => {\n  const { datasource, onChange, query, isTagsLoading } = props;\n  const styles = useStyles2(getStyles);\n  const generateId = () => uuidv4().slice(0, 8);\n\n  useEffect(() => {\n    if (!query.groupBy || query.groupBy.length === 0) {\n      onChange({\n        ...query,\n        groupBy: [\n          {\n            id: generateId(),\n            scope: TraceqlSearchScope.Span,\n          },\n        ],\n      });\n    }\n  }, [onChange, query]);\n\n  const getTags = (f: TraceqlFilter) => {\n    return datasource!.languageProvider.getMetricsSummaryTags(f.scope);\n  };\n\n  const addFilter = () => {\n    updateFilter({\n      id: generateId(),\n      scope: TraceqlSearchScope.Span,\n    });\n  };\n\n  const removeFilter = (filter: TraceqlFilter) => {\n    onChange({ ...query, groupBy: query.groupBy?.filter((f) => f.id !== filter.id) });\n  };\n\n  const updateFilter = (filter: TraceqlFilter) => {\n    const copy = { ...query };\n    copy.groupBy ||= [];\n    const indexOfFilter = copy.groupBy.findIndex((f) => f.id === filter.id);\n    if (indexOfFilter >= 0) {\n      copy.groupBy = replaceAt(copy.groupBy, indexOfFilter, filter);\n    } else {\n      copy.groupBy.push(filter);\n    }\n    onChange(copy);\n  };\n\n  const scopeOptions = Object.values(TraceqlSearchScope).map((t) => ({ label: t, value: t }));\n\n  return (\n    <InlineSearchField\n      label=\"Aggregate by\"\n      tooltip=\"Select one or more tags to see the metrics summary. Note: the metrics summary API only considers spans of kind = server.\"\n    >\n      <>\n        {query.groupBy?.map((f, i) => (\n          <div key={f.id}>\n            <HorizontalGroup spacing={'none'} width={'auto'}>\n              <Select\n                aria-label={`Select scope for filter ${i + 1}`}\n                onChange={(v) => {\n                  updateFilter({ ...f, scope: v?.value, tag: '' });\n                }}\n                options={scopeOptions}\n                placeholder=\"Select scope\"\n                value={f.scope}\n              />\n              <Select\n                aria-label={`Select tag for filter ${i + 1}`}\n                isClearable\n                isLoading={isTagsLoading}\n                key={f.tag}\n                onChange={(v) => {\n                  updateFilter({ ...f, tag: v?.value });\n                }}\n                options={getTags(f)?.map((t) => ({\n                  label: t,\n                  value: t,\n                }))}\n                placeholder=\"Select tag\"\n                value={f.tag || ''}\n              />\n              {(f.tag || (query.groupBy?.length ?? 0) > 1) && (\n                <AccessoryButton\n                  aria-label={`Remove tag for filter ${i + 1}`}\n                  icon=\"times\"\n                  onClick={() => removeFilter(f)}\n                  tooltip=\"Remove tag\"\n                  title={`Remove tag for filter ${i + 1}`}\n                  variant=\"secondary\"\n                />\n              )}\n              {f.tag && i === (query.groupBy?.length ?? 0) - 1 && (\n                <span className={styles.addTag}>\n                  <AccessoryButton\n                    aria-label=\"Add tag\"\n                    icon=\"plus\"\n                    onClick={() => addFilter()}\n                    tooltip=\"Add tag\"\n                    variant=\"secondary\"\n                  />\n                </span>\n              )}\n            </HorizontalGroup>\n          </div>\n        ))}\n      </>\n    </InlineSearchField>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  addTag: css({\n    marginLeft: theme.spacing(1),\n  }),\n});\n","import { css } from '@emotion/css';\nimport React, { useCallback, useEffect, useState } from 'react';\n\nimport { CoreApp, GrafanaTheme2 } from '@grafana/data';\nimport { TemporaryAlert } from '@grafana/o11y-ds-frontend';\nimport { config, FetchError, getTemplateSrv, reportInteraction } from '@grafana/runtime';\nimport { Alert, Button, HorizontalGroup, Select, useStyles2 } from '@grafana/ui';\n\nimport { RawQuery } from '../_importedDependencies/datasources/prometheus/RawQuery';\nimport { TraceqlFilter, TraceqlSearchScope } from '../dataquery.gen';\nimport { TempoDatasource } from '../datasource';\nimport { TempoQueryBuilderOptions } from '../traceql/TempoQueryBuilderOptions';\nimport { traceqlGrammar } from '../traceql/traceql';\nimport { TempoQuery } from '../types';\n\nimport DurationInput from './DurationInput';\nimport { GroupByField } from './GroupByField';\nimport InlineSearchField from './InlineSearchField';\nimport SearchField from './SearchField';\nimport TagsInput from './TagsInput';\nimport { filterScopedTag, filterTitle, generateQueryFromFilters, replaceAt } from './utils';\n\ninterface Props {\n  datasource: TempoDatasource;\n  query: TempoQuery;\n  onChange: (value: TempoQuery) => void;\n  onBlur?: () => void;\n  onClearResults: () => void;\n  app?: CoreApp;\n}\n\nconst hardCodedFilterIds = ['min-duration', 'max-duration', 'status'];\n\nconst TraceQLSearch = ({ datasource, query, onChange, onClearResults, app }: Props) => {\n  const styles = useStyles2(getStyles);\n  const [alertText, setAlertText] = useState<string>();\n  const [error, setError] = useState<Error | FetchError | null>(null);\n\n  const [isTagsLoading, setIsTagsLoading] = useState(true);\n  const [traceQlQuery, setTraceQlQuery] = useState<string>('');\n\n  const templateSrv = getTemplateSrv();\n\n  const updateFilter = useCallback(\n    (s: TraceqlFilter) => {\n      const copy = { ...query };\n      copy.filters ||= [];\n      const indexOfFilter = copy.filters.findIndex((f) => f.id === s.id);\n      if (indexOfFilter >= 0) {\n        // update in place if the filter already exists, for consistency and to avoid UI bugs\n        copy.filters = replaceAt(copy.filters, indexOfFilter, s);\n      } else {\n        copy.filters.push(s);\n      }\n      onChange(copy);\n    },\n    [onChange, query]\n  );\n\n  const deleteFilter = (s: TraceqlFilter) => {\n    onChange({ ...query, filters: query.filters.filter((f) => f.id !== s.id) });\n  };\n\n  useEffect(() => {\n    setTraceQlQuery(generateQueryFromFilters(query.filters || []));\n  }, [query]);\n\n  const findFilter = useCallback((id: string) => query.filters?.find((f) => f.id === id), [query.filters]);\n\n  useEffect(() => {\n    const fetchTags = async () => {\n      try {\n        await datasource.languageProvider.start();\n        setIsTagsLoading(false);\n        setAlertText(undefined);\n      } catch (error) {\n        if (error instanceof Error) {\n          setAlertText(`Error: ${error.message}`);\n        }\n      }\n    };\n    fetchTags();\n  }, [datasource, setAlertText]);\n\n  useEffect(() => {\n    // Initialize state with configured static filters that already have a value from the config\n    datasource.search?.filters\n      ?.filter((f) => f.value)\n      .forEach((f) => {\n        if (!findFilter(f.id)) {\n          updateFilter(f);\n        }\n      });\n  }, [datasource.search?.filters, findFilter, updateFilter]);\n\n  // filter out tags that already exist in the static fields\n  const staticTags = datasource.search?.filters?.map((f) => f.tag) || [];\n  staticTags.push('duration');\n  staticTags.push('traceDuration');\n\n  // Dynamic filters are all filters that don't match the ID of a filter in the datasource configuration\n  // The duration and status fields are a special case since its selector is hard-coded\n  const dynamicFilters = (query.filters || []).filter(\n    (f) =>\n      !hardCodedFilterIds.includes(f.id) &&\n      (datasource.search?.filters?.findIndex((sf) => sf.id === f.id) || 0) === -1 &&\n      f.id !== 'duration-type'\n  );\n\n  return (\n    <>\n      <div className={styles.container}>\n        <div>\n          {datasource.search?.filters?.map(\n            (f) =>\n              f.tag && (\n                <InlineSearchField\n                  key={f.id}\n                  label={filterTitle(f)}\n                  tooltip={`Filter your search by ${filterScopedTag(\n                    f\n                  )}. To modify the default filters shown for search visit the Tempo datasource configuration page.`}\n                >\n                  <SearchField\n                    filter={findFilter(f.id) || f}\n                    datasource={datasource}\n                    setError={setError}\n                    updateFilter={updateFilter}\n                    tags={[]}\n                    hideScope={true}\n                    hideTag={true}\n                    query={traceQlQuery}\n                  />\n                </InlineSearchField>\n              )\n          )}\n          <InlineSearchField label={'Status'}>\n            <SearchField\n              filter={\n                findFilter('status') || {\n                  id: 'status',\n                  tag: 'status',\n                  scope: TraceqlSearchScope.Intrinsic,\n                  operator: '=',\n                }\n              }\n              datasource={datasource}\n              setError={setError}\n              updateFilter={updateFilter}\n              tags={[]}\n              hideScope={true}\n              hideTag={true}\n              query={traceQlQuery}\n              isMulti={false}\n              allowCustomValue={false}\n            />\n          </InlineSearchField>\n          <InlineSearchField\n            label={'Duration'}\n            tooltip=\"The trace or span duration, i.e. end - start time of the trace/span. Accepted units are ns, ms, s, m, h\"\n          >\n            <HorizontalGroup spacing={'none'}>\n              <Select\n                options={[\n                  { label: 'span', value: 'span' },\n                  { label: 'trace', value: 'trace' },\n                ]}\n                value={findFilter('duration-type')?.value ?? 'span'}\n                onChange={(v) => {\n                  const filter = findFilter('duration-type') || {\n                    id: 'duration-type',\n                    value: 'span',\n                  };\n                  updateFilter({ ...filter, value: v?.value });\n                }}\n                aria-label={'duration type'}\n              />\n              <DurationInput\n                filter={\n                  findFilter('min-duration') || {\n                    id: 'min-duration',\n                    tag: 'duration',\n                    operator: '>',\n                    valueType: 'duration',\n                  }\n                }\n                operators={['>', '>=']}\n                updateFilter={updateFilter}\n              />\n              <DurationInput\n                filter={\n                  findFilter('max-duration') || {\n                    id: 'max-duration',\n                    tag: 'duration',\n                    operator: '<',\n                    valueType: 'duration',\n                  }\n                }\n                operators={['<', '<=']}\n                updateFilter={updateFilter}\n              />\n            </HorizontalGroup>\n          </InlineSearchField>\n          <InlineSearchField label={'Tags'}>\n            <TagsInput\n              filters={dynamicFilters}\n              datasource={datasource}\n              setError={setError}\n              updateFilter={updateFilter}\n              deleteFilter={deleteFilter}\n              staticTags={staticTags}\n              isTagsLoading={isTagsLoading}\n              query={traceQlQuery}\n              requireTagAndValue={true}\n            />\n          </InlineSearchField>\n          {config.featureToggles.metricsSummary && (\n            <GroupByField datasource={datasource} onChange={onChange} query={query} isTagsLoading={isTagsLoading} />\n          )}\n        </div>\n        <div className={styles.rawQueryContainer}>\n          <RawQuery query={templateSrv.replace(traceQlQuery)} lang={{ grammar: traceqlGrammar, name: 'traceql' }} />\n          <Button\n            variant=\"secondary\"\n            size=\"sm\"\n            onClick={() => {\n              reportInteraction('grafana_traces_copy_to_traceql_clicked', {\n                app: app ?? '',\n                grafana_version: config.buildInfo.version,\n                location: 'search_tab',\n              });\n\n              onClearResults();\n              const traceQlQuery = generateQueryFromFilters(query.filters || []);\n              onChange({\n                ...query,\n                query: traceQlQuery,\n                queryType: 'traceql',\n              });\n            }}\n          >\n            Edit in TraceQL\n          </Button>\n        </div>\n        <TempoQueryBuilderOptions onChange={onChange} query={query} />\n      </div>\n      {error ? (\n        <Alert title=\"Unable to connect to Tempo search\" severity=\"info\" className={styles.alert}>\n          Please ensure that Tempo is configured with search enabled. If you would like to hide this tab, you can\n          configure it in the <a href={`/datasources/edit/${datasource.uid}`}>datasource settings</a>.\n        </Alert>\n      ) : null}\n      {alertText && <TemporaryAlert severity={'error'} text={alertText} />}\n    </>\n  );\n};\n\nexport default TraceQLSearch;\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  alert: css({\n    maxWidth: '75ch',\n    marginTop: theme.spacing(2),\n  }),\n  container: css({\n    display: 'flex',\n    gap: '4px',\n    flexWrap: 'wrap',\n    flexDirection: 'column',\n  }),\n  rawQueryContainer: css({\n    alignItems: 'center',\n    backgroundColor: theme.colors.background.secondary,\n    display: 'flex',\n    justifyContent: 'space-between',\n    padding: theme.spacing(1),\n  }),\n});\n","const consoleLogger = {\n  type: 'logger',\n  log(args) {\n    this.output('log', args);\n  },\n  warn(args) {\n    this.output('warn', args);\n  },\n  error(args) {\n    this.output('error', args);\n  },\n  output(type, args) {\n    if (console && console[type]) console[type].apply(console, args);\n  }\n};\nclass Logger {\n  constructor(concreteLogger) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    this.init(concreteLogger, options);\n  }\n  init(concreteLogger) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    this.prefix = options.prefix || 'i18next:';\n    this.logger = concreteLogger || consoleLogger;\n    this.options = options;\n    this.debug = options.debug;\n  }\n  log() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    return this.forward(args, 'log', '', true);\n  }\n  warn() {\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n    return this.forward(args, 'warn', '', true);\n  }\n  error() {\n    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n    return this.forward(args, 'error', '');\n  }\n  deprecate() {\n    for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n      args[_key4] = arguments[_key4];\n    }\n    return this.forward(args, 'warn', 'WARNING DEPRECATED: ', true);\n  }\n  forward(args, lvl, prefix, debugOnly) {\n    if (debugOnly && !this.debug) return null;\n    if (typeof args[0] === 'string') args[0] = `${prefix}${this.prefix} ${args[0]}`;\n    return this.logger[lvl](args);\n  }\n  create(moduleName) {\n    return new Logger(this.logger, {\n      ...{\n        prefix: `${this.prefix}:${moduleName}:`\n      },\n      ...this.options\n    });\n  }\n  clone(options) {\n    options = options || this.options;\n    options.prefix = options.prefix || this.prefix;\n    return new Logger(this.logger, options);\n  }\n}\nvar baseLogger = new Logger();\n\nclass EventEmitter {\n  constructor() {\n    this.observers = {};\n  }\n  on(events, listener) {\n    events.split(' ').forEach(event => {\n      if (!this.observers[event]) this.observers[event] = new Map();\n      const numListeners = this.observers[event].get(listener) || 0;\n      this.observers[event].set(listener, numListeners + 1);\n    });\n    return this;\n  }\n  off(event, listener) {\n    if (!this.observers[event]) return;\n    if (!listener) {\n      delete this.observers[event];\n      return;\n    }\n    this.observers[event].delete(listener);\n  }\n  emit(event) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n    if (this.observers[event]) {\n      const cloned = Array.from(this.observers[event].entries());\n      cloned.forEach(_ref => {\n        let [observer, numTimesAdded] = _ref;\n        for (let i = 0; i < numTimesAdded; i++) {\n          observer(...args);\n        }\n      });\n    }\n    if (this.observers['*']) {\n      const cloned = Array.from(this.observers['*'].entries());\n      cloned.forEach(_ref2 => {\n        let [observer, numTimesAdded] = _ref2;\n        for (let i = 0; i < numTimesAdded; i++) {\n          observer.apply(observer, [event, ...args]);\n        }\n      });\n    }\n  }\n}\n\nfunction defer() {\n  let res;\n  let rej;\n  const promise = new Promise((resolve, reject) => {\n    res = resolve;\n    rej = reject;\n  });\n  promise.resolve = res;\n  promise.reject = rej;\n  return promise;\n}\nfunction makeString(object) {\n  if (object == null) return '';\n  return '' + object;\n}\nfunction copy(a, s, t) {\n  a.forEach(m => {\n    if (s[m]) t[m] = s[m];\n  });\n}\nconst lastOfPathSeparatorRegExp = /###/g;\nfunction getLastOfPath(object, path, Empty) {\n  function cleanKey(key) {\n    return key && key.indexOf('###') > -1 ? key.replace(lastOfPathSeparatorRegExp, '.') : key;\n  }\n  function canNotTraverseDeeper() {\n    return !object || typeof object === 'string';\n  }\n  const stack = typeof path !== 'string' ? path : path.split('.');\n  let stackIndex = 0;\n  while (stackIndex < stack.length - 1) {\n    if (canNotTraverseDeeper()) return {};\n    const key = cleanKey(stack[stackIndex]);\n    if (!object[key] && Empty) object[key] = new Empty();\n    if (Object.prototype.hasOwnProperty.call(object, key)) {\n      object = object[key];\n    } else {\n      object = {};\n    }\n    ++stackIndex;\n  }\n  if (canNotTraverseDeeper()) return {};\n  return {\n    obj: object,\n    k: cleanKey(stack[stackIndex])\n  };\n}\nfunction setPath(object, path, newValue) {\n  const {\n    obj,\n    k\n  } = getLastOfPath(object, path, Object);\n  if (obj !== undefined || path.length === 1) {\n    obj[k] = newValue;\n    return;\n  }\n  let e = path[path.length - 1];\n  let p = path.slice(0, path.length - 1);\n  let last = getLastOfPath(object, p, Object);\n  while (last.obj === undefined && p.length) {\n    e = `${p[p.length - 1]}.${e}`;\n    p = p.slice(0, p.length - 1);\n    last = getLastOfPath(object, p, Object);\n    if (last && last.obj && typeof last.obj[`${last.k}.${e}`] !== 'undefined') {\n      last.obj = undefined;\n    }\n  }\n  last.obj[`${last.k}.${e}`] = newValue;\n}\nfunction pushPath(object, path, newValue, concat) {\n  const {\n    obj,\n    k\n  } = getLastOfPath(object, path, Object);\n  obj[k] = obj[k] || [];\n  if (concat) obj[k] = obj[k].concat(newValue);\n  if (!concat) obj[k].push(newValue);\n}\nfunction getPath(object, path) {\n  const {\n    obj,\n    k\n  } = getLastOfPath(object, path);\n  if (!obj) return undefined;\n  return obj[k];\n}\nfunction getPathWithDefaults(data, defaultData, key) {\n  const value = getPath(data, key);\n  if (value !== undefined) {\n    return value;\n  }\n  return getPath(defaultData, key);\n}\nfunction deepExtend(target, source, overwrite) {\n  for (const prop in source) {\n    if (prop !== '__proto__' && prop !== 'constructor') {\n      if (prop in target) {\n        if (typeof target[prop] === 'string' || target[prop] instanceof String || typeof source[prop] === 'string' || source[prop] instanceof String) {\n          if (overwrite) target[prop] = source[prop];\n        } else {\n          deepExtend(target[prop], source[prop], overwrite);\n        }\n      } else {\n        target[prop] = source[prop];\n      }\n    }\n  }\n  return target;\n}\nfunction regexEscape(str) {\n  return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&');\n}\nvar _entityMap = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;',\n  '/': '&#x2F;'\n};\nfunction escape(data) {\n  if (typeof data === 'string') {\n    return data.replace(/[&<>\"'\\/]/g, s => _entityMap[s]);\n  }\n  return data;\n}\nclass RegExpCache {\n  constructor(capacity) {\n    this.capacity = capacity;\n    this.regExpMap = new Map();\n    this.regExpQueue = [];\n  }\n  getRegExp(pattern) {\n    const regExpFromCache = this.regExpMap.get(pattern);\n    if (regExpFromCache !== undefined) {\n      return regExpFromCache;\n    }\n    const regExpNew = new RegExp(pattern);\n    if (this.regExpQueue.length === this.capacity) {\n      this.regExpMap.delete(this.regExpQueue.shift());\n    }\n    this.regExpMap.set(pattern, regExpNew);\n    this.regExpQueue.push(pattern);\n    return regExpNew;\n  }\n}\nconst chars = [' ', ',', '?', '!', ';'];\nconst looksLikeObjectPathRegExpCache = new RegExpCache(20);\nfunction looksLikeObjectPath(key, nsSeparator, keySeparator) {\n  nsSeparator = nsSeparator || '';\n  keySeparator = keySeparator || '';\n  const possibleChars = chars.filter(c => nsSeparator.indexOf(c) < 0 && keySeparator.indexOf(c) < 0);\n  if (possibleChars.length === 0) return true;\n  const r = looksLikeObjectPathRegExpCache.getRegExp(`(${possibleChars.map(c => c === '?' ? '\\\\?' : c).join('|')})`);\n  let matched = !r.test(key);\n  if (!matched) {\n    const ki = key.indexOf(keySeparator);\n    if (ki > 0 && !r.test(key.substring(0, ki))) {\n      matched = true;\n    }\n  }\n  return matched;\n}\nfunction deepFind(obj, path) {\n  let keySeparator = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '.';\n  if (!obj) return undefined;\n  if (obj[path]) return obj[path];\n  const tokens = path.split(keySeparator);\n  let current = obj;\n  for (let i = 0; i < tokens.length;) {\n    if (!current || typeof current !== 'object') {\n      return undefined;\n    }\n    let next;\n    let nextPath = '';\n    for (let j = i; j < tokens.length; ++j) {\n      if (j !== i) {\n        nextPath += keySeparator;\n      }\n      nextPath += tokens[j];\n      next = current[nextPath];\n      if (next !== undefined) {\n        if (['string', 'number', 'boolean'].indexOf(typeof next) > -1 && j < tokens.length - 1) {\n          continue;\n        }\n        i += j - i + 1;\n        break;\n      }\n    }\n    current = next;\n  }\n  return current;\n}\nfunction getCleanedCode(code) {\n  if (code && code.indexOf('_') > 0) return code.replace('_', '-');\n  return code;\n}\n\nclass ResourceStore extends EventEmitter {\n  constructor(data) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n      ns: ['translation'],\n      defaultNS: 'translation'\n    };\n    super();\n    this.data = data || {};\n    this.options = options;\n    if (this.options.keySeparator === undefined) {\n      this.options.keySeparator = '.';\n    }\n    if (this.options.ignoreJSONStructure === undefined) {\n      this.options.ignoreJSONStructure = true;\n    }\n  }\n  addNamespaces(ns) {\n    if (this.options.ns.indexOf(ns) < 0) {\n      this.options.ns.push(ns);\n    }\n  }\n  removeNamespaces(ns) {\n    const index = this.options.ns.indexOf(ns);\n    if (index > -1) {\n      this.options.ns.splice(index, 1);\n    }\n  }\n  getResource(lng, ns, key) {\n    let options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    const keySeparator = options.keySeparator !== undefined ? options.keySeparator : this.options.keySeparator;\n    const ignoreJSONStructure = options.ignoreJSONStructure !== undefined ? options.ignoreJSONStructure : this.options.ignoreJSONStructure;\n    let path;\n    if (lng.indexOf('.') > -1) {\n      path = lng.split('.');\n    } else {\n      path = [lng, ns];\n      if (key) {\n        if (Array.isArray(key)) {\n          path.push(...key);\n        } else if (typeof key === 'string' && keySeparator) {\n          path.push(...key.split(keySeparator));\n        } else {\n          path.push(key);\n        }\n      }\n    }\n    const result = getPath(this.data, path);\n    if (!result && !ns && !key && lng.indexOf('.') > -1) {\n      lng = path[0];\n      ns = path[1];\n      key = path.slice(2).join('.');\n    }\n    if (result || !ignoreJSONStructure || typeof key !== 'string') return result;\n    return deepFind(this.data && this.data[lng] && this.data[lng][ns], key, keySeparator);\n  }\n  addResource(lng, ns, key, value) {\n    let options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {\n      silent: false\n    };\n    const keySeparator = options.keySeparator !== undefined ? options.keySeparator : this.options.keySeparator;\n    let path = [lng, ns];\n    if (key) path = path.concat(keySeparator ? key.split(keySeparator) : key);\n    if (lng.indexOf('.') > -1) {\n      path = lng.split('.');\n      value = ns;\n      ns = path[1];\n    }\n    this.addNamespaces(ns);\n    setPath(this.data, path, value);\n    if (!options.silent) this.emit('added', lng, ns, key, value);\n  }\n  addResources(lng, ns, resources) {\n    let options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {\n      silent: false\n    };\n    for (const m in resources) {\n      if (typeof resources[m] === 'string' || Object.prototype.toString.apply(resources[m]) === '[object Array]') this.addResource(lng, ns, m, resources[m], {\n        silent: true\n      });\n    }\n    if (!options.silent) this.emit('added', lng, ns, resources);\n  }\n  addResourceBundle(lng, ns, resources, deep, overwrite) {\n    let options = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {\n      silent: false,\n      skipCopy: false\n    };\n    let path = [lng, ns];\n    if (lng.indexOf('.') > -1) {\n      path = lng.split('.');\n      deep = resources;\n      resources = ns;\n      ns = path[1];\n    }\n    this.addNamespaces(ns);\n    let pack = getPath(this.data, path) || {};\n    if (!options.skipCopy) resources = JSON.parse(JSON.stringify(resources));\n    if (deep) {\n      deepExtend(pack, resources, overwrite);\n    } else {\n      pack = {\n        ...pack,\n        ...resources\n      };\n    }\n    setPath(this.data, path, pack);\n    if (!options.silent) this.emit('added', lng, ns, resources);\n  }\n  removeResourceBundle(lng, ns) {\n    if (this.hasResourceBundle(lng, ns)) {\n      delete this.data[lng][ns];\n    }\n    this.removeNamespaces(ns);\n    this.emit('removed', lng, ns);\n  }\n  hasResourceBundle(lng, ns) {\n    return this.getResource(lng, ns) !== undefined;\n  }\n  getResourceBundle(lng, ns) {\n    if (!ns) ns = this.options.defaultNS;\n    if (this.options.compatibilityAPI === 'v1') return {\n      ...{},\n      ...this.getResource(lng, ns)\n    };\n    return this.getResource(lng, ns);\n  }\n  getDataByLanguage(lng) {\n    return this.data[lng];\n  }\n  hasLanguageSomeTranslations(lng) {\n    const data = this.getDataByLanguage(lng);\n    const n = data && Object.keys(data) || [];\n    return !!n.find(v => data[v] && Object.keys(data[v]).length > 0);\n  }\n  toJSON() {\n    return this.data;\n  }\n}\n\nvar postProcessor = {\n  processors: {},\n  addPostProcessor(module) {\n    this.processors[module.name] = module;\n  },\n  handle(processors, value, key, options, translator) {\n    processors.forEach(processor => {\n      if (this.processors[processor]) value = this.processors[processor].process(value, key, options, translator);\n    });\n    return value;\n  }\n};\n\nconst checkedLoadedFor = {};\nclass Translator extends EventEmitter {\n  constructor(services) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    super();\n    copy(['resourceStore', 'languageUtils', 'pluralResolver', 'interpolator', 'backendConnector', 'i18nFormat', 'utils'], services, this);\n    this.options = options;\n    if (this.options.keySeparator === undefined) {\n      this.options.keySeparator = '.';\n    }\n    this.logger = baseLogger.create('translator');\n  }\n  changeLanguage(lng) {\n    if (lng) this.language = lng;\n  }\n  exists(key) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n      interpolation: {}\n    };\n    if (key === undefined || key === null) {\n      return false;\n    }\n    const resolved = this.resolve(key, options);\n    return resolved && resolved.res !== undefined;\n  }\n  extractFromKey(key, options) {\n    let nsSeparator = options.nsSeparator !== undefined ? options.nsSeparator : this.options.nsSeparator;\n    if (nsSeparator === undefined) nsSeparator = ':';\n    const keySeparator = options.keySeparator !== undefined ? options.keySeparator : this.options.keySeparator;\n    let namespaces = options.ns || this.options.defaultNS || [];\n    const wouldCheckForNsInKey = nsSeparator && key.indexOf(nsSeparator) > -1;\n    const seemsNaturalLanguage = !this.options.userDefinedKeySeparator && !options.keySeparator && !this.options.userDefinedNsSeparator && !options.nsSeparator && !looksLikeObjectPath(key, nsSeparator, keySeparator);\n    if (wouldCheckForNsInKey && !seemsNaturalLanguage) {\n      const m = key.match(this.interpolator.nestingRegexp);\n      if (m && m.length > 0) {\n        return {\n          key,\n          namespaces\n        };\n      }\n      const parts = key.split(nsSeparator);\n      if (nsSeparator !== keySeparator || nsSeparator === keySeparator && this.options.ns.indexOf(parts[0]) > -1) namespaces = parts.shift();\n      key = parts.join(keySeparator);\n    }\n    if (typeof namespaces === 'string') namespaces = [namespaces];\n    return {\n      key,\n      namespaces\n    };\n  }\n  translate(keys, options, lastKey) {\n    if (typeof options !== 'object' && this.options.overloadTranslationOptionHandler) {\n      options = this.options.overloadTranslationOptionHandler(arguments);\n    }\n    if (typeof options === 'object') options = {\n      ...options\n    };\n    if (!options) options = {};\n    if (keys === undefined || keys === null) return '';\n    if (!Array.isArray(keys)) keys = [String(keys)];\n    const returnDetails = options.returnDetails !== undefined ? options.returnDetails : this.options.returnDetails;\n    const keySeparator = options.keySeparator !== undefined ? options.keySeparator : this.options.keySeparator;\n    const {\n      key,\n      namespaces\n    } = this.extractFromKey(keys[keys.length - 1], options);\n    const namespace = namespaces[namespaces.length - 1];\n    const lng = options.lng || this.language;\n    const appendNamespaceToCIMode = options.appendNamespaceToCIMode || this.options.appendNamespaceToCIMode;\n    if (lng && lng.toLowerCase() === 'cimode') {\n      if (appendNamespaceToCIMode) {\n        const nsSeparator = options.nsSeparator || this.options.nsSeparator;\n        if (returnDetails) {\n          return {\n            res: `${namespace}${nsSeparator}${key}`,\n            usedKey: key,\n            exactUsedKey: key,\n            usedLng: lng,\n            usedNS: namespace,\n            usedParams: this.getUsedParamsDetails(options)\n          };\n        }\n        return `${namespace}${nsSeparator}${key}`;\n      }\n      if (returnDetails) {\n        return {\n          res: key,\n          usedKey: key,\n          exactUsedKey: key,\n          usedLng: lng,\n          usedNS: namespace,\n          usedParams: this.getUsedParamsDetails(options)\n        };\n      }\n      return key;\n    }\n    const resolved = this.resolve(keys, options);\n    let res = resolved && resolved.res;\n    const resUsedKey = resolved && resolved.usedKey || key;\n    const resExactUsedKey = resolved && resolved.exactUsedKey || key;\n    const resType = Object.prototype.toString.apply(res);\n    const noObject = ['[object Number]', '[object Function]', '[object RegExp]'];\n    const joinArrays = options.joinArrays !== undefined ? options.joinArrays : this.options.joinArrays;\n    const handleAsObjectInI18nFormat = !this.i18nFormat || this.i18nFormat.handleAsObject;\n    const handleAsObject = typeof res !== 'string' && typeof res !== 'boolean' && typeof res !== 'number';\n    if (handleAsObjectInI18nFormat && res && handleAsObject && noObject.indexOf(resType) < 0 && !(typeof joinArrays === 'string' && resType === '[object Array]')) {\n      if (!options.returnObjects && !this.options.returnObjects) {\n        if (!this.options.returnedObjectHandler) {\n          this.logger.warn('accessing an object - but returnObjects options is not enabled!');\n        }\n        const r = this.options.returnedObjectHandler ? this.options.returnedObjectHandler(resUsedKey, res, {\n          ...options,\n          ns: namespaces\n        }) : `key '${key} (${this.language})' returned an object instead of string.`;\n        if (returnDetails) {\n          resolved.res = r;\n          resolved.usedParams = this.getUsedParamsDetails(options);\n          return resolved;\n        }\n        return r;\n      }\n      if (keySeparator) {\n        const resTypeIsArray = resType === '[object Array]';\n        const copy = resTypeIsArray ? [] : {};\n        const newKeyToUse = resTypeIsArray ? resExactUsedKey : resUsedKey;\n        for (const m in res) {\n          if (Object.prototype.hasOwnProperty.call(res, m)) {\n            const deepKey = `${newKeyToUse}${keySeparator}${m}`;\n            copy[m] = this.translate(deepKey, {\n              ...options,\n              ...{\n                joinArrays: false,\n                ns: namespaces\n              }\n            });\n            if (copy[m] === deepKey) copy[m] = res[m];\n          }\n        }\n        res = copy;\n      }\n    } else if (handleAsObjectInI18nFormat && typeof joinArrays === 'string' && resType === '[object Array]') {\n      res = res.join(joinArrays);\n      if (res) res = this.extendTranslation(res, keys, options, lastKey);\n    } else {\n      let usedDefault = false;\n      let usedKey = false;\n      const needsPluralHandling = options.count !== undefined && typeof options.count !== 'string';\n      const hasDefaultValue = Translator.hasDefaultValue(options);\n      const defaultValueSuffix = needsPluralHandling ? this.pluralResolver.getSuffix(lng, options.count, options) : '';\n      const defaultValueSuffixOrdinalFallback = options.ordinal && needsPluralHandling ? this.pluralResolver.getSuffix(lng, options.count, {\n        ordinal: false\n      }) : '';\n      const needsZeroSuffixLookup = needsPluralHandling && !options.ordinal && options.count === 0 && this.pluralResolver.shouldUseIntlApi();\n      const defaultValue = needsZeroSuffixLookup && options[`defaultValue${this.options.pluralSeparator}zero`] || options[`defaultValue${defaultValueSuffix}`] || options[`defaultValue${defaultValueSuffixOrdinalFallback}`] || options.defaultValue;\n      if (!this.isValidLookup(res) && hasDefaultValue) {\n        usedDefault = true;\n        res = defaultValue;\n      }\n      if (!this.isValidLookup(res)) {\n        usedKey = true;\n        res = key;\n      }\n      const missingKeyNoValueFallbackToKey = options.missingKeyNoValueFallbackToKey || this.options.missingKeyNoValueFallbackToKey;\n      const resForMissing = missingKeyNoValueFallbackToKey && usedKey ? undefined : res;\n      const updateMissing = hasDefaultValue && defaultValue !== res && this.options.updateMissing;\n      if (usedKey || usedDefault || updateMissing) {\n        this.logger.log(updateMissing ? 'updateKey' : 'missingKey', lng, namespace, key, updateMissing ? defaultValue : res);\n        if (keySeparator) {\n          const fk = this.resolve(key, {\n            ...options,\n            keySeparator: false\n          });\n          if (fk && fk.res) this.logger.warn('Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.');\n        }\n        let lngs = [];\n        const fallbackLngs = this.languageUtils.getFallbackCodes(this.options.fallbackLng, options.lng || this.language);\n        if (this.options.saveMissingTo === 'fallback' && fallbackLngs && fallbackLngs[0]) {\n          for (let i = 0; i < fallbackLngs.length; i++) {\n            lngs.push(fallbackLngs[i]);\n          }\n        } else if (this.options.saveMissingTo === 'all') {\n          lngs = this.languageUtils.toResolveHierarchy(options.lng || this.language);\n        } else {\n          lngs.push(options.lng || this.language);\n        }\n        const send = (l, k, specificDefaultValue) => {\n          const defaultForMissing = hasDefaultValue && specificDefaultValue !== res ? specificDefaultValue : resForMissing;\n          if (this.options.missingKeyHandler) {\n            this.options.missingKeyHandler(l, namespace, k, defaultForMissing, updateMissing, options);\n          } else if (this.backendConnector && this.backendConnector.saveMissing) {\n            this.backendConnector.saveMissing(l, namespace, k, defaultForMissing, updateMissing, options);\n          }\n          this.emit('missingKey', l, namespace, k, res);\n        };\n        if (this.options.saveMissing) {\n          if (this.options.saveMissingPlurals && needsPluralHandling) {\n            lngs.forEach(language => {\n              const suffixes = this.pluralResolver.getSuffixes(language, options);\n              if (needsZeroSuffixLookup && options[`defaultValue${this.options.pluralSeparator}zero`] && suffixes.indexOf(`${this.options.pluralSeparator}zero`) < 0) {\n                suffixes.push(`${this.options.pluralSeparator}zero`);\n              }\n              suffixes.forEach(suffix => {\n                send([language], key + suffix, options[`defaultValue${suffix}`] || defaultValue);\n              });\n            });\n          } else {\n            send(lngs, key, defaultValue);\n          }\n        }\n      }\n      res = this.extendTranslation(res, keys, options, resolved, lastKey);\n      if (usedKey && res === key && this.options.appendNamespaceToMissingKey) res = `${namespace}:${key}`;\n      if ((usedKey || usedDefault) && this.options.parseMissingKeyHandler) {\n        if (this.options.compatibilityAPI !== 'v1') {\n          res = this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey ? `${namespace}:${key}` : key, usedDefault ? res : undefined);\n        } else {\n          res = this.options.parseMissingKeyHandler(res);\n        }\n      }\n    }\n    if (returnDetails) {\n      resolved.res = res;\n      resolved.usedParams = this.getUsedParamsDetails(options);\n      return resolved;\n    }\n    return res;\n  }\n  extendTranslation(res, key, options, resolved, lastKey) {\n    var _this = this;\n    if (this.i18nFormat && this.i18nFormat.parse) {\n      res = this.i18nFormat.parse(res, {\n        ...this.options.interpolation.defaultVariables,\n        ...options\n      }, options.lng || this.language || resolved.usedLng, resolved.usedNS, resolved.usedKey, {\n        resolved\n      });\n    } else if (!options.skipInterpolation) {\n      if (options.interpolation) this.interpolator.init({\n        ...options,\n        ...{\n          interpolation: {\n            ...this.options.interpolation,\n            ...options.interpolation\n          }\n        }\n      });\n      const skipOnVariables = typeof res === 'string' && (options && options.interpolation && options.interpolation.skipOnVariables !== undefined ? options.interpolation.skipOnVariables : this.options.interpolation.skipOnVariables);\n      let nestBef;\n      if (skipOnVariables) {\n        const nb = res.match(this.interpolator.nestingRegexp);\n        nestBef = nb && nb.length;\n      }\n      let data = options.replace && typeof options.replace !== 'string' ? options.replace : options;\n      if (this.options.interpolation.defaultVariables) data = {\n        ...this.options.interpolation.defaultVariables,\n        ...data\n      };\n      res = this.interpolator.interpolate(res, data, options.lng || this.language, options);\n      if (skipOnVariables) {\n        const na = res.match(this.interpolator.nestingRegexp);\n        const nestAft = na && na.length;\n        if (nestBef < nestAft) options.nest = false;\n      }\n      if (!options.lng && this.options.compatibilityAPI !== 'v1' && resolved && resolved.res) options.lng = resolved.usedLng;\n      if (options.nest !== false) res = this.interpolator.nest(res, function () {\n        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n        if (lastKey && lastKey[0] === args[0] && !options.context) {\n          _this.logger.warn(`It seems you are nesting recursively key: ${args[0]} in key: ${key[0]}`);\n          return null;\n        }\n        return _this.translate(...args, key);\n      }, options);\n      if (options.interpolation) this.interpolator.reset();\n    }\n    const postProcess = options.postProcess || this.options.postProcess;\n    const postProcessorNames = typeof postProcess === 'string' ? [postProcess] : postProcess;\n    if (res !== undefined && res !== null && postProcessorNames && postProcessorNames.length && options.applyPostProcessor !== false) {\n      res = postProcessor.handle(postProcessorNames, res, key, this.options && this.options.postProcessPassResolved ? {\n        i18nResolved: {\n          ...resolved,\n          usedParams: this.getUsedParamsDetails(options)\n        },\n        ...options\n      } : options, this);\n    }\n    return res;\n  }\n  resolve(keys) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    let found;\n    let usedKey;\n    let exactUsedKey;\n    let usedLng;\n    let usedNS;\n    if (typeof keys === 'string') keys = [keys];\n    keys.forEach(k => {\n      if (this.isValidLookup(found)) return;\n      const extracted = this.extractFromKey(k, options);\n      const key = extracted.key;\n      usedKey = key;\n      let namespaces = extracted.namespaces;\n      if (this.options.fallbackNS) namespaces = namespaces.concat(this.options.fallbackNS);\n      const needsPluralHandling = options.count !== undefined && typeof options.count !== 'string';\n      const needsZeroSuffixLookup = needsPluralHandling && !options.ordinal && options.count === 0 && this.pluralResolver.shouldUseIntlApi();\n      const needsContextHandling = options.context !== undefined && (typeof options.context === 'string' || typeof options.context === 'number') && options.context !== '';\n      const codes = options.lngs ? options.lngs : this.languageUtils.toResolveHierarchy(options.lng || this.language, options.fallbackLng);\n      namespaces.forEach(ns => {\n        if (this.isValidLookup(found)) return;\n        usedNS = ns;\n        if (!checkedLoadedFor[`${codes[0]}-${ns}`] && this.utils && this.utils.hasLoadedNamespace && !this.utils.hasLoadedNamespace(usedNS)) {\n          checkedLoadedFor[`${codes[0]}-${ns}`] = true;\n          this.logger.warn(`key \"${usedKey}\" for languages \"${codes.join(', ')}\" won't get resolved as namespace \"${usedNS}\" was not yet loaded`, 'This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!');\n        }\n        codes.forEach(code => {\n          if (this.isValidLookup(found)) return;\n          usedLng = code;\n          const finalKeys = [key];\n          if (this.i18nFormat && this.i18nFormat.addLookupKeys) {\n            this.i18nFormat.addLookupKeys(finalKeys, key, code, ns, options);\n          } else {\n            let pluralSuffix;\n            if (needsPluralHandling) pluralSuffix = this.pluralResolver.getSuffix(code, options.count, options);\n            const zeroSuffix = `${this.options.pluralSeparator}zero`;\n            const ordinalPrefix = `${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;\n            if (needsPluralHandling) {\n              finalKeys.push(key + pluralSuffix);\n              if (options.ordinal && pluralSuffix.indexOf(ordinalPrefix) === 0) {\n                finalKeys.push(key + pluralSuffix.replace(ordinalPrefix, this.options.pluralSeparator));\n              }\n              if (needsZeroSuffixLookup) {\n                finalKeys.push(key + zeroSuffix);\n              }\n            }\n            if (needsContextHandling) {\n              const contextKey = `${key}${this.options.contextSeparator}${options.context}`;\n              finalKeys.push(contextKey);\n              if (needsPluralHandling) {\n                finalKeys.push(contextKey + pluralSuffix);\n                if (options.ordinal && pluralSuffix.indexOf(ordinalPrefix) === 0) {\n                  finalKeys.push(contextKey + pluralSuffix.replace(ordinalPrefix, this.options.pluralSeparator));\n                }\n                if (needsZeroSuffixLookup) {\n                  finalKeys.push(contextKey + zeroSuffix);\n                }\n              }\n            }\n          }\n          let possibleKey;\n          while (possibleKey = finalKeys.pop()) {\n            if (!this.isValidLookup(found)) {\n              exactUsedKey = possibleKey;\n              found = this.getResource(code, ns, possibleKey, options);\n            }\n          }\n        });\n      });\n    });\n    return {\n      res: found,\n      usedKey,\n      exactUsedKey,\n      usedLng,\n      usedNS\n    };\n  }\n  isValidLookup(res) {\n    return res !== undefined && !(!this.options.returnNull && res === null) && !(!this.options.returnEmptyString && res === '');\n  }\n  getResource(code, ns, key) {\n    let options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    if (this.i18nFormat && this.i18nFormat.getResource) return this.i18nFormat.getResource(code, ns, key, options);\n    return this.resourceStore.getResource(code, ns, key, options);\n  }\n  getUsedParamsDetails() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const optionsKeys = ['defaultValue', 'ordinal', 'context', 'replace', 'lng', 'lngs', 'fallbackLng', 'ns', 'keySeparator', 'nsSeparator', 'returnObjects', 'returnDetails', 'joinArrays', 'postProcess', 'interpolation'];\n    const useOptionsReplaceForData = options.replace && typeof options.replace !== 'string';\n    let data = useOptionsReplaceForData ? options.replace : options;\n    if (useOptionsReplaceForData && typeof options.count !== 'undefined') {\n      data.count = options.count;\n    }\n    if (this.options.interpolation.defaultVariables) {\n      data = {\n        ...this.options.interpolation.defaultVariables,\n        ...data\n      };\n    }\n    if (!useOptionsReplaceForData) {\n      data = {\n        ...data\n      };\n      for (const key of optionsKeys) {\n        delete data[key];\n      }\n    }\n    return data;\n  }\n  static hasDefaultValue(options) {\n    const prefix = 'defaultValue';\n    for (const option in options) {\n      if (Object.prototype.hasOwnProperty.call(options, option) && prefix === option.substring(0, prefix.length) && undefined !== options[option]) {\n        return true;\n      }\n    }\n    return false;\n  }\n}\n\nfunction capitalize(string) {\n  return string.charAt(0).toUpperCase() + string.slice(1);\n}\nclass LanguageUtil {\n  constructor(options) {\n    this.options = options;\n    this.supportedLngs = this.options.supportedLngs || false;\n    this.logger = baseLogger.create('languageUtils');\n  }\n  getScriptPartFromCode(code) {\n    code = getCleanedCode(code);\n    if (!code || code.indexOf('-') < 0) return null;\n    const p = code.split('-');\n    if (p.length === 2) return null;\n    p.pop();\n    if (p[p.length - 1].toLowerCase() === 'x') return null;\n    return this.formatLanguageCode(p.join('-'));\n  }\n  getLanguagePartFromCode(code) {\n    code = getCleanedCode(code);\n    if (!code || code.indexOf('-') < 0) return code;\n    const p = code.split('-');\n    return this.formatLanguageCode(p[0]);\n  }\n  formatLanguageCode(code) {\n    if (typeof code === 'string' && code.indexOf('-') > -1) {\n      const specialCases = ['hans', 'hant', 'latn', 'cyrl', 'cans', 'mong', 'arab'];\n      let p = code.split('-');\n      if (this.options.lowerCaseLng) {\n        p = p.map(part => part.toLowerCase());\n      } else if (p.length === 2) {\n        p[0] = p[0].toLowerCase();\n        p[1] = p[1].toUpperCase();\n        if (specialCases.indexOf(p[1].toLowerCase()) > -1) p[1] = capitalize(p[1].toLowerCase());\n      } else if (p.length === 3) {\n        p[0] = p[0].toLowerCase();\n        if (p[1].length === 2) p[1] = p[1].toUpperCase();\n        if (p[0] !== 'sgn' && p[2].length === 2) p[2] = p[2].toUpperCase();\n        if (specialCases.indexOf(p[1].toLowerCase()) > -1) p[1] = capitalize(p[1].toLowerCase());\n        if (specialCases.indexOf(p[2].toLowerCase()) > -1) p[2] = capitalize(p[2].toLowerCase());\n      }\n      return p.join('-');\n    }\n    return this.options.cleanCode || this.options.lowerCaseLng ? code.toLowerCase() : code;\n  }\n  isSupportedCode(code) {\n    if (this.options.load === 'languageOnly' || this.options.nonExplicitSupportedLngs) {\n      code = this.getLanguagePartFromCode(code);\n    }\n    return !this.supportedLngs || !this.supportedLngs.length || this.supportedLngs.indexOf(code) > -1;\n  }\n  getBestMatchFromCodes(codes) {\n    if (!codes) return null;\n    let found;\n    codes.forEach(code => {\n      if (found) return;\n      const cleanedLng = this.formatLanguageCode(code);\n      if (!this.options.supportedLngs || this.isSupportedCode(cleanedLng)) found = cleanedLng;\n    });\n    if (!found && this.options.supportedLngs) {\n      codes.forEach(code => {\n        if (found) return;\n        const lngOnly = this.getLanguagePartFromCode(code);\n        if (this.isSupportedCode(lngOnly)) return found = lngOnly;\n        found = this.options.supportedLngs.find(supportedLng => {\n          if (supportedLng === lngOnly) return supportedLng;\n          if (supportedLng.indexOf('-') < 0 && lngOnly.indexOf('-') < 0) return;\n          if (supportedLng.indexOf('-') > 0 && lngOnly.indexOf('-') < 0 && supportedLng.substring(0, supportedLng.indexOf('-')) === lngOnly) return supportedLng;\n          if (supportedLng.indexOf(lngOnly) === 0 && lngOnly.length > 1) return supportedLng;\n        });\n      });\n    }\n    if (!found) found = this.getFallbackCodes(this.options.fallbackLng)[0];\n    return found;\n  }\n  getFallbackCodes(fallbacks, code) {\n    if (!fallbacks) return [];\n    if (typeof fallbacks === 'function') fallbacks = fallbacks(code);\n    if (typeof fallbacks === 'string') fallbacks = [fallbacks];\n    if (Object.prototype.toString.apply(fallbacks) === '[object Array]') return fallbacks;\n    if (!code) return fallbacks.default || [];\n    let found = fallbacks[code];\n    if (!found) found = fallbacks[this.getScriptPartFromCode(code)];\n    if (!found) found = fallbacks[this.formatLanguageCode(code)];\n    if (!found) found = fallbacks[this.getLanguagePartFromCode(code)];\n    if (!found) found = fallbacks.default;\n    return found || [];\n  }\n  toResolveHierarchy(code, fallbackCode) {\n    const fallbackCodes = this.getFallbackCodes(fallbackCode || this.options.fallbackLng || [], code);\n    const codes = [];\n    const addCode = c => {\n      if (!c) return;\n      if (this.isSupportedCode(c)) {\n        codes.push(c);\n      } else {\n        this.logger.warn(`rejecting language code not found in supportedLngs: ${c}`);\n      }\n    };\n    if (typeof code === 'string' && (code.indexOf('-') > -1 || code.indexOf('_') > -1)) {\n      if (this.options.load !== 'languageOnly') addCode(this.formatLanguageCode(code));\n      if (this.options.load !== 'languageOnly' && this.options.load !== 'currentOnly') addCode(this.getScriptPartFromCode(code));\n      if (this.options.load !== 'currentOnly') addCode(this.getLanguagePartFromCode(code));\n    } else if (typeof code === 'string') {\n      addCode(this.formatLanguageCode(code));\n    }\n    fallbackCodes.forEach(fc => {\n      if (codes.indexOf(fc) < 0) addCode(this.formatLanguageCode(fc));\n    });\n    return codes;\n  }\n}\n\nlet sets = [{\n  lngs: ['ach', 'ak', 'am', 'arn', 'br', 'fil', 'gun', 'ln', 'mfe', 'mg', 'mi', 'oc', 'pt', 'pt-BR', 'tg', 'tl', 'ti', 'tr', 'uz', 'wa'],\n  nr: [1, 2],\n  fc: 1\n}, {\n  lngs: ['af', 'an', 'ast', 'az', 'bg', 'bn', 'ca', 'da', 'de', 'dev', 'el', 'en', 'eo', 'es', 'et', 'eu', 'fi', 'fo', 'fur', 'fy', 'gl', 'gu', 'ha', 'hi', 'hu', 'hy', 'ia', 'it', 'kk', 'kn', 'ku', 'lb', 'mai', 'ml', 'mn', 'mr', 'nah', 'nap', 'nb', 'ne', 'nl', 'nn', 'no', 'nso', 'pa', 'pap', 'pms', 'ps', 'pt-PT', 'rm', 'sco', 'se', 'si', 'so', 'son', 'sq', 'sv', 'sw', 'ta', 'te', 'tk', 'ur', 'yo'],\n  nr: [1, 2],\n  fc: 2\n}, {\n  lngs: ['ay', 'bo', 'cgg', 'fa', 'ht', 'id', 'ja', 'jbo', 'ka', 'km', 'ko', 'ky', 'lo', 'ms', 'sah', 'su', 'th', 'tt', 'ug', 'vi', 'wo', 'zh'],\n  nr: [1],\n  fc: 3\n}, {\n  lngs: ['be', 'bs', 'cnr', 'dz', 'hr', 'ru', 'sr', 'uk'],\n  nr: [1, 2, 5],\n  fc: 4\n}, {\n  lngs: ['ar'],\n  nr: [0, 1, 2, 3, 11, 100],\n  fc: 5\n}, {\n  lngs: ['cs', 'sk'],\n  nr: [1, 2, 5],\n  fc: 6\n}, {\n  lngs: ['csb', 'pl'],\n  nr: [1, 2, 5],\n  fc: 7\n}, {\n  lngs: ['cy'],\n  nr: [1, 2, 3, 8],\n  fc: 8\n}, {\n  lngs: ['fr'],\n  nr: [1, 2],\n  fc: 9\n}, {\n  lngs: ['ga'],\n  nr: [1, 2, 3, 7, 11],\n  fc: 10\n}, {\n  lngs: ['gd'],\n  nr: [1, 2, 3, 20],\n  fc: 11\n}, {\n  lngs: ['is'],\n  nr: [1, 2],\n  fc: 12\n}, {\n  lngs: ['jv'],\n  nr: [0, 1],\n  fc: 13\n}, {\n  lngs: ['kw'],\n  nr: [1, 2, 3, 4],\n  fc: 14\n}, {\n  lngs: ['lt'],\n  nr: [1, 2, 10],\n  fc: 15\n}, {\n  lngs: ['lv'],\n  nr: [1, 2, 0],\n  fc: 16\n}, {\n  lngs: ['mk'],\n  nr: [1, 2],\n  fc: 17\n}, {\n  lngs: ['mnk'],\n  nr: [0, 1, 2],\n  fc: 18\n}, {\n  lngs: ['mt'],\n  nr: [1, 2, 11, 20],\n  fc: 19\n}, {\n  lngs: ['or'],\n  nr: [2, 1],\n  fc: 2\n}, {\n  lngs: ['ro'],\n  nr: [1, 2, 20],\n  fc: 20\n}, {\n  lngs: ['sl'],\n  nr: [5, 1, 2, 3],\n  fc: 21\n}, {\n  lngs: ['he', 'iw'],\n  nr: [1, 2, 20, 21],\n  fc: 22\n}];\nlet _rulesPluralsTypes = {\n  1: function (n) {\n    return Number(n > 1);\n  },\n  2: function (n) {\n    return Number(n != 1);\n  },\n  3: function (n) {\n    return 0;\n  },\n  4: function (n) {\n    return Number(n % 10 == 1 && n % 100 != 11 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2);\n  },\n  5: function (n) {\n    return Number(n == 0 ? 0 : n == 1 ? 1 : n == 2 ? 2 : n % 100 >= 3 && n % 100 <= 10 ? 3 : n % 100 >= 11 ? 4 : 5);\n  },\n  6: function (n) {\n    return Number(n == 1 ? 0 : n >= 2 && n <= 4 ? 1 : 2);\n  },\n  7: function (n) {\n    return Number(n == 1 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2);\n  },\n  8: function (n) {\n    return Number(n == 1 ? 0 : n == 2 ? 1 : n != 8 && n != 11 ? 2 : 3);\n  },\n  9: function (n) {\n    return Number(n >= 2);\n  },\n  10: function (n) {\n    return Number(n == 1 ? 0 : n == 2 ? 1 : n < 7 ? 2 : n < 11 ? 3 : 4);\n  },\n  11: function (n) {\n    return Number(n == 1 || n == 11 ? 0 : n == 2 || n == 12 ? 1 : n > 2 && n < 20 ? 2 : 3);\n  },\n  12: function (n) {\n    return Number(n % 10 != 1 || n % 100 == 11);\n  },\n  13: function (n) {\n    return Number(n !== 0);\n  },\n  14: function (n) {\n    return Number(n == 1 ? 0 : n == 2 ? 1 : n == 3 ? 2 : 3);\n  },\n  15: function (n) {\n    return Number(n % 10 == 1 && n % 100 != 11 ? 0 : n % 10 >= 2 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2);\n  },\n  16: function (n) {\n    return Number(n % 10 == 1 && n % 100 != 11 ? 0 : n !== 0 ? 1 : 2);\n  },\n  17: function (n) {\n    return Number(n == 1 || n % 10 == 1 && n % 100 != 11 ? 0 : 1);\n  },\n  18: function (n) {\n    return Number(n == 0 ? 0 : n == 1 ? 1 : 2);\n  },\n  19: function (n) {\n    return Number(n == 1 ? 0 : n == 0 || n % 100 > 1 && n % 100 < 11 ? 1 : n % 100 > 10 && n % 100 < 20 ? 2 : 3);\n  },\n  20: function (n) {\n    return Number(n == 1 ? 0 : n == 0 || n % 100 > 0 && n % 100 < 20 ? 1 : 2);\n  },\n  21: function (n) {\n    return Number(n % 100 == 1 ? 1 : n % 100 == 2 ? 2 : n % 100 == 3 || n % 100 == 4 ? 3 : 0);\n  },\n  22: function (n) {\n    return Number(n == 1 ? 0 : n == 2 ? 1 : (n < 0 || n > 10) && n % 10 == 0 ? 2 : 3);\n  }\n};\nconst nonIntlVersions = ['v1', 'v2', 'v3'];\nconst intlVersions = ['v4'];\nconst suffixesOrder = {\n  zero: 0,\n  one: 1,\n  two: 2,\n  few: 3,\n  many: 4,\n  other: 5\n};\nfunction createRules() {\n  const rules = {};\n  sets.forEach(set => {\n    set.lngs.forEach(l => {\n      rules[l] = {\n        numbers: set.nr,\n        plurals: _rulesPluralsTypes[set.fc]\n      };\n    });\n  });\n  return rules;\n}\nclass PluralResolver {\n  constructor(languageUtils) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    this.languageUtils = languageUtils;\n    this.options = options;\n    this.logger = baseLogger.create('pluralResolver');\n    if ((!this.options.compatibilityJSON || intlVersions.includes(this.options.compatibilityJSON)) && (typeof Intl === 'undefined' || !Intl.PluralRules)) {\n      this.options.compatibilityJSON = 'v3';\n      this.logger.error('Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.');\n    }\n    this.rules = createRules();\n  }\n  addRule(lng, obj) {\n    this.rules[lng] = obj;\n  }\n  getRule(code) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    if (this.shouldUseIntlApi()) {\n      try {\n        return new Intl.PluralRules(getCleanedCode(code === 'dev' ? 'en' : code), {\n          type: options.ordinal ? 'ordinal' : 'cardinal'\n        });\n      } catch (err) {\n        return;\n      }\n    }\n    return this.rules[code] || this.rules[this.languageUtils.getLanguagePartFromCode(code)];\n  }\n  needsPlural(code) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const rule = this.getRule(code, options);\n    if (this.shouldUseIntlApi()) {\n      return rule && rule.resolvedOptions().pluralCategories.length > 1;\n    }\n    return rule && rule.numbers.length > 1;\n  }\n  getPluralFormsOfKey(code, key) {\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return this.getSuffixes(code, options).map(suffix => `${key}${suffix}`);\n  }\n  getSuffixes(code) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const rule = this.getRule(code, options);\n    if (!rule) {\n      return [];\n    }\n    if (this.shouldUseIntlApi()) {\n      return rule.resolvedOptions().pluralCategories.sort((pluralCategory1, pluralCategory2) => suffixesOrder[pluralCategory1] - suffixesOrder[pluralCategory2]).map(pluralCategory => `${this.options.prepend}${options.ordinal ? `ordinal${this.options.prepend}` : ''}${pluralCategory}`);\n    }\n    return rule.numbers.map(number => this.getSuffix(code, number, options));\n  }\n  getSuffix(code, count) {\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    const rule = this.getRule(code, options);\n    if (rule) {\n      if (this.shouldUseIntlApi()) {\n        return `${this.options.prepend}${options.ordinal ? `ordinal${this.options.prepend}` : ''}${rule.select(count)}`;\n      }\n      return this.getSuffixRetroCompatible(rule, count);\n    }\n    this.logger.warn(`no plural rule found for: ${code}`);\n    return '';\n  }\n  getSuffixRetroCompatible(rule, count) {\n    const idx = rule.noAbs ? rule.plurals(count) : rule.plurals(Math.abs(count));\n    let suffix = rule.numbers[idx];\n    if (this.options.simplifyPluralSuffix && rule.numbers.length === 2 && rule.numbers[0] === 1) {\n      if (suffix === 2) {\n        suffix = 'plural';\n      } else if (suffix === 1) {\n        suffix = '';\n      }\n    }\n    const returnSuffix = () => this.options.prepend && suffix.toString() ? this.options.prepend + suffix.toString() : suffix.toString();\n    if (this.options.compatibilityJSON === 'v1') {\n      if (suffix === 1) return '';\n      if (typeof suffix === 'number') return `_plural_${suffix.toString()}`;\n      return returnSuffix();\n    } else if (this.options.compatibilityJSON === 'v2') {\n      return returnSuffix();\n    } else if (this.options.simplifyPluralSuffix && rule.numbers.length === 2 && rule.numbers[0] === 1) {\n      return returnSuffix();\n    }\n    return this.options.prepend && idx.toString() ? this.options.prepend + idx.toString() : idx.toString();\n  }\n  shouldUseIntlApi() {\n    return !nonIntlVersions.includes(this.options.compatibilityJSON);\n  }\n}\n\nfunction deepFindWithDefaults(data, defaultData, key) {\n  let keySeparator = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '.';\n  let ignoreJSONStructure = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : true;\n  let path = getPathWithDefaults(data, defaultData, key);\n  if (!path && ignoreJSONStructure && typeof key === 'string') {\n    path = deepFind(data, key, keySeparator);\n    if (path === undefined) path = deepFind(defaultData, key, keySeparator);\n  }\n  return path;\n}\nclass Interpolator {\n  constructor() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this.logger = baseLogger.create('interpolator');\n    this.options = options;\n    this.format = options.interpolation && options.interpolation.format || (value => value);\n    this.init(options);\n  }\n  init() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (!options.interpolation) options.interpolation = {\n      escapeValue: true\n    };\n    const iOpts = options.interpolation;\n    this.escape = iOpts.escape !== undefined ? iOpts.escape : escape;\n    this.escapeValue = iOpts.escapeValue !== undefined ? iOpts.escapeValue : true;\n    this.useRawValueToEscape = iOpts.useRawValueToEscape !== undefined ? iOpts.useRawValueToEscape : false;\n    this.prefix = iOpts.prefix ? regexEscape(iOpts.prefix) : iOpts.prefixEscaped || '{{';\n    this.suffix = iOpts.suffix ? regexEscape(iOpts.suffix) : iOpts.suffixEscaped || '}}';\n    this.formatSeparator = iOpts.formatSeparator ? iOpts.formatSeparator : iOpts.formatSeparator || ',';\n    this.unescapePrefix = iOpts.unescapeSuffix ? '' : iOpts.unescapePrefix || '-';\n    this.unescapeSuffix = this.unescapePrefix ? '' : iOpts.unescapeSuffix || '';\n    this.nestingPrefix = iOpts.nestingPrefix ? regexEscape(iOpts.nestingPrefix) : iOpts.nestingPrefixEscaped || regexEscape('$t(');\n    this.nestingSuffix = iOpts.nestingSuffix ? regexEscape(iOpts.nestingSuffix) : iOpts.nestingSuffixEscaped || regexEscape(')');\n    this.nestingOptionsSeparator = iOpts.nestingOptionsSeparator ? iOpts.nestingOptionsSeparator : iOpts.nestingOptionsSeparator || ',';\n    this.maxReplaces = iOpts.maxReplaces ? iOpts.maxReplaces : 1000;\n    this.alwaysFormat = iOpts.alwaysFormat !== undefined ? iOpts.alwaysFormat : false;\n    this.resetRegExp();\n  }\n  reset() {\n    if (this.options) this.init(this.options);\n  }\n  resetRegExp() {\n    const getOrResetRegExp = (existingRegExp, pattern) => {\n      if (existingRegExp && existingRegExp.source === pattern) {\n        existingRegExp.lastIndex = 0;\n        return existingRegExp;\n      }\n      return new RegExp(pattern, 'g');\n    };\n    this.regexp = getOrResetRegExp(this.regexp, `${this.prefix}(.+?)${this.suffix}`);\n    this.regexpUnescape = getOrResetRegExp(this.regexpUnescape, `${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`);\n    this.nestingRegexp = getOrResetRegExp(this.nestingRegexp, `${this.nestingPrefix}(.+?)${this.nestingSuffix}`);\n  }\n  interpolate(str, data, lng, options) {\n    let match;\n    let value;\n    let replaces;\n    const defaultData = this.options && this.options.interpolation && this.options.interpolation.defaultVariables || {};\n    function regexSafe(val) {\n      return val.replace(/\\$/g, '$$$$');\n    }\n    const handleFormat = key => {\n      if (key.indexOf(this.formatSeparator) < 0) {\n        const path = deepFindWithDefaults(data, defaultData, key, this.options.keySeparator, this.options.ignoreJSONStructure);\n        return this.alwaysFormat ? this.format(path, undefined, lng, {\n          ...options,\n          ...data,\n          interpolationkey: key\n        }) : path;\n      }\n      const p = key.split(this.formatSeparator);\n      const k = p.shift().trim();\n      const f = p.join(this.formatSeparator).trim();\n      return this.format(deepFindWithDefaults(data, defaultData, k, this.options.keySeparator, this.options.ignoreJSONStructure), f, lng, {\n        ...options,\n        ...data,\n        interpolationkey: k\n      });\n    };\n    this.resetRegExp();\n    const missingInterpolationHandler = options && options.missingInterpolationHandler || this.options.missingInterpolationHandler;\n    const skipOnVariables = options && options.interpolation && options.interpolation.skipOnVariables !== undefined ? options.interpolation.skipOnVariables : this.options.interpolation.skipOnVariables;\n    const todos = [{\n      regex: this.regexpUnescape,\n      safeValue: val => regexSafe(val)\n    }, {\n      regex: this.regexp,\n      safeValue: val => this.escapeValue ? regexSafe(this.escape(val)) : regexSafe(val)\n    }];\n    todos.forEach(todo => {\n      replaces = 0;\n      while (match = todo.regex.exec(str)) {\n        const matchedVar = match[1].trim();\n        value = handleFormat(matchedVar);\n        if (value === undefined) {\n          if (typeof missingInterpolationHandler === 'function') {\n            const temp = missingInterpolationHandler(str, match, options);\n            value = typeof temp === 'string' ? temp : '';\n          } else if (options && Object.prototype.hasOwnProperty.call(options, matchedVar)) {\n            value = '';\n          } else if (skipOnVariables) {\n            value = match[0];\n            continue;\n          } else {\n            this.logger.warn(`missed to pass in variable ${matchedVar} for interpolating ${str}`);\n            value = '';\n          }\n        } else if (typeof value !== 'string' && !this.useRawValueToEscape) {\n          value = makeString(value);\n        }\n        const safeValue = todo.safeValue(value);\n        str = str.replace(match[0], safeValue);\n        if (skipOnVariables) {\n          todo.regex.lastIndex += value.length;\n          todo.regex.lastIndex -= match[0].length;\n        } else {\n          todo.regex.lastIndex = 0;\n        }\n        replaces++;\n        if (replaces >= this.maxReplaces) {\n          break;\n        }\n      }\n    });\n    return str;\n  }\n  nest(str, fc) {\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    let match;\n    let value;\n    let clonedOptions;\n    function handleHasOptions(key, inheritedOptions) {\n      const sep = this.nestingOptionsSeparator;\n      if (key.indexOf(sep) < 0) return key;\n      const c = key.split(new RegExp(`${sep}[ ]*{`));\n      let optionsString = `{${c[1]}`;\n      key = c[0];\n      optionsString = this.interpolate(optionsString, clonedOptions);\n      const matchedSingleQuotes = optionsString.match(/'/g);\n      const matchedDoubleQuotes = optionsString.match(/\"/g);\n      if (matchedSingleQuotes && matchedSingleQuotes.length % 2 === 0 && !matchedDoubleQuotes || matchedDoubleQuotes.length % 2 !== 0) {\n        optionsString = optionsString.replace(/'/g, '\"');\n      }\n      try {\n        clonedOptions = JSON.parse(optionsString);\n        if (inheritedOptions) clonedOptions = {\n          ...inheritedOptions,\n          ...clonedOptions\n        };\n      } catch (e) {\n        this.logger.warn(`failed parsing options string in nesting for key ${key}`, e);\n        return `${key}${sep}${optionsString}`;\n      }\n      delete clonedOptions.defaultValue;\n      return key;\n    }\n    while (match = this.nestingRegexp.exec(str)) {\n      let formatters = [];\n      clonedOptions = {\n        ...options\n      };\n      clonedOptions = clonedOptions.replace && typeof clonedOptions.replace !== 'string' ? clonedOptions.replace : clonedOptions;\n      clonedOptions.applyPostProcessor = false;\n      delete clonedOptions.defaultValue;\n      let doReduce = false;\n      if (match[0].indexOf(this.formatSeparator) !== -1 && !/{.*}/.test(match[1])) {\n        const r = match[1].split(this.formatSeparator).map(elem => elem.trim());\n        match[1] = r.shift();\n        formatters = r;\n        doReduce = true;\n      }\n      value = fc(handleHasOptions.call(this, match[1].trim(), clonedOptions), clonedOptions);\n      if (value && match[0] === str && typeof value !== 'string') return value;\n      if (typeof value !== 'string') value = makeString(value);\n      if (!value) {\n        this.logger.warn(`missed to resolve ${match[1]} for nesting ${str}`);\n        value = '';\n      }\n      if (doReduce) {\n        value = formatters.reduce((v, f) => this.format(v, f, options.lng, {\n          ...options,\n          interpolationkey: match[1].trim()\n        }), value.trim());\n      }\n      str = str.replace(match[0], value);\n      this.regexp.lastIndex = 0;\n    }\n    return str;\n  }\n}\n\nfunction parseFormatStr(formatStr) {\n  let formatName = formatStr.toLowerCase().trim();\n  const formatOptions = {};\n  if (formatStr.indexOf('(') > -1) {\n    const p = formatStr.split('(');\n    formatName = p[0].toLowerCase().trim();\n    const optStr = p[1].substring(0, p[1].length - 1);\n    if (formatName === 'currency' && optStr.indexOf(':') < 0) {\n      if (!formatOptions.currency) formatOptions.currency = optStr.trim();\n    } else if (formatName === 'relativetime' && optStr.indexOf(':') < 0) {\n      if (!formatOptions.range) formatOptions.range = optStr.trim();\n    } else {\n      const opts = optStr.split(';');\n      opts.forEach(opt => {\n        if (!opt) return;\n        const [key, ...rest] = opt.split(':');\n        const val = rest.join(':').trim().replace(/^'+|'+$/g, '');\n        if (!formatOptions[key.trim()]) formatOptions[key.trim()] = val;\n        if (val === 'false') formatOptions[key.trim()] = false;\n        if (val === 'true') formatOptions[key.trim()] = true;\n        if (!isNaN(val)) formatOptions[key.trim()] = parseInt(val, 10);\n      });\n    }\n  }\n  return {\n    formatName,\n    formatOptions\n  };\n}\nfunction createCachedFormatter(fn) {\n  const cache = {};\n  return function invokeFormatter(val, lng, options) {\n    const key = lng + JSON.stringify(options);\n    let formatter = cache[key];\n    if (!formatter) {\n      formatter = fn(getCleanedCode(lng), options);\n      cache[key] = formatter;\n    }\n    return formatter(val);\n  };\n}\nclass Formatter {\n  constructor() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this.logger = baseLogger.create('formatter');\n    this.options = options;\n    this.formats = {\n      number: createCachedFormatter((lng, opt) => {\n        const formatter = new Intl.NumberFormat(lng, {\n          ...opt\n        });\n        return val => formatter.format(val);\n      }),\n      currency: createCachedFormatter((lng, opt) => {\n        const formatter = new Intl.NumberFormat(lng, {\n          ...opt,\n          style: 'currency'\n        });\n        return val => formatter.format(val);\n      }),\n      datetime: createCachedFormatter((lng, opt) => {\n        const formatter = new Intl.DateTimeFormat(lng, {\n          ...opt\n        });\n        return val => formatter.format(val);\n      }),\n      relativetime: createCachedFormatter((lng, opt) => {\n        const formatter = new Intl.RelativeTimeFormat(lng, {\n          ...opt\n        });\n        return val => formatter.format(val, opt.range || 'day');\n      }),\n      list: createCachedFormatter((lng, opt) => {\n        const formatter = new Intl.ListFormat(lng, {\n          ...opt\n        });\n        return val => formatter.format(val);\n      })\n    };\n    this.init(options);\n  }\n  init(services) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n      interpolation: {}\n    };\n    const iOpts = options.interpolation;\n    this.formatSeparator = iOpts.formatSeparator ? iOpts.formatSeparator : iOpts.formatSeparator || ',';\n  }\n  add(name, fc) {\n    this.formats[name.toLowerCase().trim()] = fc;\n  }\n  addCached(name, fc) {\n    this.formats[name.toLowerCase().trim()] = createCachedFormatter(fc);\n  }\n  format(value, format, lng) {\n    let options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    const formats = format.split(this.formatSeparator);\n    const result = formats.reduce((mem, f) => {\n      const {\n        formatName,\n        formatOptions\n      } = parseFormatStr(f);\n      if (this.formats[formatName]) {\n        let formatted = mem;\n        try {\n          const valOptions = options && options.formatParams && options.formatParams[options.interpolationkey] || {};\n          const l = valOptions.locale || valOptions.lng || options.locale || options.lng || lng;\n          formatted = this.formats[formatName](mem, l, {\n            ...formatOptions,\n            ...options,\n            ...valOptions\n          });\n        } catch (error) {\n          this.logger.warn(error);\n        }\n        return formatted;\n      } else {\n        this.logger.warn(`there was no format function for ${formatName}`);\n      }\n      return mem;\n    }, value);\n    return result;\n  }\n}\n\nfunction removePending(q, name) {\n  if (q.pending[name] !== undefined) {\n    delete q.pending[name];\n    q.pendingCount--;\n  }\n}\nclass Connector extends EventEmitter {\n  constructor(backend, store, services) {\n    let options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    super();\n    this.backend = backend;\n    this.store = store;\n    this.services = services;\n    this.languageUtils = services.languageUtils;\n    this.options = options;\n    this.logger = baseLogger.create('backendConnector');\n    this.waitingReads = [];\n    this.maxParallelReads = options.maxParallelReads || 10;\n    this.readingCalls = 0;\n    this.maxRetries = options.maxRetries >= 0 ? options.maxRetries : 5;\n    this.retryTimeout = options.retryTimeout >= 1 ? options.retryTimeout : 350;\n    this.state = {};\n    this.queue = [];\n    if (this.backend && this.backend.init) {\n      this.backend.init(services, options.backend, options);\n    }\n  }\n  queueLoad(languages, namespaces, options, callback) {\n    const toLoad = {};\n    const pending = {};\n    const toLoadLanguages = {};\n    const toLoadNamespaces = {};\n    languages.forEach(lng => {\n      let hasAllNamespaces = true;\n      namespaces.forEach(ns => {\n        const name = `${lng}|${ns}`;\n        if (!options.reload && this.store.hasResourceBundle(lng, ns)) {\n          this.state[name] = 2;\n        } else if (this.state[name] < 0) ; else if (this.state[name] === 1) {\n          if (pending[name] === undefined) pending[name] = true;\n        } else {\n          this.state[name] = 1;\n          hasAllNamespaces = false;\n          if (pending[name] === undefined) pending[name] = true;\n          if (toLoad[name] === undefined) toLoad[name] = true;\n          if (toLoadNamespaces[ns] === undefined) toLoadNamespaces[ns] = true;\n        }\n      });\n      if (!hasAllNamespaces) toLoadLanguages[lng] = true;\n    });\n    if (Object.keys(toLoad).length || Object.keys(pending).length) {\n      this.queue.push({\n        pending,\n        pendingCount: Object.keys(pending).length,\n        loaded: {},\n        errors: [],\n        callback\n      });\n    }\n    return {\n      toLoad: Object.keys(toLoad),\n      pending: Object.keys(pending),\n      toLoadLanguages: Object.keys(toLoadLanguages),\n      toLoadNamespaces: Object.keys(toLoadNamespaces)\n    };\n  }\n  loaded(name, err, data) {\n    const s = name.split('|');\n    const lng = s[0];\n    const ns = s[1];\n    if (err) this.emit('failedLoading', lng, ns, err);\n    if (data) {\n      this.store.addResourceBundle(lng, ns, data, undefined, undefined, {\n        skipCopy: true\n      });\n    }\n    this.state[name] = err ? -1 : 2;\n    const loaded = {};\n    this.queue.forEach(q => {\n      pushPath(q.loaded, [lng], ns);\n      removePending(q, name);\n      if (err) q.errors.push(err);\n      if (q.pendingCount === 0 && !q.done) {\n        Object.keys(q.loaded).forEach(l => {\n          if (!loaded[l]) loaded[l] = {};\n          const loadedKeys = q.loaded[l];\n          if (loadedKeys.length) {\n            loadedKeys.forEach(n => {\n              if (loaded[l][n] === undefined) loaded[l][n] = true;\n            });\n          }\n        });\n        q.done = true;\n        if (q.errors.length) {\n          q.callback(q.errors);\n        } else {\n          q.callback();\n        }\n      }\n    });\n    this.emit('loaded', loaded);\n    this.queue = this.queue.filter(q => !q.done);\n  }\n  read(lng, ns, fcName) {\n    let tried = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n    let wait = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : this.retryTimeout;\n    let callback = arguments.length > 5 ? arguments[5] : undefined;\n    if (!lng.length) return callback(null, {});\n    if (this.readingCalls >= this.maxParallelReads) {\n      this.waitingReads.push({\n        lng,\n        ns,\n        fcName,\n        tried,\n        wait,\n        callback\n      });\n      return;\n    }\n    this.readingCalls++;\n    const resolver = (err, data) => {\n      this.readingCalls--;\n      if (this.waitingReads.length > 0) {\n        const next = this.waitingReads.shift();\n        this.read(next.lng, next.ns, next.fcName, next.tried, next.wait, next.callback);\n      }\n      if (err && data && tried < this.maxRetries) {\n        setTimeout(() => {\n          this.read.call(this, lng, ns, fcName, tried + 1, wait * 2, callback);\n        }, wait);\n        return;\n      }\n      callback(err, data);\n    };\n    const fc = this.backend[fcName].bind(this.backend);\n    if (fc.length === 2) {\n      try {\n        const r = fc(lng, ns);\n        if (r && typeof r.then === 'function') {\n          r.then(data => resolver(null, data)).catch(resolver);\n        } else {\n          resolver(null, r);\n        }\n      } catch (err) {\n        resolver(err);\n      }\n      return;\n    }\n    return fc(lng, ns, resolver);\n  }\n  prepareLoading(languages, namespaces) {\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    let callback = arguments.length > 3 ? arguments[3] : undefined;\n    if (!this.backend) {\n      this.logger.warn('No backend was added via i18next.use. Will not load resources.');\n      return callback && callback();\n    }\n    if (typeof languages === 'string') languages = this.languageUtils.toResolveHierarchy(languages);\n    if (typeof namespaces === 'string') namespaces = [namespaces];\n    const toLoad = this.queueLoad(languages, namespaces, options, callback);\n    if (!toLoad.toLoad.length) {\n      if (!toLoad.pending.length) callback();\n      return null;\n    }\n    toLoad.toLoad.forEach(name => {\n      this.loadOne(name);\n    });\n  }\n  load(languages, namespaces, callback) {\n    this.prepareLoading(languages, namespaces, {}, callback);\n  }\n  reload(languages, namespaces, callback) {\n    this.prepareLoading(languages, namespaces, {\n      reload: true\n    }, callback);\n  }\n  loadOne(name) {\n    let prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n    const s = name.split('|');\n    const lng = s[0];\n    const ns = s[1];\n    this.read(lng, ns, 'read', undefined, undefined, (err, data) => {\n      if (err) this.logger.warn(`${prefix}loading namespace ${ns} for language ${lng} failed`, err);\n      if (!err && data) this.logger.log(`${prefix}loaded namespace ${ns} for language ${lng}`, data);\n      this.loaded(name, err, data);\n    });\n  }\n  saveMissing(languages, namespace, key, fallbackValue, isUpdate) {\n    let options = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n    let clb = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : () => {};\n    if (this.services.utils && this.services.utils.hasLoadedNamespace && !this.services.utils.hasLoadedNamespace(namespace)) {\n      this.logger.warn(`did not save key \"${key}\" as the namespace \"${namespace}\" was not yet loaded`, 'This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!');\n      return;\n    }\n    if (key === undefined || key === null || key === '') return;\n    if (this.backend && this.backend.create) {\n      const opts = {\n        ...options,\n        isUpdate\n      };\n      const fc = this.backend.create.bind(this.backend);\n      if (fc.length < 6) {\n        try {\n          let r;\n          if (fc.length === 5) {\n            r = fc(languages, namespace, key, fallbackValue, opts);\n          } else {\n            r = fc(languages, namespace, key, fallbackValue);\n          }\n          if (r && typeof r.then === 'function') {\n            r.then(data => clb(null, data)).catch(clb);\n          } else {\n            clb(null, r);\n          }\n        } catch (err) {\n          clb(err);\n        }\n      } else {\n        fc(languages, namespace, key, fallbackValue, clb, opts);\n      }\n    }\n    if (!languages || !languages[0]) return;\n    this.store.addResource(languages[0], namespace, key, fallbackValue);\n  }\n}\n\nfunction get() {\n  return {\n    debug: false,\n    initImmediate: true,\n    ns: ['translation'],\n    defaultNS: ['translation'],\n    fallbackLng: ['dev'],\n    fallbackNS: false,\n    supportedLngs: false,\n    nonExplicitSupportedLngs: false,\n    load: 'all',\n    preload: false,\n    simplifyPluralSuffix: true,\n    keySeparator: '.',\n    nsSeparator: ':',\n    pluralSeparator: '_',\n    contextSeparator: '_',\n    partialBundledLanguages: false,\n    saveMissing: false,\n    updateMissing: false,\n    saveMissingTo: 'fallback',\n    saveMissingPlurals: true,\n    missingKeyHandler: false,\n    missingInterpolationHandler: false,\n    postProcess: false,\n    postProcessPassResolved: false,\n    returnNull: false,\n    returnEmptyString: true,\n    returnObjects: false,\n    joinArrays: false,\n    returnedObjectHandler: false,\n    parseMissingKeyHandler: false,\n    appendNamespaceToMissingKey: false,\n    appendNamespaceToCIMode: false,\n    overloadTranslationOptionHandler: function handle(args) {\n      let ret = {};\n      if (typeof args[1] === 'object') ret = args[1];\n      if (typeof args[1] === 'string') ret.defaultValue = args[1];\n      if (typeof args[2] === 'string') ret.tDescription = args[2];\n      if (typeof args[2] === 'object' || typeof args[3] === 'object') {\n        const options = args[3] || args[2];\n        Object.keys(options).forEach(key => {\n          ret[key] = options[key];\n        });\n      }\n      return ret;\n    },\n    interpolation: {\n      escapeValue: true,\n      format: value => value,\n      prefix: '{{',\n      suffix: '}}',\n      formatSeparator: ',',\n      unescapePrefix: '-',\n      nestingPrefix: '$t(',\n      nestingSuffix: ')',\n      nestingOptionsSeparator: ',',\n      maxReplaces: 1000,\n      skipOnVariables: true\n    }\n  };\n}\nfunction transformOptions(options) {\n  if (typeof options.ns === 'string') options.ns = [options.ns];\n  if (typeof options.fallbackLng === 'string') options.fallbackLng = [options.fallbackLng];\n  if (typeof options.fallbackNS === 'string') options.fallbackNS = [options.fallbackNS];\n  if (options.supportedLngs && options.supportedLngs.indexOf('cimode') < 0) {\n    options.supportedLngs = options.supportedLngs.concat(['cimode']);\n  }\n  return options;\n}\n\nfunction noop() {}\nfunction bindMemberFunctions(inst) {\n  const mems = Object.getOwnPropertyNames(Object.getPrototypeOf(inst));\n  mems.forEach(mem => {\n    if (typeof inst[mem] === 'function') {\n      inst[mem] = inst[mem].bind(inst);\n    }\n  });\n}\nclass I18n extends EventEmitter {\n  constructor() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let callback = arguments.length > 1 ? arguments[1] : undefined;\n    super();\n    this.options = transformOptions(options);\n    this.services = {};\n    this.logger = baseLogger;\n    this.modules = {\n      external: []\n    };\n    bindMemberFunctions(this);\n    if (callback && !this.isInitialized && !options.isClone) {\n      if (!this.options.initImmediate) {\n        this.init(options, callback);\n        return this;\n      }\n      setTimeout(() => {\n        this.init(options, callback);\n      }, 0);\n    }\n  }\n  init() {\n    var _this = this;\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let callback = arguments.length > 1 ? arguments[1] : undefined;\n    this.isInitializing = true;\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n    if (!options.defaultNS && options.defaultNS !== false && options.ns) {\n      if (typeof options.ns === 'string') {\n        options.defaultNS = options.ns;\n      } else if (options.ns.indexOf('translation') < 0) {\n        options.defaultNS = options.ns[0];\n      }\n    }\n    const defOpts = get();\n    this.options = {\n      ...defOpts,\n      ...this.options,\n      ...transformOptions(options)\n    };\n    if (this.options.compatibilityAPI !== 'v1') {\n      this.options.interpolation = {\n        ...defOpts.interpolation,\n        ...this.options.interpolation\n      };\n    }\n    if (options.keySeparator !== undefined) {\n      this.options.userDefinedKeySeparator = options.keySeparator;\n    }\n    if (options.nsSeparator !== undefined) {\n      this.options.userDefinedNsSeparator = options.nsSeparator;\n    }\n    function createClassOnDemand(ClassOrObject) {\n      if (!ClassOrObject) return null;\n      if (typeof ClassOrObject === 'function') return new ClassOrObject();\n      return ClassOrObject;\n    }\n    if (!this.options.isClone) {\n      if (this.modules.logger) {\n        baseLogger.init(createClassOnDemand(this.modules.logger), this.options);\n      } else {\n        baseLogger.init(null, this.options);\n      }\n      let formatter;\n      if (this.modules.formatter) {\n        formatter = this.modules.formatter;\n      } else if (typeof Intl !== 'undefined') {\n        formatter = Formatter;\n      }\n      const lu = new LanguageUtil(this.options);\n      this.store = new ResourceStore(this.options.resources, this.options);\n      const s = this.services;\n      s.logger = baseLogger;\n      s.resourceStore = this.store;\n      s.languageUtils = lu;\n      s.pluralResolver = new PluralResolver(lu, {\n        prepend: this.options.pluralSeparator,\n        compatibilityJSON: this.options.compatibilityJSON,\n        simplifyPluralSuffix: this.options.simplifyPluralSuffix\n      });\n      if (formatter && (!this.options.interpolation.format || this.options.interpolation.format === defOpts.interpolation.format)) {\n        s.formatter = createClassOnDemand(formatter);\n        s.formatter.init(s, this.options);\n        this.options.interpolation.format = s.formatter.format.bind(s.formatter);\n      }\n      s.interpolator = new Interpolator(this.options);\n      s.utils = {\n        hasLoadedNamespace: this.hasLoadedNamespace.bind(this)\n      };\n      s.backendConnector = new Connector(createClassOnDemand(this.modules.backend), s.resourceStore, s, this.options);\n      s.backendConnector.on('*', function (event) {\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n        _this.emit(event, ...args);\n      });\n      if (this.modules.languageDetector) {\n        s.languageDetector = createClassOnDemand(this.modules.languageDetector);\n        if (s.languageDetector.init) s.languageDetector.init(s, this.options.detection, this.options);\n      }\n      if (this.modules.i18nFormat) {\n        s.i18nFormat = createClassOnDemand(this.modules.i18nFormat);\n        if (s.i18nFormat.init) s.i18nFormat.init(this);\n      }\n      this.translator = new Translator(this.services, this.options);\n      this.translator.on('*', function (event) {\n        for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n          args[_key2 - 1] = arguments[_key2];\n        }\n        _this.emit(event, ...args);\n      });\n      this.modules.external.forEach(m => {\n        if (m.init) m.init(this);\n      });\n    }\n    this.format = this.options.interpolation.format;\n    if (!callback) callback = noop;\n    if (this.options.fallbackLng && !this.services.languageDetector && !this.options.lng) {\n      const codes = this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);\n      if (codes.length > 0 && codes[0] !== 'dev') this.options.lng = codes[0];\n    }\n    if (!this.services.languageDetector && !this.options.lng) {\n      this.logger.warn('init: no languageDetector is used and no lng is defined');\n    }\n    const storeApi = ['getResource', 'hasResourceBundle', 'getResourceBundle', 'getDataByLanguage'];\n    storeApi.forEach(fcName => {\n      this[fcName] = function () {\n        return _this.store[fcName](...arguments);\n      };\n    });\n    const storeApiChained = ['addResource', 'addResources', 'addResourceBundle', 'removeResourceBundle'];\n    storeApiChained.forEach(fcName => {\n      this[fcName] = function () {\n        _this.store[fcName](...arguments);\n        return _this;\n      };\n    });\n    const deferred = defer();\n    const load = () => {\n      const finish = (err, t) => {\n        this.isInitializing = false;\n        if (this.isInitialized && !this.initializedStoreOnce) this.logger.warn('init: i18next is already initialized. You should call init just once!');\n        this.isInitialized = true;\n        if (!this.options.isClone) this.logger.log('initialized', this.options);\n        this.emit('initialized', this.options);\n        deferred.resolve(t);\n        callback(err, t);\n      };\n      if (this.languages && this.options.compatibilityAPI !== 'v1' && !this.isInitialized) return finish(null, this.t.bind(this));\n      this.changeLanguage(this.options.lng, finish);\n    };\n    if (this.options.resources || !this.options.initImmediate) {\n      load();\n    } else {\n      setTimeout(load, 0);\n    }\n    return deferred;\n  }\n  loadResources(language) {\n    let callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : noop;\n    let usedCallback = callback;\n    const usedLng = typeof language === 'string' ? language : this.language;\n    if (typeof language === 'function') usedCallback = language;\n    if (!this.options.resources || this.options.partialBundledLanguages) {\n      if (usedLng && usedLng.toLowerCase() === 'cimode' && (!this.options.preload || this.options.preload.length === 0)) return usedCallback();\n      const toLoad = [];\n      const append = lng => {\n        if (!lng) return;\n        if (lng === 'cimode') return;\n        const lngs = this.services.languageUtils.toResolveHierarchy(lng);\n        lngs.forEach(l => {\n          if (l === 'cimode') return;\n          if (toLoad.indexOf(l) < 0) toLoad.push(l);\n        });\n      };\n      if (!usedLng) {\n        const fallbacks = this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);\n        fallbacks.forEach(l => append(l));\n      } else {\n        append(usedLng);\n      }\n      if (this.options.preload) {\n        this.options.preload.forEach(l => append(l));\n      }\n      this.services.backendConnector.load(toLoad, this.options.ns, e => {\n        if (!e && !this.resolvedLanguage && this.language) this.setResolvedLanguage(this.language);\n        usedCallback(e);\n      });\n    } else {\n      usedCallback(null);\n    }\n  }\n  reloadResources(lngs, ns, callback) {\n    const deferred = defer();\n    if (!lngs) lngs = this.languages;\n    if (!ns) ns = this.options.ns;\n    if (!callback) callback = noop;\n    this.services.backendConnector.reload(lngs, ns, err => {\n      deferred.resolve();\n      callback(err);\n    });\n    return deferred;\n  }\n  use(module) {\n    if (!module) throw new Error('You are passing an undefined module! Please check the object you are passing to i18next.use()');\n    if (!module.type) throw new Error('You are passing a wrong module! Please check the object you are passing to i18next.use()');\n    if (module.type === 'backend') {\n      this.modules.backend = module;\n    }\n    if (module.type === 'logger' || module.log && module.warn && module.error) {\n      this.modules.logger = module;\n    }\n    if (module.type === 'languageDetector') {\n      this.modules.languageDetector = module;\n    }\n    if (module.type === 'i18nFormat') {\n      this.modules.i18nFormat = module;\n    }\n    if (module.type === 'postProcessor') {\n      postProcessor.addPostProcessor(module);\n    }\n    if (module.type === 'formatter') {\n      this.modules.formatter = module;\n    }\n    if (module.type === '3rdParty') {\n      this.modules.external.push(module);\n    }\n    return this;\n  }\n  setResolvedLanguage(l) {\n    if (!l || !this.languages) return;\n    if (['cimode', 'dev'].indexOf(l) > -1) return;\n    for (let li = 0; li < this.languages.length; li++) {\n      const lngInLngs = this.languages[li];\n      if (['cimode', 'dev'].indexOf(lngInLngs) > -1) continue;\n      if (this.store.hasLanguageSomeTranslations(lngInLngs)) {\n        this.resolvedLanguage = lngInLngs;\n        break;\n      }\n    }\n  }\n  changeLanguage(lng, callback) {\n    var _this2 = this;\n    this.isLanguageChangingTo = lng;\n    const deferred = defer();\n    this.emit('languageChanging', lng);\n    const setLngProps = l => {\n      this.language = l;\n      this.languages = this.services.languageUtils.toResolveHierarchy(l);\n      this.resolvedLanguage = undefined;\n      this.setResolvedLanguage(l);\n    };\n    const done = (err, l) => {\n      if (l) {\n        setLngProps(l);\n        this.translator.changeLanguage(l);\n        this.isLanguageChangingTo = undefined;\n        this.emit('languageChanged', l);\n        this.logger.log('languageChanged', l);\n      } else {\n        this.isLanguageChangingTo = undefined;\n      }\n      deferred.resolve(function () {\n        return _this2.t(...arguments);\n      });\n      if (callback) callback(err, function () {\n        return _this2.t(...arguments);\n      });\n    };\n    const setLng = lngs => {\n      if (!lng && !lngs && this.services.languageDetector) lngs = [];\n      const l = typeof lngs === 'string' ? lngs : this.services.languageUtils.getBestMatchFromCodes(lngs);\n      if (l) {\n        if (!this.language) {\n          setLngProps(l);\n        }\n        if (!this.translator.language) this.translator.changeLanguage(l);\n        if (this.services.languageDetector && this.services.languageDetector.cacheUserLanguage) this.services.languageDetector.cacheUserLanguage(l);\n      }\n      this.loadResources(l, err => {\n        done(err, l);\n      });\n    };\n    if (!lng && this.services.languageDetector && !this.services.languageDetector.async) {\n      setLng(this.services.languageDetector.detect());\n    } else if (!lng && this.services.languageDetector && this.services.languageDetector.async) {\n      if (this.services.languageDetector.detect.length === 0) {\n        this.services.languageDetector.detect().then(setLng);\n      } else {\n        this.services.languageDetector.detect(setLng);\n      }\n    } else {\n      setLng(lng);\n    }\n    return deferred;\n  }\n  getFixedT(lng, ns, keyPrefix) {\n    var _this3 = this;\n    const fixedT = function (key, opts) {\n      let options;\n      if (typeof opts !== 'object') {\n        for (var _len3 = arguments.length, rest = new Array(_len3 > 2 ? _len3 - 2 : 0), _key3 = 2; _key3 < _len3; _key3++) {\n          rest[_key3 - 2] = arguments[_key3];\n        }\n        options = _this3.options.overloadTranslationOptionHandler([key, opts].concat(rest));\n      } else {\n        options = {\n          ...opts\n        };\n      }\n      options.lng = options.lng || fixedT.lng;\n      options.lngs = options.lngs || fixedT.lngs;\n      options.ns = options.ns || fixedT.ns;\n      options.keyPrefix = options.keyPrefix || keyPrefix || fixedT.keyPrefix;\n      const keySeparator = _this3.options.keySeparator || '.';\n      let resultKey;\n      if (options.keyPrefix && Array.isArray(key)) {\n        resultKey = key.map(k => `${options.keyPrefix}${keySeparator}${k}`);\n      } else {\n        resultKey = options.keyPrefix ? `${options.keyPrefix}${keySeparator}${key}` : key;\n      }\n      return _this3.t(resultKey, options);\n    };\n    if (typeof lng === 'string') {\n      fixedT.lng = lng;\n    } else {\n      fixedT.lngs = lng;\n    }\n    fixedT.ns = ns;\n    fixedT.keyPrefix = keyPrefix;\n    return fixedT;\n  }\n  t() {\n    return this.translator && this.translator.translate(...arguments);\n  }\n  exists() {\n    return this.translator && this.translator.exists(...arguments);\n  }\n  setDefaultNamespace(ns) {\n    this.options.defaultNS = ns;\n  }\n  hasLoadedNamespace(ns) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    if (!this.isInitialized) {\n      this.logger.warn('hasLoadedNamespace: i18next was not initialized', this.languages);\n      return false;\n    }\n    if (!this.languages || !this.languages.length) {\n      this.logger.warn('hasLoadedNamespace: i18n.languages were undefined or empty', this.languages);\n      return false;\n    }\n    const lng = options.lng || this.resolvedLanguage || this.languages[0];\n    const fallbackLng = this.options ? this.options.fallbackLng : false;\n    const lastLng = this.languages[this.languages.length - 1];\n    if (lng.toLowerCase() === 'cimode') return true;\n    const loadNotPending = (l, n) => {\n      const loadState = this.services.backendConnector.state[`${l}|${n}`];\n      return loadState === -1 || loadState === 2;\n    };\n    if (options.precheck) {\n      const preResult = options.precheck(this, loadNotPending);\n      if (preResult !== undefined) return preResult;\n    }\n    if (this.hasResourceBundle(lng, ns)) return true;\n    if (!this.services.backendConnector.backend || this.options.resources && !this.options.partialBundledLanguages) return true;\n    if (loadNotPending(lng, ns) && (!fallbackLng || loadNotPending(lastLng, ns))) return true;\n    return false;\n  }\n  loadNamespaces(ns, callback) {\n    const deferred = defer();\n    if (!this.options.ns) {\n      if (callback) callback();\n      return Promise.resolve();\n    }\n    if (typeof ns === 'string') ns = [ns];\n    ns.forEach(n => {\n      if (this.options.ns.indexOf(n) < 0) this.options.ns.push(n);\n    });\n    this.loadResources(err => {\n      deferred.resolve();\n      if (callback) callback(err);\n    });\n    return deferred;\n  }\n  loadLanguages(lngs, callback) {\n    const deferred = defer();\n    if (typeof lngs === 'string') lngs = [lngs];\n    const preloaded = this.options.preload || [];\n    const newLngs = lngs.filter(lng => preloaded.indexOf(lng) < 0);\n    if (!newLngs.length) {\n      if (callback) callback();\n      return Promise.resolve();\n    }\n    this.options.preload = preloaded.concat(newLngs);\n    this.loadResources(err => {\n      deferred.resolve();\n      if (callback) callback(err);\n    });\n    return deferred;\n  }\n  dir(lng) {\n    if (!lng) lng = this.resolvedLanguage || (this.languages && this.languages.length > 0 ? this.languages[0] : this.language);\n    if (!lng) return 'rtl';\n    const rtlLngs = ['ar', 'shu', 'sqr', 'ssh', 'xaa', 'yhd', 'yud', 'aao', 'abh', 'abv', 'acm', 'acq', 'acw', 'acx', 'acy', 'adf', 'ads', 'aeb', 'aec', 'afb', 'ajp', 'apc', 'apd', 'arb', 'arq', 'ars', 'ary', 'arz', 'auz', 'avl', 'ayh', 'ayl', 'ayn', 'ayp', 'bbz', 'pga', 'he', 'iw', 'ps', 'pbt', 'pbu', 'pst', 'prp', 'prd', 'ug', 'ur', 'ydd', 'yds', 'yih', 'ji', 'yi', 'hbo', 'men', 'xmn', 'fa', 'jpr', 'peo', 'pes', 'prs', 'dv', 'sam', 'ckb'];\n    const languageUtils = this.services && this.services.languageUtils || new LanguageUtil(get());\n    return rtlLngs.indexOf(languageUtils.getLanguagePartFromCode(lng)) > -1 || lng.toLowerCase().indexOf('-arab') > 1 ? 'rtl' : 'ltr';\n  }\n  static createInstance() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let callback = arguments.length > 1 ? arguments[1] : undefined;\n    return new I18n(options, callback);\n  }\n  cloneInstance() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : noop;\n    const forkResourceStore = options.forkResourceStore;\n    if (forkResourceStore) delete options.forkResourceStore;\n    const mergedOptions = {\n      ...this.options,\n      ...options,\n      ...{\n        isClone: true\n      }\n    };\n    const clone = new I18n(mergedOptions);\n    if (options.debug !== undefined || options.prefix !== undefined) {\n      clone.logger = clone.logger.clone(options);\n    }\n    const membersToCopy = ['store', 'services', 'language'];\n    membersToCopy.forEach(m => {\n      clone[m] = this[m];\n    });\n    clone.services = {\n      ...this.services\n    };\n    clone.services.utils = {\n      hasLoadedNamespace: clone.hasLoadedNamespace.bind(clone)\n    };\n    if (forkResourceStore) {\n      clone.store = new ResourceStore(this.store.data, mergedOptions);\n      clone.services.resourceStore = clone.store;\n    }\n    clone.translator = new Translator(clone.services, mergedOptions);\n    clone.translator.on('*', function (event) {\n      for (var _len4 = arguments.length, args = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n        args[_key4 - 1] = arguments[_key4];\n      }\n      clone.emit(event, ...args);\n    });\n    clone.init(mergedOptions, callback);\n    clone.translator.options = mergedOptions;\n    clone.translator.backendConnector.services.utils = {\n      hasLoadedNamespace: clone.hasLoadedNamespace.bind(clone)\n    };\n    return clone;\n  }\n  toJSON() {\n    return {\n      options: this.options,\n      store: this.store,\n      language: this.language,\n      languages: this.languages,\n      resolvedLanguage: this.resolvedLanguage\n    };\n  }\n}\nconst instance = I18n.createInstance();\ninstance.createInstance = I18n.createInstance;\n\nconst createInstance = instance.createInstance;\nconst dir = instance.dir;\nconst init = instance.init;\nconst loadResources = instance.loadResources;\nconst reloadResources = instance.reloadResources;\nconst use = instance.use;\nconst changeLanguage = instance.changeLanguage;\nconst getFixedT = instance.getFixedT;\nconst t = instance.t;\nconst exists = instance.exists;\nconst setDefaultNamespace = instance.setDefaultNamespace;\nconst hasLoadedNamespace = instance.hasLoadedNamespace;\nconst loadNamespaces = instance.loadNamespaces;\nconst loadLanguages = instance.loadLanguages;\n\nexport { changeLanguage, createInstance, instance as default, dir, exists, getFixedT, hasLoadedNamespace, init, loadLanguages, loadNamespaces, loadResources, reloadResources, setDefaultNamespace, t, use };\n","import React, { ReactElement } from 'react';\n\nimport { AdHocVariableFilter, DataSourceRef, SelectableValue } from '@grafana/data';\nimport { getDataSourceSrv } from '@grafana/runtime';\nimport { Icon, SegmentAsync } from '@grafana/ui';\n\ninterface Props {\n  datasource: DataSourceRef;\n  filterKey: string | null;\n  onChange: (item: SelectableValue<string | null>) => void;\n  allFilters: AdHocVariableFilter[];\n  disabled?: boolean;\n}\n\nconst MIN_WIDTH = 90;\nexport const AdHocFilterKey = ({ datasource, onChange, disabled, filterKey, allFilters }: Props) => {\n  const loadKeys = () => fetchFilterKeys(datasource, filterKey, allFilters);\n  const loadKeysWithRemove = () => fetchFilterKeysWithRemove(datasource, filterKey, allFilters);\n\n  if (filterKey === null) {\n    return (\n      <div className=\"gf-form\" data-testid=\"AdHocFilterKey-add-key-wrapper\">\n        <SegmentAsync\n          disabled={disabled}\n          className=\"query-segment-key\"\n          Component={plusSegment}\n          value={filterKey}\n          onChange={onChange}\n          loadOptions={loadKeys}\n          inputMinWidth={MIN_WIDTH}\n        />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"gf-form\" data-testid=\"AdHocFilterKey-key-wrapper\">\n      <SegmentAsync\n        disabled={disabled}\n        className=\"query-segment-key\"\n        value={filterKey}\n        onChange={onChange}\n        loadOptions={loadKeysWithRemove}\n        inputMinWidth={MIN_WIDTH}\n      />\n    </div>\n  );\n};\n\nexport const REMOVE_FILTER_KEY = '-- remove filter --';\nconst REMOVE_VALUE = { label: REMOVE_FILTER_KEY, value: REMOVE_FILTER_KEY };\n\nconst plusSegment: ReactElement = (\n  <span className=\"gf-form-label query-part\" aria-label=\"Add Filter\">\n    <Icon name=\"plus\" />\n  </span>\n);\n\nconst fetchFilterKeys = async (\n  datasource: DataSourceRef,\n  currentKey: string | null,\n  allFilters: AdHocVariableFilter[]\n): Promise<Array<SelectableValue<string>>> => {\n  const ds = await getDataSourceSrv().get(datasource);\n\n  if (!ds || !ds.getTagKeys) {\n    return [];\n  }\n\n  const otherFilters = allFilters.filter((f) => f.key !== currentKey);\n  const metrics = await ds.getTagKeys({ filters: otherFilters });\n  return metrics.map((m) => ({ label: m.text, value: m.text }));\n};\n\nconst fetchFilterKeysWithRemove = async (\n  datasource: DataSourceRef,\n  currentKey: string | null,\n  allFilters: AdHocVariableFilter[]\n): Promise<Array<SelectableValue<string>>> => {\n  const keys = await fetchFilterKeys(datasource, currentKey, allFilters);\n  return [REMOVE_VALUE, ...keys];\n};\n","import React from 'react';\n\nimport {\n  AdHocVariableFilter,\n  DataSourceRef,\n  MetricFindValue,\n  SelectableValue,\n  getDefaultTimeRange,\n} from '@grafana/data';\n// import { getTimeSrv } from 'app/features/dashboard/services/TimeSrv';\nimport { getDataSourceSrv } from '@grafana/runtime';\nimport { SegmentAsync } from '@grafana/ui';\n\ninterface Props {\n  datasource: DataSourceRef;\n  filterKey: string;\n  filterValue?: string;\n  onChange: (item: SelectableValue<string>) => void;\n  placeHolder?: string;\n  disabled?: boolean;\n  allFilters: AdHocVariableFilter[];\n}\n\nexport const AdHocFilterValue = ({\n  datasource,\n  disabled,\n  onChange,\n  filterKey,\n  filterValue,\n  placeHolder,\n  allFilters,\n}: Props) => {\n  const loadValues = () => fetchFilterValues(datasource, filterKey, allFilters);\n\n  return (\n    <div className=\"gf-form\" data-testid=\"AdHocFilterValue-value-wrapper\">\n      <SegmentAsync\n        className=\"query-segment-value\"\n        disabled={disabled}\n        placeholder={placeHolder}\n        value={filterValue}\n        onChange={onChange}\n        loadOptions={loadValues}\n      />\n    </div>\n  );\n};\n\nconst fetchFilterValues = async (\n  datasource: DataSourceRef,\n  key: string,\n  allFilters: AdHocVariableFilter[]\n): Promise<Array<SelectableValue<string>>> => {\n  const ds = await getDataSourceSrv().get(datasource);\n\n  if (!ds || !ds.getTagValues) {\n    return [];\n  }\n\n  // const timeRange = getTimeSrv().timeRange();\n  // As https://github.com/grafana/grafana/pull/76118/files#diff-260d46415915a2e3e7d294e313bd128666e9f0868aa94d8aee4d4a24a060b542L27-R26\n  const timeRange = getDefaultTimeRange();\n\n  // Filter out the current filter key from the list of all filters\n  const otherFilters = allFilters.filter((f) => f.key !== key);\n  const metrics = await ds.getTagValues({ key, filters: otherFilters, timeRange });\n  return metrics.map((m: MetricFindValue) => ({ label: m.text, value: m.text }));\n};\n","import React from 'react';\n\nimport { SelectableValue } from '@grafana/data';\nimport { Segment } from '@grafana/ui';\n\ninterface Props {\n  value: string;\n  onChange: (item: SelectableValue<string>) => void;\n  disabled?: boolean;\n}\n\nconst options = ['=', '!=', '<', '>', '=~', '!~'].map<SelectableValue<string>>((value) => ({\n  label: value,\n  value,\n}));\n\nexport const OperatorSegment = ({ value, disabled, onChange }: Props) => {\n  return (\n    <Segment\n      className=\"query-segment-operator\"\n      value={value}\n      disabled={disabled}\n      options={options}\n      onChange={onChange}\n    />\n  );\n};\n","import React from 'react';\n\nimport { AdHocVariableFilter, DataSourceRef, SelectableValue } from '@grafana/data';\n\nimport { AdHocFilterKey } from './AdHocFilterKey';\nimport { AdHocFilterValue } from './AdHocFilterValue';\nimport { OperatorSegment } from './OperatorSegment';\n\ninterface Props {\n  datasource: DataSourceRef;\n  filter: AdHocVariableFilter;\n  allFilters: AdHocVariableFilter[];\n  onKeyChange: (item: SelectableValue<string | null>) => void;\n  onOperatorChange: (item: SelectableValue<string>) => void;\n  onValueChange: (item: SelectableValue<string>) => void;\n  placeHolder?: string;\n  getTagKeysOptions?: any;\n  disabled?: boolean;\n}\n\nexport const AdHocFilterRenderer = ({\n  datasource,\n  filter: { key, operator, value },\n  onKeyChange,\n  onOperatorChange,\n  onValueChange,\n  placeHolder,\n  allFilters,\n  disabled,\n}: Props) => {\n  return (\n    <>\n      <AdHocFilterKey\n        disabled={disabled}\n        datasource={datasource}\n        filterKey={key}\n        onChange={onKeyChange}\n        allFilters={allFilters}\n      />\n      <div className=\"gf-form\">\n        <OperatorSegment disabled={disabled} value={operator} onChange={onOperatorChange} />\n      </div>\n      <AdHocFilterValue\n        disabled={disabled}\n        datasource={datasource}\n        filterKey={key}\n        filterValue={value}\n        allFilters={allFilters}\n        onChange={onValueChange}\n        placeHolder={placeHolder}\n      />\n    </>\n  );\n};\n","import i18n from 'i18next';\nimport React, { useCallback, useState } from 'react';\n\nimport { AdHocVariableFilter, DataSourceRef, SelectableValue } from '@grafana/data';\n\nimport { AdHocFilterKey, REMOVE_FILTER_KEY } from './AdHocFilterKey';\nimport { AdHocFilterRenderer } from './AdHocFilterRenderer';\n\ninterface Props {\n  datasource: DataSourceRef;\n  onCompleted: (filter: AdHocVariableFilter) => void;\n  appendBefore?: React.ReactNode;\n  allFilters: AdHocVariableFilter[];\n}\n\n// Reassign t() so i18next-parser doesn't warn on dynamic key, and we can have 'failOnWarnings' enabled\nconst tFunc = i18n.t;\n\n// import { t } from 'app/core/internationalization';\nexport const t = (id: string, defaultMessage: string, values?: Record<string, unknown>) => {\n  return tFunc(id, defaultMessage, values);\n};\n\nexport const AdHocFilterBuilder = ({ datasource, appendBefore, onCompleted, allFilters }: Props) => {\n  const [key, setKey] = useState<string | null>(null);\n  const [operator, setOperator] = useState<string>('=');\n\n  const onKeyChanged = useCallback(\n    (item: SelectableValue<string | null>) => {\n      if (item.value !== REMOVE_FILTER_KEY) {\n        setKey(item.value ?? '');\n        return;\n      }\n      setKey(null);\n    },\n    [setKey]\n  );\n\n  const onOperatorChanged = useCallback(\n    (item: SelectableValue<string>) => setOperator(item.value ?? ''),\n    [setOperator]\n  );\n\n  const onValueChanged = useCallback(\n    (item: SelectableValue<string>) => {\n      onCompleted({\n        value: item.value ?? '',\n        operator: operator,\n        key: key!,\n      });\n      setKey(null);\n      setOperator('=');\n    },\n    [onCompleted, operator, key]\n  );\n\n  if (key === null) {\n    return <AdHocFilterKey datasource={datasource} filterKey={key} onChange={onKeyChanged} allFilters={allFilters} />;\n  }\n\n  return (\n    <React.Fragment key=\"filter-builder\">\n      {appendBefore}\n      <AdHocFilterRenderer\n        datasource={datasource}\n        filter={{ key, value: '', operator }}\n        placeHolder={t('variable.adhoc.placeholder', 'Select value')}\n        onKeyChange={onKeyChanged}\n        onOperatorChange={onOperatorChanged}\n        onValueChange={onValueChanged}\n        allFilters={allFilters}\n      />\n    </React.Fragment>\n  );\n};\n","import React from 'react';\n\ninterface Props {\n  label: string;\n}\n\nexport const ConditionSegment = ({ label }: Props) => {\n  return (\n    <div className=\"gf-form\">\n      <span className=\"gf-form-label query-keyword\">{label}</span>\n    </div>\n  );\n};\n","import React, { PureComponent, ReactNode } from 'react';\n\nimport { AdHocVariableFilter, DataSourceRef, SelectableValue } from '@grafana/data';\nimport { Segment } from '@grafana/ui';\n\nimport { AdHocFilterBuilder } from './AdHocFilterBuilder';\nimport { REMOVE_FILTER_KEY } from './AdHocFilterKey';\nimport { AdHocFilterRenderer } from './AdHocFilterRenderer';\nimport { ConditionSegment } from './ConditionSegment';\n\ninterface Props {\n  datasource: DataSourceRef | null;\n  filters: AdHocVariableFilter[];\n  baseFilters?: AdHocVariableFilter[];\n  addFilter: (filter: AdHocVariableFilter) => void;\n  removeFilter: (index: number) => void;\n  changeFilter: (index: number, newFilter: AdHocVariableFilter) => void;\n  disabled?: boolean;\n}\n\n/**\n * Simple filtering component that automatically uses datasource APIs to get available labels and its values, for\n * dynamic visual filtering without need for much setup. Instead of having single onChange prop this reports all the\n * change events with separate props so it is usable with AdHocPicker.\n *\n * Note: There isn't API on datasource to suggest the operators here so that is hardcoded to use prometheus style\n * operators. Also filters are assumed to be joined with `AND` operator, which is also hardcoded.\n */\nexport class AdHocFilter extends PureComponent<Props> {\n  onChange = (index: number, prop: string) => (key: SelectableValue<string | null>) => {\n    const { filters } = this.props;\n    const { value } = key;\n\n    if (key.value === REMOVE_FILTER_KEY) {\n      return this.props.removeFilter(index);\n    }\n\n    return this.props.changeFilter(index, {\n      ...filters[index],\n      [prop]: value,\n    });\n  };\n\n  appendFilterToVariable = (filter: AdHocVariableFilter) => {\n    this.props.addFilter(filter);\n  };\n\n  render() {\n    const { filters, disabled } = this.props;\n\n    return (\n      <div className=\"gf-form-inline\">\n        {this.renderFilters(filters, disabled)}\n\n        {!disabled && (\n          <AdHocFilterBuilder\n            datasource={this.props.datasource!}\n            appendBefore={filters.length > 0 ? <ConditionSegment label=\"AND\" /> : null}\n            onCompleted={this.appendFilterToVariable}\n            allFilters={this.getAllFilters()}\n          />\n        )}\n      </div>\n    );\n  }\n\n  getAllFilters() {\n    if (this.props.baseFilters) {\n      return this.props.baseFilters.concat(this.props.filters);\n    }\n\n    return this.props.filters;\n  }\n\n  renderFilters(filters: AdHocVariableFilter[], disabled?: boolean) {\n    if (filters.length === 0 && disabled) {\n      return <Segment disabled={disabled} value=\"No filters\" options={[]} onChange={() => {}} />;\n    }\n\n    return filters.reduce((segments: ReactNode[], filter, index) => {\n      if (segments.length > 0) {\n        segments.push(<ConditionSegment label=\"AND\" key={`condition-${index}`} />);\n      }\n      segments.push(this.renderFilterSegments(filter, index, disabled));\n      return segments;\n    }, []);\n  }\n\n  renderFilterSegments(filter: AdHocVariableFilter, index: number, disabled?: boolean) {\n    return (\n      <React.Fragment key={`filter-${index}`}>\n        <AdHocFilterRenderer\n          disabled={disabled}\n          datasource={this.props.datasource!}\n          filter={filter}\n          onKeyChange={this.onChange(index, 'key')}\n          onOperatorChange={this.onChange(index, 'operator')}\n          onValueChange={this.onChange(index, 'value')}\n          allFilters={this.getAllFilters()}\n        />\n      </React.Fragment>\n    );\n  }\n}\n","import { css } from '@emotion/css';\nimport React, { useEffect, useState } from 'react';\nimport useAsync from 'react-use/lib/useAsync';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Alert, InlineField, InlineFieldRow, useStyles2 } from '@grafana/ui';\n\nimport { AdHocFilter } from './_importedDependencies/components/AdHocFilter/AdHocFilter';\nimport { AdHocVariableFilter } from './_importedDependencies/components/AdHocFilter/types';\nimport { PrometheusDatasource } from './_importedDependencies/datasources/prometheus/types';\nimport { TempoQuery } from './types';\nimport { getDS } from './utils';\n\nexport function ServiceGraphSection({\n  graphDatasourceUid,\n  query,\n  onChange,\n}: {\n  graphDatasourceUid?: string;\n  query: TempoQuery;\n  onChange: (value: TempoQuery) => void;\n}) {\n  const styles = useStyles2(getStyles);\n  const dsState = useAsync(() => getDS(graphDatasourceUid), [graphDatasourceUid]);\n\n  // Check if service graph metrics are being collected. If not, displays a warning\n  const [hasKeys, setHasKeys] = useState<boolean | undefined>(undefined);\n  useEffect(() => {\n    async function fn(ds: PrometheusDatasource) {\n      const keys = await ds.getTagKeys({\n        filters: [\n          {\n            key: '__name__',\n            operator: '=~',\n            value:\n              'traces_service_graph_request_server_seconds_sum|traces_service_graph_request_total|traces_service_graph_request_failed_total',\n            condition: '',\n          },\n        ],\n      });\n      setHasKeys(Boolean(keys.length));\n    }\n    if (!dsState.loading && dsState.value) {\n      fn(dsState.value as PrometheusDatasource);\n    }\n  }, [dsState]);\n\n  if (dsState.loading) {\n    return null;\n  }\n\n  const ds = dsState.value;\n\n  if (!graphDatasourceUid) {\n    return getWarning(\n      'No service graph datasource selected',\n      'Please set up a service graph datasource in the datasource settings',\n      styles\n    );\n  }\n\n  if (graphDatasourceUid && !ds) {\n    return getWarning(\n      'No service graph data found',\n      'Service graph datasource is configured but the data source no longer exists. Please configure existing data source to use the service graph functionality',\n      styles\n    );\n  }\n\n  const filters = queryToFilter(\n    (Array.isArray(query.serviceMapQuery) ? query.serviceMapQuery[0] : query.serviceMapQuery) || ''\n  );\n\n  return (\n    <div>\n      <InlineFieldRow>\n        <InlineField label=\"Filter\" labelWidth={14} grow>\n          <AdHocFilter\n            datasource={{ uid: graphDatasourceUid }}\n            filters={filters}\n            baseFilters={[\n              {\n                key: '__name__',\n                operator: '=~',\n                value: 'traces_service_graph_request_total|traces_spanmetrics_calls_total',\n                condition: '',\n              },\n            ]}\n            addFilter={(filter: AdHocVariableFilter) => {\n              onChange({\n                ...query,\n                serviceMapQuery: filtersToQuery([...filters, filter]),\n              });\n            }}\n            removeFilter={(index: number) => {\n              const newFilters = [...filters];\n              newFilters.splice(index, 1);\n              onChange({ ...query, serviceMapQuery: filtersToQuery(newFilters) });\n            }}\n            changeFilter={(index: number, filter: AdHocVariableFilter) => {\n              const newFilters = [...filters];\n              newFilters.splice(index, 1, filter);\n              onChange({ ...query, serviceMapQuery: filtersToQuery(newFilters) });\n            }}\n          />\n        </InlineField>\n      </InlineFieldRow>\n      {hasKeys === false\n        ? getWarning(\n            'No service graph data found',\n            'Please ensure that service graph metrics are set up correctly',\n            styles\n          )\n        : null}\n    </div>\n  );\n}\n\nfunction getWarning(title: string, description: string, styles: { alert: string; link: string }) {\n  return (\n    <Alert title={title} severity=\"info\" className={styles.alert}>\n      {description} according to the{' '}\n      <a\n        target=\"_blank\"\n        rel=\"noreferrer noopener\"\n        href=\"https://grafana.com/docs/grafana/latest/datasources/tempo/service-graph/\"\n        className={styles.link}\n      >\n        Tempo documentation\n      </a>\n      .\n    </Alert>\n  );\n}\n\nfunction queryToFilter(query: string): AdHocVariableFilter[] {\n  let match;\n  let filters: AdHocVariableFilter[] = [];\n  const re = /([\\w_]+)(=|!=|<|>|=~|!~)\"(.*?)\"/g;\n  while ((match = re.exec(query)) !== null) {\n    filters.push({\n      key: match[1],\n      operator: match[2],\n      value: match[3],\n      condition: '',\n    });\n  }\n  return filters;\n}\n\nfunction filtersToQuery(filters: AdHocVariableFilter[]): string {\n  return `{${filters.map((f) => `${f.key}${f.operator}\"${f.value}\"`).join(',')}}`;\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  alert: css({\n    maxWidth: '75ch',\n    marginTop: theme.spacing(2),\n  }),\n  link: css({\n    color: theme.colors.text.link,\n    textDecoration: 'underline',\n  }),\n});\n","import { DataSourceJsonData } from '@grafana/data/src';\nimport { NodeGraphOptions, TraceToLogsOptions } from '@grafana/o11y-ds-frontend';\n\nimport { TempoQuery as TempoBase, TempoQueryType, TraceqlFilter } from './dataquery.gen';\n\nexport interface TempoJsonData extends DataSourceJsonData {\n  tracesToLogs?: TraceToLogsOptions;\n  serviceMap?: {\n    datasourceUid?: string;\n  };\n  search?: {\n    hide?: boolean;\n    filters?: TraceqlFilter[];\n  };\n  nodeGraph?: NodeGraphOptions;\n  spanBar?: {\n    tag: string;\n  };\n  traceQuery?: {\n    timeShiftEnabled?: boolean;\n    spanStartTimeShift?: string;\n    spanEndTimeShift?: string;\n  };\n}\n\nexport interface TempoQuery extends TempoBase {\n  queryType: TempoQueryType;\n}\n\nexport interface MyDataSourceOptions extends DataSourceJsonData {}\n\nexport const defaultQuery: Partial<TempoQuery> = {};\n\nexport type TraceSearchMetadata = {\n  traceID: string;\n  rootServiceName: string;\n  rootTraceName: string;\n  startTimeUnixNano?: string;\n  durationMs?: number;\n  spanSet?: Spanset; // deprecated in Tempo, https://github.com/grafana/tempo/blob/3cc44fca03ba7d676dc77da6a18b8222546ede3c/docs/sources/tempo/api_docs/_index.md?plain=1#L619\n  spanSets?: Spanset[];\n};\n\nexport type SearchMetrics = {\n  inspectedTraces?: number;\n  inspectedBytes?: number;\n  totalBlocks?: number;\n  completedJobs?: number;\n  totalJobs?: number;\n  totalBlockBytes?: number;\n};\n\nexport enum SpanKind {\n  UNSPECIFIED,\n  INTERNAL,\n  SERVER,\n  CLIENT,\n  PRODUCER,\n  CONSUMER,\n}\n\nexport type SpanAttributes = {\n  key: string;\n  value: {\n    stringValue?: string;\n    intValue?: string;\n    boolValue?: boolean;\n    doubleValue?: string;\n    Value?: {\n      string_value?: string;\n      int_value?: string;\n      bool_value?: boolean;\n      double_value?: string;\n    };\n  };\n};\n\nexport type Span = {\n  durationNanos: string;\n  traceId?: string;\n  spanID: string;\n  traceState?: string;\n  parentSpanId?: string;\n  name?: string;\n  kind?: SpanKind;\n  startTimeUnixNano: string;\n  endTimeUnixNano?: string;\n  attributes?: SpanAttributes[];\n  dropped_attributes_count?: number;\n};\n\nexport type Spanset = {\n  attributes?: SpanAttributes[];\n  spans: Span[];\n};\n\nexport type SearchResponse = {\n  traces: TraceSearchMetadata[];\n  metrics: SearchMetrics;\n};\n\nexport type Scope = {\n  name: string;\n  tags: string[];\n};\n\n// Maps to QueryRangeResponse of tempopb https://github.com/grafana/tempo/blob/cfda98fc5cb0777963f41e0949b9ad2d24b4b5b8/pkg/tempopb/tempo.proto#L360\nexport type TraceqlMetricsResponse = {\n  series: MetricsSeries[];\n  metrics: SearchMetrics;\n};\n\nexport type MetricsSeries = {\n  labels: MetricsSeriesLabel[];\n  samples: MetricsSeriesSample[];\n  promLabels: string;\n};\n\nexport type MetricsSeriesLabel = {\n  key: string;\n  value: ProtoValue;\n};\n\nexport type ProtoValue = {\n  stringValue?: string;\n  intValue?: string;\n  boolValue?: boolean;\n  doubleValue?: string;\n};\n\nexport type MetricsSeriesSample = {\n  timestampMs: string;\n  value: number;\n};\n","/**\nThe default maximum length of a `TreeBuffer` node.\n*/\nconst DefaultBufferLength = 1024;\nlet nextPropID = 0;\nclass Range {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n    }\n}\n/**\nEach [node type](#common.NodeType) or [individual tree](#common.Tree)\ncan have metadata associated with it in props. Instances of this\nclass represent prop names.\n*/\nclass NodeProp {\n    /**\n    Create a new node prop type.\n    */\n    constructor(config = {}) {\n        this.id = nextPropID++;\n        this.perNode = !!config.perNode;\n        this.deserialize = config.deserialize || (() => {\n            throw new Error(\"This node type doesn't define a deserialize function\");\n        });\n    }\n    /**\n    This is meant to be used with\n    [`NodeSet.extend`](#common.NodeSet.extend) or\n    [`LRParser.configure`](#lr.ParserConfig.props) to compute\n    prop values for each node type in the set. Takes a [match\n    object](#common.NodeType^match) or function that returns undefined\n    if the node type doesn't get this prop, and the prop's value if\n    it does.\n    */\n    add(match) {\n        if (this.perNode)\n            throw new RangeError(\"Can't add per-node props to node types\");\n        if (typeof match != \"function\")\n            match = NodeType.match(match);\n        return (type) => {\n            let result = match(type);\n            return result === undefined ? null : [this, result];\n        };\n    }\n}\n/**\nProp that is used to describe matching delimiters. For opening\ndelimiters, this holds an array of node names (written as a\nspace-separated string when declaring this prop in a grammar)\nfor the node types of closing delimiters that match it.\n*/\nNodeProp.closedBy = new NodeProp({ deserialize: str => str.split(\" \") });\n/**\nThe inverse of [`closedBy`](#common.NodeProp^closedBy). This is\nattached to closing delimiters, holding an array of node names\nof types of matching opening delimiters.\n*/\nNodeProp.openedBy = new NodeProp({ deserialize: str => str.split(\" \") });\n/**\nUsed to assign node types to groups (for example, all node\ntypes that represent an expression could be tagged with an\n`\"Expression\"` group).\n*/\nNodeProp.group = new NodeProp({ deserialize: str => str.split(\" \") });\n/**\nAttached to nodes to indicate these should be\n[displayed](https://codemirror.net/docs/ref/#language.syntaxTree)\nin a bidirectional text isolate, so that direction-neutral\ncharacters on their sides don't incorrectly get associated with\nsurrounding text. You'll generally want to set this for nodes\nthat contain arbitrary text, like strings and comments, and for\nnodes that appear _inside_ arbitrary text, like HTML tags. When\nnot given a value, in a grammar declaration, defaults to\n`\"auto\"`.\n*/\nNodeProp.isolate = new NodeProp({ deserialize: value => {\n        if (value && value != \"rtl\" && value != \"ltr\" && value != \"auto\")\n            throw new RangeError(\"Invalid value for isolate: \" + value);\n        return value || \"auto\";\n    } });\n/**\nThe hash of the [context](#lr.ContextTracker.constructor)\nthat the node was parsed in, if any. Used to limit reuse of\ncontextual nodes.\n*/\nNodeProp.contextHash = new NodeProp({ perNode: true });\n/**\nThe distance beyond the end of the node that the tokenizer\nlooked ahead for any of the tokens inside the node. (The LR\nparser only stores this when it is larger than 25, for\nefficiency reasons.)\n*/\nNodeProp.lookAhead = new NodeProp({ perNode: true });\n/**\nThis per-node prop is used to replace a given node, or part of a\nnode, with another tree. This is useful to include trees from\ndifferent languages in mixed-language parsers.\n*/\nNodeProp.mounted = new NodeProp({ perNode: true });\n/**\nA mounted tree, which can be [stored](#common.NodeProp^mounted) on\na tree node to indicate that parts of its content are\nrepresented by another tree.\n*/\nclass MountedTree {\n    constructor(\n    /**\n    The inner tree.\n    */\n    tree, \n    /**\n    If this is null, this tree replaces the entire node (it will\n    be included in the regular iteration instead of its host\n    node). If not, only the given ranges are considered to be\n    covered by this tree. This is used for trees that are mixed in\n    a way that isn't strictly hierarchical. Such mounted trees are\n    only entered by [`resolveInner`](#common.Tree.resolveInner)\n    and [`enter`](#common.SyntaxNode.enter).\n    */\n    overlay, \n    /**\n    The parser used to create this subtree.\n    */\n    parser) {\n        this.tree = tree;\n        this.overlay = overlay;\n        this.parser = parser;\n    }\n    /**\n    @internal\n    */\n    static get(tree) {\n        return tree && tree.props && tree.props[NodeProp.mounted.id];\n    }\n}\nconst noProps = Object.create(null);\n/**\nEach node in a syntax tree has a node type associated with it.\n*/\nclass NodeType {\n    /**\n    @internal\n    */\n    constructor(\n    /**\n    The name of the node type. Not necessarily unique, but if the\n    grammar was written properly, different node types with the\n    same name within a node set should play the same semantic\n    role.\n    */\n    name, \n    /**\n    @internal\n    */\n    props, \n    /**\n    The id of this node in its set. Corresponds to the term ids\n    used in the parser.\n    */\n    id, \n    /**\n    @internal\n    */\n    flags = 0) {\n        this.name = name;\n        this.props = props;\n        this.id = id;\n        this.flags = flags;\n    }\n    /**\n    Define a node type.\n    */\n    static define(spec) {\n        let props = spec.props && spec.props.length ? Object.create(null) : noProps;\n        let flags = (spec.top ? 1 /* NodeFlag.Top */ : 0) | (spec.skipped ? 2 /* NodeFlag.Skipped */ : 0) |\n            (spec.error ? 4 /* NodeFlag.Error */ : 0) | (spec.name == null ? 8 /* NodeFlag.Anonymous */ : 0);\n        let type = new NodeType(spec.name || \"\", props, spec.id, flags);\n        if (spec.props)\n            for (let src of spec.props) {\n                if (!Array.isArray(src))\n                    src = src(type);\n                if (src) {\n                    if (src[0].perNode)\n                        throw new RangeError(\"Can't store a per-node prop on a node type\");\n                    props[src[0].id] = src[1];\n                }\n            }\n        return type;\n    }\n    /**\n    Retrieves a node prop for this type. Will return `undefined` if\n    the prop isn't present on this node.\n    */\n    prop(prop) { return this.props[prop.id]; }\n    /**\n    True when this is the top node of a grammar.\n    */\n    get isTop() { return (this.flags & 1 /* NodeFlag.Top */) > 0; }\n    /**\n    True when this node is produced by a skip rule.\n    */\n    get isSkipped() { return (this.flags & 2 /* NodeFlag.Skipped */) > 0; }\n    /**\n    Indicates whether this is an error node.\n    */\n    get isError() { return (this.flags & 4 /* NodeFlag.Error */) > 0; }\n    /**\n    When true, this node type doesn't correspond to a user-declared\n    named node, for example because it is used to cache repetition.\n    */\n    get isAnonymous() { return (this.flags & 8 /* NodeFlag.Anonymous */) > 0; }\n    /**\n    Returns true when this node's name or one of its\n    [groups](#common.NodeProp^group) matches the given string.\n    */\n    is(name) {\n        if (typeof name == 'string') {\n            if (this.name == name)\n                return true;\n            let group = this.prop(NodeProp.group);\n            return group ? group.indexOf(name) > -1 : false;\n        }\n        return this.id == name;\n    }\n    /**\n    Create a function from node types to arbitrary values by\n    specifying an object whose property names are node or\n    [group](#common.NodeProp^group) names. Often useful with\n    [`NodeProp.add`](#common.NodeProp.add). You can put multiple\n    names, separated by spaces, in a single property name to map\n    multiple node names to a single value.\n    */\n    static match(map) {\n        let direct = Object.create(null);\n        for (let prop in map)\n            for (let name of prop.split(\" \"))\n                direct[name] = map[prop];\n        return (node) => {\n            for (let groups = node.prop(NodeProp.group), i = -1; i < (groups ? groups.length : 0); i++) {\n                let found = direct[i < 0 ? node.name : groups[i]];\n                if (found)\n                    return found;\n            }\n        };\n    }\n}\n/**\nAn empty dummy node type to use when no actual type is available.\n*/\nNodeType.none = new NodeType(\"\", Object.create(null), 0, 8 /* NodeFlag.Anonymous */);\n/**\nA node set holds a collection of node types. It is used to\ncompactly represent trees by storing their type ids, rather than a\nfull pointer to the type object, in a numeric array. Each parser\n[has](#lr.LRParser.nodeSet) a node set, and [tree\nbuffers](#common.TreeBuffer) can only store collections of nodes\nfrom the same set. A set can have a maximum of 2**16 (65536) node\ntypes in it, so that the ids fit into 16-bit typed array slots.\n*/\nclass NodeSet {\n    /**\n    Create a set with the given types. The `id` property of each\n    type should correspond to its position within the array.\n    */\n    constructor(\n    /**\n    The node types in this set, by id.\n    */\n    types) {\n        this.types = types;\n        for (let i = 0; i < types.length; i++)\n            if (types[i].id != i)\n                throw new RangeError(\"Node type ids should correspond to array positions when creating a node set\");\n    }\n    /**\n    Create a copy of this set with some node properties added. The\n    arguments to this method can be created with\n    [`NodeProp.add`](#common.NodeProp.add).\n    */\n    extend(...props) {\n        let newTypes = [];\n        for (let type of this.types) {\n            let newProps = null;\n            for (let source of props) {\n                let add = source(type);\n                if (add) {\n                    if (!newProps)\n                        newProps = Object.assign({}, type.props);\n                    newProps[add[0].id] = add[1];\n                }\n            }\n            newTypes.push(newProps ? new NodeType(type.name, newProps, type.id, type.flags) : type);\n        }\n        return new NodeSet(newTypes);\n    }\n}\nconst CachedNode = new WeakMap(), CachedInnerNode = new WeakMap();\n/**\nOptions that control iteration. Can be combined with the `|`\noperator to enable multiple ones.\n*/\nvar IterMode;\n(function (IterMode) {\n    /**\n    When enabled, iteration will only visit [`Tree`](#common.Tree)\n    objects, not nodes packed into\n    [`TreeBuffer`](#common.TreeBuffer)s.\n    */\n    IterMode[IterMode[\"ExcludeBuffers\"] = 1] = \"ExcludeBuffers\";\n    /**\n    Enable this to make iteration include anonymous nodes (such as\n    the nodes that wrap repeated grammar constructs into a balanced\n    tree).\n    */\n    IterMode[IterMode[\"IncludeAnonymous\"] = 2] = \"IncludeAnonymous\";\n    /**\n    By default, regular [mounted](#common.NodeProp^mounted) nodes\n    replace their base node in iteration. Enable this to ignore them\n    instead.\n    */\n    IterMode[IterMode[\"IgnoreMounts\"] = 4] = \"IgnoreMounts\";\n    /**\n    This option only applies in\n    [`enter`](#common.SyntaxNode.enter)-style methods. It tells the\n    library to not enter mounted overlays if one covers the given\n    position.\n    */\n    IterMode[IterMode[\"IgnoreOverlays\"] = 8] = \"IgnoreOverlays\";\n})(IterMode || (IterMode = {}));\n/**\nA piece of syntax tree. There are two ways to approach these\ntrees: the way they are actually stored in memory, and the\nconvenient way.\n\nSyntax trees are stored as a tree of `Tree` and `TreeBuffer`\nobjects. By packing detail information into `TreeBuffer` leaf\nnodes, the representation is made a lot more memory-efficient.\n\nHowever, when you want to actually work with tree nodes, this\nrepresentation is very awkward, so most client code will want to\nuse the [`TreeCursor`](#common.TreeCursor) or\n[`SyntaxNode`](#common.SyntaxNode) interface instead, which provides\na view on some part of this data structure, and can be used to\nmove around to adjacent nodes.\n*/\nclass Tree {\n    /**\n    Construct a new tree. See also [`Tree.build`](#common.Tree^build).\n    */\n    constructor(\n    /**\n    The type of the top node.\n    */\n    type, \n    /**\n    This node's child nodes.\n    */\n    children, \n    /**\n    The positions (offsets relative to the start of this tree) of\n    the children.\n    */\n    positions, \n    /**\n    The total length of this tree\n    */\n    length, \n    /**\n    Per-node [node props](#common.NodeProp) to associate with this node.\n    */\n    props) {\n        this.type = type;\n        this.children = children;\n        this.positions = positions;\n        this.length = length;\n        /**\n        @internal\n        */\n        this.props = null;\n        if (props && props.length) {\n            this.props = Object.create(null);\n            for (let [prop, value] of props)\n                this.props[typeof prop == \"number\" ? prop : prop.id] = value;\n        }\n    }\n    /**\n    @internal\n    */\n    toString() {\n        let mounted = MountedTree.get(this);\n        if (mounted && !mounted.overlay)\n            return mounted.tree.toString();\n        let children = \"\";\n        for (let ch of this.children) {\n            let str = ch.toString();\n            if (str) {\n                if (children)\n                    children += \",\";\n                children += str;\n            }\n        }\n        return !this.type.name ? children :\n            (/\\W/.test(this.type.name) && !this.type.isError ? JSON.stringify(this.type.name) : this.type.name) +\n                (children.length ? \"(\" + children + \")\" : \"\");\n    }\n    /**\n    Get a [tree cursor](#common.TreeCursor) positioned at the top of\n    the tree. Mode can be used to [control](#common.IterMode) which\n    nodes the cursor visits.\n    */\n    cursor(mode = 0) {\n        return new TreeCursor(this.topNode, mode);\n    }\n    /**\n    Get a [tree cursor](#common.TreeCursor) pointing into this tree\n    at the given position and side (see\n    [`moveTo`](#common.TreeCursor.moveTo).\n    */\n    cursorAt(pos, side = 0, mode = 0) {\n        let scope = CachedNode.get(this) || this.topNode;\n        let cursor = new TreeCursor(scope);\n        cursor.moveTo(pos, side);\n        CachedNode.set(this, cursor._tree);\n        return cursor;\n    }\n    /**\n    Get a [syntax node](#common.SyntaxNode) object for the top of the\n    tree.\n    */\n    get topNode() {\n        return new TreeNode(this, 0, 0, null);\n    }\n    /**\n    Get the [syntax node](#common.SyntaxNode) at the given position.\n    If `side` is -1, this will move into nodes that end at the\n    position. If 1, it'll move into nodes that start at the\n    position. With 0, it'll only enter nodes that cover the position\n    from both sides.\n    \n    Note that this will not enter\n    [overlays](#common.MountedTree.overlay), and you often want\n    [`resolveInner`](#common.Tree.resolveInner) instead.\n    */\n    resolve(pos, side = 0) {\n        let node = resolveNode(CachedNode.get(this) || this.topNode, pos, side, false);\n        CachedNode.set(this, node);\n        return node;\n    }\n    /**\n    Like [`resolve`](#common.Tree.resolve), but will enter\n    [overlaid](#common.MountedTree.overlay) nodes, producing a syntax node\n    pointing into the innermost overlaid tree at the given position\n    (with parent links going through all parent structure, including\n    the host trees).\n    */\n    resolveInner(pos, side = 0) {\n        let node = resolveNode(CachedInnerNode.get(this) || this.topNode, pos, side, true);\n        CachedInnerNode.set(this, node);\n        return node;\n    }\n    /**\n    In some situations, it can be useful to iterate through all\n    nodes around a position, including those in overlays that don't\n    directly cover the position. This method gives you an iterator\n    that will produce all nodes, from small to big, around the given\n    position.\n    */\n    resolveStack(pos, side = 0) {\n        return stackIterator(this, pos, side);\n    }\n    /**\n    Iterate over the tree and its children, calling `enter` for any\n    node that touches the `from`/`to` region (if given) before\n    running over such a node's children, and `leave` (if given) when\n    leaving the node. When `enter` returns `false`, that node will\n    not have its children iterated over (or `leave` called).\n    */\n    iterate(spec) {\n        let { enter, leave, from = 0, to = this.length } = spec;\n        let mode = spec.mode || 0, anon = (mode & IterMode.IncludeAnonymous) > 0;\n        for (let c = this.cursor(mode | IterMode.IncludeAnonymous);;) {\n            let entered = false;\n            if (c.from <= to && c.to >= from && (!anon && c.type.isAnonymous || enter(c) !== false)) {\n                if (c.firstChild())\n                    continue;\n                entered = true;\n            }\n            for (;;) {\n                if (entered && leave && (anon || !c.type.isAnonymous))\n                    leave(c);\n                if (c.nextSibling())\n                    break;\n                if (!c.parent())\n                    return;\n                entered = true;\n            }\n        }\n    }\n    /**\n    Get the value of the given [node prop](#common.NodeProp) for this\n    node. Works with both per-node and per-type props.\n    */\n    prop(prop) {\n        return !prop.perNode ? this.type.prop(prop) : this.props ? this.props[prop.id] : undefined;\n    }\n    /**\n    Returns the node's [per-node props](#common.NodeProp.perNode) in a\n    format that can be passed to the [`Tree`](#common.Tree)\n    constructor.\n    */\n    get propValues() {\n        let result = [];\n        if (this.props)\n            for (let id in this.props)\n                result.push([+id, this.props[id]]);\n        return result;\n    }\n    /**\n    Balance the direct children of this tree, producing a copy of\n    which may have children grouped into subtrees with type\n    [`NodeType.none`](#common.NodeType^none).\n    */\n    balance(config = {}) {\n        return this.children.length <= 8 /* Balance.BranchFactor */ ? this :\n            balanceRange(NodeType.none, this.children, this.positions, 0, this.children.length, 0, this.length, (children, positions, length) => new Tree(this.type, children, positions, length, this.propValues), config.makeTree || ((children, positions, length) => new Tree(NodeType.none, children, positions, length)));\n    }\n    /**\n    Build a tree from a postfix-ordered buffer of node information,\n    or a cursor over such a buffer.\n    */\n    static build(data) { return buildTree(data); }\n}\n/**\nThe empty tree\n*/\nTree.empty = new Tree(NodeType.none, [], [], 0);\nclass FlatBufferCursor {\n    constructor(buffer, index) {\n        this.buffer = buffer;\n        this.index = index;\n    }\n    get id() { return this.buffer[this.index - 4]; }\n    get start() { return this.buffer[this.index - 3]; }\n    get end() { return this.buffer[this.index - 2]; }\n    get size() { return this.buffer[this.index - 1]; }\n    get pos() { return this.index; }\n    next() { this.index -= 4; }\n    fork() { return new FlatBufferCursor(this.buffer, this.index); }\n}\n/**\nTree buffers contain (type, start, end, endIndex) quads for each\nnode. In such a buffer, nodes are stored in prefix order (parents\nbefore children, with the endIndex of the parent indicating which\nchildren belong to it).\n*/\nclass TreeBuffer {\n    /**\n    Create a tree buffer.\n    */\n    constructor(\n    /**\n    The buffer's content.\n    */\n    buffer, \n    /**\n    The total length of the group of nodes in the buffer.\n    */\n    length, \n    /**\n    The node set used in this buffer.\n    */\n    set) {\n        this.buffer = buffer;\n        this.length = length;\n        this.set = set;\n    }\n    /**\n    @internal\n    */\n    get type() { return NodeType.none; }\n    /**\n    @internal\n    */\n    toString() {\n        let result = [];\n        for (let index = 0; index < this.buffer.length;) {\n            result.push(this.childString(index));\n            index = this.buffer[index + 3];\n        }\n        return result.join(\",\");\n    }\n    /**\n    @internal\n    */\n    childString(index) {\n        let id = this.buffer[index], endIndex = this.buffer[index + 3];\n        let type = this.set.types[id], result = type.name;\n        if (/\\W/.test(result) && !type.isError)\n            result = JSON.stringify(result);\n        index += 4;\n        if (endIndex == index)\n            return result;\n        let children = [];\n        while (index < endIndex) {\n            children.push(this.childString(index));\n            index = this.buffer[index + 3];\n        }\n        return result + \"(\" + children.join(\",\") + \")\";\n    }\n    /**\n    @internal\n    */\n    findChild(startIndex, endIndex, dir, pos, side) {\n        let { buffer } = this, pick = -1;\n        for (let i = startIndex; i != endIndex; i = buffer[i + 3]) {\n            if (checkSide(side, pos, buffer[i + 1], buffer[i + 2])) {\n                pick = i;\n                if (dir > 0)\n                    break;\n            }\n        }\n        return pick;\n    }\n    /**\n    @internal\n    */\n    slice(startI, endI, from) {\n        let b = this.buffer;\n        let copy = new Uint16Array(endI - startI), len = 0;\n        for (let i = startI, j = 0; i < endI;) {\n            copy[j++] = b[i++];\n            copy[j++] = b[i++] - from;\n            let to = copy[j++] = b[i++] - from;\n            copy[j++] = b[i++] - startI;\n            len = Math.max(len, to);\n        }\n        return new TreeBuffer(copy, len, this.set);\n    }\n}\nfunction checkSide(side, pos, from, to) {\n    switch (side) {\n        case -2 /* Side.Before */: return from < pos;\n        case -1 /* Side.AtOrBefore */: return to >= pos && from < pos;\n        case 0 /* Side.Around */: return from < pos && to > pos;\n        case 1 /* Side.AtOrAfter */: return from <= pos && to > pos;\n        case 2 /* Side.After */: return to > pos;\n        case 4 /* Side.DontCare */: return true;\n    }\n}\nfunction resolveNode(node, pos, side, overlays) {\n    var _a;\n    // Move up to a node that actually holds the position, if possible\n    while (node.from == node.to ||\n        (side < 1 ? node.from >= pos : node.from > pos) ||\n        (side > -1 ? node.to <= pos : node.to < pos)) {\n        let parent = !overlays && node instanceof TreeNode && node.index < 0 ? null : node.parent;\n        if (!parent)\n            return node;\n        node = parent;\n    }\n    let mode = overlays ? 0 : IterMode.IgnoreOverlays;\n    // Must go up out of overlays when those do not overlap with pos\n    if (overlays)\n        for (let scan = node, parent = scan.parent; parent; scan = parent, parent = scan.parent) {\n            if (scan instanceof TreeNode && scan.index < 0 && ((_a = parent.enter(pos, side, mode)) === null || _a === void 0 ? void 0 : _a.from) != scan.from)\n                node = parent;\n        }\n    for (;;) {\n        let inner = node.enter(pos, side, mode);\n        if (!inner)\n            return node;\n        node = inner;\n    }\n}\nclass BaseNode {\n    cursor(mode = 0) { return new TreeCursor(this, mode); }\n    getChild(type, before = null, after = null) {\n        let r = getChildren(this, type, before, after);\n        return r.length ? r[0] : null;\n    }\n    getChildren(type, before = null, after = null) {\n        return getChildren(this, type, before, after);\n    }\n    resolve(pos, side = 0) {\n        return resolveNode(this, pos, side, false);\n    }\n    resolveInner(pos, side = 0) {\n        return resolveNode(this, pos, side, true);\n    }\n    matchContext(context) {\n        return matchNodeContext(this, context);\n    }\n    enterUnfinishedNodesBefore(pos) {\n        let scan = this.childBefore(pos), node = this;\n        while (scan) {\n            let last = scan.lastChild;\n            if (!last || last.to != scan.to)\n                break;\n            if (last.type.isError && last.from == last.to) {\n                node = scan;\n                scan = last.prevSibling;\n            }\n            else {\n                scan = last;\n            }\n        }\n        return node;\n    }\n    get node() { return this; }\n    get next() { return this.parent; }\n}\nclass TreeNode extends BaseNode {\n    constructor(_tree, from, \n    // Index in parent node, set to -1 if the node is not a direct child of _parent.node (overlay)\n    index, _parent) {\n        super();\n        this._tree = _tree;\n        this.from = from;\n        this.index = index;\n        this._parent = _parent;\n    }\n    get type() { return this._tree.type; }\n    get name() { return this._tree.type.name; }\n    get to() { return this.from + this._tree.length; }\n    nextChild(i, dir, pos, side, mode = 0) {\n        for (let parent = this;;) {\n            for (let { children, positions } = parent._tree, e = dir > 0 ? children.length : -1; i != e; i += dir) {\n                let next = children[i], start = positions[i] + parent.from;\n                if (!checkSide(side, pos, start, start + next.length))\n                    continue;\n                if (next instanceof TreeBuffer) {\n                    if (mode & IterMode.ExcludeBuffers)\n                        continue;\n                    let index = next.findChild(0, next.buffer.length, dir, pos - start, side);\n                    if (index > -1)\n                        return new BufferNode(new BufferContext(parent, next, i, start), null, index);\n                }\n                else if ((mode & IterMode.IncludeAnonymous) || (!next.type.isAnonymous || hasChild(next))) {\n                    let mounted;\n                    if (!(mode & IterMode.IgnoreMounts) && (mounted = MountedTree.get(next)) && !mounted.overlay)\n                        return new TreeNode(mounted.tree, start, i, parent);\n                    let inner = new TreeNode(next, start, i, parent);\n                    return (mode & IterMode.IncludeAnonymous) || !inner.type.isAnonymous ? inner\n                        : inner.nextChild(dir < 0 ? next.children.length - 1 : 0, dir, pos, side);\n                }\n            }\n            if ((mode & IterMode.IncludeAnonymous) || !parent.type.isAnonymous)\n                return null;\n            if (parent.index >= 0)\n                i = parent.index + dir;\n            else\n                i = dir < 0 ? -1 : parent._parent._tree.children.length;\n            parent = parent._parent;\n            if (!parent)\n                return null;\n        }\n    }\n    get firstChild() { return this.nextChild(0, 1, 0, 4 /* Side.DontCare */); }\n    get lastChild() { return this.nextChild(this._tree.children.length - 1, -1, 0, 4 /* Side.DontCare */); }\n    childAfter(pos) { return this.nextChild(0, 1, pos, 2 /* Side.After */); }\n    childBefore(pos) { return this.nextChild(this._tree.children.length - 1, -1, pos, -2 /* Side.Before */); }\n    enter(pos, side, mode = 0) {\n        let mounted;\n        if (!(mode & IterMode.IgnoreOverlays) && (mounted = MountedTree.get(this._tree)) && mounted.overlay) {\n            let rPos = pos - this.from;\n            for (let { from, to } of mounted.overlay) {\n                if ((side > 0 ? from <= rPos : from < rPos) &&\n                    (side < 0 ? to >= rPos : to > rPos))\n                    return new TreeNode(mounted.tree, mounted.overlay[0].from + this.from, -1, this);\n            }\n        }\n        return this.nextChild(0, 1, pos, side, mode);\n    }\n    nextSignificantParent() {\n        let val = this;\n        while (val.type.isAnonymous && val._parent)\n            val = val._parent;\n        return val;\n    }\n    get parent() {\n        return this._parent ? this._parent.nextSignificantParent() : null;\n    }\n    get nextSibling() {\n        return this._parent && this.index >= 0 ? this._parent.nextChild(this.index + 1, 1, 0, 4 /* Side.DontCare */) : null;\n    }\n    get prevSibling() {\n        return this._parent && this.index >= 0 ? this._parent.nextChild(this.index - 1, -1, 0, 4 /* Side.DontCare */) : null;\n    }\n    get tree() { return this._tree; }\n    toTree() { return this._tree; }\n    /**\n    @internal\n    */\n    toString() { return this._tree.toString(); }\n}\nfunction getChildren(node, type, before, after) {\n    let cur = node.cursor(), result = [];\n    if (!cur.firstChild())\n        return result;\n    if (before != null)\n        for (let found = false; !found;) {\n            found = cur.type.is(before);\n            if (!cur.nextSibling())\n                return result;\n        }\n    for (;;) {\n        if (after != null && cur.type.is(after))\n            return result;\n        if (cur.type.is(type))\n            result.push(cur.node);\n        if (!cur.nextSibling())\n            return after == null ? result : [];\n    }\n}\nfunction matchNodeContext(node, context, i = context.length - 1) {\n    for (let p = node.parent; i >= 0; p = p.parent) {\n        if (!p)\n            return false;\n        if (!p.type.isAnonymous) {\n            if (context[i] && context[i] != p.name)\n                return false;\n            i--;\n        }\n    }\n    return true;\n}\nclass BufferContext {\n    constructor(parent, buffer, index, start) {\n        this.parent = parent;\n        this.buffer = buffer;\n        this.index = index;\n        this.start = start;\n    }\n}\nclass BufferNode extends BaseNode {\n    get name() { return this.type.name; }\n    get from() { return this.context.start + this.context.buffer.buffer[this.index + 1]; }\n    get to() { return this.context.start + this.context.buffer.buffer[this.index + 2]; }\n    constructor(context, _parent, index) {\n        super();\n        this.context = context;\n        this._parent = _parent;\n        this.index = index;\n        this.type = context.buffer.set.types[context.buffer.buffer[index]];\n    }\n    child(dir, pos, side) {\n        let { buffer } = this.context;\n        let index = buffer.findChild(this.index + 4, buffer.buffer[this.index + 3], dir, pos - this.context.start, side);\n        return index < 0 ? null : new BufferNode(this.context, this, index);\n    }\n    get firstChild() { return this.child(1, 0, 4 /* Side.DontCare */); }\n    get lastChild() { return this.child(-1, 0, 4 /* Side.DontCare */); }\n    childAfter(pos) { return this.child(1, pos, 2 /* Side.After */); }\n    childBefore(pos) { return this.child(-1, pos, -2 /* Side.Before */); }\n    enter(pos, side, mode = 0) {\n        if (mode & IterMode.ExcludeBuffers)\n            return null;\n        let { buffer } = this.context;\n        let index = buffer.findChild(this.index + 4, buffer.buffer[this.index + 3], side > 0 ? 1 : -1, pos - this.context.start, side);\n        return index < 0 ? null : new BufferNode(this.context, this, index);\n    }\n    get parent() {\n        return this._parent || this.context.parent.nextSignificantParent();\n    }\n    externalSibling(dir) {\n        return this._parent ? null : this.context.parent.nextChild(this.context.index + dir, dir, 0, 4 /* Side.DontCare */);\n    }\n    get nextSibling() {\n        let { buffer } = this.context;\n        let after = buffer.buffer[this.index + 3];\n        if (after < (this._parent ? buffer.buffer[this._parent.index + 3] : buffer.buffer.length))\n            return new BufferNode(this.context, this._parent, after);\n        return this.externalSibling(1);\n    }\n    get prevSibling() {\n        let { buffer } = this.context;\n        let parentStart = this._parent ? this._parent.index + 4 : 0;\n        if (this.index == parentStart)\n            return this.externalSibling(-1);\n        return new BufferNode(this.context, this._parent, buffer.findChild(parentStart, this.index, -1, 0, 4 /* Side.DontCare */));\n    }\n    get tree() { return null; }\n    toTree() {\n        let children = [], positions = [];\n        let { buffer } = this.context;\n        let startI = this.index + 4, endI = buffer.buffer[this.index + 3];\n        if (endI > startI) {\n            let from = buffer.buffer[this.index + 1];\n            children.push(buffer.slice(startI, endI, from));\n            positions.push(0);\n        }\n        return new Tree(this.type, children, positions, this.to - this.from);\n    }\n    /**\n    @internal\n    */\n    toString() { return this.context.buffer.childString(this.index); }\n}\nfunction iterStack(heads) {\n    if (!heads.length)\n        return null;\n    let pick = 0, picked = heads[0];\n    for (let i = 1; i < heads.length; i++) {\n        let node = heads[i];\n        if (node.from > picked.from || node.to < picked.to) {\n            picked = node;\n            pick = i;\n        }\n    }\n    let next = picked instanceof TreeNode && picked.index < 0 ? null : picked.parent;\n    let newHeads = heads.slice();\n    if (next)\n        newHeads[pick] = next;\n    else\n        newHeads.splice(pick, 1);\n    return new StackIterator(newHeads, picked);\n}\nclass StackIterator {\n    constructor(heads, node) {\n        this.heads = heads;\n        this.node = node;\n    }\n    get next() { return iterStack(this.heads); }\n}\nfunction stackIterator(tree, pos, side) {\n    let inner = tree.resolveInner(pos, side), layers = null;\n    for (let scan = inner instanceof TreeNode ? inner : inner.context.parent; scan; scan = scan.parent) {\n        if (scan.index < 0) { // This is an overlay root\n            let parent = scan.parent;\n            (layers || (layers = [inner])).push(parent.resolve(pos, side));\n            scan = parent;\n        }\n        else {\n            let mount = MountedTree.get(scan.tree);\n            // Relevant overlay branching off\n            if (mount && mount.overlay && mount.overlay[0].from <= pos && mount.overlay[mount.overlay.length - 1].to >= pos) {\n                let root = new TreeNode(mount.tree, mount.overlay[0].from + scan.from, -1, scan);\n                (layers || (layers = [inner])).push(resolveNode(root, pos, side, false));\n            }\n        }\n    }\n    return layers ? iterStack(layers) : inner;\n}\n/**\nA tree cursor object focuses on a given node in a syntax tree, and\nallows you to move to adjacent nodes.\n*/\nclass TreeCursor {\n    /**\n    Shorthand for `.type.name`.\n    */\n    get name() { return this.type.name; }\n    /**\n    @internal\n    */\n    constructor(node, \n    /**\n    @internal\n    */\n    mode = 0) {\n        this.mode = mode;\n        /**\n        @internal\n        */\n        this.buffer = null;\n        this.stack = [];\n        /**\n        @internal\n        */\n        this.index = 0;\n        this.bufferNode = null;\n        if (node instanceof TreeNode) {\n            this.yieldNode(node);\n        }\n        else {\n            this._tree = node.context.parent;\n            this.buffer = node.context;\n            for (let n = node._parent; n; n = n._parent)\n                this.stack.unshift(n.index);\n            this.bufferNode = node;\n            this.yieldBuf(node.index);\n        }\n    }\n    yieldNode(node) {\n        if (!node)\n            return false;\n        this._tree = node;\n        this.type = node.type;\n        this.from = node.from;\n        this.to = node.to;\n        return true;\n    }\n    yieldBuf(index, type) {\n        this.index = index;\n        let { start, buffer } = this.buffer;\n        this.type = type || buffer.set.types[buffer.buffer[index]];\n        this.from = start + buffer.buffer[index + 1];\n        this.to = start + buffer.buffer[index + 2];\n        return true;\n    }\n    /**\n    @internal\n    */\n    yield(node) {\n        if (!node)\n            return false;\n        if (node instanceof TreeNode) {\n            this.buffer = null;\n            return this.yieldNode(node);\n        }\n        this.buffer = node.context;\n        return this.yieldBuf(node.index, node.type);\n    }\n    /**\n    @internal\n    */\n    toString() {\n        return this.buffer ? this.buffer.buffer.childString(this.index) : this._tree.toString();\n    }\n    /**\n    @internal\n    */\n    enterChild(dir, pos, side) {\n        if (!this.buffer)\n            return this.yield(this._tree.nextChild(dir < 0 ? this._tree._tree.children.length - 1 : 0, dir, pos, side, this.mode));\n        let { buffer } = this.buffer;\n        let index = buffer.findChild(this.index + 4, buffer.buffer[this.index + 3], dir, pos - this.buffer.start, side);\n        if (index < 0)\n            return false;\n        this.stack.push(this.index);\n        return this.yieldBuf(index);\n    }\n    /**\n    Move the cursor to this node's first child. When this returns\n    false, the node has no child, and the cursor has not been moved.\n    */\n    firstChild() { return this.enterChild(1, 0, 4 /* Side.DontCare */); }\n    /**\n    Move the cursor to this node's last child.\n    */\n    lastChild() { return this.enterChild(-1, 0, 4 /* Side.DontCare */); }\n    /**\n    Move the cursor to the first child that ends after `pos`.\n    */\n    childAfter(pos) { return this.enterChild(1, pos, 2 /* Side.After */); }\n    /**\n    Move to the last child that starts before `pos`.\n    */\n    childBefore(pos) { return this.enterChild(-1, pos, -2 /* Side.Before */); }\n    /**\n    Move the cursor to the child around `pos`. If side is -1 the\n    child may end at that position, when 1 it may start there. This\n    will also enter [overlaid](#common.MountedTree.overlay)\n    [mounted](#common.NodeProp^mounted) trees unless `overlays` is\n    set to false.\n    */\n    enter(pos, side, mode = this.mode) {\n        if (!this.buffer)\n            return this.yield(this._tree.enter(pos, side, mode));\n        return mode & IterMode.ExcludeBuffers ? false : this.enterChild(1, pos, side);\n    }\n    /**\n    Move to the node's parent node, if this isn't the top node.\n    */\n    parent() {\n        if (!this.buffer)\n            return this.yieldNode((this.mode & IterMode.IncludeAnonymous) ? this._tree._parent : this._tree.parent);\n        if (this.stack.length)\n            return this.yieldBuf(this.stack.pop());\n        let parent = (this.mode & IterMode.IncludeAnonymous) ? this.buffer.parent : this.buffer.parent.nextSignificantParent();\n        this.buffer = null;\n        return this.yieldNode(parent);\n    }\n    /**\n    @internal\n    */\n    sibling(dir) {\n        if (!this.buffer)\n            return !this._tree._parent ? false\n                : this.yield(this._tree.index < 0 ? null\n                    : this._tree._parent.nextChild(this._tree.index + dir, dir, 0, 4 /* Side.DontCare */, this.mode));\n        let { buffer } = this.buffer, d = this.stack.length - 1;\n        if (dir < 0) {\n            let parentStart = d < 0 ? 0 : this.stack[d] + 4;\n            if (this.index != parentStart)\n                return this.yieldBuf(buffer.findChild(parentStart, this.index, -1, 0, 4 /* Side.DontCare */));\n        }\n        else {\n            let after = buffer.buffer[this.index + 3];\n            if (after < (d < 0 ? buffer.buffer.length : buffer.buffer[this.stack[d] + 3]))\n                return this.yieldBuf(after);\n        }\n        return d < 0 ? this.yield(this.buffer.parent.nextChild(this.buffer.index + dir, dir, 0, 4 /* Side.DontCare */, this.mode)) : false;\n    }\n    /**\n    Move to this node's next sibling, if any.\n    */\n    nextSibling() { return this.sibling(1); }\n    /**\n    Move to this node's previous sibling, if any.\n    */\n    prevSibling() { return this.sibling(-1); }\n    atLastNode(dir) {\n        let index, parent, { buffer } = this;\n        if (buffer) {\n            if (dir > 0) {\n                if (this.index < buffer.buffer.buffer.length)\n                    return false;\n            }\n            else {\n                for (let i = 0; i < this.index; i++)\n                    if (buffer.buffer.buffer[i + 3] < this.index)\n                        return false;\n            }\n            ({ index, parent } = buffer);\n        }\n        else {\n            ({ index, _parent: parent } = this._tree);\n        }\n        for (; parent; { index, _parent: parent } = parent) {\n            if (index > -1)\n                for (let i = index + dir, e = dir < 0 ? -1 : parent._tree.children.length; i != e; i += dir) {\n                    let child = parent._tree.children[i];\n                    if ((this.mode & IterMode.IncludeAnonymous) ||\n                        child instanceof TreeBuffer ||\n                        !child.type.isAnonymous ||\n                        hasChild(child))\n                        return false;\n                }\n        }\n        return true;\n    }\n    move(dir, enter) {\n        if (enter && this.enterChild(dir, 0, 4 /* Side.DontCare */))\n            return true;\n        for (;;) {\n            if (this.sibling(dir))\n                return true;\n            if (this.atLastNode(dir) || !this.parent())\n                return false;\n        }\n    }\n    /**\n    Move to the next node in a\n    [pre-order](https://en.wikipedia.org/wiki/Tree_traversal#Pre-order,_NLR)\n    traversal, going from a node to its first child or, if the\n    current node is empty or `enter` is false, its next sibling or\n    the next sibling of the first parent node that has one.\n    */\n    next(enter = true) { return this.move(1, enter); }\n    /**\n    Move to the next node in a last-to-first pre-order traveral. A\n    node is followed by its last child or, if it has none, its\n    previous sibling or the previous sibling of the first parent\n    node that has one.\n    */\n    prev(enter = true) { return this.move(-1, enter); }\n    /**\n    Move the cursor to the innermost node that covers `pos`. If\n    `side` is -1, it will enter nodes that end at `pos`. If it is 1,\n    it will enter nodes that start at `pos`.\n    */\n    moveTo(pos, side = 0) {\n        // Move up to a node that actually holds the position, if possible\n        while (this.from == this.to ||\n            (side < 1 ? this.from >= pos : this.from > pos) ||\n            (side > -1 ? this.to <= pos : this.to < pos))\n            if (!this.parent())\n                break;\n        // Then scan down into child nodes as far as possible\n        while (this.enterChild(1, pos, side)) { }\n        return this;\n    }\n    /**\n    Get a [syntax node](#common.SyntaxNode) at the cursor's current\n    position.\n    */\n    get node() {\n        if (!this.buffer)\n            return this._tree;\n        let cache = this.bufferNode, result = null, depth = 0;\n        if (cache && cache.context == this.buffer) {\n            scan: for (let index = this.index, d = this.stack.length; d >= 0;) {\n                for (let c = cache; c; c = c._parent)\n                    if (c.index == index) {\n                        if (index == this.index)\n                            return c;\n                        result = c;\n                        depth = d + 1;\n                        break scan;\n                    }\n                index = this.stack[--d];\n            }\n        }\n        for (let i = depth; i < this.stack.length; i++)\n            result = new BufferNode(this.buffer, result, this.stack[i]);\n        return this.bufferNode = new BufferNode(this.buffer, result, this.index);\n    }\n    /**\n    Get the [tree](#common.Tree) that represents the current node, if\n    any. Will return null when the node is in a [tree\n    buffer](#common.TreeBuffer).\n    */\n    get tree() {\n        return this.buffer ? null : this._tree._tree;\n    }\n    /**\n    Iterate over the current node and all its descendants, calling\n    `enter` when entering a node and `leave`, if given, when leaving\n    one. When `enter` returns `false`, any children of that node are\n    skipped, and `leave` isn't called for it.\n    */\n    iterate(enter, leave) {\n        for (let depth = 0;;) {\n            let mustLeave = false;\n            if (this.type.isAnonymous || enter(this) !== false) {\n                if (this.firstChild()) {\n                    depth++;\n                    continue;\n                }\n                if (!this.type.isAnonymous)\n                    mustLeave = true;\n            }\n            for (;;) {\n                if (mustLeave && leave)\n                    leave(this);\n                mustLeave = this.type.isAnonymous;\n                if (this.nextSibling())\n                    break;\n                if (!depth)\n                    return;\n                this.parent();\n                depth--;\n                mustLeave = true;\n            }\n        }\n    }\n    /**\n    Test whether the current node matches a given contexta sequence\n    of direct parent node names. Empty strings in the context array\n    are treated as wildcards.\n    */\n    matchContext(context) {\n        if (!this.buffer)\n            return matchNodeContext(this.node, context);\n        let { buffer } = this.buffer, { types } = buffer.set;\n        for (let i = context.length - 1, d = this.stack.length - 1; i >= 0; d--) {\n            if (d < 0)\n                return matchNodeContext(this.node, context, i);\n            let type = types[buffer.buffer[this.stack[d]]];\n            if (!type.isAnonymous) {\n                if (context[i] && context[i] != type.name)\n                    return false;\n                i--;\n            }\n        }\n        return true;\n    }\n}\nfunction hasChild(tree) {\n    return tree.children.some(ch => ch instanceof TreeBuffer || !ch.type.isAnonymous || hasChild(ch));\n}\nfunction buildTree(data) {\n    var _a;\n    let { buffer, nodeSet, maxBufferLength = DefaultBufferLength, reused = [], minRepeatType = nodeSet.types.length } = data;\n    let cursor = Array.isArray(buffer) ? new FlatBufferCursor(buffer, buffer.length) : buffer;\n    let types = nodeSet.types;\n    let contextHash = 0, lookAhead = 0;\n    function takeNode(parentStart, minPos, children, positions, inRepeat, depth) {\n        let { id, start, end, size } = cursor;\n        let lookAheadAtStart = lookAhead;\n        while (size < 0) {\n            cursor.next();\n            if (size == -1 /* SpecialRecord.Reuse */) {\n                let node = reused[id];\n                children.push(node);\n                positions.push(start - parentStart);\n                return;\n            }\n            else if (size == -3 /* SpecialRecord.ContextChange */) { // Context change\n                contextHash = id;\n                return;\n            }\n            else if (size == -4 /* SpecialRecord.LookAhead */) {\n                lookAhead = id;\n                return;\n            }\n            else {\n                throw new RangeError(`Unrecognized record size: ${size}`);\n            }\n        }\n        let type = types[id], node, buffer;\n        let startPos = start - parentStart;\n        if (end - start <= maxBufferLength && (buffer = findBufferSize(cursor.pos - minPos, inRepeat))) {\n            // Small enough for a buffer, and no reused nodes inside\n            let data = new Uint16Array(buffer.size - buffer.skip);\n            let endPos = cursor.pos - buffer.size, index = data.length;\n            while (cursor.pos > endPos)\n                index = copyToBuffer(buffer.start, data, index);\n            node = new TreeBuffer(data, end - buffer.start, nodeSet);\n            startPos = buffer.start - parentStart;\n        }\n        else { // Make it a node\n            let endPos = cursor.pos - size;\n            cursor.next();\n            let localChildren = [], localPositions = [];\n            let localInRepeat = id >= minRepeatType ? id : -1;\n            let lastGroup = 0, lastEnd = end;\n            while (cursor.pos > endPos) {\n                if (localInRepeat >= 0 && cursor.id == localInRepeat && cursor.size >= 0) {\n                    if (cursor.end <= lastEnd - maxBufferLength) {\n                        makeRepeatLeaf(localChildren, localPositions, start, lastGroup, cursor.end, lastEnd, localInRepeat, lookAheadAtStart);\n                        lastGroup = localChildren.length;\n                        lastEnd = cursor.end;\n                    }\n                    cursor.next();\n                }\n                else if (depth > 2500 /* CutOff.Depth */) {\n                    takeFlatNode(start, endPos, localChildren, localPositions);\n                }\n                else {\n                    takeNode(start, endPos, localChildren, localPositions, localInRepeat, depth + 1);\n                }\n            }\n            if (localInRepeat >= 0 && lastGroup > 0 && lastGroup < localChildren.length)\n                makeRepeatLeaf(localChildren, localPositions, start, lastGroup, start, lastEnd, localInRepeat, lookAheadAtStart);\n            localChildren.reverse();\n            localPositions.reverse();\n            if (localInRepeat > -1 && lastGroup > 0) {\n                let make = makeBalanced(type);\n                node = balanceRange(type, localChildren, localPositions, 0, localChildren.length, 0, end - start, make, make);\n            }\n            else {\n                node = makeTree(type, localChildren, localPositions, end - start, lookAheadAtStart - end);\n            }\n        }\n        children.push(node);\n        positions.push(startPos);\n    }\n    function takeFlatNode(parentStart, minPos, children, positions) {\n        let nodes = []; // Temporary, inverted array of leaf nodes found, with absolute positions\n        let nodeCount = 0, stopAt = -1;\n        while (cursor.pos > minPos) {\n            let { id, start, end, size } = cursor;\n            if (size > 4) { // Not a leaf\n                cursor.next();\n            }\n            else if (stopAt > -1 && start < stopAt) {\n                break;\n            }\n            else {\n                if (stopAt < 0)\n                    stopAt = end - maxBufferLength;\n                nodes.push(id, start, end);\n                nodeCount++;\n                cursor.next();\n            }\n        }\n        if (nodeCount) {\n            let buffer = new Uint16Array(nodeCount * 4);\n            let start = nodes[nodes.length - 2];\n            for (let i = nodes.length - 3, j = 0; i >= 0; i -= 3) {\n                buffer[j++] = nodes[i];\n                buffer[j++] = nodes[i + 1] - start;\n                buffer[j++] = nodes[i + 2] - start;\n                buffer[j++] = j;\n            }\n            children.push(new TreeBuffer(buffer, nodes[2] - start, nodeSet));\n            positions.push(start - parentStart);\n        }\n    }\n    function makeBalanced(type) {\n        return (children, positions, length) => {\n            let lookAhead = 0, lastI = children.length - 1, last, lookAheadProp;\n            if (lastI >= 0 && (last = children[lastI]) instanceof Tree) {\n                if (!lastI && last.type == type && last.length == length)\n                    return last;\n                if (lookAheadProp = last.prop(NodeProp.lookAhead))\n                    lookAhead = positions[lastI] + last.length + lookAheadProp;\n            }\n            return makeTree(type, children, positions, length, lookAhead);\n        };\n    }\n    function makeRepeatLeaf(children, positions, base, i, from, to, type, lookAhead) {\n        let localChildren = [], localPositions = [];\n        while (children.length > i) {\n            localChildren.push(children.pop());\n            localPositions.push(positions.pop() + base - from);\n        }\n        children.push(makeTree(nodeSet.types[type], localChildren, localPositions, to - from, lookAhead - to));\n        positions.push(from - base);\n    }\n    function makeTree(type, children, positions, length, lookAhead = 0, props) {\n        if (contextHash) {\n            let pair = [NodeProp.contextHash, contextHash];\n            props = props ? [pair].concat(props) : [pair];\n        }\n        if (lookAhead > 25) {\n            let pair = [NodeProp.lookAhead, lookAhead];\n            props = props ? [pair].concat(props) : [pair];\n        }\n        return new Tree(type, children, positions, length, props);\n    }\n    function findBufferSize(maxSize, inRepeat) {\n        // Scan through the buffer to find previous siblings that fit\n        // together in a TreeBuffer, and don't contain any reused nodes\n        // (which can't be stored in a buffer).\n        // If `inRepeat` is > -1, ignore node boundaries of that type for\n        // nesting, but make sure the end falls either at the start\n        // (`maxSize`) or before such a node.\n        let fork = cursor.fork();\n        let size = 0, start = 0, skip = 0, minStart = fork.end - maxBufferLength;\n        let result = { size: 0, start: 0, skip: 0 };\n        scan: for (let minPos = fork.pos - maxSize; fork.pos > minPos;) {\n            let nodeSize = fork.size;\n            // Pretend nested repeat nodes of the same type don't exist\n            if (fork.id == inRepeat && nodeSize >= 0) {\n                // Except that we store the current state as a valid return\n                // value.\n                result.size = size;\n                result.start = start;\n                result.skip = skip;\n                skip += 4;\n                size += 4;\n                fork.next();\n                continue;\n            }\n            let startPos = fork.pos - nodeSize;\n            if (nodeSize < 0 || startPos < minPos || fork.start < minStart)\n                break;\n            let localSkipped = fork.id >= minRepeatType ? 4 : 0;\n            let nodeStart = fork.start;\n            fork.next();\n            while (fork.pos > startPos) {\n                if (fork.size < 0) {\n                    if (fork.size == -3 /* SpecialRecord.ContextChange */)\n                        localSkipped += 4;\n                    else\n                        break scan;\n                }\n                else if (fork.id >= minRepeatType) {\n                    localSkipped += 4;\n                }\n                fork.next();\n            }\n            start = nodeStart;\n            size += nodeSize;\n            skip += localSkipped;\n        }\n        if (inRepeat < 0 || size == maxSize) {\n            result.size = size;\n            result.start = start;\n            result.skip = skip;\n        }\n        return result.size > 4 ? result : undefined;\n    }\n    function copyToBuffer(bufferStart, buffer, index) {\n        let { id, start, end, size } = cursor;\n        cursor.next();\n        if (size >= 0 && id < minRepeatType) {\n            let startIndex = index;\n            if (size > 4) {\n                let endPos = cursor.pos - (size - 4);\n                while (cursor.pos > endPos)\n                    index = copyToBuffer(bufferStart, buffer, index);\n            }\n            buffer[--index] = startIndex;\n            buffer[--index] = end - bufferStart;\n            buffer[--index] = start - bufferStart;\n            buffer[--index] = id;\n        }\n        else if (size == -3 /* SpecialRecord.ContextChange */) {\n            contextHash = id;\n        }\n        else if (size == -4 /* SpecialRecord.LookAhead */) {\n            lookAhead = id;\n        }\n        return index;\n    }\n    let children = [], positions = [];\n    while (cursor.pos > 0)\n        takeNode(data.start || 0, data.bufferStart || 0, children, positions, -1, 0);\n    let length = (_a = data.length) !== null && _a !== void 0 ? _a : (children.length ? positions[0] + children[0].length : 0);\n    return new Tree(types[data.topID], children.reverse(), positions.reverse(), length);\n}\nconst nodeSizeCache = new WeakMap;\nfunction nodeSize(balanceType, node) {\n    if (!balanceType.isAnonymous || node instanceof TreeBuffer || node.type != balanceType)\n        return 1;\n    let size = nodeSizeCache.get(node);\n    if (size == null) {\n        size = 1;\n        for (let child of node.children) {\n            if (child.type != balanceType || !(child instanceof Tree)) {\n                size = 1;\n                break;\n            }\n            size += nodeSize(balanceType, child);\n        }\n        nodeSizeCache.set(node, size);\n    }\n    return size;\n}\nfunction balanceRange(\n// The type the balanced tree's inner nodes.\nbalanceType, \n// The direct children and their positions\nchildren, positions, \n// The index range in children/positions to use\nfrom, to, \n// The start position of the nodes, relative to their parent.\nstart, \n// Length of the outer node\nlength, \n// Function to build the top node of the balanced tree\nmkTop, \n// Function to build internal nodes for the balanced tree\nmkTree) {\n    let total = 0;\n    for (let i = from; i < to; i++)\n        total += nodeSize(balanceType, children[i]);\n    let maxChild = Math.ceil((total * 1.5) / 8 /* Balance.BranchFactor */);\n    let localChildren = [], localPositions = [];\n    function divide(children, positions, from, to, offset) {\n        for (let i = from; i < to;) {\n            let groupFrom = i, groupStart = positions[i], groupSize = nodeSize(balanceType, children[i]);\n            i++;\n            for (; i < to; i++) {\n                let nextSize = nodeSize(balanceType, children[i]);\n                if (groupSize + nextSize >= maxChild)\n                    break;\n                groupSize += nextSize;\n            }\n            if (i == groupFrom + 1) {\n                if (groupSize > maxChild) {\n                    let only = children[groupFrom]; // Only trees can have a size > 1\n                    divide(only.children, only.positions, 0, only.children.length, positions[groupFrom] + offset);\n                    continue;\n                }\n                localChildren.push(children[groupFrom]);\n            }\n            else {\n                let length = positions[i - 1] + children[i - 1].length - groupStart;\n                localChildren.push(balanceRange(balanceType, children, positions, groupFrom, i, groupStart, length, null, mkTree));\n            }\n            localPositions.push(groupStart + offset - start);\n        }\n    }\n    divide(children, positions, from, to, 0);\n    return (mkTop || mkTree)(localChildren, localPositions, length);\n}\n/**\nProvides a way to associate values with pieces of trees. As long\nas that part of the tree is reused, the associated values can be\nretrieved from an updated tree.\n*/\nclass NodeWeakMap {\n    constructor() {\n        this.map = new WeakMap();\n    }\n    setBuffer(buffer, index, value) {\n        let inner = this.map.get(buffer);\n        if (!inner)\n            this.map.set(buffer, inner = new Map);\n        inner.set(index, value);\n    }\n    getBuffer(buffer, index) {\n        let inner = this.map.get(buffer);\n        return inner && inner.get(index);\n    }\n    /**\n    Set the value for this syntax node.\n    */\n    set(node, value) {\n        if (node instanceof BufferNode)\n            this.setBuffer(node.context.buffer, node.index, value);\n        else if (node instanceof TreeNode)\n            this.map.set(node.tree, value);\n    }\n    /**\n    Retrieve value for this syntax node, if it exists in the map.\n    */\n    get(node) {\n        return node instanceof BufferNode ? this.getBuffer(node.context.buffer, node.index)\n            : node instanceof TreeNode ? this.map.get(node.tree) : undefined;\n    }\n    /**\n    Set the value for the node that a cursor currently points to.\n    */\n    cursorSet(cursor, value) {\n        if (cursor.buffer)\n            this.setBuffer(cursor.buffer.buffer, cursor.index, value);\n        else\n            this.map.set(cursor.tree, value);\n    }\n    /**\n    Retrieve the value for the node that a cursor currently points\n    to.\n    */\n    cursorGet(cursor) {\n        return cursor.buffer ? this.getBuffer(cursor.buffer.buffer, cursor.index) : this.map.get(cursor.tree);\n    }\n}\n\n/**\nTree fragments are used during [incremental\nparsing](#common.Parser.startParse) to track parts of old trees\nthat can be reused in a new parse. An array of fragments is used\nto track regions of an old tree whose nodes might be reused in new\nparses. Use the static\n[`applyChanges`](#common.TreeFragment^applyChanges) method to\nupdate fragments for document changes.\n*/\nclass TreeFragment {\n    /**\n    Construct a tree fragment. You'll usually want to use\n    [`addTree`](#common.TreeFragment^addTree) and\n    [`applyChanges`](#common.TreeFragment^applyChanges) instead of\n    calling this directly.\n    */\n    constructor(\n    /**\n    The start of the unchanged range pointed to by this fragment.\n    This refers to an offset in the _updated_ document (as opposed\n    to the original tree).\n    */\n    from, \n    /**\n    The end of the unchanged range.\n    */\n    to, \n    /**\n    The tree that this fragment is based on.\n    */\n    tree, \n    /**\n    The offset between the fragment's tree and the document that\n    this fragment can be used against. Add this when going from\n    document to tree positions, subtract it to go from tree to\n    document positions.\n    */\n    offset, openStart = false, openEnd = false) {\n        this.from = from;\n        this.to = to;\n        this.tree = tree;\n        this.offset = offset;\n        this.open = (openStart ? 1 /* Open.Start */ : 0) | (openEnd ? 2 /* Open.End */ : 0);\n    }\n    /**\n    Whether the start of the fragment represents the start of a\n    parse, or the end of a change. (In the second case, it may not\n    be safe to reuse some nodes at the start, depending on the\n    parsing algorithm.)\n    */\n    get openStart() { return (this.open & 1 /* Open.Start */) > 0; }\n    /**\n    Whether the end of the fragment represents the end of a\n    full-document parse, or the start of a change.\n    */\n    get openEnd() { return (this.open & 2 /* Open.End */) > 0; }\n    /**\n    Create a set of fragments from a freshly parsed tree, or update\n    an existing set of fragments by replacing the ones that overlap\n    with a tree with content from the new tree. When `partial` is\n    true, the parse is treated as incomplete, and the resulting\n    fragment has [`openEnd`](#common.TreeFragment.openEnd) set to\n    true.\n    */\n    static addTree(tree, fragments = [], partial = false) {\n        let result = [new TreeFragment(0, tree.length, tree, 0, false, partial)];\n        for (let f of fragments)\n            if (f.to > tree.length)\n                result.push(f);\n        return result;\n    }\n    /**\n    Apply a set of edits to an array of fragments, removing or\n    splitting fragments as necessary to remove edited ranges, and\n    adjusting offsets for fragments that moved.\n    */\n    static applyChanges(fragments, changes, minGap = 128) {\n        if (!changes.length)\n            return fragments;\n        let result = [];\n        let fI = 1, nextF = fragments.length ? fragments[0] : null;\n        for (let cI = 0, pos = 0, off = 0;; cI++) {\n            let nextC = cI < changes.length ? changes[cI] : null;\n            let nextPos = nextC ? nextC.fromA : 1e9;\n            if (nextPos - pos >= minGap)\n                while (nextF && nextF.from < nextPos) {\n                    let cut = nextF;\n                    if (pos >= cut.from || nextPos <= cut.to || off) {\n                        let fFrom = Math.max(cut.from, pos) - off, fTo = Math.min(cut.to, nextPos) - off;\n                        cut = fFrom >= fTo ? null : new TreeFragment(fFrom, fTo, cut.tree, cut.offset + off, cI > 0, !!nextC);\n                    }\n                    if (cut)\n                        result.push(cut);\n                    if (nextF.to > nextPos)\n                        break;\n                    nextF = fI < fragments.length ? fragments[fI++] : null;\n                }\n            if (!nextC)\n                break;\n            pos = nextC.toA;\n            off = nextC.toA - nextC.toB;\n        }\n        return result;\n    }\n}\n/**\nA superclass that parsers should extend.\n*/\nclass Parser {\n    /**\n    Start a parse, returning a [partial parse](#common.PartialParse)\n    object. [`fragments`](#common.TreeFragment) can be passed in to\n    make the parse incremental.\n    \n    By default, the entire input is parsed. You can pass `ranges`,\n    which should be a sorted array of non-empty, non-overlapping\n    ranges, to parse only those ranges. The tree returned in that\n    case will start at `ranges[0].from`.\n    */\n    startParse(input, fragments, ranges) {\n        if (typeof input == \"string\")\n            input = new StringInput(input);\n        ranges = !ranges ? [new Range(0, input.length)] : ranges.length ? ranges.map(r => new Range(r.from, r.to)) : [new Range(0, 0)];\n        return this.createParse(input, fragments || [], ranges);\n    }\n    /**\n    Run a full parse, returning the resulting tree.\n    */\n    parse(input, fragments, ranges) {\n        let parse = this.startParse(input, fragments, ranges);\n        for (;;) {\n            let done = parse.advance();\n            if (done)\n                return done;\n        }\n    }\n}\nclass StringInput {\n    constructor(string) {\n        this.string = string;\n    }\n    get length() { return this.string.length; }\n    chunk(from) { return this.string.slice(from); }\n    get lineChunks() { return false; }\n    read(from, to) { return this.string.slice(from, to); }\n}\n\n/**\nCreate a parse wrapper that, after the inner parse completes,\nscans its tree for mixed language regions with the `nest`\nfunction, runs the resulting [inner parses](#common.NestedParse),\nand then [mounts](#common.NodeProp^mounted) their results onto the\ntree.\n*/\nfunction parseMixed(nest) {\n    return (parse, input, fragments, ranges) => new MixedParse(parse, nest, input, fragments, ranges);\n}\nclass InnerParse {\n    constructor(parser, parse, overlay, target, from) {\n        this.parser = parser;\n        this.parse = parse;\n        this.overlay = overlay;\n        this.target = target;\n        this.from = from;\n    }\n}\nfunction checkRanges(ranges) {\n    if (!ranges.length || ranges.some(r => r.from >= r.to))\n        throw new RangeError(\"Invalid inner parse ranges given: \" + JSON.stringify(ranges));\n}\nclass ActiveOverlay {\n    constructor(parser, predicate, mounts, index, start, target, prev) {\n        this.parser = parser;\n        this.predicate = predicate;\n        this.mounts = mounts;\n        this.index = index;\n        this.start = start;\n        this.target = target;\n        this.prev = prev;\n        this.depth = 0;\n        this.ranges = [];\n    }\n}\nconst stoppedInner = new NodeProp({ perNode: true });\nclass MixedParse {\n    constructor(base, nest, input, fragments, ranges) {\n        this.nest = nest;\n        this.input = input;\n        this.fragments = fragments;\n        this.ranges = ranges;\n        this.inner = [];\n        this.innerDone = 0;\n        this.baseTree = null;\n        this.stoppedAt = null;\n        this.baseParse = base;\n    }\n    advance() {\n        if (this.baseParse) {\n            let done = this.baseParse.advance();\n            if (!done)\n                return null;\n            this.baseParse = null;\n            this.baseTree = done;\n            this.startInner();\n            if (this.stoppedAt != null)\n                for (let inner of this.inner)\n                    inner.parse.stopAt(this.stoppedAt);\n        }\n        if (this.innerDone == this.inner.length) {\n            let result = this.baseTree;\n            if (this.stoppedAt != null)\n                result = new Tree(result.type, result.children, result.positions, result.length, result.propValues.concat([[stoppedInner, this.stoppedAt]]));\n            return result;\n        }\n        let inner = this.inner[this.innerDone], done = inner.parse.advance();\n        if (done) {\n            this.innerDone++;\n            // This is a somewhat dodgy but super helpful hack where we\n            // patch up nodes created by the inner parse (and thus\n            // presumably not aliased anywhere else) to hold the information\n            // about the inner parse.\n            let props = Object.assign(Object.create(null), inner.target.props);\n            props[NodeProp.mounted.id] = new MountedTree(done, inner.overlay, inner.parser);\n            inner.target.props = props;\n        }\n        return null;\n    }\n    get parsedPos() {\n        if (this.baseParse)\n            return 0;\n        let pos = this.input.length;\n        for (let i = this.innerDone; i < this.inner.length; i++) {\n            if (this.inner[i].from < pos)\n                pos = Math.min(pos, this.inner[i].parse.parsedPos);\n        }\n        return pos;\n    }\n    stopAt(pos) {\n        this.stoppedAt = pos;\n        if (this.baseParse)\n            this.baseParse.stopAt(pos);\n        else\n            for (let i = this.innerDone; i < this.inner.length; i++)\n                this.inner[i].parse.stopAt(pos);\n    }\n    startInner() {\n        let fragmentCursor = new FragmentCursor(this.fragments);\n        let overlay = null;\n        let covered = null;\n        let cursor = new TreeCursor(new TreeNode(this.baseTree, this.ranges[0].from, 0, null), IterMode.IncludeAnonymous | IterMode.IgnoreMounts);\n        scan: for (let nest, isCovered;;) {\n            let enter = true, range;\n            if (this.stoppedAt != null && cursor.from >= this.stoppedAt) {\n                enter = false;\n            }\n            else if (fragmentCursor.hasNode(cursor)) {\n                if (overlay) {\n                    let match = overlay.mounts.find(m => m.frag.from <= cursor.from && m.frag.to >= cursor.to && m.mount.overlay);\n                    if (match)\n                        for (let r of match.mount.overlay) {\n                            let from = r.from + match.pos, to = r.to + match.pos;\n                            if (from >= cursor.from && to <= cursor.to && !overlay.ranges.some(r => r.from < to && r.to > from))\n                                overlay.ranges.push({ from, to });\n                        }\n                }\n                enter = false;\n            }\n            else if (covered && (isCovered = checkCover(covered.ranges, cursor.from, cursor.to))) {\n                enter = isCovered != 2 /* Cover.Full */;\n            }\n            else if (!cursor.type.isAnonymous && (nest = this.nest(cursor, this.input)) &&\n                (cursor.from < cursor.to || !nest.overlay)) {\n                if (!cursor.tree)\n                    materialize(cursor);\n                let oldMounts = fragmentCursor.findMounts(cursor.from, nest.parser);\n                if (typeof nest.overlay == \"function\") {\n                    overlay = new ActiveOverlay(nest.parser, nest.overlay, oldMounts, this.inner.length, cursor.from, cursor.tree, overlay);\n                }\n                else {\n                    let ranges = punchRanges(this.ranges, nest.overlay ||\n                        (cursor.from < cursor.to ? [new Range(cursor.from, cursor.to)] : []));\n                    if (ranges.length)\n                        checkRanges(ranges);\n                    if (ranges.length || !nest.overlay)\n                        this.inner.push(new InnerParse(nest.parser, ranges.length ? nest.parser.startParse(this.input, enterFragments(oldMounts, ranges), ranges)\n                            : nest.parser.startParse(\"\"), nest.overlay ? nest.overlay.map(r => new Range(r.from - cursor.from, r.to - cursor.from)) : null, cursor.tree, ranges.length ? ranges[0].from : cursor.from));\n                    if (!nest.overlay)\n                        enter = false;\n                    else if (ranges.length)\n                        covered = { ranges, depth: 0, prev: covered };\n                }\n            }\n            else if (overlay && (range = overlay.predicate(cursor))) {\n                if (range === true)\n                    range = new Range(cursor.from, cursor.to);\n                if (range.from < range.to)\n                    overlay.ranges.push(range);\n            }\n            if (enter && cursor.firstChild()) {\n                if (overlay)\n                    overlay.depth++;\n                if (covered)\n                    covered.depth++;\n            }\n            else {\n                for (;;) {\n                    if (cursor.nextSibling())\n                        break;\n                    if (!cursor.parent())\n                        break scan;\n                    if (overlay && !--overlay.depth) {\n                        let ranges = punchRanges(this.ranges, overlay.ranges);\n                        if (ranges.length) {\n                            checkRanges(ranges);\n                            this.inner.splice(overlay.index, 0, new InnerParse(overlay.parser, overlay.parser.startParse(this.input, enterFragments(overlay.mounts, ranges), ranges), overlay.ranges.map(r => new Range(r.from - overlay.start, r.to - overlay.start)), overlay.target, ranges[0].from));\n                        }\n                        overlay = overlay.prev;\n                    }\n                    if (covered && !--covered.depth)\n                        covered = covered.prev;\n                }\n            }\n        }\n    }\n}\nfunction checkCover(covered, from, to) {\n    for (let range of covered) {\n        if (range.from >= to)\n            break;\n        if (range.to > from)\n            return range.from <= from && range.to >= to ? 2 /* Cover.Full */ : 1 /* Cover.Partial */;\n    }\n    return 0 /* Cover.None */;\n}\n// Take a piece of buffer and convert it into a stand-alone\n// TreeBuffer.\nfunction sliceBuf(buf, startI, endI, nodes, positions, off) {\n    if (startI < endI) {\n        let from = buf.buffer[startI + 1];\n        nodes.push(buf.slice(startI, endI, from));\n        positions.push(from - off);\n    }\n}\n// This function takes a node that's in a buffer, and converts it, and\n// its parent buffer nodes, into a Tree. This is again acting on the\n// assumption that the trees and buffers have been constructed by the\n// parse that was ran via the mix parser, and thus aren't shared with\n// any other code, making violations of the immutability safe.\nfunction materialize(cursor) {\n    let { node } = cursor, stack = [];\n    let buffer = node.context.buffer;\n    // Scan up to the nearest tree\n    do {\n        stack.push(cursor.index);\n        cursor.parent();\n    } while (!cursor.tree);\n    // Find the index of the buffer in that tree\n    let base = cursor.tree, i = base.children.indexOf(buffer);\n    let buf = base.children[i], b = buf.buffer, newStack = [i];\n    // Split a level in the buffer, putting the nodes before and after\n    // the child that contains `node` into new buffers.\n    function split(startI, endI, type, innerOffset, length, stackPos) {\n        let targetI = stack[stackPos];\n        let children = [], positions = [];\n        sliceBuf(buf, startI, targetI, children, positions, innerOffset);\n        let from = b[targetI + 1], to = b[targetI + 2];\n        newStack.push(children.length);\n        let child = stackPos\n            ? split(targetI + 4, b[targetI + 3], buf.set.types[b[targetI]], from, to - from, stackPos - 1)\n            : node.toTree();\n        children.push(child);\n        positions.push(from - innerOffset);\n        sliceBuf(buf, b[targetI + 3], endI, children, positions, innerOffset);\n        return new Tree(type, children, positions, length);\n    }\n    base.children[i] = split(0, b.length, NodeType.none, 0, buf.length, stack.length - 1);\n    // Move the cursor back to the target node\n    for (let index of newStack) {\n        let tree = cursor.tree.children[index], pos = cursor.tree.positions[index];\n        cursor.yield(new TreeNode(tree, pos + cursor.from, index, cursor._tree));\n    }\n}\nclass StructureCursor {\n    constructor(root, offset) {\n        this.offset = offset;\n        this.done = false;\n        this.cursor = root.cursor(IterMode.IncludeAnonymous | IterMode.IgnoreMounts);\n    }\n    // Move to the first node (in pre-order) that starts at or after `pos`.\n    moveTo(pos) {\n        let { cursor } = this, p = pos - this.offset;\n        while (!this.done && cursor.from < p) {\n            if (cursor.to >= pos && cursor.enter(p, 1, IterMode.IgnoreOverlays | IterMode.ExcludeBuffers)) ;\n            else if (!cursor.next(false))\n                this.done = true;\n        }\n    }\n    hasNode(cursor) {\n        this.moveTo(cursor.from);\n        if (!this.done && this.cursor.from + this.offset == cursor.from && this.cursor.tree) {\n            for (let tree = this.cursor.tree;;) {\n                if (tree == cursor.tree)\n                    return true;\n                if (tree.children.length && tree.positions[0] == 0 && tree.children[0] instanceof Tree)\n                    tree = tree.children[0];\n                else\n                    break;\n            }\n        }\n        return false;\n    }\n}\nclass FragmentCursor {\n    constructor(fragments) {\n        var _a;\n        this.fragments = fragments;\n        this.curTo = 0;\n        this.fragI = 0;\n        if (fragments.length) {\n            let first = this.curFrag = fragments[0];\n            this.curTo = (_a = first.tree.prop(stoppedInner)) !== null && _a !== void 0 ? _a : first.to;\n            this.inner = new StructureCursor(first.tree, -first.offset);\n        }\n        else {\n            this.curFrag = this.inner = null;\n        }\n    }\n    hasNode(node) {\n        while (this.curFrag && node.from >= this.curTo)\n            this.nextFrag();\n        return this.curFrag && this.curFrag.from <= node.from && this.curTo >= node.to && this.inner.hasNode(node);\n    }\n    nextFrag() {\n        var _a;\n        this.fragI++;\n        if (this.fragI == this.fragments.length) {\n            this.curFrag = this.inner = null;\n        }\n        else {\n            let frag = this.curFrag = this.fragments[this.fragI];\n            this.curTo = (_a = frag.tree.prop(stoppedInner)) !== null && _a !== void 0 ? _a : frag.to;\n            this.inner = new StructureCursor(frag.tree, -frag.offset);\n        }\n    }\n    findMounts(pos, parser) {\n        var _a;\n        let result = [];\n        if (this.inner) {\n            this.inner.cursor.moveTo(pos, 1);\n            for (let pos = this.inner.cursor.node; pos; pos = pos.parent) {\n                let mount = (_a = pos.tree) === null || _a === void 0 ? void 0 : _a.prop(NodeProp.mounted);\n                if (mount && mount.parser == parser) {\n                    for (let i = this.fragI; i < this.fragments.length; i++) {\n                        let frag = this.fragments[i];\n                        if (frag.from >= pos.to)\n                            break;\n                        if (frag.tree == this.curFrag.tree)\n                            result.push({\n                                frag,\n                                pos: pos.from - frag.offset,\n                                mount\n                            });\n                    }\n                }\n            }\n        }\n        return result;\n    }\n}\nfunction punchRanges(outer, ranges) {\n    let copy = null, current = ranges;\n    for (let i = 1, j = 0; i < outer.length; i++) {\n        let gapFrom = outer[i - 1].to, gapTo = outer[i].from;\n        for (; j < current.length; j++) {\n            let r = current[j];\n            if (r.from >= gapTo)\n                break;\n            if (r.to <= gapFrom)\n                continue;\n            if (!copy)\n                current = copy = ranges.slice();\n            if (r.from < gapFrom) {\n                copy[j] = new Range(r.from, gapFrom);\n                if (r.to > gapTo)\n                    copy.splice(j + 1, 0, new Range(gapTo, r.to));\n            }\n            else if (r.to > gapTo) {\n                copy[j--] = new Range(gapTo, r.to);\n            }\n            else {\n                copy.splice(j--, 1);\n            }\n        }\n    }\n    return current;\n}\nfunction findCoverChanges(a, b, from, to) {\n    let iA = 0, iB = 0, inA = false, inB = false, pos = -1e9;\n    let result = [];\n    for (;;) {\n        let nextA = iA == a.length ? 1e9 : inA ? a[iA].to : a[iA].from;\n        let nextB = iB == b.length ? 1e9 : inB ? b[iB].to : b[iB].from;\n        if (inA != inB) {\n            let start = Math.max(pos, from), end = Math.min(nextA, nextB, to);\n            if (start < end)\n                result.push(new Range(start, end));\n        }\n        pos = Math.min(nextA, nextB);\n        if (pos == 1e9)\n            break;\n        if (nextA == pos) {\n            if (!inA)\n                inA = true;\n            else {\n                inA = false;\n                iA++;\n            }\n        }\n        if (nextB == pos) {\n            if (!inB)\n                inB = true;\n            else {\n                inB = false;\n                iB++;\n            }\n        }\n    }\n    return result;\n}\n// Given a number of fragments for the outer tree, and a set of ranges\n// to parse, find fragments for inner trees mounted around those\n// ranges, if any.\nfunction enterFragments(mounts, ranges) {\n    let result = [];\n    for (let { pos, mount, frag } of mounts) {\n        let startPos = pos + (mount.overlay ? mount.overlay[0].from : 0), endPos = startPos + mount.tree.length;\n        let from = Math.max(frag.from, startPos), to = Math.min(frag.to, endPos);\n        if (mount.overlay) {\n            let overlay = mount.overlay.map(r => new Range(r.from + pos, r.to + pos));\n            let changes = findCoverChanges(ranges, overlay, from, to);\n            for (let i = 0, pos = from;; i++) {\n                let last = i == changes.length, end = last ? to : changes[i].from;\n                if (end > pos)\n                    result.push(new TreeFragment(pos, end, mount.tree, -startPos, frag.from >= pos || frag.openStart, frag.to <= end || frag.openEnd));\n                if (last)\n                    break;\n                pos = changes[i].to;\n            }\n        }\n        else {\n            result.push(new TreeFragment(from, to, mount.tree, -startPos, frag.from >= startPos || frag.openStart, frag.to <= endPos || frag.openEnd));\n        }\n    }\n    return result;\n}\n\nexport { DefaultBufferLength, IterMode, MountedTree, NodeProp, NodeSet, NodeType, NodeWeakMap, Parser, Tree, TreeBuffer, TreeCursor, TreeFragment, parseMixed };\n","import { Parser, NodeProp, NodeSet, NodeType, DefaultBufferLength, Tree, IterMode } from '@lezer/common';\n\n/// A parse stack. These are used internally by the parser to track\n/// parsing progress. They also provide some properties and methods\n/// that external code such as a tokenizer can use to get information\n/// about the parse state.\nclass Stack {\n    /// @internal\n    constructor(\n    /// The parse that this stack is part of @internal\n    p, \n    /// Holds state, input pos, buffer index triplets for all but the\n    /// top state @internal\n    stack, \n    /// The current parse state @internal\n    state, \n    // The position at which the next reduce should take place. This\n    // can be less than `this.pos` when skipped expressions have been\n    // added to the stack (which should be moved outside of the next\n    // reduction)\n    /// @internal\n    reducePos, \n    /// The input position up to which this stack has parsed.\n    pos, \n    /// The dynamic score of the stack, including dynamic precedence\n    /// and error-recovery penalties\n    /// @internal\n    score, \n    // The output buffer. Holds (type, start, end, size) quads\n    // representing nodes created by the parser, where `size` is\n    // amount of buffer array entries covered by this node.\n    /// @internal\n    buffer, \n    // The base offset of the buffer. When stacks are split, the split\n    // instance shared the buffer history with its parent up to\n    // `bufferBase`, which is the absolute offset (including the\n    // offset of previous splits) into the buffer at which this stack\n    // starts writing.\n    /// @internal\n    bufferBase, \n    /// @internal\n    curContext, \n    /// @internal\n    lookAhead = 0, \n    // A parent stack from which this was split off, if any. This is\n    // set up so that it always points to a stack that has some\n    // additional buffer content, never to a stack with an equal\n    // `bufferBase`.\n    /// @internal\n    parent) {\n        this.p = p;\n        this.stack = stack;\n        this.state = state;\n        this.reducePos = reducePos;\n        this.pos = pos;\n        this.score = score;\n        this.buffer = buffer;\n        this.bufferBase = bufferBase;\n        this.curContext = curContext;\n        this.lookAhead = lookAhead;\n        this.parent = parent;\n    }\n    /// @internal\n    toString() {\n        return `[${this.stack.filter((_, i) => i % 3 == 0).concat(this.state)}]@${this.pos}${this.score ? \"!\" + this.score : \"\"}`;\n    }\n    // Start an empty stack\n    /// @internal\n    static start(p, state, pos = 0) {\n        let cx = p.parser.context;\n        return new Stack(p, [], state, pos, pos, 0, [], 0, cx ? new StackContext(cx, cx.start) : null, 0, null);\n    }\n    /// The stack's current [context](#lr.ContextTracker) value, if\n    /// any. Its type will depend on the context tracker's type\n    /// parameter, or it will be `null` if there is no context\n    /// tracker.\n    get context() { return this.curContext ? this.curContext.context : null; }\n    // Push a state onto the stack, tracking its start position as well\n    // as the buffer base at that point.\n    /// @internal\n    pushState(state, start) {\n        this.stack.push(this.state, start, this.bufferBase + this.buffer.length);\n        this.state = state;\n    }\n    // Apply a reduce action\n    /// @internal\n    reduce(action) {\n        var _a;\n        let depth = action >> 19 /* Action.ReduceDepthShift */, type = action & 65535 /* Action.ValueMask */;\n        let { parser } = this.p;\n        let dPrec = parser.dynamicPrecedence(type);\n        if (dPrec)\n            this.score += dPrec;\n        if (depth == 0) {\n            this.pushState(parser.getGoto(this.state, type, true), this.reducePos);\n            // Zero-depth reductions are a special casethey add stuff to\n            // the stack without popping anything off.\n            if (type < parser.minRepeatTerm)\n                this.storeNode(type, this.reducePos, this.reducePos, 4, true);\n            this.reduceContext(type, this.reducePos);\n            return;\n        }\n        // Find the base index into `this.stack`, content after which will\n        // be dropped. Note that with `StayFlag` reductions we need to\n        // consume two extra frames (the dummy parent node for the skipped\n        // expression and the state that we'll be staying in, which should\n        // be moved to `this.state`).\n        let base = this.stack.length - ((depth - 1) * 3) - (action & 262144 /* Action.StayFlag */ ? 6 : 0);\n        let start = base ? this.stack[base - 2] : this.p.ranges[0].from, size = this.reducePos - start;\n        // This is a kludge to try and detect overly deep left-associative\n        // trees, which will not increase the parse stack depth and thus\n        // won't be caught by the regular stack-depth limit check.\n        if (size >= 2000 /* Recover.MinBigReduction */ && !((_a = this.p.parser.nodeSet.types[type]) === null || _a === void 0 ? void 0 : _a.isAnonymous)) {\n            if (start == this.p.lastBigReductionStart) {\n                this.p.bigReductionCount++;\n                this.p.lastBigReductionSize = size;\n            }\n            else if (this.p.lastBigReductionSize < size) {\n                this.p.bigReductionCount = 1;\n                this.p.lastBigReductionStart = start;\n                this.p.lastBigReductionSize = size;\n            }\n        }\n        let bufferBase = base ? this.stack[base - 1] : 0, count = this.bufferBase + this.buffer.length - bufferBase;\n        // Store normal terms or `R -> R R` repeat reductions\n        if (type < parser.minRepeatTerm || (action & 131072 /* Action.RepeatFlag */)) {\n            let pos = parser.stateFlag(this.state, 1 /* StateFlag.Skipped */) ? this.pos : this.reducePos;\n            this.storeNode(type, start, pos, count + 4, true);\n        }\n        if (action & 262144 /* Action.StayFlag */) {\n            this.state = this.stack[base];\n        }\n        else {\n            let baseStateID = this.stack[base - 3];\n            this.state = parser.getGoto(baseStateID, type, true);\n        }\n        while (this.stack.length > base)\n            this.stack.pop();\n        this.reduceContext(type, start);\n    }\n    // Shift a value into the buffer\n    /// @internal\n    storeNode(term, start, end, size = 4, isReduce = false) {\n        if (term == 0 /* Term.Err */ &&\n            (!this.stack.length || this.stack[this.stack.length - 1] < this.buffer.length + this.bufferBase)) {\n            // Try to omit/merge adjacent error nodes\n            let cur = this, top = this.buffer.length;\n            if (top == 0 && cur.parent) {\n                top = cur.bufferBase - cur.parent.bufferBase;\n                cur = cur.parent;\n            }\n            if (top > 0 && cur.buffer[top - 4] == 0 /* Term.Err */ && cur.buffer[top - 1] > -1) {\n                if (start == end)\n                    return;\n                if (cur.buffer[top - 2] >= start) {\n                    cur.buffer[top - 2] = end;\n                    return;\n                }\n            }\n        }\n        if (!isReduce || this.pos == end) { // Simple case, just append\n            this.buffer.push(term, start, end, size);\n        }\n        else { // There may be skipped nodes that have to be moved forward\n            let index = this.buffer.length;\n            if (index > 0 && this.buffer[index - 4] != 0 /* Term.Err */)\n                while (index > 0 && this.buffer[index - 2] > end) {\n                    // Move this record forward\n                    this.buffer[index] = this.buffer[index - 4];\n                    this.buffer[index + 1] = this.buffer[index - 3];\n                    this.buffer[index + 2] = this.buffer[index - 2];\n                    this.buffer[index + 3] = this.buffer[index - 1];\n                    index -= 4;\n                    if (size > 4)\n                        size -= 4;\n                }\n            this.buffer[index] = term;\n            this.buffer[index + 1] = start;\n            this.buffer[index + 2] = end;\n            this.buffer[index + 3] = size;\n        }\n    }\n    // Apply a shift action\n    /// @internal\n    shift(action, next, nextEnd) {\n        let start = this.pos;\n        if (action & 131072 /* Action.GotoFlag */) {\n            this.pushState(action & 65535 /* Action.ValueMask */, this.pos);\n        }\n        else if ((action & 262144 /* Action.StayFlag */) == 0) { // Regular shift\n            let nextState = action, { parser } = this.p;\n            if (nextEnd > this.pos || next <= parser.maxNode) {\n                this.pos = nextEnd;\n                if (!parser.stateFlag(nextState, 1 /* StateFlag.Skipped */))\n                    this.reducePos = nextEnd;\n            }\n            this.pushState(nextState, start);\n            this.shiftContext(next, start);\n            if (next <= parser.maxNode)\n                this.buffer.push(next, start, nextEnd, 4);\n        }\n        else { // Shift-and-stay, which means this is a skipped token\n            this.pos = nextEnd;\n            this.shiftContext(next, start);\n            if (next <= this.p.parser.maxNode)\n                this.buffer.push(next, start, nextEnd, 4);\n        }\n    }\n    // Apply an action\n    /// @internal\n    apply(action, next, nextEnd) {\n        if (action & 65536 /* Action.ReduceFlag */)\n            this.reduce(action);\n        else\n            this.shift(action, next, nextEnd);\n    }\n    // Add a prebuilt (reused) node into the buffer.\n    /// @internal\n    useNode(value, next) {\n        let index = this.p.reused.length - 1;\n        if (index < 0 || this.p.reused[index] != value) {\n            this.p.reused.push(value);\n            index++;\n        }\n        let start = this.pos;\n        this.reducePos = this.pos = start + value.length;\n        this.pushState(next, start);\n        this.buffer.push(index, start, this.reducePos, -1 /* size == -1 means this is a reused value */);\n        if (this.curContext)\n            this.updateContext(this.curContext.tracker.reuse(this.curContext.context, value, this, this.p.stream.reset(this.pos - value.length)));\n    }\n    // Split the stack. Due to the buffer sharing and the fact\n    // that `this.stack` tends to stay quite shallow, this isn't very\n    // expensive.\n    /// @internal\n    split() {\n        let parent = this;\n        let off = parent.buffer.length;\n        // Because the top of the buffer (after this.pos) may be mutated\n        // to reorder reductions and skipped tokens, and shared buffers\n        // should be immutable, this copies any outstanding skipped tokens\n        // to the new buffer, and puts the base pointer before them.\n        while (off > 0 && parent.buffer[off - 2] > parent.reducePos)\n            off -= 4;\n        let buffer = parent.buffer.slice(off), base = parent.bufferBase + off;\n        // Make sure parent points to an actual parent with content, if there is such a parent.\n        while (parent && base == parent.bufferBase)\n            parent = parent.parent;\n        return new Stack(this.p, this.stack.slice(), this.state, this.reducePos, this.pos, this.score, buffer, base, this.curContext, this.lookAhead, parent);\n    }\n    // Try to recover from an error by 'deleting' (ignoring) one token.\n    /// @internal\n    recoverByDelete(next, nextEnd) {\n        let isNode = next <= this.p.parser.maxNode;\n        if (isNode)\n            this.storeNode(next, this.pos, nextEnd, 4);\n        this.storeNode(0 /* Term.Err */, this.pos, nextEnd, isNode ? 8 : 4);\n        this.pos = this.reducePos = nextEnd;\n        this.score -= 190 /* Recover.Delete */;\n    }\n    /// Check if the given term would be able to be shifted (optionally\n    /// after some reductions) on this stack. This can be useful for\n    /// external tokenizers that want to make sure they only provide a\n    /// given token when it applies.\n    canShift(term) {\n        for (let sim = new SimulatedStack(this);;) {\n            let action = this.p.parser.stateSlot(sim.state, 4 /* ParseState.DefaultReduce */) || this.p.parser.hasAction(sim.state, term);\n            if (action == 0)\n                return false;\n            if ((action & 65536 /* Action.ReduceFlag */) == 0)\n                return true;\n            sim.reduce(action);\n        }\n    }\n    // Apply up to Recover.MaxNext recovery actions that conceptually\n    // inserts some missing token or rule.\n    /// @internal\n    recoverByInsert(next) {\n        if (this.stack.length >= 300 /* Recover.MaxInsertStackDepth */)\n            return [];\n        let nextStates = this.p.parser.nextStates(this.state);\n        if (nextStates.length > 4 /* Recover.MaxNext */ << 1 || this.stack.length >= 120 /* Recover.DampenInsertStackDepth */) {\n            let best = [];\n            for (let i = 0, s; i < nextStates.length; i += 2) {\n                if ((s = nextStates[i + 1]) != this.state && this.p.parser.hasAction(s, next))\n                    best.push(nextStates[i], s);\n            }\n            if (this.stack.length < 120 /* Recover.DampenInsertStackDepth */)\n                for (let i = 0; best.length < 4 /* Recover.MaxNext */ << 1 && i < nextStates.length; i += 2) {\n                    let s = nextStates[i + 1];\n                    if (!best.some((v, i) => (i & 1) && v == s))\n                        best.push(nextStates[i], s);\n                }\n            nextStates = best;\n        }\n        let result = [];\n        for (let i = 0; i < nextStates.length && result.length < 4 /* Recover.MaxNext */; i += 2) {\n            let s = nextStates[i + 1];\n            if (s == this.state)\n                continue;\n            let stack = this.split();\n            stack.pushState(s, this.pos);\n            stack.storeNode(0 /* Term.Err */, stack.pos, stack.pos, 4, true);\n            stack.shiftContext(nextStates[i], this.pos);\n            stack.score -= 200 /* Recover.Insert */;\n            result.push(stack);\n        }\n        return result;\n    }\n    // Force a reduce, if possible. Return false if that can't\n    // be done.\n    /// @internal\n    forceReduce() {\n        let reduce = this.p.parser.stateSlot(this.state, 5 /* ParseState.ForcedReduce */);\n        if ((reduce & 65536 /* Action.ReduceFlag */) == 0)\n            return false;\n        let { parser } = this.p;\n        if (!parser.validAction(this.state, reduce)) {\n            let depth = reduce >> 19 /* Action.ReduceDepthShift */, term = reduce & 65535 /* Action.ValueMask */;\n            let target = this.stack.length - depth * 3;\n            if (target < 0 || parser.getGoto(this.stack[target], term, false) < 0)\n                return false;\n            this.storeNode(0 /* Term.Err */, this.reducePos, this.reducePos, 4, true);\n            this.score -= 100 /* Recover.Reduce */;\n        }\n        this.reducePos = this.pos;\n        this.reduce(reduce);\n        return true;\n    }\n    /// @internal\n    forceAll() {\n        while (!this.p.parser.stateFlag(this.state, 2 /* StateFlag.Accepting */)) {\n            if (!this.forceReduce()) {\n                this.storeNode(0 /* Term.Err */, this.pos, this.pos, 4, true);\n                break;\n            }\n        }\n        return this;\n    }\n    /// Check whether this state has no further actions (assumed to be a direct descendant of the\n    /// top state, since any other states must be able to continue\n    /// somehow). @internal\n    get deadEnd() {\n        if (this.stack.length != 3)\n            return false;\n        let { parser } = this.p;\n        return parser.data[parser.stateSlot(this.state, 1 /* ParseState.Actions */)] == 65535 /* Seq.End */ &&\n            !parser.stateSlot(this.state, 4 /* ParseState.DefaultReduce */);\n    }\n    /// Restart the stack (put it back in its start state). Only safe\n    /// when this.stack.length == 3 (state is directly below the top\n    /// state). @internal\n    restart() {\n        this.state = this.stack[0];\n        this.stack.length = 0;\n    }\n    /// @internal\n    sameState(other) {\n        if (this.state != other.state || this.stack.length != other.stack.length)\n            return false;\n        for (let i = 0; i < this.stack.length; i += 3)\n            if (this.stack[i] != other.stack[i])\n                return false;\n        return true;\n    }\n    /// Get the parser used by this stack.\n    get parser() { return this.p.parser; }\n    /// Test whether a given dialect (by numeric ID, as exported from\n    /// the terms file) is enabled.\n    dialectEnabled(dialectID) { return this.p.parser.dialect.flags[dialectID]; }\n    shiftContext(term, start) {\n        if (this.curContext)\n            this.updateContext(this.curContext.tracker.shift(this.curContext.context, term, this, this.p.stream.reset(start)));\n    }\n    reduceContext(term, start) {\n        if (this.curContext)\n            this.updateContext(this.curContext.tracker.reduce(this.curContext.context, term, this, this.p.stream.reset(start)));\n    }\n    /// @internal\n    emitContext() {\n        let last = this.buffer.length - 1;\n        if (last < 0 || this.buffer[last] != -3)\n            this.buffer.push(this.curContext.hash, this.reducePos, this.reducePos, -3);\n    }\n    /// @internal\n    emitLookAhead() {\n        let last = this.buffer.length - 1;\n        if (last < 0 || this.buffer[last] != -4)\n            this.buffer.push(this.lookAhead, this.reducePos, this.reducePos, -4);\n    }\n    updateContext(context) {\n        if (context != this.curContext.context) {\n            let newCx = new StackContext(this.curContext.tracker, context);\n            if (newCx.hash != this.curContext.hash)\n                this.emitContext();\n            this.curContext = newCx;\n        }\n    }\n    /// @internal\n    setLookAhead(lookAhead) {\n        if (lookAhead > this.lookAhead) {\n            this.emitLookAhead();\n            this.lookAhead = lookAhead;\n        }\n    }\n    /// @internal\n    close() {\n        if (this.curContext && this.curContext.tracker.strict)\n            this.emitContext();\n        if (this.lookAhead > 0)\n            this.emitLookAhead();\n    }\n}\nclass StackContext {\n    constructor(tracker, context) {\n        this.tracker = tracker;\n        this.context = context;\n        this.hash = tracker.strict ? tracker.hash(context) : 0;\n    }\n}\nvar Recover;\n(function (Recover) {\n    Recover[Recover[\"Insert\"] = 200] = \"Insert\";\n    Recover[Recover[\"Delete\"] = 190] = \"Delete\";\n    Recover[Recover[\"Reduce\"] = 100] = \"Reduce\";\n    Recover[Recover[\"MaxNext\"] = 4] = \"MaxNext\";\n    Recover[Recover[\"MaxInsertStackDepth\"] = 300] = \"MaxInsertStackDepth\";\n    Recover[Recover[\"DampenInsertStackDepth\"] = 120] = \"DampenInsertStackDepth\";\n    Recover[Recover[\"MinBigReduction\"] = 2000] = \"MinBigReduction\";\n})(Recover || (Recover = {}));\n// Used to cheaply run some reductions to scan ahead without mutating\n// an entire stack\nclass SimulatedStack {\n    constructor(start) {\n        this.start = start;\n        this.state = start.state;\n        this.stack = start.stack;\n        this.base = this.stack.length;\n    }\n    reduce(action) {\n        let term = action & 65535 /* Action.ValueMask */, depth = action >> 19 /* Action.ReduceDepthShift */;\n        if (depth == 0) {\n            if (this.stack == this.start.stack)\n                this.stack = this.stack.slice();\n            this.stack.push(this.state, 0, 0);\n            this.base += 3;\n        }\n        else {\n            this.base -= (depth - 1) * 3;\n        }\n        let goto = this.start.p.parser.getGoto(this.stack[this.base - 3], term, true);\n        this.state = goto;\n    }\n}\n// This is given to `Tree.build` to build a buffer, and encapsulates\n// the parent-stack-walking necessary to read the nodes.\nclass StackBufferCursor {\n    constructor(stack, pos, index) {\n        this.stack = stack;\n        this.pos = pos;\n        this.index = index;\n        this.buffer = stack.buffer;\n        if (this.index == 0)\n            this.maybeNext();\n    }\n    static create(stack, pos = stack.bufferBase + stack.buffer.length) {\n        return new StackBufferCursor(stack, pos, pos - stack.bufferBase);\n    }\n    maybeNext() {\n        let next = this.stack.parent;\n        if (next != null) {\n            this.index = this.stack.bufferBase - next.bufferBase;\n            this.stack = next;\n            this.buffer = next.buffer;\n        }\n    }\n    get id() { return this.buffer[this.index - 4]; }\n    get start() { return this.buffer[this.index - 3]; }\n    get end() { return this.buffer[this.index - 2]; }\n    get size() { return this.buffer[this.index - 1]; }\n    next() {\n        this.index -= 4;\n        this.pos -= 4;\n        if (this.index == 0)\n            this.maybeNext();\n    }\n    fork() {\n        return new StackBufferCursor(this.stack, this.pos, this.index);\n    }\n}\n\n// See lezer-generator/src/encode.ts for comments about the encoding\n// used here\nfunction decodeArray(input, Type = Uint16Array) {\n    if (typeof input != \"string\")\n        return input;\n    let array = null;\n    for (let pos = 0, out = 0; pos < input.length;) {\n        let value = 0;\n        for (;;) {\n            let next = input.charCodeAt(pos++), stop = false;\n            if (next == 126 /* Encode.BigValCode */) {\n                value = 65535 /* Encode.BigVal */;\n                break;\n            }\n            if (next >= 92 /* Encode.Gap2 */)\n                next--;\n            if (next >= 34 /* Encode.Gap1 */)\n                next--;\n            let digit = next - 32 /* Encode.Start */;\n            if (digit >= 46 /* Encode.Base */) {\n                digit -= 46 /* Encode.Base */;\n                stop = true;\n            }\n            value += digit;\n            if (stop)\n                break;\n            value *= 46 /* Encode.Base */;\n        }\n        if (array)\n            array[out++] = value;\n        else\n            array = new Type(value);\n    }\n    return array;\n}\n\nclass CachedToken {\n    constructor() {\n        this.start = -1;\n        this.value = -1;\n        this.end = -1;\n        this.extended = -1;\n        this.lookAhead = 0;\n        this.mask = 0;\n        this.context = 0;\n    }\n}\nconst nullToken = new CachedToken;\n/// [Tokenizers](#lr.ExternalTokenizer) interact with the input\n/// through this interface. It presents the input as a stream of\n/// characters, tracking lookahead and hiding the complexity of\n/// [ranges](#common.Parser.parse^ranges) from tokenizer code.\nclass InputStream {\n    /// @internal\n    constructor(\n    /// @internal\n    input, \n    /// @internal\n    ranges) {\n        this.input = input;\n        this.ranges = ranges;\n        /// @internal\n        this.chunk = \"\";\n        /// @internal\n        this.chunkOff = 0;\n        /// Backup chunk\n        this.chunk2 = \"\";\n        this.chunk2Pos = 0;\n        /// The character code of the next code unit in the input, or -1\n        /// when the stream is at the end of the input.\n        this.next = -1;\n        /// @internal\n        this.token = nullToken;\n        this.rangeIndex = 0;\n        this.pos = this.chunkPos = ranges[0].from;\n        this.range = ranges[0];\n        this.end = ranges[ranges.length - 1].to;\n        this.readNext();\n    }\n    /// @internal\n    resolveOffset(offset, assoc) {\n        let range = this.range, index = this.rangeIndex;\n        let pos = this.pos + offset;\n        while (pos < range.from) {\n            if (!index)\n                return null;\n            let next = this.ranges[--index];\n            pos -= range.from - next.to;\n            range = next;\n        }\n        while (assoc < 0 ? pos > range.to : pos >= range.to) {\n            if (index == this.ranges.length - 1)\n                return null;\n            let next = this.ranges[++index];\n            pos += next.from - range.to;\n            range = next;\n        }\n        return pos;\n    }\n    /// @internal\n    clipPos(pos) {\n        if (pos >= this.range.from && pos < this.range.to)\n            return pos;\n        for (let range of this.ranges)\n            if (range.to > pos)\n                return Math.max(pos, range.from);\n        return this.end;\n    }\n    /// Look at a code unit near the stream position. `.peek(0)` equals\n    /// `.next`, `.peek(-1)` gives you the previous character, and so\n    /// on.\n    ///\n    /// Note that looking around during tokenizing creates dependencies\n    /// on potentially far-away content, which may reduce the\n    /// effectiveness incremental parsingwhen looking forwardor even\n    /// cause invalid reparses when looking backward more than 25 code\n    /// units, since the library does not track lookbehind.\n    peek(offset) {\n        let idx = this.chunkOff + offset, pos, result;\n        if (idx >= 0 && idx < this.chunk.length) {\n            pos = this.pos + offset;\n            result = this.chunk.charCodeAt(idx);\n        }\n        else {\n            let resolved = this.resolveOffset(offset, 1);\n            if (resolved == null)\n                return -1;\n            pos = resolved;\n            if (pos >= this.chunk2Pos && pos < this.chunk2Pos + this.chunk2.length) {\n                result = this.chunk2.charCodeAt(pos - this.chunk2Pos);\n            }\n            else {\n                let i = this.rangeIndex, range = this.range;\n                while (range.to <= pos)\n                    range = this.ranges[++i];\n                this.chunk2 = this.input.chunk(this.chunk2Pos = pos);\n                if (pos + this.chunk2.length > range.to)\n                    this.chunk2 = this.chunk2.slice(0, range.to - pos);\n                result = this.chunk2.charCodeAt(0);\n            }\n        }\n        if (pos >= this.token.lookAhead)\n            this.token.lookAhead = pos + 1;\n        return result;\n    }\n    /// Accept a token. By default, the end of the token is set to the\n    /// current stream position, but you can pass an offset (relative to\n    /// the stream position) to change that.\n    acceptToken(token, endOffset = 0) {\n        let end = endOffset ? this.resolveOffset(endOffset, -1) : this.pos;\n        if (end == null || end < this.token.start)\n            throw new RangeError(\"Token end out of bounds\");\n        this.token.value = token;\n        this.token.end = end;\n    }\n    getChunk() {\n        if (this.pos >= this.chunk2Pos && this.pos < this.chunk2Pos + this.chunk2.length) {\n            let { chunk, chunkPos } = this;\n            this.chunk = this.chunk2;\n            this.chunkPos = this.chunk2Pos;\n            this.chunk2 = chunk;\n            this.chunk2Pos = chunkPos;\n            this.chunkOff = this.pos - this.chunkPos;\n        }\n        else {\n            this.chunk2 = this.chunk;\n            this.chunk2Pos = this.chunkPos;\n            let nextChunk = this.input.chunk(this.pos);\n            let end = this.pos + nextChunk.length;\n            this.chunk = end > this.range.to ? nextChunk.slice(0, this.range.to - this.pos) : nextChunk;\n            this.chunkPos = this.pos;\n            this.chunkOff = 0;\n        }\n    }\n    readNext() {\n        if (this.chunkOff >= this.chunk.length) {\n            this.getChunk();\n            if (this.chunkOff == this.chunk.length)\n                return this.next = -1;\n        }\n        return this.next = this.chunk.charCodeAt(this.chunkOff);\n    }\n    /// Move the stream forward N (defaults to 1) code units. Returns\n    /// the new value of [`next`](#lr.InputStream.next).\n    advance(n = 1) {\n        this.chunkOff += n;\n        while (this.pos + n >= this.range.to) {\n            if (this.rangeIndex == this.ranges.length - 1)\n                return this.setDone();\n            n -= this.range.to - this.pos;\n            this.range = this.ranges[++this.rangeIndex];\n            this.pos = this.range.from;\n        }\n        this.pos += n;\n        if (this.pos >= this.token.lookAhead)\n            this.token.lookAhead = this.pos + 1;\n        return this.readNext();\n    }\n    setDone() {\n        this.pos = this.chunkPos = this.end;\n        this.range = this.ranges[this.rangeIndex = this.ranges.length - 1];\n        this.chunk = \"\";\n        return this.next = -1;\n    }\n    /// @internal\n    reset(pos, token) {\n        if (token) {\n            this.token = token;\n            token.start = pos;\n            token.lookAhead = pos + 1;\n            token.value = token.extended = -1;\n        }\n        else {\n            this.token = nullToken;\n        }\n        if (this.pos != pos) {\n            this.pos = pos;\n            if (pos == this.end) {\n                this.setDone();\n                return this;\n            }\n            while (pos < this.range.from)\n                this.range = this.ranges[--this.rangeIndex];\n            while (pos >= this.range.to)\n                this.range = this.ranges[++this.rangeIndex];\n            if (pos >= this.chunkPos && pos < this.chunkPos + this.chunk.length) {\n                this.chunkOff = pos - this.chunkPos;\n            }\n            else {\n                this.chunk = \"\";\n                this.chunkOff = 0;\n            }\n            this.readNext();\n        }\n        return this;\n    }\n    /// @internal\n    read(from, to) {\n        if (from >= this.chunkPos && to <= this.chunkPos + this.chunk.length)\n            return this.chunk.slice(from - this.chunkPos, to - this.chunkPos);\n        if (from >= this.chunk2Pos && to <= this.chunk2Pos + this.chunk2.length)\n            return this.chunk2.slice(from - this.chunk2Pos, to - this.chunk2Pos);\n        if (from >= this.range.from && to <= this.range.to)\n            return this.input.read(from, to);\n        let result = \"\";\n        for (let r of this.ranges) {\n            if (r.from >= to)\n                break;\n            if (r.to > from)\n                result += this.input.read(Math.max(r.from, from), Math.min(r.to, to));\n        }\n        return result;\n    }\n}\n/// @internal\nclass TokenGroup {\n    constructor(data, id) {\n        this.data = data;\n        this.id = id;\n    }\n    token(input, stack) {\n        let { parser } = stack.p;\n        readToken(this.data, input, stack, this.id, parser.data, parser.tokenPrecTable);\n    }\n}\nTokenGroup.prototype.contextual = TokenGroup.prototype.fallback = TokenGroup.prototype.extend = false;\n/// @hide\nclass LocalTokenGroup {\n    constructor(data, precTable, elseToken) {\n        this.precTable = precTable;\n        this.elseToken = elseToken;\n        this.data = typeof data == \"string\" ? decodeArray(data) : data;\n    }\n    token(input, stack) {\n        let start = input.pos, cur;\n        for (;;) {\n            cur = input.pos;\n            readToken(this.data, input, stack, 0, this.data, this.precTable);\n            if (input.token.value > -1)\n                break;\n            if (this.elseToken == null)\n                return;\n            if (input.next < 0)\n                break;\n            input.advance();\n            input.reset(cur + 1, input.token);\n        }\n        if (cur > start) {\n            input.reset(start, input.token);\n            input.acceptToken(this.elseToken, cur - start);\n        }\n    }\n}\nLocalTokenGroup.prototype.contextual = TokenGroup.prototype.fallback = TokenGroup.prototype.extend = false;\n/// `@external tokens` declarations in the grammar should resolve to\n/// an instance of this class.\nclass ExternalTokenizer {\n    /// Create a tokenizer. The first argument is the function that,\n    /// given an input stream, scans for the types of tokens it\n    /// recognizes at the stream's position, and calls\n    /// [`acceptToken`](#lr.InputStream.acceptToken) when it finds\n    /// one.\n    constructor(\n    /// @internal\n    token, options = {}) {\n        this.token = token;\n        this.contextual = !!options.contextual;\n        this.fallback = !!options.fallback;\n        this.extend = !!options.extend;\n    }\n}\n// Tokenizer data is stored a big uint16 array containing, for each\n// state:\n//\n//  - A group bitmask, indicating what token groups are reachable from\n//    this state, so that paths that can only lead to tokens not in\n//    any of the current groups can be cut off early.\n//\n//  - The position of the end of the state's sequence of accepting\n//    tokens\n//\n//  - The number of outgoing edges for the state\n//\n//  - The accepting tokens, as (token id, group mask) pairs\n//\n//  - The outgoing edges, as (start character, end character, state\n//    index) triples, with end character being exclusive\n//\n// This function interprets that data, running through a stream as\n// long as new states with the a matching group mask can be reached,\n// and updating `input.token` when it matches a token.\nfunction readToken(data, input, stack, group, precTable, precOffset) {\n    let state = 0, groupMask = 1 << group, { dialect } = stack.p.parser;\n    scan: for (;;) {\n        if ((groupMask & data[state]) == 0)\n            break;\n        let accEnd = data[state + 1];\n        // Check whether this state can lead to a token in the current group\n        // Accept tokens in this state, possibly overwriting\n        // lower-precedence / shorter tokens\n        for (let i = state + 3; i < accEnd; i += 2)\n            if ((data[i + 1] & groupMask) > 0) {\n                let term = data[i];\n                if (dialect.allows(term) &&\n                    (input.token.value == -1 || input.token.value == term ||\n                        overrides(term, input.token.value, precTable, precOffset))) {\n                    input.acceptToken(term);\n                    break;\n                }\n            }\n        let next = input.next, low = 0, high = data[state + 2];\n        // Special case for EOF\n        if (input.next < 0 && high > low && data[accEnd + high * 3 - 3] == 65535 /* Seq.End */ && data[accEnd + high * 3 - 3] == 65535 /* Seq.End */) {\n            state = data[accEnd + high * 3 - 1];\n            continue scan;\n        }\n        // Do a binary search on the state's edges\n        for (; low < high;) {\n            let mid = (low + high) >> 1;\n            let index = accEnd + mid + (mid << 1);\n            let from = data[index], to = data[index + 1] || 0x10000;\n            if (next < from)\n                high = mid;\n            else if (next >= to)\n                low = mid + 1;\n            else {\n                state = data[index + 2];\n                input.advance();\n                continue scan;\n            }\n        }\n        break;\n    }\n}\nfunction findOffset(data, start, term) {\n    for (let i = start, next; (next = data[i]) != 65535 /* Seq.End */; i++)\n        if (next == term)\n            return i - start;\n    return -1;\n}\nfunction overrides(token, prev, tableData, tableOffset) {\n    let iPrev = findOffset(tableData, tableOffset, prev);\n    return iPrev < 0 || findOffset(tableData, tableOffset, token) < iPrev;\n}\n\n// Environment variable used to control console output\nconst verbose = typeof process != \"undefined\" && process.env && /\\bparse\\b/.test(process.env.LOG);\nlet stackIDs = null;\nvar Safety;\n(function (Safety) {\n    Safety[Safety[\"Margin\"] = 25] = \"Margin\";\n})(Safety || (Safety = {}));\nfunction cutAt(tree, pos, side) {\n    let cursor = tree.cursor(IterMode.IncludeAnonymous);\n    cursor.moveTo(pos);\n    for (;;) {\n        if (!(side < 0 ? cursor.childBefore(pos) : cursor.childAfter(pos)))\n            for (;;) {\n                if ((side < 0 ? cursor.to < pos : cursor.from > pos) && !cursor.type.isError)\n                    return side < 0 ? Math.max(0, Math.min(cursor.to - 1, pos - 25 /* Safety.Margin */))\n                        : Math.min(tree.length, Math.max(cursor.from + 1, pos + 25 /* Safety.Margin */));\n                if (side < 0 ? cursor.prevSibling() : cursor.nextSibling())\n                    break;\n                if (!cursor.parent())\n                    return side < 0 ? 0 : tree.length;\n            }\n    }\n}\nclass FragmentCursor {\n    constructor(fragments, nodeSet) {\n        this.fragments = fragments;\n        this.nodeSet = nodeSet;\n        this.i = 0;\n        this.fragment = null;\n        this.safeFrom = -1;\n        this.safeTo = -1;\n        this.trees = [];\n        this.start = [];\n        this.index = [];\n        this.nextFragment();\n    }\n    nextFragment() {\n        let fr = this.fragment = this.i == this.fragments.length ? null : this.fragments[this.i++];\n        if (fr) {\n            this.safeFrom = fr.openStart ? cutAt(fr.tree, fr.from + fr.offset, 1) - fr.offset : fr.from;\n            this.safeTo = fr.openEnd ? cutAt(fr.tree, fr.to + fr.offset, -1) - fr.offset : fr.to;\n            while (this.trees.length) {\n                this.trees.pop();\n                this.start.pop();\n                this.index.pop();\n            }\n            this.trees.push(fr.tree);\n            this.start.push(-fr.offset);\n            this.index.push(0);\n            this.nextStart = this.safeFrom;\n        }\n        else {\n            this.nextStart = 1e9;\n        }\n    }\n    // `pos` must be >= any previously given `pos` for this cursor\n    nodeAt(pos) {\n        if (pos < this.nextStart)\n            return null;\n        while (this.fragment && this.safeTo <= pos)\n            this.nextFragment();\n        if (!this.fragment)\n            return null;\n        for (;;) {\n            let last = this.trees.length - 1;\n            if (last < 0) { // End of tree\n                this.nextFragment();\n                return null;\n            }\n            let top = this.trees[last], index = this.index[last];\n            if (index == top.children.length) {\n                this.trees.pop();\n                this.start.pop();\n                this.index.pop();\n                continue;\n            }\n            let next = top.children[index];\n            let start = this.start[last] + top.positions[index];\n            if (start > pos) {\n                this.nextStart = start;\n                return null;\n            }\n            if (next instanceof Tree) {\n                if (start == pos) {\n                    if (start < this.safeFrom)\n                        return null;\n                    let end = start + next.length;\n                    if (end <= this.safeTo) {\n                        let lookAhead = next.prop(NodeProp.lookAhead);\n                        if (!lookAhead || end + lookAhead < this.fragment.to)\n                            return next;\n                    }\n                }\n                this.index[last]++;\n                if (start + next.length >= Math.max(this.safeFrom, pos)) { // Enter this node\n                    this.trees.push(next);\n                    this.start.push(start);\n                    this.index.push(0);\n                }\n            }\n            else {\n                this.index[last]++;\n                this.nextStart = start + next.length;\n            }\n        }\n    }\n}\nclass TokenCache {\n    constructor(parser, stream) {\n        this.stream = stream;\n        this.tokens = [];\n        this.mainToken = null;\n        this.actions = [];\n        this.tokens = parser.tokenizers.map(_ => new CachedToken);\n    }\n    getActions(stack) {\n        let actionIndex = 0;\n        let main = null;\n        let { parser } = stack.p, { tokenizers } = parser;\n        let mask = parser.stateSlot(stack.state, 3 /* ParseState.TokenizerMask */);\n        let context = stack.curContext ? stack.curContext.hash : 0;\n        let lookAhead = 0;\n        for (let i = 0; i < tokenizers.length; i++) {\n            if (((1 << i) & mask) == 0)\n                continue;\n            let tokenizer = tokenizers[i], token = this.tokens[i];\n            if (main && !tokenizer.fallback)\n                continue;\n            if (tokenizer.contextual || token.start != stack.pos || token.mask != mask || token.context != context) {\n                this.updateCachedToken(token, tokenizer, stack);\n                token.mask = mask;\n                token.context = context;\n            }\n            if (token.lookAhead > token.end + 25 /* Safety.Margin */)\n                lookAhead = Math.max(token.lookAhead, lookAhead);\n            if (token.value != 0 /* Term.Err */) {\n                let startIndex = actionIndex;\n                if (token.extended > -1)\n                    actionIndex = this.addActions(stack, token.extended, token.end, actionIndex);\n                actionIndex = this.addActions(stack, token.value, token.end, actionIndex);\n                if (!tokenizer.extend) {\n                    main = token;\n                    if (actionIndex > startIndex)\n                        break;\n                }\n            }\n        }\n        while (this.actions.length > actionIndex)\n            this.actions.pop();\n        if (lookAhead)\n            stack.setLookAhead(lookAhead);\n        if (!main && stack.pos == this.stream.end) {\n            main = new CachedToken;\n            main.value = stack.p.parser.eofTerm;\n            main.start = main.end = stack.pos;\n            actionIndex = this.addActions(stack, main.value, main.end, actionIndex);\n        }\n        this.mainToken = main;\n        return this.actions;\n    }\n    getMainToken(stack) {\n        if (this.mainToken)\n            return this.mainToken;\n        let main = new CachedToken, { pos, p } = stack;\n        main.start = pos;\n        main.end = Math.min(pos + 1, p.stream.end);\n        main.value = pos == p.stream.end ? p.parser.eofTerm : 0 /* Term.Err */;\n        return main;\n    }\n    updateCachedToken(token, tokenizer, stack) {\n        let start = this.stream.clipPos(stack.pos);\n        tokenizer.token(this.stream.reset(start, token), stack);\n        if (token.value > -1) {\n            let { parser } = stack.p;\n            for (let i = 0; i < parser.specialized.length; i++)\n                if (parser.specialized[i] == token.value) {\n                    let result = parser.specializers[i](this.stream.read(token.start, token.end), stack);\n                    if (result >= 0 && stack.p.parser.dialect.allows(result >> 1)) {\n                        if ((result & 1) == 0 /* Specialize.Specialize */)\n                            token.value = result >> 1;\n                        else\n                            token.extended = result >> 1;\n                        break;\n                    }\n                }\n        }\n        else {\n            token.value = 0 /* Term.Err */;\n            token.end = this.stream.clipPos(start + 1);\n        }\n    }\n    putAction(action, token, end, index) {\n        // Don't add duplicate actions\n        for (let i = 0; i < index; i += 3)\n            if (this.actions[i] == action)\n                return index;\n        this.actions[index++] = action;\n        this.actions[index++] = token;\n        this.actions[index++] = end;\n        return index;\n    }\n    addActions(stack, token, end, index) {\n        let { state } = stack, { parser } = stack.p, { data } = parser;\n        for (let set = 0; set < 2; set++) {\n            for (let i = parser.stateSlot(state, set ? 2 /* ParseState.Skip */ : 1 /* ParseState.Actions */);; i += 3) {\n                if (data[i] == 65535 /* Seq.End */) {\n                    if (data[i + 1] == 1 /* Seq.Next */) {\n                        i = pair(data, i + 2);\n                    }\n                    else {\n                        if (index == 0 && data[i + 1] == 2 /* Seq.Other */)\n                            index = this.putAction(pair(data, i + 2), token, end, index);\n                        break;\n                    }\n                }\n                if (data[i] == token)\n                    index = this.putAction(pair(data, i + 1), token, end, index);\n            }\n        }\n        return index;\n    }\n}\nvar Rec;\n(function (Rec) {\n    Rec[Rec[\"Distance\"] = 5] = \"Distance\";\n    Rec[Rec[\"MaxRemainingPerStep\"] = 3] = \"MaxRemainingPerStep\";\n    // When two stacks have been running independently long enough to\n    // add this many elements to their buffers, prune one.\n    Rec[Rec[\"MinBufferLengthPrune\"] = 500] = \"MinBufferLengthPrune\";\n    Rec[Rec[\"ForceReduceLimit\"] = 10] = \"ForceReduceLimit\";\n    // Once a stack reaches this depth (in .stack.length) force-reduce\n    // it back to CutTo to avoid creating trees that overflow the stack\n    // on recursive traversal.\n    Rec[Rec[\"CutDepth\"] = 15000] = \"CutDepth\";\n    Rec[Rec[\"CutTo\"] = 9000] = \"CutTo\";\n    Rec[Rec[\"MaxLeftAssociativeReductionCount\"] = 300] = \"MaxLeftAssociativeReductionCount\";\n    // The maximum number of non-recovering stacks to explore (to avoid\n    // getting bogged down with exponentially multiplying stacks in\n    // ambiguous content)\n    Rec[Rec[\"MaxStackCount\"] = 12] = \"MaxStackCount\";\n})(Rec || (Rec = {}));\nclass Parse {\n    constructor(parser, input, fragments, ranges) {\n        this.parser = parser;\n        this.input = input;\n        this.ranges = ranges;\n        this.recovering = 0;\n        this.nextStackID = 0x2654; // , , , , , , , , , , , , , \n        this.minStackPos = 0;\n        this.reused = [];\n        this.stoppedAt = null;\n        this.lastBigReductionStart = -1;\n        this.lastBigReductionSize = 0;\n        this.bigReductionCount = 0;\n        this.stream = new InputStream(input, ranges);\n        this.tokens = new TokenCache(parser, this.stream);\n        this.topTerm = parser.top[1];\n        let { from } = ranges[0];\n        this.stacks = [Stack.start(this, parser.top[0], from)];\n        this.fragments = fragments.length && this.stream.end - from > parser.bufferLength * 4\n            ? new FragmentCursor(fragments, parser.nodeSet) : null;\n    }\n    get parsedPos() {\n        return this.minStackPos;\n    }\n    // Move the parser forward. This will process all parse stacks at\n    // `this.pos` and try to advance them to a further position. If no\n    // stack for such a position is found, it'll start error-recovery.\n    //\n    // When the parse is finished, this will return a syntax tree. When\n    // not, it returns `null`.\n    advance() {\n        let stacks = this.stacks, pos = this.minStackPos;\n        // This will hold stacks beyond `pos`.\n        let newStacks = this.stacks = [];\n        let stopped, stoppedTokens;\n        // If a large amount of reductions happened with the same start\n        // position, force the stack out of that production in order to\n        // avoid creating a tree too deep to recurse through.\n        // (This is an ugly kludge, because unfortunately there is no\n        // straightforward, cheap way to check for this happening, due to\n        // the history of reductions only being available in an\n        // expensive-to-access format in the stack buffers.)\n        if (this.bigReductionCount > 300 /* Rec.MaxLeftAssociativeReductionCount */ && stacks.length == 1) {\n            let [s] = stacks;\n            while (s.forceReduce() && s.stack.length && s.stack[s.stack.length - 2] >= this.lastBigReductionStart) { }\n            this.bigReductionCount = this.lastBigReductionSize = 0;\n        }\n        // Keep advancing any stacks at `pos` until they either move\n        // forward or can't be advanced. Gather stacks that can't be\n        // advanced further in `stopped`.\n        for (let i = 0; i < stacks.length; i++) {\n            let stack = stacks[i];\n            for (;;) {\n                this.tokens.mainToken = null;\n                if (stack.pos > pos) {\n                    newStacks.push(stack);\n                }\n                else if (this.advanceStack(stack, newStacks, stacks)) {\n                    continue;\n                }\n                else {\n                    if (!stopped) {\n                        stopped = [];\n                        stoppedTokens = [];\n                    }\n                    stopped.push(stack);\n                    let tok = this.tokens.getMainToken(stack);\n                    stoppedTokens.push(tok.value, tok.end);\n                }\n                break;\n            }\n        }\n        if (!newStacks.length) {\n            let finished = stopped && findFinished(stopped);\n            if (finished)\n                return this.stackToTree(finished);\n            if (this.parser.strict) {\n                if (verbose && stopped)\n                    console.log(\"Stuck with token \" + (this.tokens.mainToken ? this.parser.getName(this.tokens.mainToken.value) : \"none\"));\n                throw new SyntaxError(\"No parse at \" + pos);\n            }\n            if (!this.recovering)\n                this.recovering = 5 /* Rec.Distance */;\n        }\n        if (this.recovering && stopped) {\n            let finished = this.stoppedAt != null && stopped[0].pos > this.stoppedAt ? stopped[0]\n                : this.runRecovery(stopped, stoppedTokens, newStacks);\n            if (finished)\n                return this.stackToTree(finished.forceAll());\n        }\n        if (this.recovering) {\n            let maxRemaining = this.recovering == 1 ? 1 : this.recovering * 3 /* Rec.MaxRemainingPerStep */;\n            if (newStacks.length > maxRemaining) {\n                newStacks.sort((a, b) => b.score - a.score);\n                while (newStacks.length > maxRemaining)\n                    newStacks.pop();\n            }\n            if (newStacks.some(s => s.reducePos > pos))\n                this.recovering--;\n        }\n        else if (newStacks.length > 1) {\n            // Prune stacks that are in the same state, or that have been\n            // running without splitting for a while, to avoid getting stuck\n            // with multiple successful stacks running endlessly on.\n            outer: for (let i = 0; i < newStacks.length - 1; i++) {\n                let stack = newStacks[i];\n                for (let j = i + 1; j < newStacks.length; j++) {\n                    let other = newStacks[j];\n                    if (stack.sameState(other) ||\n                        stack.buffer.length > 500 /* Rec.MinBufferLengthPrune */ && other.buffer.length > 500 /* Rec.MinBufferLengthPrune */) {\n                        if (((stack.score - other.score) || (stack.buffer.length - other.buffer.length)) > 0) {\n                            newStacks.splice(j--, 1);\n                        }\n                        else {\n                            newStacks.splice(i--, 1);\n                            continue outer;\n                        }\n                    }\n                }\n            }\n            if (newStacks.length > 12 /* Rec.MaxStackCount */)\n                newStacks.splice(12 /* Rec.MaxStackCount */, newStacks.length - 12 /* Rec.MaxStackCount */);\n        }\n        this.minStackPos = newStacks[0].pos;\n        for (let i = 1; i < newStacks.length; i++)\n            if (newStacks[i].pos < this.minStackPos)\n                this.minStackPos = newStacks[i].pos;\n        return null;\n    }\n    stopAt(pos) {\n        if (this.stoppedAt != null && this.stoppedAt < pos)\n            throw new RangeError(\"Can't move stoppedAt forward\");\n        this.stoppedAt = pos;\n    }\n    // Returns an updated version of the given stack, or null if the\n    // stack can't advance normally. When `split` and `stacks` are\n    // given, stacks split off by ambiguous operations will be pushed to\n    // `split`, or added to `stacks` if they move `pos` forward.\n    advanceStack(stack, stacks, split) {\n        let start = stack.pos, { parser } = this;\n        let base = verbose ? this.stackID(stack) + \" -> \" : \"\";\n        if (this.stoppedAt != null && start > this.stoppedAt)\n            return stack.forceReduce() ? stack : null;\n        if (this.fragments) {\n            let strictCx = stack.curContext && stack.curContext.tracker.strict, cxHash = strictCx ? stack.curContext.hash : 0;\n            for (let cached = this.fragments.nodeAt(start); cached;) {\n                let match = this.parser.nodeSet.types[cached.type.id] == cached.type ? parser.getGoto(stack.state, cached.type.id) : -1;\n                if (match > -1 && cached.length && (!strictCx || (cached.prop(NodeProp.contextHash) || 0) == cxHash)) {\n                    stack.useNode(cached, match);\n                    if (verbose)\n                        console.log(base + this.stackID(stack) + ` (via reuse of ${parser.getName(cached.type.id)})`);\n                    return true;\n                }\n                if (!(cached instanceof Tree) || cached.children.length == 0 || cached.positions[0] > 0)\n                    break;\n                let inner = cached.children[0];\n                if (inner instanceof Tree && cached.positions[0] == 0)\n                    cached = inner;\n                else\n                    break;\n            }\n        }\n        let defaultReduce = parser.stateSlot(stack.state, 4 /* ParseState.DefaultReduce */);\n        if (defaultReduce > 0) {\n            stack.reduce(defaultReduce);\n            if (verbose)\n                console.log(base + this.stackID(stack) + ` (via always-reduce ${parser.getName(defaultReduce & 65535 /* Action.ValueMask */)})`);\n            return true;\n        }\n        if (stack.stack.length >= 15000 /* Rec.CutDepth */) {\n            while (stack.stack.length > 9000 /* Rec.CutTo */ && stack.forceReduce()) { }\n        }\n        let actions = this.tokens.getActions(stack);\n        for (let i = 0; i < actions.length;) {\n            let action = actions[i++], term = actions[i++], end = actions[i++];\n            let last = i == actions.length || !split;\n            let localStack = last ? stack : stack.split();\n            localStack.apply(action, term, end);\n            if (verbose)\n                console.log(base + this.stackID(localStack) + ` (via ${(action & 65536 /* Action.ReduceFlag */) == 0 ? \"shift\"\n                    : `reduce of ${parser.getName(action & 65535 /* Action.ValueMask */)}`} for ${parser.getName(term)} @ ${start}${localStack == stack ? \"\" : \", split\"})`);\n            if (last)\n                return true;\n            else if (localStack.pos > start)\n                stacks.push(localStack);\n            else\n                split.push(localStack);\n        }\n        return false;\n    }\n    // Advance a given stack forward as far as it will go. Returns the\n    // (possibly updated) stack if it got stuck, or null if it moved\n    // forward and was given to `pushStackDedup`.\n    advanceFully(stack, newStacks) {\n        let pos = stack.pos;\n        for (;;) {\n            if (!this.advanceStack(stack, null, null))\n                return false;\n            if (stack.pos > pos) {\n                pushStackDedup(stack, newStacks);\n                return true;\n            }\n        }\n    }\n    runRecovery(stacks, tokens, newStacks) {\n        let finished = null, restarted = false;\n        for (let i = 0; i < stacks.length; i++) {\n            let stack = stacks[i], token = tokens[i << 1], tokenEnd = tokens[(i << 1) + 1];\n            let base = verbose ? this.stackID(stack) + \" -> \" : \"\";\n            if (stack.deadEnd) {\n                if (restarted)\n                    continue;\n                restarted = true;\n                stack.restart();\n                if (verbose)\n                    console.log(base + this.stackID(stack) + \" (restarted)\");\n                let done = this.advanceFully(stack, newStacks);\n                if (done)\n                    continue;\n            }\n            let force = stack.split(), forceBase = base;\n            for (let j = 0; force.forceReduce() && j < 10 /* Rec.ForceReduceLimit */; j++) {\n                if (verbose)\n                    console.log(forceBase + this.stackID(force) + \" (via force-reduce)\");\n                let done = this.advanceFully(force, newStacks);\n                if (done)\n                    break;\n                if (verbose)\n                    forceBase = this.stackID(force) + \" -> \";\n            }\n            for (let insert of stack.recoverByInsert(token)) {\n                if (verbose)\n                    console.log(base + this.stackID(insert) + \" (via recover-insert)\");\n                this.advanceFully(insert, newStacks);\n            }\n            if (this.stream.end > stack.pos) {\n                if (tokenEnd == stack.pos) {\n                    tokenEnd++;\n                    token = 0 /* Term.Err */;\n                }\n                stack.recoverByDelete(token, tokenEnd);\n                if (verbose)\n                    console.log(base + this.stackID(stack) + ` (via recover-delete ${this.parser.getName(token)})`);\n                pushStackDedup(stack, newStacks);\n            }\n            else if (!finished || finished.score < stack.score) {\n                finished = stack;\n            }\n        }\n        return finished;\n    }\n    // Convert the stack's buffer to a syntax tree.\n    stackToTree(stack) {\n        stack.close();\n        return Tree.build({ buffer: StackBufferCursor.create(stack),\n            nodeSet: this.parser.nodeSet,\n            topID: this.topTerm,\n            maxBufferLength: this.parser.bufferLength,\n            reused: this.reused,\n            start: this.ranges[0].from,\n            length: stack.pos - this.ranges[0].from,\n            minRepeatType: this.parser.minRepeatTerm });\n    }\n    stackID(stack) {\n        let id = (stackIDs || (stackIDs = new WeakMap)).get(stack);\n        if (!id)\n            stackIDs.set(stack, id = String.fromCodePoint(this.nextStackID++));\n        return id + stack;\n    }\n}\nfunction pushStackDedup(stack, newStacks) {\n    for (let i = 0; i < newStacks.length; i++) {\n        let other = newStacks[i];\n        if (other.pos == stack.pos && other.sameState(stack)) {\n            if (newStacks[i].score < stack.score)\n                newStacks[i] = stack;\n            return;\n        }\n    }\n    newStacks.push(stack);\n}\nclass Dialect {\n    constructor(source, flags, disabled) {\n        this.source = source;\n        this.flags = flags;\n        this.disabled = disabled;\n    }\n    allows(term) { return !this.disabled || this.disabled[term] == 0; }\n}\nconst id = x => x;\n/// Context trackers are used to track stateful context (such as\n/// indentation in the Python grammar, or parent elements in the XML\n/// grammar) needed by external tokenizers. You declare them in a\n/// grammar file as `@context exportName from \"module\"`.\n///\n/// Context values should be immutable, and can be updated (replaced)\n/// on shift or reduce actions.\n///\n/// The export used in a `@context` declaration should be of this\n/// type.\nclass ContextTracker {\n    /// Define a context tracker.\n    constructor(spec) {\n        this.start = spec.start;\n        this.shift = spec.shift || id;\n        this.reduce = spec.reduce || id;\n        this.reuse = spec.reuse || id;\n        this.hash = spec.hash || (() => 0);\n        this.strict = spec.strict !== false;\n    }\n}\n/// Holds the parse tables for a given grammar, as generated by\n/// `lezer-generator`, and provides [methods](#common.Parser) to parse\n/// content with.\nclass LRParser extends Parser {\n    /// @internal\n    constructor(spec) {\n        super();\n        /// @internal\n        this.wrappers = [];\n        if (spec.version != 14 /* File.Version */)\n            throw new RangeError(`Parser version (${spec.version}) doesn't match runtime version (${14 /* File.Version */})`);\n        let nodeNames = spec.nodeNames.split(\" \");\n        this.minRepeatTerm = nodeNames.length;\n        for (let i = 0; i < spec.repeatNodeCount; i++)\n            nodeNames.push(\"\");\n        let topTerms = Object.keys(spec.topRules).map(r => spec.topRules[r][1]);\n        let nodeProps = [];\n        for (let i = 0; i < nodeNames.length; i++)\n            nodeProps.push([]);\n        function setProp(nodeID, prop, value) {\n            nodeProps[nodeID].push([prop, prop.deserialize(String(value))]);\n        }\n        if (spec.nodeProps)\n            for (let propSpec of spec.nodeProps) {\n                let prop = propSpec[0];\n                if (typeof prop == \"string\")\n                    prop = NodeProp[prop];\n                for (let i = 1; i < propSpec.length;) {\n                    let next = propSpec[i++];\n                    if (next >= 0) {\n                        setProp(next, prop, propSpec[i++]);\n                    }\n                    else {\n                        let value = propSpec[i + -next];\n                        for (let j = -next; j > 0; j--)\n                            setProp(propSpec[i++], prop, value);\n                        i++;\n                    }\n                }\n            }\n        this.nodeSet = new NodeSet(nodeNames.map((name, i) => NodeType.define({\n            name: i >= this.minRepeatTerm ? undefined : name,\n            id: i,\n            props: nodeProps[i],\n            top: topTerms.indexOf(i) > -1,\n            error: i == 0,\n            skipped: spec.skippedNodes && spec.skippedNodes.indexOf(i) > -1\n        })));\n        if (spec.propSources)\n            this.nodeSet = this.nodeSet.extend(...spec.propSources);\n        this.strict = false;\n        this.bufferLength = DefaultBufferLength;\n        let tokenArray = decodeArray(spec.tokenData);\n        this.context = spec.context;\n        this.specializerSpecs = spec.specialized || [];\n        this.specialized = new Uint16Array(this.specializerSpecs.length);\n        for (let i = 0; i < this.specializerSpecs.length; i++)\n            this.specialized[i] = this.specializerSpecs[i].term;\n        this.specializers = this.specializerSpecs.map(getSpecializer);\n        this.states = decodeArray(spec.states, Uint32Array);\n        this.data = decodeArray(spec.stateData);\n        this.goto = decodeArray(spec.goto);\n        this.maxTerm = spec.maxTerm;\n        this.tokenizers = spec.tokenizers.map(value => typeof value == \"number\" ? new TokenGroup(tokenArray, value) : value);\n        this.topRules = spec.topRules;\n        this.dialects = spec.dialects || {};\n        this.dynamicPrecedences = spec.dynamicPrecedences || null;\n        this.tokenPrecTable = spec.tokenPrec;\n        this.termNames = spec.termNames || null;\n        this.maxNode = this.nodeSet.types.length - 1;\n        this.dialect = this.parseDialect();\n        this.top = this.topRules[Object.keys(this.topRules)[0]];\n    }\n    createParse(input, fragments, ranges) {\n        let parse = new Parse(this, input, fragments, ranges);\n        for (let w of this.wrappers)\n            parse = w(parse, input, fragments, ranges);\n        return parse;\n    }\n    /// Get a goto table entry @internal\n    getGoto(state, term, loose = false) {\n        let table = this.goto;\n        if (term >= table[0])\n            return -1;\n        for (let pos = table[term + 1];;) {\n            let groupTag = table[pos++], last = groupTag & 1;\n            let target = table[pos++];\n            if (last && loose)\n                return target;\n            for (let end = pos + (groupTag >> 1); pos < end; pos++)\n                if (table[pos] == state)\n                    return target;\n            if (last)\n                return -1;\n        }\n    }\n    /// Check if this state has an action for a given terminal @internal\n    hasAction(state, terminal) {\n        let data = this.data;\n        for (let set = 0; set < 2; set++) {\n            for (let i = this.stateSlot(state, set ? 2 /* ParseState.Skip */ : 1 /* ParseState.Actions */), next;; i += 3) {\n                if ((next = data[i]) == 65535 /* Seq.End */) {\n                    if (data[i + 1] == 1 /* Seq.Next */)\n                        next = data[i = pair(data, i + 2)];\n                    else if (data[i + 1] == 2 /* Seq.Other */)\n                        return pair(data, i + 2);\n                    else\n                        break;\n                }\n                if (next == terminal || next == 0 /* Term.Err */)\n                    return pair(data, i + 1);\n            }\n        }\n        return 0;\n    }\n    /// @internal\n    stateSlot(state, slot) {\n        return this.states[(state * 6 /* ParseState.Size */) + slot];\n    }\n    /// @internal\n    stateFlag(state, flag) {\n        return (this.stateSlot(state, 0 /* ParseState.Flags */) & flag) > 0;\n    }\n    /// @internal\n    validAction(state, action) {\n        if (action == this.stateSlot(state, 4 /* ParseState.DefaultReduce */))\n            return true;\n        for (let i = this.stateSlot(state, 1 /* ParseState.Actions */);; i += 3) {\n            if (this.data[i] == 65535 /* Seq.End */) {\n                if (this.data[i + 1] == 1 /* Seq.Next */)\n                    i = pair(this.data, i + 2);\n                else\n                    return false;\n            }\n            if (action == pair(this.data, i + 1))\n                return true;\n        }\n    }\n    /// Get the states that can follow this one through shift actions or\n    /// goto jumps. @internal\n    nextStates(state) {\n        let result = [];\n        for (let i = this.stateSlot(state, 1 /* ParseState.Actions */);; i += 3) {\n            if (this.data[i] == 65535 /* Seq.End */) {\n                if (this.data[i + 1] == 1 /* Seq.Next */)\n                    i = pair(this.data, i + 2);\n                else\n                    break;\n            }\n            if ((this.data[i + 2] & (65536 /* Action.ReduceFlag */ >> 16)) == 0) {\n                let value = this.data[i + 1];\n                if (!result.some((v, i) => (i & 1) && v == value))\n                    result.push(this.data[i], value);\n            }\n        }\n        return result;\n    }\n    /// Configure the parser. Returns a new parser instance that has the\n    /// given settings modified. Settings not provided in `config` are\n    /// kept from the original parser.\n    configure(config) {\n        // Hideous reflection-based kludge to make it easy to create a\n        // slightly modified copy of a parser.\n        let copy = Object.assign(Object.create(LRParser.prototype), this);\n        if (config.props)\n            copy.nodeSet = this.nodeSet.extend(...config.props);\n        if (config.top) {\n            let info = this.topRules[config.top];\n            if (!info)\n                throw new RangeError(`Invalid top rule name ${config.top}`);\n            copy.top = info;\n        }\n        if (config.tokenizers)\n            copy.tokenizers = this.tokenizers.map(t => {\n                let found = config.tokenizers.find(r => r.from == t);\n                return found ? found.to : t;\n            });\n        if (config.specializers) {\n            copy.specializers = this.specializers.slice();\n            copy.specializerSpecs = this.specializerSpecs.map((s, i) => {\n                let found = config.specializers.find(r => r.from == s.external);\n                if (!found)\n                    return s;\n                let spec = Object.assign(Object.assign({}, s), { external: found.to });\n                copy.specializers[i] = getSpecializer(spec);\n                return spec;\n            });\n        }\n        if (config.contextTracker)\n            copy.context = config.contextTracker;\n        if (config.dialect)\n            copy.dialect = this.parseDialect(config.dialect);\n        if (config.strict != null)\n            copy.strict = config.strict;\n        if (config.wrap)\n            copy.wrappers = copy.wrappers.concat(config.wrap);\n        if (config.bufferLength != null)\n            copy.bufferLength = config.bufferLength;\n        return copy;\n    }\n    /// Tells you whether any [parse wrappers](#lr.ParserConfig.wrap)\n    /// are registered for this parser.\n    hasWrappers() {\n        return this.wrappers.length > 0;\n    }\n    /// Returns the name associated with a given term. This will only\n    /// work for all terms when the parser was generated with the\n    /// `--names` option. By default, only the names of tagged terms are\n    /// stored.\n    getName(term) {\n        return this.termNames ? this.termNames[term] : String(term <= this.maxNode && this.nodeSet.types[term].name || term);\n    }\n    /// The eof term id is always allocated directly after the node\n    /// types. @internal\n    get eofTerm() { return this.maxNode + 1; }\n    /// The type of top node produced by the parser.\n    get topNode() { return this.nodeSet.types[this.top[1]]; }\n    /// @internal\n    dynamicPrecedence(term) {\n        let prec = this.dynamicPrecedences;\n        return prec == null ? 0 : prec[term] || 0;\n    }\n    /// @internal\n    parseDialect(dialect) {\n        let values = Object.keys(this.dialects), flags = values.map(() => false);\n        if (dialect)\n            for (let part of dialect.split(\" \")) {\n                let id = values.indexOf(part);\n                if (id >= 0)\n                    flags[id] = true;\n            }\n        let disabled = null;\n        for (let i = 0; i < values.length; i++)\n            if (!flags[i]) {\n                for (let j = this.dialects[values[i]], id; (id = this.data[j++]) != 65535 /* Seq.End */;)\n                    (disabled || (disabled = new Uint8Array(this.maxTerm + 1)))[id] = 1;\n            }\n        return new Dialect(dialect, flags, disabled);\n    }\n    /// Used by the output of the parser generator. Not available to\n    /// user code. @hide\n    static deserialize(spec) {\n        return new LRParser(spec);\n    }\n}\nfunction pair(data, off) { return data[off] | (data[off + 1] << 16); }\nfunction findFinished(stacks) {\n    let best = null;\n    for (let stack of stacks) {\n        let stopped = stack.p.stoppedAt;\n        if ((stack.pos == stack.p.stream.end || stopped != null && stack.pos > stopped) &&\n            stack.p.parser.stateFlag(stack.state, 2 /* StateFlag.Accepting */) &&\n            (!best || best.score < stack.score))\n            best = stack;\n    }\n    return best;\n}\nfunction getSpecializer(spec) {\n    if (spec.external) {\n        let mask = spec.extend ? 1 /* Specialize.Extend */ : 0 /* Specialize.Specialize */;\n        return (value, stack) => (spec.external(value, stack) << 1) | mask;\n    }\n    return spec.get;\n}\n\nexport { ContextTracker, ExternalTokenizer, InputStream, LRParser, LocalTokenGroup, Stack };\n","import { LRParser, LocalTokenGroup } from '@lezer/lr';\n\n// This file was generated by lezer-generator. You probably shouldn't edit it.\nconst parser = LRParser.deserialize({\n  version: 14,\n  states: \"2`O]QPOOP!pOPOOO]QPO'#CkO#dQPO'#CjO%wQQO'#ClOOQO'#DP'#DPOOQO'#DO'#DOO&OQPO'#DOO&TQSO'#C{OOQO'#C|'#C|O&]QPO'#C|O&hQPO'#DRO&mQPO'#DSO&rQPO'#DUOOQO'#DW'#DWO&wQPO'#DVOOQO'#Cj'#CjQ'PQPOOOOQO'#C`'#C`P'nO!bO'#C^POOO)C?T)C?TO'yQPO,59VO(QQSO,59hO(]QPO,59TO(}QPO,58zO)UQPO,59VO)UQPO,59VO)UQPO,59VO)UQPO,59VO)UQPO,59VO)UQPO,59VO)UQPO,59VOOQO'#Co'#CoOOQO'#Cu'#CuO)ZQWO'#CuO)rQ`O'#CwO)wQPO'#CwO#nQQO'#CmO)|QWO,59WO#nQQO'#CmOOQO'#Cm'#CmOOQO,59W,59WO#nQQO,59jO*[QPO,59hO*[QPO,59gOOQO,59h,59hO#nQQO,59mO#nQQO,59nOOQO,59p,59pO+PQPO,59qO,rQPO,59qO]QPO,58zO]QPO,58zO]QPO,58zO]QPO,58zO]QPO,58zO]QPO,58zO]QPO,58zO]QPO,58zO]QPO,58zPOOO'#D['#D[P,yO!bO,58xPOOO,58x,58xOOQO1G.q1G.qOOQO1G/S1G/SOOQO1G.o1G.oOOQO1G.f1G.fO)UQPO'#CkO-vQPO1G.qO.oQPO1G.qO.vQPO1G.qO/oQPO1G.qO/vQPO1G.qO/}QPO1G.qO0UQ`O,59cOOQO,59c,59cO0aQ`O,59cO0fQWO,59XO#nQQO,59XO#nQQO,59XO#nQQO,59XOOQO1G.r1G.rO0tQWO,59XO1YQWO1G/UO*[QPO'#C|O1hQpO1G/RO2`QWO1G/XO2qQWO'#DTO3SQPO1G/YOOQO1G/]1G/]O3[QPO'#CuOOQO'#DZ'#DZOOQO'#DY'#DYO3gQPO'#DXOOQO'#DX'#DXO3oQPO1G/]O4fQPO1G.fO5_QPO1G.fO5fQPO1G.fO6_QPO1G.fO6fQPO1G.fO6mQPO1G.fO7fQPO1G.fO7mQPO1G.fPOOO-E7Y-E7YPOOO1G.d1G.dO7tQPO,59VOOQO1G.}1G.}O8`QPO1G.}OOQO1G.s1G.sO8vQWO1G.sO8}QWO1G.sOOQO7+$p7+$pO9UQSO,59hO#nQQO'#D]O9^QPO7+$sOOQO7+$s7+$sO#nQQO,59oOOQO7+$t7+$tO9fQPO,59tO9pQPO7+$wO:hQ`O7+$iO:mQWO,59wOOQO-E7Z-E7ZOOQO<<H_<<H_O;OQWO1G/ZOOQO1G/`1G/`OOQO1G/_1G/_O;aQPO1G/_OOQO<<Hc<<HcOOQO<<HT<<HTO;fQPO7+$yOOQO<<He<<He\",\n  stateData: \";x~O!SOSPOS!TPQ~OeXOfXOgXOhXO!XQO![SO!^YO!vUO!wTO!xTO!yTO!zTO!{ZO!}[O#O]O#Q^O#R^O#S^O#T^O#U^O#V^O~O!TcO~OTiOUjOVlOWkOXmOYnO!ZoOZ^X[^X~O!Q^X!Y^X~P!uOdpOepOfpOgpOhpOjrOmtOntO!XuO!^wO!_wO!`pO!apO!bpO!cpO!dpO!epO!fpO!gpO!hpO!ipO!jpO!kpO!lqO!mqO!nqO!oqO!pqO!qqO!rqO!sqO!tqO!usO~O!]yO~P#nO!XzO~Oq{Ot|O~Oe}Of}Og}O~O!X!OO~O!X!PO~O#P!QO~O!X!SO#P!RO~OT!TOU!UOV!VOW!WOX!XOY!YOZ![O[!]O!Z!ZO~O!U!^O!V!^O!W!`O~O!Y!aO~P!uOq{Ot|O!Y!bO~O!Y!cOTSXUSXVSXWSXXSXYSXZSX[SX!ZSX~O!Y!dO~P'PO!X!eO~O!u!lOTiXYiXbiX!]iX!YiX!|iX~Ol!mO~O!u!nO~OT!qOY!rOb!pO!]!sO~OeXOfXOgXOhXO!X!vO!^YO!vUO!wTO!xTO!yTO!zTO~O!{ZOTyaUyaVyaWyaXyaYyaZya[ya!Qya!Zya!Yya~Oj!|OmtOntO!lqO!mqO!nqO!oqO!pqO!qqO!rqO!sqO!tqO!usO~Og#QO~P+wO!U!^O!V!^O!W#]O~OUjOVlOWkOXmO!ZoOY_iZ_i[_i!Q_i!Y_i~OT_i~P-UOUjOT_iV_iX_iY_iZ_i[_i!Q_i!Z_i!Y_i~OW_i~P-}OWkO~P-}OUjOVlOWkOT_iY_iZ_i[_i!Q_i!Z_i!Y_i~OX_i~P.}OTiO~P-UOXmO~P.}Ol#_Om#`On#`O~Ol#_O~OT!qOY!rOb!pO!Y#aO~OT!qOY!rOb!pO!]aa!Yaa!|aa~OT!qOY!rOb!pO!Y#dO~Oq{OToiUoiVoiWoiXoiYoiZoi[oi!Qoi!Zoi!Yoi~OT!qOY!rOb!pO!Y#hO!|#fO~OT!qOY!rOb!pO!YwX!|wX~O!Y#jO!|#iO~O!u!lO!YiX!|iX~O!|#kO!Y{X~O!Y#lO~OU!UOV!VOW!WOX!XO!Z!ZOYSiZSi[Si!QSi!YSi~OTSi~P3tOU!UOTSiVSiXSiYSiZSi[Si!QSi!ZSi!YSi~OW!WO~P4mOWSi~P4mOU!UOV!VOW!WOTSiYSiZSi[Si!QSi!ZSi!YSi~OXSi~P5mOT!TO~P3tOX!XO~P5mOT!TOU!UOV!VOW!WOX!XOY!YO!Z!ZO[Si!QSi!YSi~OZSi~P6tOZ![O~P6tOTiOUjOVlOWkOXmOYnO!Y!aO!ZoO~O!u#mO~Ob!pOYai!]ai!Yai!|ai~OTai~P8eOT!qO~P8eOq{O!Y!bO~O!Y#pO!|#fO~Of#tOg#sO~P+wO!{ZOTyqUyqVyqWyqXyqYyqZyq[yq!Qyq!Zyq!Yyq~Ol#vO~OT!qOY!rOb!pO!Y!Pa!|!Pa~OT!qOY!rOb!pO!Ywi!|wi~O!|#wO~Og#xO~OgfePqbjmjnln~\",\n  goto: \"(e!QPP!RP!UPPPPPPPP!w#U#e$^$kP%^PPPPP%kP%kPPP$^%|P&f&vP'W$^'k$^$^'n'{(O(R(X(_RdPQaOQhQQ!d!UQ#S!TQ#T!VQ#U!WQ#V!XQ#W!YQ#X!ZQ#Y![R#Z!]gbOQ!T!U!V!W!X!Y!Z![!]dbO!T!U!V!W!X!Y!Z![!]RgQdRO!T!U!V!W!X!Y!Z![!]QeQQ!ajQ!fiQ!gkQ!hlQ!imQ!jnQ!koR#^!eg`OQ!T!U!V!W!X!Y!Z![!]QvSQ!ouQ!twQ!uzQ!x!OQ!y!PQ#a!pQ#b!qQ#c!rQ#n#fR#q#igxSuwz!O!P!p!q!r#f#ifxSuwz!O!P!p!q!r#f#iT!}!S#kdWO!T!U!V!W!X!Y!Z![!]QfQQ!b{Q!w|R#e!vmXOQ{|!T!U!V!W!X!Y!Z![!]!vmVOQ{|!T!U!V!W!X!Y!Z![!]!vf`OQ!T!U!V!W!X!Y!Z![!]Q!{!RR#u#lR!z!Pg_OQ!T!U!V!W!X!Y!Z![!]R#R!SR#P!SQ#O!SR#r#kQ!_cR#[!_Q#g!xR#o#g\",\n  nodeNames: \" LineComment BlockComment TraceQL SpansetPipelineExpression And Gt Desc Lt Anc Or Pipe ExperimentalOp WrappedSpansetPipeline SpansetPipeline SpansetExpression SpansetFilter FieldExpression FieldOp Static String Integer Float Duration TemplateVariable IntrinsicField Parent AttributeField Identifier Resource Span ScalarFilter ScalarExpression ScalarOp Aggregate AggregateExpression ComparisonOp GroupOperation SelectOperation SelectArgs CoalesceOperation MetricsOperation MetricsOperationType MetricsArgs MetricsQuery MetricsQueryExpression\",\n  maxTerm: 99,\n  skippedNodes: [0,1,2,46],\n  repeatNodeCount: 2,\n  tokenData: \"&5x~R!`X^%Tpq%Tqr%xrs'Qst(dtu*juv2cvw3_wx(dxy3jyz3wz{2c{|2c|}3|}!O4R!O!P4[!P!Q4a!Q![5[![!](d!]!^(d!^!_7O!_!`7d!`!a7n!a!b(d!b!c(d!c!}(d#Q#R8S#R#S(d#S#T8Z#T#U<c#U#VHo#V#WJg#W#X!C}#X#Y!Ki#Y#Z#!Z#Z#](d#]#^#&{#^#_(d#_#`#.g#`#a(d#a#b#2Z#b#c#I{#c#d$ m#d#e$#e#e#f$/w#f#g$@w#g#h%.m#h#i%Hh#i#j&(v#j#o(d#o#p&5Y#p#q&5_#q#r&5l#r#s&5q#y#z%T$f$g%T#BY#BZ%T$IS$I_%T$I|$JO%T$JT$JU%T$KV$KW%T&FU&FV%T~%YY!S~X^%Tpq%T#y#z%T$f$g%T#BY#BZ%T$IS$I_%T$I|$JO%T$JT$JU%T$KV$KW%T&FU&FV%T#Q%}S!_S!^!_&Z!_!`&h!`!a&o#r#s&w!d&`P[!d!^!_&c!d&hO[!dh&oOtWb`!d&tP[!d!`!a&c!|'QOtW[!db`t'TVOr'Qrs'js#O'Q#O#P*Z#P;'S'Q;'S;=`*d<%lO'Qt'qZdSlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dp(iZlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dp)_VOr)[rs(ds#O)[#O#P)t#P;'S)[;'S;=`)}<%lO)[p)wQrs)[#O#P)[p*QP;=`<%l)[p*WP;=`<%l(dt*^Qrs'Q#O#P'Qt*gP;=`<%l'Qv*oelpOp(drs,Qst,jtu,juv,jwx,jz|,j}![(d![!],j!]!^,j!a!b,j!b!c,j!c!},j!}#Q(d#R#S,j#S#T,j#T#o,j#o#p-y#s;'S(d;'S;=`*T<%lO(dv,TVOr,Qrs,js#O,Q#O#P-j#P;'S,Q;'S;=`-s<%lO,Qv,qZhUlpOp,jrs,Qsv,jwx,jz|,j}!^,j!a#Q,j#R#o,j#s;'S,j;'S;=`-d<%lO,jv-gP;=`<%l,jv-mQrs,Q#O#P,Qv-vP;=`<%l,Qv-|^rs.xst/btu/buv/bwx/bz|/b![!]/b!]!^/b!a!b/b!b!c/b!c!}/b#R#S/b#S#T/b#T#o/bv.{VOr.xrs/bs#O.x#O#P2S#P;'S.x;'S;=`2]<%lO.xv/e^Op/brs.xsv/bwx/bz|/b}![/b![!]0a!]!^/b!a#Q/b#R#o/b#q#r1u#s;'S/b;'S;=`1|<%lO/bv0deOp/brs.xsv/bwx/bz|/b}!O/b!O!P0a!P!Q/b!Q![0a![!]0a!]!^/b!a!c/b!c!}0a!}#Q/b#R#S0a#S#T/b#T#o0a#q#r1u#s;'S/b;'S;=`1|<%lO/bv1|OhUlpv2PP;=`<%l/bv2VQrs.x#O#P.xv2`P;=`<%l.x#l2lZq!jb`lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(d~3bPvw3e~3jOT~~3oP!X~yz3r~3wO#P~~3|O!Y~~4RO!|~#Q4[O!^Uq!jb`~4aO!u~~4hQq!jb`z{4n!P!Q4s~4sO!T~~4xSP~OY4sZ;'S4s;'S;=`5U<%lO4s~5XP;=`<%l4s~5aWe~!O!P5y!Q![5[#[#]6k#a#b6p#b#c6x#g#h6k#i#j6x${$|6x~5|P!Q![6P~6UVf~!Q![6P#[#]6k#a#b6p#b#c6x#g#h6k#i#j6x${$|6x~6pOg~~6uPg~#g#h6k~6{P#g#h6k!|7XQtWW!db`!^!_7_!_!`&h!d7dOX!dh7kPtWb`#r#s&h!|7wQtWU!db`!_!`&h!`!a7}!d8SOV!d!z8ZOq!jb`t8`dlpOp8Zpr9nrs:]sv8Zvw9nwx8Zxz9nz|8Z|}9n}!^8Z!^!a9n!a#Q8Z#Q#R9n#R#S8Z#S#T'j#T#o8Z#o#s9n#s;'S8Z;'S;=`<]<%lO8ZS9qTO#S9n#S#T:Q#T;'S9n;'S;=`:V<%lO9nS:VOdSS:YP;=`<%l9nt:`XOr:]rs8Zs#O:]#O#P:{#P#S:]#S#T;k#T;'S:];'S;=`<V<%lO:]t;OXOr9nrs:]s#O9n#O#P:]#P#S9n#S#T:Q#T;'S9n;'S;=`:V<%lO9nt;pVdSOr)[rs(ds#O)[#O#P)t#P;'S)[;'S;=`)}<%lO)[t<YP;=`<%l:]t<`P;=`<%l8Zr<h]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#j(d#j#k=a#k#o(d#s;'S(d;'S;=`*T<%lO(dr=f]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#Z(d#Z#[>_#[#o(d#s;'S(d;'S;=`*T<%lO(dr>f[!yQlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#S?[#S#o(d#s;'S(d;'S;=`*T<%lO(dr?a]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#c(d#c#d@Y#d#o(d#s;'S(d;'S;=`*T<%lO(dr@_]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#j(d#j#kAW#k#o(d#s;'S(d;'S;=`*T<%lO(drA]]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#YBU#Y#o(d#s;'S(d;'S;=`*T<%lO(drBZ]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#gCS#g#o(d#s;'S(d;'S;=`*T<%lO(drCX[lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#SC}#S#o(d#s;'S(d;'S;=`*T<%lO(drDS]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#iD{#i#o(d#s;'S(d;'S;=`*T<%lO(drEQ]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#](d#]#^Ey#^#o(d#s;'S(d;'S;=`*T<%lO(drFO]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#a(d#a#bFw#b#o(d#s;'S(d;'S;=`*T<%lO(drF|]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#YGu#Y#o(d#s;'S(d;'S;=`*T<%lO(drG|Z#SQlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(drHt]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#m(d#m#nIm#n#o(d#s;'S(d;'S;=`*T<%lO(drItZ!{QlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dvJlalpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#[(d#[#]Kq#]#`(d#`#a!&Z#a#c(d#c#d!*{#d#o(d#s;'S(d;'S;=`*T<%lO(dvKv]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#](d#]#^Lo#^#o(d#s;'S(d;'S;=`*T<%lO(dvLt]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#`(d#`#aMm#a#o(d#s;'S(d;'S;=`*T<%lO(dvMr]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#W(d#W#XNk#X#o(d#s;'S(d;'S;=`*T<%lO(dvNp]lpOp(drs)[sv(dwx(dz|(d}!^(d!a!e(d!e!f! i!f#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dv! n]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#c(d#c#d!!g#d#o(d#s;'S(d;'S;=`*T<%lO(dv!!l]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#i(d#i#j!#e#j#o(d#s;'S(d;'S;=`*T<%lO(dv!#j]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#b(d#b#c!$c#c#o(d#s;'S(d;'S;=`*T<%lO(dv!$h]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i!%a#i#o(d#s;'S(d;'S;=`*T<%lO(dv!%hZ!lUlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dt!&`]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#](d#]#^!'X#^#o(d#s;'S(d;'S;=`*T<%lO(dt!'^]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y!(V#Y#o(d#s;'S(d;'S;=`*T<%lO(dt!([]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#b(d#b#c!)T#c#o(d#s;'S(d;'S;=`*T<%lO(dt!)Y]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i!*R#i#o(d#s;'S(d;'S;=`*T<%lO(dt!*YZ!iSlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dv!+QalpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#T(d#T#U!,V#U#b(d#b#c!1u#c#i(d#i#j!7e#j#o(d#s;'S(d;'S;=`*T<%lO(dr!,[]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#`(d#`#a!-T#a#o(d#s;'S(d;'S;=`*T<%lO(dr!-Y]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y!.R#Y#o(d#s;'S(d;'S;=`*T<%lO(dr!.W]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#g(d#g#h!/P#h#o(d#s;'S(d;'S;=`*T<%lO(dr!/U]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#V(d#V#W!/}#W#o(d#s;'S(d;'S;=`*T<%lO(dr!0S]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y!0{#Y#o(d#s;'S(d;'S;=`*T<%lO(dr!1SZ#OQlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dt!1z]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#g(d#g#h!2s#h#o(d#s;'S(d;'S;=`*T<%lO(dt!2x]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#i(d#i#j!3q#j#o(d#s;'S(d;'S;=`*T<%lO(dt!3v]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#a(d#a#b!4o#b#o(d#s;'S(d;'S;=`*T<%lO(dt!4t]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y!5m#Y#o(d#s;'S(d;'S;=`*T<%lO(dt!5r]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g!6k#g#o(d#s;'S(d;'S;=`*T<%lO(dt!6rZ!kSlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dr!7j]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#b(d#b#c!8c#c#o(d#s;'S(d;'S;=`*T<%lO(dr!8h]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i!9a#i#o(d#s;'S(d;'S;=`*T<%lO(dr!9f]lpOp(drs)[sv(dwx(dxy!:_z|(d}!^(d!a#Q(d#R#S!:j#S#o(d#s;'S(d;'S;=`*T<%lO(dQ!:bPyz!:eQ!:jO!vQr!:o]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#c(d#c#d!;h#d#o(d#s;'S(d;'S;=`*T<%lO(dr!;m]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#j(d#j#k!<f#k#o(d#s;'S(d;'S;=`*T<%lO(dr!<k]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y!=d#Y#o(d#s;'S(d;'S;=`*T<%lO(dr!=i]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g!>b#g#o(d#s;'S(d;'S;=`*T<%lO(dr!>g[lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#S!?]#S#o(d#s;'S(d;'S;=`*T<%lO(dr!?b]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i!@Z#i#o(d#s;'S(d;'S;=`*T<%lO(dr!@`]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#](d#]#^!AX#^#o(d#s;'S(d;'S;=`*T<%lO(dr!A^]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#a(d#a#b!BV#b#o(d#s;'S(d;'S;=`*T<%lO(dr!B[]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y!CT#Y#o(d#s;'S(d;'S;=`*T<%lO(dr!C[Z#RQlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dv!DS]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#i(d#i#j!D{#j#o(d#s;'S(d;'S;=`*T<%lO(dv!EQ]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g!Ey#g#o(d#s;'S(d;'S;=`*T<%lO(dv!FO]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#T(d#T#U!Fw#U#o(d#s;'S(d;'S;=`*T<%lO(dv!F|]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i!Gu#i#o(d#s;'S(d;'S;=`*T<%lO(dv!Gz]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#](d#]#^!Hs#^#o(d#s;'S(d;'S;=`*T<%lO(dv!Hx]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#c(d#c#d!Iq#d#o(d#s;'S(d;'S;=`*T<%lO(dv!Iv]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#b(d#b#c!Jo#c#o(d#s;'S(d;'S;=`*T<%lO(dv!JvZ!mUlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dt!Kn]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g!Lg#g#o(d#s;'S(d;'S;=`*T<%lO(dt!Ll]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g!Me#g#o(d#s;'S(d;'S;=`*T<%lO(dt!Mj]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#c(d#c#d!Nc#d#o(d#s;'S(d;'S;=`*T<%lO(dt!Nh]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g# a#g#o(d#s;'S(d;'S;=`*T<%lO(dt# hZ!dSlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dt#!`]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#T(d#T#U##X#U#o(d#s;'S(d;'S;=`*T<%lO(dt##^]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#`(d#`#a#$V#a#o(d#s;'S(d;'S;=`*T<%lO(dt#$[]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#g(d#g#h#%T#h#o(d#s;'S(d;'S;=`*T<%lO(dt#%Y]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y#&R#Y#o(d#s;'S(d;'S;=`*T<%lO(dt#&YZ!aSlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dt#'Q]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#b(d#b#c#'y#c#o(d#s;'S(d;'S;=`*T<%lO(dt#(O]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i#(w#i#o(d#s;'S(d;'S;=`*T<%lO(dt#(|]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y#)u#Y#o(d#s;'S(d;'S;=`*T<%lO(dt#)z]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g#*s#g#o(d#s;'S(d;'S;=`*T<%lO(dt#*x]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#b(d#b#c#+q#c#o(d#s;'S(d;'S;=`*T<%lO(dt#+v]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#T(d#T#U#,o#U#o(d#s;'S(d;'S;=`*T<%lO(dt#,t]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#`(d#`#a#-m#a#o(d#s;'S(d;'S;=`*T<%lO(dt#-tZ!gSlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dv#.l]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#](d#]#^#/e#^#o(d#s;'S(d;'S;=`*T<%lO(dv#/j]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#b(d#b#c#0c#c#o(d#s;'S(d;'S;=`*T<%lO(dv#0h]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#W(d#W#X#1a#X#o(d#s;'S(d;'S;=`*T<%lO(dv#1hZ!nUlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dr#2`_lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#T(d#T#U#3_#U#](d#]#^#>m#^#o(d#s;'S(d;'S;=`*T<%lO(dr#3d]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#l(d#l#m#4]#m#o(d#s;'S(d;'S;=`*T<%lO(dr#4d[!wQlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#S#5Y#S#o(d#s;'S(d;'S;=`*T<%lO(dr#5_]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#c(d#c#d#6W#d#o(d#s;'S(d;'S;=`*T<%lO(dr#6]]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#j(d#j#k#7U#k#o(d#s;'S(d;'S;=`*T<%lO(dr#7Z]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y#8S#Y#o(d#s;'S(d;'S;=`*T<%lO(dr#8X]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g#9Q#g#o(d#s;'S(d;'S;=`*T<%lO(dr#9V[lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#S#9{#S#o(d#s;'S(d;'S;=`*T<%lO(dr#:Q]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i#:y#i#o(d#s;'S(d;'S;=`*T<%lO(dr#;O]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#](d#]#^#;w#^#o(d#s;'S(d;'S;=`*T<%lO(dr#;|]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#a(d#a#b#<u#b#o(d#s;'S(d;'S;=`*T<%lO(dr#<z]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y#=s#Y#o(d#s;'S(d;'S;=`*T<%lO(dr#=zZ#TQlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dr#>r]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#b(d#b#c#?k#c#o(d#s;'S(d;'S;=`*T<%lO(dr#?r[!xQlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#S#@h#S#o(d#s;'S(d;'S;=`*T<%lO(dr#@m]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#c(d#c#d#Af#d#o(d#s;'S(d;'S;=`*T<%lO(dr#Ak]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#j(d#j#k#Bd#k#o(d#s;'S(d;'S;=`*T<%lO(dr#Bi]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y#Cb#Y#o(d#s;'S(d;'S;=`*T<%lO(dr#Cg]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g#D`#g#o(d#s;'S(d;'S;=`*T<%lO(dr#De[lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#S#EZ#S#o(d#s;'S(d;'S;=`*T<%lO(dr#E`]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i#FX#i#o(d#s;'S(d;'S;=`*T<%lO(dr#F^]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#](d#]#^#GV#^#o(d#s;'S(d;'S;=`*T<%lO(dr#G[]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#a(d#a#b#HT#b#o(d#s;'S(d;'S;=`*T<%lO(dr#HY]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y#IR#Y#o(d#s;'S(d;'S;=`*T<%lO(dr#IYZ#UQlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dv#JQ_lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#T(d#T#U#KP#U#](d#]#^#Mu#^#o(d#s;'S(d;'S;=`*T<%lO(dv#KU]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#a(d#a#b#K}#b#o(d#s;'S(d;'S;=`*T<%lO(dv#LS]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y#L{#Y#o(d#s;'S(d;'S;=`*T<%lO(dv#MSZ!oUlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dt#Mz]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#`(d#`#a#Ns#a#o(d#s;'S(d;'S;=`*T<%lO(dt#NzZ!bSlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dt$ r]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#_(d#_#`$!k#`#o(d#s;'S(d;'S;=`*T<%lO(dt$!rZ!cSlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(d~$#j_lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#T(d#T#U$$i#U#f(d#f#g$)Z#g#o(d#s;'S(d;'S;=`*T<%lO(d~$$n]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g$%g#g#o(d#s;'S(d;'S;=`*T<%lO(d~$%l]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y$&e#Y#o(d#s;'S(d;'S;=`*T<%lO(d~$&j]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#b(d#b#c$'c#c#o(d#s;'S(d;'S;=`*T<%lO(d~$'h]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i$(a#i#o(d#s;'S(d;'S;=`*T<%lO(d~$(hZj~lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dt$)`]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#c(d#c#d$*X#d#o(d#s;'S(d;'S;=`*T<%lO(dt$*^]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#W(d#W#X$+V#X#o(d#s;'S(d;'S;=`*T<%lO(dt$+[]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#i(d#i#j$,T#j#o(d#s;'S(d;'S;=`*T<%lO(dt$,Y]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#V(d#V#W$-R#W#o(d#s;'S(d;'S;=`*T<%lO(dt$-W]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y$.P#Y#o(d#s;'S(d;'S;=`*T<%lO(dt$.U]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g$.}#g#o(d#s;'S(d;'S;=`*T<%lO(dt$/UZ!jSlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dr$/|]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#i(d#i#j$0u#j#o(d#s;'S(d;'S;=`*T<%lO(dr$0z]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#T(d#T#U$1s#U#o(d#s;'S(d;'S;=`*T<%lO(dr$1x]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#b(d#b#c$2q#c#o(d#s;'S(d;'S;=`*T<%lO(dr$2v]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i$3o#i#o(d#s;'S(d;'S;=`*T<%lO(dr$3t]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#](d#]#^$4m#^#o(d#s;'S(d;'S;=`*T<%lO(dr$4r]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#`(d#`#a$5k#a#o(d#s;'S(d;'S;=`*T<%lO(dr$5p]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y$6i#Y#o(d#s;'S(d;'S;=`*T<%lO(dr$6n[lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#S$7d#S#o(d#s;'S(d;'S;=`*T<%lO(dr$7i]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#c(d#c#d$8b#d#o(d#s;'S(d;'S;=`*T<%lO(dr$8g]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#j(d#j#k$9`#k#o(d#s;'S(d;'S;=`*T<%lO(dr$9e]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y$:^#Y#o(d#s;'S(d;'S;=`*T<%lO(dr$:c]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g$;[#g#o(d#s;'S(d;'S;=`*T<%lO(dr$;a[lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#S$<V#S#o(d#s;'S(d;'S;=`*T<%lO(dr$<[]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i$=T#i#o(d#s;'S(d;'S;=`*T<%lO(dr$=Y]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#](d#]#^$>R#^#o(d#s;'S(d;'S;=`*T<%lO(dr$>W]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#a(d#a#b$?P#b#o(d#s;'S(d;'S;=`*T<%lO(dr$?U]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y$?}#Y#o(d#s;'S(d;'S;=`*T<%lO(dr$@UZ#VQlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(d~$@|alpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#T(d#T#U$BR#U#X(d#X#Y$Dw#Y#c(d#c#d$Ke#d#o(d#s;'S(d;'S;=`*T<%lO(dr$BW]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i$CP#i#o(d#s;'S(d;'S;=`*T<%lO(dr$CU]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y$C}#Y#o(d#s;'S(d;'S;=`*T<%lO(dr$DUZ#QQlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(d~$D|]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#g(d#g#h$Eu#h#o(d#s;'S(d;'S;=`*T<%lO(d~$Ez]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#c(d#c#d$Fs#d#o(d#s;'S(d;'S;=`*T<%lO(d~$Fx]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#i(d#i#j$Gq#j#o(d#s;'S(d;'S;=`*T<%lO(d~$Gv]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g$Ho#g#o(d#s;'S(d;'S;=`*T<%lO(d~$Ht]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#V(d#V#W$Im#W#o(d#s;'S(d;'S;=`*T<%lO(d~$Ir]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y$Jk#Y#o(d#s;'S(d;'S;=`*T<%lO(d~$JrZm~lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dv$Kj]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#c(d#c#d$Lc#d#o(d#s;'S(d;'S;=`*T<%lO(dv$Lh]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i$Ma#i#o(d#s;'S(d;'S;=`*T<%lO(dv$Mf_lpOp(drs)[sv(dwx(dz|(d}!^(d!a!p(d!p!q$Ne!q!u(d!u!v%$X!v#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dv$Nj]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#T(d#T#U% c#U#o(d#s;'S(d;'S;=`*T<%lO(dv% h]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#a(d#a#b%!a#b#o(d#s;'S(d;'S;=`*T<%lO(dv%!f]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y%#_#Y#o(d#s;'S(d;'S;=`*T<%lO(dv%#fZ!pUlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dv%$^]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y%%V#Y#o(d#s;'S(d;'S;=`*T<%lO(dv%%[]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g%&T#g#o(d#s;'S(d;'S;=`*T<%lO(dv%&Y]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#j(d#j#k%'R#k#o(d#s;'S(d;'S;=`*T<%lO(dv%'W]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#](d#]#^%(P#^#o(d#s;'S(d;'S;=`*T<%lO(dv%(U]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#V(d#V#W%(}#W#o(d#s;'S(d;'S;=`*T<%lO(dv%)S]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y%){#Y#o(d#s;'S(d;'S;=`*T<%lO(dv%*Q]lpOp(drs)[sv(dwx(dz|(d}!^(d!a!p(d!p!q%*y!q#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dv%+O]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#T(d#T#U%+w#U#o(d#s;'S(d;'S;=`*T<%lO(dv%+|]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#a(d#a#b%,u#b#o(d#s;'S(d;'S;=`*T<%lO(dv%,z]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y%-s#Y#o(d#s;'S(d;'S;=`*T<%lO(dv%-zZ!qUlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(d~%.rblpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y%/z#Y#d(d#d#e%8f#e#h(d#h#i%;[#i#j%Fp#j#o(d#s;'S(d;'S;=`*T<%lO(dv%0P_lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#`(d#`#a%1O#a#f(d#f#g%4r#g#o(d#s;'S(d;'S;=`*T<%lO(dr%1T]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y%1|#Y#o(d#s;'S(d;'S;=`*T<%lO(dr%2R]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#V(d#V#W%2z#W#o(d#s;'S(d;'S;=`*T<%lO(dr%3P]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i%3x#i#o(d#s;'S(d;'S;=`*T<%lO(dr%4PZ!}QlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dt%4w]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#j(d#j#k%5p#k#o(d#s;'S(d;'S;=`*T<%lO(dt%5u]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y%6n#Y#o(d#s;'S(d;'S;=`*T<%lO(dt%6s]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g%7l#g#o(d#s;'S(d;'S;=`*T<%lO(dt%7sZ!hSlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(d~%8k]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#T(d#T#U%9d#U#o(d#s;'S(d;'S;=`*T<%lO(d~%9i]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#b(d#b#c%:b#c#o(d#s;'S(d;'S;=`*T<%lO(d~%:iZn~lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dv%;a]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#T(d#T#U%<Y#U#o(d#s;'S(d;'S;=`*T<%lO(dv%<_]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i%=W#i#o(d#s;'S(d;'S;=`*T<%lO(dv%=]]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#i(d#i#j%>U#j#o(d#s;'S(d;'S;=`*T<%lO(dv%>Z]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#g(d#g#h%?S#h#o(d#s;'S(d;'S;=`*T<%lO(dv%?Z]!rUlpOp(drs)[sv(dwx(dz|(d}!^(d!a!o(d!o!p%@S!p#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dv%@X]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y%AQ#Y#o(d#s;'S(d;'S;=`*T<%lO(dv%AV]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#g(d#g#h%BO#h#o(d#s;'S(d;'S;=`*T<%lO(dv%BT]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#g(d#g#h%B|#h#o(d#s;'S(d;'S;=`*T<%lO(dv%CR]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#T(d#T#U%Cz#U#o(d#s;'S(d;'S;=`*T<%lO(dv%DP]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#Z(d#Z#[%Dx#[#o(d#s;'S(d;'S;=`*T<%lO(dv%D}]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y%Ev#Y#o(d#s;'S(d;'S;=`*T<%lO(dv%E}Z!sUlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dr%Fu]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#a(d#a#b%Gn#b#o(d#s;'S(d;'S;=`*T<%lO(dr%GuZ!zQlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dv%Hm]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g%If#g#o(d#s;'S(d;'S;=`*T<%lO(dv%Ik_lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#T(d#T#U%Jj#U#i(d#i#j&'O#j#o(d#s;'S(d;'S;=`*T<%lO(dv%Jo]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#V(d#V#W%Kh#W#o(d#s;'S(d;'S;=`*T<%lO(dv%Km]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y%Lf#Y#o(d#s;'S(d;'S;=`*T<%lO(dv%Lk]lpOp(drs)[sv(dwx(dz|(d}!^(d!a!f(d!f!g%Md!g#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dv%Mi]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#i(d#i#j%Nb#j#o(d#s;'S(d;'S;=`*T<%lO(dv%Ng]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#f(d#f#g& `#g#o(d#s;'S(d;'S;=`*T<%lO(dv& e]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#T(d#T#U&!^#U#o(d#s;'S(d;'S;=`*T<%lO(dv&!c]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i&#[#i#o(d#s;'S(d;'S;=`*T<%lO(dv&#a]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#](d#]#^&$Y#^#o(d#s;'S(d;'S;=`*T<%lO(dv&$_]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#c(d#c#d&%W#d#o(d#s;'S(d;'S;=`*T<%lO(dv&%]]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#b(d#b#c&&U#c#o(d#s;'S(d;'S;=`*T<%lO(dv&&]Z!tUlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dt&'T]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y&'|#Y#o(d#s;'S(d;'S;=`*T<%lO(dt&(TZ!`SlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dt&({]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#b(d#b#c&)t#c#o(d#s;'S(d;'S;=`*T<%lO(dt&)y]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#g(d#g#h&*r#h#o(d#s;'S(d;'S;=`*T<%lO(dt&*w_lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y&+v#Y#d(d#d#e&-n#e#o(d#s;'S(d;'S;=`*T<%lO(dt&+{]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#h(d#h#i&,t#i#o(d#s;'S(d;'S;=`*T<%lO(dt&,{Z!eSlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(dt&-s]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y&.l#Y#o(d#s;'S(d;'S;=`*T<%lO(dt&.q]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#V(d#V#W&/j#W#o(d#s;'S(d;'S;=`*T<%lO(dt&/o]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#](d#]#^&0h#^#o(d#s;'S(d;'S;=`*T<%lO(dt&0m]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#Y(d#Y#Z&1f#Z#o(d#s;'S(d;'S;=`*T<%lO(dt&1k]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#](d#]#^&2d#^#o(d#s;'S(d;'S;=`*T<%lO(dt&2i]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#X(d#X#Y&3b#Y#o(d#s;'S(d;'S;=`*T<%lO(dt&3g]lpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#W(d#W#X&4`#X#o(d#s;'S(d;'S;=`*T<%lO(dt&4gZ!fSlpOp(drs)[sv(dwx(dz|(d}!^(d!a#Q(d#R#o(d#s;'S(d;'S;=`*T<%lO(d~&5_O![~~&5dPZ~#p#q&5g~&5lOY~~&5qO!]~!t&5xO!Z!db`\",\n  tokenizers: [1, 2, 3, 4, 5, 6, new LocalTokenGroup(\"j~RQYZXz{^~^O!V~~aP!P!Qd~iO!W~~\", 25, 52)],\n  topRules: {\"TraceQL\":[0,3]},\n  tokenPrec: 1223\n});\n// This file was generated by lezer-generator. You probably shouldn't edit it.\nconst LineComment = 1,\n  BlockComment = 2,\n  TraceQL = 3,\n  SpansetPipelineExpression = 4,\n  And = 5,\n  Gt = 6,\n  Desc = 7,\n  Lt = 8,\n  Anc = 9,\n  Or = 10,\n  Pipe = 11,\n  ExperimentalOp = 12,\n  WrappedSpansetPipeline = 13,\n  SpansetPipeline = 14,\n  SpansetExpression = 15,\n  SpansetFilter = 16,\n  FieldExpression = 17,\n  FieldOp = 18,\n  Static = 19,\n  String = 20,\n  Integer = 21,\n  Float = 22,\n  Duration = 23,\n  TemplateVariable = 24,\n  IntrinsicField = 25,\n  Parent = 26,\n  AttributeField = 27,\n  Identifier = 28,\n  Resource = 29,\n  Span = 30,\n  ScalarFilter = 31,\n  ScalarExpression = 32,\n  ScalarOp = 33,\n  Aggregate = 34,\n  AggregateExpression = 35,\n  ComparisonOp = 36,\n  GroupOperation = 37,\n  SelectOperation = 38,\n  SelectArgs = 39,\n  CoalesceOperation = 40,\n  MetricsOperation = 41,\n  MetricsOperationType = 42,\n  MetricsArgs = 43,\n  MetricsQuery = 44,\n  MetricsQueryExpression = 45;\n\nexport { Aggregate, AggregateExpression, Anc, And, AttributeField, BlockComment, CoalesceOperation, ComparisonOp, Desc, Duration, ExperimentalOp, FieldExpression, FieldOp, Float, GroupOperation, Gt, Identifier, Integer, IntrinsicField, LineComment, Lt, MetricsArgs, MetricsOperation, MetricsOperationType, MetricsQuery, MetricsQueryExpression, Or, Parent, Pipe, Resource, ScalarExpression, ScalarFilter, ScalarOp, SelectArgs, SelectOperation, Span, SpansetExpression, SpansetFilter, SpansetPipeline, SpansetPipelineExpression, Static, String, TemplateVariable, TraceQL, WrappedSpansetPipeline, parser };\n","import { SyntaxNode, Tree } from '@lezer/common';\n\nimport {\n  Aggregate,\n  And,\n  AttributeField,\n  ComparisonOp,\n  FieldExpression,\n  FieldOp,\n  GroupOperation,\n  IntrinsicField,\n  Or,\n  parser,\n  Pipe,\n  ScalarFilter,\n  SelectArgs,\n  SelectOperation,\n  SpansetFilter,\n  SpansetPipeline,\n  SpansetPipelineExpression,\n  Static,\n  String as StringNode,\n  TraceQL,\n} from '@grafana/lezer-traceql';\n\ntype Direction = 'parent' | 'firstChild' | 'lastChild' | 'nextSibling' | 'prevSibling';\ntype NodeType = number;\n\nexport type Situation = { query: string } & SituationType;\n\nexport type SituationType =\n  | {\n      type: 'UNKNOWN';\n    }\n  | {\n      type: 'EMPTY';\n    }\n  | {\n      type: 'SPANSET_EMPTY';\n    }\n  | {\n      type: 'SPANSET_ONLY_DOT';\n    }\n  | {\n      type: 'SPANSET_EXPRESSION_OPERATORS';\n    }\n  | {\n      type: 'SPANFIELD_COMBINING_OPERATORS';\n    }\n  | {\n      type: 'SPANSET_IN_NAME';\n    }\n  | {\n      type: 'SPANSET_IN_NAME_SCOPE';\n      scope: string;\n    }\n  | {\n      type: 'SPANSET_IN_VALUE';\n      tagName: string;\n      betweenQuotes: boolean;\n    }\n  | {\n      type: 'SPANSET_AFTER_VALUE';\n    }\n  | {\n      type: 'SPANSET_COMBINING_OPERATORS';\n    }\n  | {\n      type: 'SPANSET_PIPELINE_AFTER_OPERATOR';\n    }\n  | {\n      type: 'SPANSET_IN_THE_MIDDLE';\n    }\n  | {\n      type: 'SPANSET_EXPRESSION_OPERATORS_WITH_MISSING_CLOSED_BRACE';\n    }\n  | {\n      type: 'NEW_SPANSET';\n    }\n  | {\n      type: 'ATTRIBUTE_FOR_FUNCTION';\n    }\n  | {\n      type: 'SPANSET_COMPARISON_OPERATORS';\n    };\n\ntype Path = Array<[Direction, NodeType[]]>;\n\ntype Resolver = {\n  path: NodeType[];\n  fun: (node: SyntaxNode, text: string, pos: number, originalPos: number) => SituationType | void;\n};\n\nfunction getErrorNode(tree: Tree, cursorPos: number): SyntaxNode | null {\n  const cur = tree.cursorAt(cursorPos);\n  do {\n    if (cur.from === cursorPos || cur.to === cursorPos) {\n      const { node } = cur;\n      if (node.type.isError) {\n        return node;\n      }\n    }\n  } while (cur.next());\n  return null;\n}\n\nfunction move(node: SyntaxNode, direction: Direction): SyntaxNode | null {\n  return node[direction];\n}\n\nfunction walk(node: SyntaxNode, path: Path): SyntaxNode | null {\n  let current: SyntaxNode | null = node;\n  for (const [direction, expectedNodeIDs] of path) {\n    current = move(current, direction);\n    if (current === null) {\n      // we could not move in the direction, we stop\n      return null;\n    }\n\n    // note that the found value can be 0, which is acceptable\n    if (expectedNodeIDs.find((id) => id === current?.type.id) === undefined) {\n      // the reached node has wrong type, we stop\n      return null;\n    }\n  }\n  return current;\n}\n\nfunction getNodeText(node: SyntaxNode, text: string): string {\n  // if the from and to are them same (e.g. for an error node) we can subtract 1 from the start/from index\n  return text.slice(node.from === node.to ? node.from - 1 : node.from, node.to);\n}\n\nfunction isPathMatch(resolverPath: NodeType[], cursorPath: number[]): boolean {\n  return resolverPath.every((item, index) => item === cursorPath[index]);\n}\n\n/**\n * Figure out where is the cursor and what kind of suggestions are appropriate.\n * @param text the user input\n * @param offset the position of the cursor (starting from 0) in the user input\n */\nexport function getSituation(text: string, offset: number): Situation | null {\n  // there is a special case when we are at the start of writing text,\n  // so we handle that case first\n  if (text === '') {\n    return {\n      query: text,\n      type: 'EMPTY',\n    };\n  }\n\n  const tree = parser.parse(text);\n\n  // Whitespaces (especially when multiple) on the left of the text cursor can trick the Lezer parser,\n  // causing a wrong tree cursor to be picked.\n  // Example: `{ span.foo =     }`, with `` being the cursor, tricks the parser.\n  // Quick and dirty hack: Shift the cursor to the left until we find a non-whitespace character on its left.\n  let shiftedOffset = offset;\n  while (shiftedOffset - 1 >= 0 && text[shiftedOffset - 1] === ' ') {\n    shiftedOffset -= 1;\n  }\n\n  // if the tree contains error, it is very probable that\n  // our node is one of those error nodes.\n  // also, if there are errors, the node lezer finds us,\n  // might not be the best node.\n  // so first we check if there is an error node at the cursor position\n  let maybeErrorNode = getErrorNode(tree, shiftedOffset);\n  if (!maybeErrorNode) {\n    // try again with the previous character\n    maybeErrorNode = getErrorNode(tree, shiftedOffset - 1);\n  }\n\n  const cur = maybeErrorNode != null ? maybeErrorNode.cursor() : tree.cursorAt(shiftedOffset);\n\n  const currentNode = cur.node;\n  const ids = [cur.type.id];\n  while (cur.parent()) {\n    ids.push(cur.type.id);\n  }\n\n  let situationType: SituationType | void = undefined;\n  for (let resolver of RESOLVERS) {\n    if (isPathMatch(resolver.path, ids)) {\n      situationType = resolver.fun(currentNode, text, shiftedOffset, offset);\n    }\n  }\n\n  return { query: text, ...(situationType ?? { type: 'UNKNOWN' }) };\n}\n\nconst ERROR_NODE_ID = 0;\n\nconst RESOLVERS: Resolver[] = [\n  // Curson on error node cases\n  {\n    path: [ERROR_NODE_ID, AttributeField],\n    fun: resolveAttribute,\n  },\n  {\n    path: [ERROR_NODE_ID, FieldExpression],\n    fun: resolveExpression,\n  },\n  {\n    path: [ERROR_NODE_ID, SpansetFilter],\n    fun: resolveSpansetWithNoClosedBrace,\n  },\n  {\n    path: [ERROR_NODE_ID, Aggregate],\n    fun: resolveAttributeForFunction,\n  },\n  {\n    path: [ERROR_NODE_ID, IntrinsicField],\n    fun: resolveAttributeForFunction,\n  },\n  {\n    path: [ERROR_NODE_ID, GroupOperation],\n    fun: resolveAttributeForFunction,\n  },\n  {\n    path: [ERROR_NODE_ID, SelectOperation],\n    fun: resolveAttributeForFunction,\n  },\n  {\n    path: [ERROR_NODE_ID, SpansetPipelineExpression],\n    fun: resolveSpansetPipeline,\n  },\n  {\n    path: [ERROR_NODE_ID, ScalarFilter, SpansetPipeline],\n    fun: resolveArithmeticOperator,\n  },\n  // Curson on valid node cases (the whole query could contain errors nevertheless)\n  {\n    path: [FieldExpression],\n    fun: resolveSpanset,\n  },\n  {\n    path: [SpansetFilter],\n    fun: resolveSpanset,\n  },\n  {\n    path: [SpansetPipelineExpression],\n    fun: resolveNewSpansetExpression,\n  },\n  {\n    path: [TraceQL],\n    fun: resolveNewSpansetExpression,\n  },\n  {\n    path: [StringNode, Static],\n    fun: resolveExpression,\n  },\n];\n\nconst resolveAttributeCompletion = (node: SyntaxNode, text: string, pos: number): SituationType | void => {\n  // The user is completing an expression. We can take advantage of the fact that the Monaco editor is smart\n  // enough to automatically detect that there are some characters before the cursor and to take them into\n  // account when providing suggestions.\n  const getAttributeFieldUpToDot = (node: SyntaxNode) => {\n    const attributeFieldParent = walk(node, [['firstChild', [AttributeField]]]);\n    const attributeFieldParentText = attributeFieldParent ? getNodeText(attributeFieldParent, text) : '';\n    const indexOfDot = attributeFieldParentText.indexOf('.');\n    return attributeFieldParentText.slice(0, indexOfDot);\n  };\n\n  // If there is a space, for sure the attribute is completed and no suggestions to complete it should be provided\n  if (text[pos - 1] === ' ') {\n    return;\n  }\n\n  const endOfPathNode = walk(node, [['firstChild', [FieldExpression]]]);\n  if (endOfPathNode) {\n    return {\n      type: 'SPANSET_IN_NAME_SCOPE',\n      scope: getAttributeFieldUpToDot(endOfPathNode),\n    };\n  }\n\n  const endOfPathNode2 = walk(node, [\n    ['parent', [SpansetFilter]],\n    ['firstChild', [FieldExpression]],\n  ]);\n  // In this case, we also need to check the character at `pos`\n  if (endOfPathNode2 && text[pos] !== ' ') {\n    return {\n      type: 'SPANSET_IN_NAME_SCOPE',\n      scope: getAttributeFieldUpToDot(endOfPathNode2),\n    };\n  }\n};\n\nfunction resolveSpanset(node: SyntaxNode, text: string, _: number, originalPos: number): SituationType {\n  const situation = resolveAttributeCompletion(node, text, originalPos);\n  if (situation) {\n    return situation;\n  }\n\n  let endOfPathNode = walk(node, [\n    ['firstChild', [FieldExpression]],\n    ['firstChild', [AttributeField]],\n  ]);\n  if (endOfPathNode) {\n    return {\n      type: 'SPANSET_EXPRESSION_OPERATORS',\n    };\n  }\n\n  endOfPathNode = walk(node, [\n    ['lastChild', [FieldExpression]],\n    ['lastChild', [FieldExpression]],\n    ['lastChild', [Static]],\n  ]);\n  if (endOfPathNode) {\n    return {\n      type: 'SPANFIELD_COMBINING_OPERATORS',\n    };\n  }\n\n  endOfPathNode = walk(node, [['lastChild', [FieldExpression]]]);\n  if (endOfPathNode) {\n    return {\n      type: 'SPANSET_EXPRESSION_OPERATORS',\n    };\n  }\n\n  return {\n    type: 'SPANSET_EMPTY',\n  };\n}\n\nfunction resolveAttribute(node: SyntaxNode, text: string): SituationType {\n  const attributeFieldParent = walk(node, [['parent', [AttributeField]]]);\n  const attributeFieldParentText = attributeFieldParent ? getNodeText(attributeFieldParent, text) : '';\n\n  if (attributeFieldParentText === '.') {\n    return {\n      type: 'SPANSET_ONLY_DOT',\n    };\n  }\n\n  const indexOfDot = attributeFieldParentText.indexOf('.');\n  const attributeFieldUpToDot = attributeFieldParentText.slice(0, indexOfDot);\n\n  if (['span', 'resource', 'parent'].find((item) => item === attributeFieldUpToDot)) {\n    return {\n      type: 'SPANSET_IN_NAME_SCOPE',\n      scope: attributeFieldUpToDot,\n    };\n  }\n  return {\n    type: 'SPANSET_IN_NAME',\n  };\n}\n\nfunction resolveExpression(node: SyntaxNode, text: string, _: number, originalPos: number): SituationType {\n  const situation = resolveAttributeCompletion(node, text, originalPos);\n  if (situation) {\n    return situation;\n  }\n\n  if (\n    walk(node, [\n      ['parent', [Static]],\n      ['parent', [FieldExpression]],\n      ['prevSibling', [FieldOp]],\n    ])\n  ) {\n    let attributeField = node.parent?.parent?.prevSibling?.prevSibling;\n    if (attributeField) {\n      return {\n        type: 'SPANSET_IN_VALUE',\n        tagName: getNodeText(attributeField, text),\n        betweenQuotes: true,\n      };\n    }\n  }\n\n  if (node.prevSibling?.type.id === FieldOp) {\n    let attributeField = node.prevSibling?.prevSibling;\n    if (attributeField) {\n      return {\n        type: 'SPANSET_IN_VALUE',\n        tagName: getNodeText(attributeField, text),\n        betweenQuotes: false,\n      };\n    }\n  }\n\n  if (node.prevSibling?.type.name === 'And' || node.prevSibling?.type.name === 'Or') {\n    return {\n      type: 'SPANSET_EMPTY',\n    };\n  }\n\n  return {\n    type: 'SPANSET_IN_THE_MIDDLE',\n  };\n}\n\nfunction resolveArithmeticOperator(node: SyntaxNode, _0: string, _1: number): SituationType | void {\n  if (node.prevSibling?.type.id !== ComparisonOp) {\n    return {\n      type: 'SPANSET_COMPARISON_OPERATORS',\n    };\n  }\n}\n\nfunction resolveNewSpansetExpression(node: SyntaxNode, text: string, offset: number): SituationType {\n  // Select the node immediately before the one pointed by the cursor\n  let previousNode = node.firstChild;\n  try {\n    previousNode = node.firstChild;\n    while (previousNode!.to < offset) {\n      previousNode = previousNode!.nextSibling;\n    }\n  } catch (error) {\n    console.error('Unexpected error while searching for previous node', error);\n  }\n\n  if (previousNode?.type.id === And || previousNode?.type.id === Or) {\n    return {\n      type: 'NEW_SPANSET',\n    };\n  }\n\n  return {\n    type: 'SPANSET_COMBINING_OPERATORS',\n  };\n}\n\nfunction resolveAttributeForFunction(node: SyntaxNode, _0: string, _1: number): SituationType | void {\n  const parent = node?.parent;\n  if (!!parent && [IntrinsicField, Aggregate, GroupOperation, SelectOperation, SelectArgs].includes(parent.type.id)) {\n    return {\n      type: 'ATTRIBUTE_FOR_FUNCTION',\n    };\n  }\n}\n\nfunction resolveSpansetPipeline(node: SyntaxNode, _1: string, _2: number): SituationType {\n  if (node.prevSibling?.type.id === Pipe) {\n    return {\n      type: 'SPANSET_PIPELINE_AFTER_OPERATOR',\n    };\n  }\n  return {\n    type: 'NEW_SPANSET',\n  };\n}\n\nfunction resolveSpansetWithNoClosedBrace(node: SyntaxNode, text: string, originalPos: number): SituationType {\n  const situation = resolveAttributeCompletion(node, text, originalPos);\n  if (situation) {\n    return situation;\n  }\n\n  return {\n    type: 'SPANSET_EXPRESSION_OPERATORS_WITH_MISSING_CLOSED_BRACE',\n  };\n}\n","import { IMarkdownString } from 'monaco-editor';\n\nimport { SelectableValue } from '@grafana/data';\nimport { isFetchError } from '@grafana/runtime';\nimport type { Monaco, monacoTypes } from '@grafana/ui';\n\nimport TempoLanguageProvider from '../language_provider';\n\nimport { getSituation, Situation } from './situation';\nimport { intrinsics, scopes } from './traceql';\n\ninterface Props {\n  languageProvider: TempoLanguageProvider;\n  setAlertText: (text?: string) => void;\n}\n\ntype MinimalCompletionItem = {\n  label: string;\n  insertText: string;\n  detail?: string;\n  documentation?: string | IMarkdownString;\n};\n\n/**\n * Class that implements CompletionItemProvider interface and allows us to provide suggestion for the Monaco\n * autocomplete system.\n *\n * Here we want to provide suggestions for TraceQL. Please refer to\n * https://grafana.com/docs/tempo/latest/traceql for the syntax of the language.\n */\nexport class CompletionProvider implements monacoTypes.languages.CompletionItemProvider {\n  languageProvider: TempoLanguageProvider;\n  registerInteractionCommandId: string | null;\n  setAlertText: (text?: string) => void;\n\n  constructor(props: Props) {\n    this.languageProvider = props.languageProvider;\n    this.setAlertText = props.setAlertText;\n    this.registerInteractionCommandId = null;\n  }\n\n  triggerCharacters = ['{', '.', '[', '(', '=', '~', ' ', '\"'];\n\n  // Operators\n  static readonly arithmeticOps: MinimalCompletionItem[] = [\n    {\n      label: '+',\n      insertText: '+',\n      detail: 'Plus',\n    },\n    {\n      label: '-',\n      insertText: '-',\n      detail: 'Minus',\n    },\n    {\n      label: '*',\n      insertText: '*',\n      detail: 'Times',\n    },\n    {\n      label: '/',\n      insertText: '/',\n      detail: 'Over',\n    },\n  ];\n\n  static readonly logicalOps: MinimalCompletionItem[] = [\n    {\n      label: '&&',\n      insertText: '&&',\n      detail: 'And',\n      documentation: 'And (intersection) operator. Checks that both conditions found matches.',\n    },\n    {\n      label: '||',\n      insertText: '||',\n      detail: 'Or',\n      documentation: 'Or (union) operator. Checks that either condition found matches.',\n    },\n  ];\n\n  static readonly comparisonOps: MinimalCompletionItem[] = [\n    {\n      label: '=',\n      insertText: '=',\n      detail: 'Equality',\n    },\n    {\n      label: '!=',\n      insertText: '!=',\n      detail: 'Inequality',\n    },\n    {\n      label: '>',\n      insertText: '>',\n      detail: 'Greater than',\n    },\n    {\n      label: '>=',\n      insertText: '>=',\n      detail: 'Greater than or equal to',\n    },\n    {\n      label: '<',\n      insertText: '<',\n      detail: 'Less than',\n    },\n    {\n      label: '<=',\n      insertText: '<=',\n      detail: 'Less than or equal to',\n    },\n    {\n      label: '=~',\n      insertText: '=~',\n      detail: 'Regular expression',\n    },\n    {\n      label: '!~',\n      insertText: '!~',\n      detail: 'Negated regular expression',\n    },\n  ];\n  static readonly structuralOps: MinimalCompletionItem[] = [\n    {\n      label: '>>',\n      insertText: '>>',\n      detail: 'Descendant',\n      documentation:\n        'Descendant operator. Looks for spans matching {condB} that are descendants of a span matching {condA}',\n    },\n    {\n      label: '>',\n      insertText: '>',\n      detail: 'Child',\n      documentation:\n        'Child operator. Looks for spans matching {condB} that are direct child spans of a parent matching {condA}',\n    },\n    {\n      label: '<<',\n      insertText: '<<',\n      detail: 'Ancestor',\n      documentation:\n        'Ancestor operator. Looks for spans matching {condB} that are ancestors of a span matching {condA}',\n    },\n    {\n      label: '<',\n      insertText: '<',\n      detail: 'Parent',\n      documentation:\n        'Parent operator. Looks for spans matching {condB} that are direct parent spans of a child matching {condA}',\n    },\n    {\n      label: '~',\n      insertText: '~',\n      detail: 'Sibling',\n      documentation:\n        'Sibling operator. Checks that spans matching {condA} and {condB} are siblings of the same parent span.',\n    },\n  ];\n\n  static readonly spansetOps: MinimalCompletionItem[] = [\n    {\n      label: '|',\n      insertText: '|',\n      detail: 'Pipe',\n    },\n    ...CompletionProvider.logicalOps,\n    ...CompletionProvider.structuralOps,\n  ];\n\n  // Functions (aggregator, selector, and combining operators)\n  static readonly spansetAggregatorOps: MinimalCompletionItem[] = [\n    {\n      label: 'count',\n      insertText: 'count()$0',\n      detail: 'Number of spans',\n      documentation: 'Counts the number of spans in a spanset',\n    },\n    {\n      label: 'avg',\n      insertText: 'avg($0)',\n      detail: 'Average of attribute',\n      documentation: 'Computes the average of a given numeric attribute or intrinsic for a spanset.',\n    },\n    {\n      label: 'max',\n      insertText: 'max($0)',\n      detail: 'Max value of attribute',\n      documentation: 'Computes the maximum value of a given numeric attribute or intrinsic for a spanset.',\n    },\n    {\n      label: 'min',\n      insertText: 'min($0)',\n      detail: 'Min value of attribute',\n      documentation: 'Computes the minimum value of a given numeric attribute or intrinsic for a spanset.',\n    },\n    {\n      label: 'sum',\n      insertText: 'sum($0)',\n      detail: 'Sum value of attribute',\n      documentation: 'Computes the sum value of a given numeric attribute or intrinsic for a spanset.',\n    },\n  ];\n\n  static readonly functions: MinimalCompletionItem[] = [\n    ...this.spansetAggregatorOps,\n    {\n      label: 'by',\n      insertText: 'by($0)',\n      detail: 'Grouping of attributes',\n      documentation: 'Groups by arbitrary attributes.',\n    },\n    {\n      label: 'select',\n      insertText: 'select($0)',\n      detail: 'Selection of fields',\n      documentation: 'Selects arbitrary fields from spans.',\n    },\n  ];\n\n  // We set these directly and ae required for the provider to function.\n  monaco: Monaco | undefined;\n  editor: monacoTypes.editor.IStandaloneCodeEditor | undefined;\n\n  private cachedValues: { [key: string]: Array<SelectableValue<string>> } = {};\n\n  provideCompletionItems(\n    model: monacoTypes.editor.ITextModel,\n    position: monacoTypes.Position\n  ): monacoTypes.languages.ProviderResult<monacoTypes.languages.CompletionList> {\n    // Should not happen, this should not be called before it is initialized\n    if (!(this.monaco && this.editor)) {\n      throw new Error('provideCompletionItems called before CompletionProvider was initialized');\n    }\n\n    // if the model-id does not match, then this call is from a different editor-instance,\n    // not \"our instance\", so return nothing\n    if (this.editor.getModel()?.id !== model.id) {\n      return { suggestions: [] };\n    }\n\n    const { range, offset } = getRangeAndOffset(this.monaco, model, position);\n    const situation = getSituation(model.getValue(), offset);\n    const completionItems = situation != null ? this.getCompletions(situation, this.setAlertText) : Promise.resolve([]);\n\n    return completionItems.then((items) => {\n      // monaco by-default alphabetically orders the items.\n      // to stop it, we use a number-as-string sortkey,\n      // so that monaco keeps the order we use\n      const maxIndexDigits = items.length.toString().length;\n      const suggestions: monacoTypes.languages.CompletionItem[] = items.map((item, index) => {\n        const suggestion: monacoTypes.languages.CompletionItem = {\n          kind: getMonacoCompletionItemKind(item.type, this.monaco!),\n          label: item.label,\n          insertText: item.insertText,\n          insertTextRules: item.insertTextRules,\n          detail: item.detail,\n          documentation: item.documentation,\n          sortText: index.toString().padStart(maxIndexDigits, '0'), // to force the order we have\n          range,\n          command: {\n            id: this.registerInteractionCommandId || 'noOp',\n            title: 'Report Interaction',\n            arguments: [item.label, item.type],\n          },\n        };\n        fixSuggestion(suggestion, item.type, model, offset);\n        return suggestion;\n      });\n      return { suggestions };\n    });\n  }\n\n  /**\n   * Set the ID for the registerInteraction command, to be used to keep track of how many completions are used by the users\n   */\n  setRegisterInteractionCommandId(id: string | null) {\n    this.registerInteractionCommandId = id;\n  }\n\n  private async getTagValues(tagName: string, query: string): Promise<Array<SelectableValue<string>>> {\n    let tagValues: Array<SelectableValue<string>>;\n    const cacheKey = `${tagName}:${query}`;\n\n    if (this.cachedValues.hasOwnProperty(cacheKey)) {\n      tagValues = this.cachedValues[cacheKey];\n    } else {\n      tagValues = await this.languageProvider.getOptionsV2(tagName, query);\n      this.cachedValues[cacheKey] = tagValues;\n    }\n    return tagValues;\n  }\n\n  /**\n   * Get suggestion based on the situation we are in like whether we should suggest tag names or values.\n   * @param situation\n   * @private\n   */\n  private async getCompletions(situation: Situation, setAlertText: (text?: string) => void): Promise<Completion[]> {\n    switch (situation.type) {\n      // This should only happen for cases that we do not support yet\n      case 'UNKNOWN': {\n        return [];\n      }\n      case 'EMPTY': {\n        return this.getScopesCompletions('{ ', '$0 }')\n          .concat(this.getIntrinsicsCompletions('{ ', '$0 }'))\n          .concat(this.getTagsCompletions('{ .'));\n      }\n      case 'SPANSET_EMPTY':\n        return this.getScopesCompletions().concat(this.getIntrinsicsCompletions()).concat(this.getTagsCompletions('.'));\n      case 'SPANSET_ONLY_DOT': {\n        return this.getTagsCompletions();\n      }\n      case 'SPANSET_IN_THE_MIDDLE':\n        return [...CompletionProvider.comparisonOps, ...CompletionProvider.logicalOps].map((key) => ({\n          ...key,\n          type: 'OPERATOR',\n        }));\n      case 'SPANSET_EXPRESSION_OPERATORS_WITH_MISSING_CLOSED_BRACE':\n        return [...CompletionProvider.comparisonOps, ...CompletionProvider.logicalOps].map((key) => ({\n          ...key,\n          type: 'OPERATOR',\n        }));\n      case 'SPANSET_IN_NAME':\n        return this.getScopesCompletions().concat(this.getIntrinsicsCompletions()).concat(this.getTagsCompletions());\n      case 'SPANSET_IN_NAME_SCOPE':\n        return this.getTagsCompletions(undefined, situation.scope);\n      case 'SPANSET_EXPRESSION_OPERATORS':\n        return [\n          ...CompletionProvider.comparisonOps,\n          ...CompletionProvider.logicalOps,\n          ...CompletionProvider.arithmeticOps,\n        ].map((key) => ({\n          ...key,\n          type: 'OPERATOR',\n        }));\n      case 'SPANFIELD_COMBINING_OPERATORS':\n        return [\n          ...CompletionProvider.logicalOps,\n          ...CompletionProvider.arithmeticOps,\n          ...CompletionProvider.comparisonOps,\n        ].map((key) => ({\n          ...key,\n          type: 'OPERATOR',\n        }));\n      case 'SPANSET_COMBINING_OPERATORS':\n        return CompletionProvider.spansetOps.map((key) => ({\n          ...key,\n          type: 'OPERATOR',\n        }));\n      case 'SPANSET_PIPELINE_AFTER_OPERATOR':\n        const functions = CompletionProvider.functions.map((key) => ({\n          ...key,\n          insertTextRules: this.monaco?.languages.CompletionItemInsertTextRule?.InsertAsSnippet,\n          type: 'FUNCTION' as const,\n        }));\n        const tags = this.getScopesCompletions()\n          .concat(this.getIntrinsicsCompletions())\n          .concat(this.getTagsCompletions('.'));\n        return [...functions, ...tags];\n      case 'SPANSET_COMPARISON_OPERATORS':\n        return CompletionProvider.comparisonOps.map((key) => ({\n          ...key,\n          type: 'OPERATOR',\n        }));\n      case 'SPANSET_IN_VALUE':\n        let tagValues;\n        try {\n          tagValues = await this.getTagValues(situation.tagName, situation.query);\n          setAlertText(undefined);\n        } catch (error) {\n          if (isFetchError(error)) {\n            setAlertText(error.data.error);\n          } else if (error instanceof Error) {\n            setAlertText(`Error: ${error.message}`);\n          }\n        }\n\n        const items: Completion[] = [];\n\n        const getInsertionText = (val: SelectableValue<string>): string => {\n          if (situation.betweenQuotes) {\n            return val.label!;\n          }\n          return val.type === 'string' ? `\"${val.label}\"` : val.label!;\n        };\n\n        tagValues?.forEach((val) => {\n          if (val?.label) {\n            items.push({\n              label: val.label,\n              insertText: getInsertionText(val),\n              type: 'TAG_VALUE',\n            });\n          }\n        });\n        return items;\n      case 'SPANSET_AFTER_VALUE':\n        return CompletionProvider.logicalOps.map((key) => ({\n          label: key.label,\n          insertText: key.insertText + '}',\n          type: 'OPERATOR',\n        }));\n      case 'NEW_SPANSET':\n        return this.getScopesCompletions('{ ', '$0 }')\n          .concat(this.getIntrinsicsCompletions('{ ', '$0 }'))\n          .concat(this.getTagsCompletions('.'));\n      case 'ATTRIBUTE_FOR_FUNCTION':\n        return this.getScopesCompletions().concat(this.getIntrinsicsCompletions()).concat(this.getTagsCompletions('.'));\n      default:\n        throw new Error(`Unexpected situation ${situation}`);\n    }\n  }\n\n  private getTagsCompletions(prepend?: string, scope?: string): Completion[] {\n    const tags = this.languageProvider.getTraceqlAutocompleteTags(scope);\n    return tags\n      .sort((a, b) => a.localeCompare(b, undefined, { sensitivity: 'accent' }))\n      .map((key) => ({\n        label: key,\n        insertText: (prepend || '') + key,\n        type: 'TAG_NAME',\n      }));\n  }\n\n  private getIntrinsicsCompletions(prepend?: string, append?: string): Completion[] {\n    return intrinsics.map((key) => ({\n      label: key,\n      insertText: (prepend || '') + key + (append || ''),\n      type: 'KEYWORD',\n      insertTextRules: this.monaco?.languages.CompletionItemInsertTextRule?.InsertAsSnippet,\n    }));\n  }\n\n  private getScopesCompletions(prepend?: string, append?: string): Completion[] {\n    return scopes.map((key) => ({\n      label: key,\n      insertText: (prepend || '') + key + (append || ''),\n      type: 'SCOPE',\n      insertTextRules: this.monaco?.languages.CompletionItemInsertTextRule?.InsertAsSnippet,\n    }));\n  }\n}\n\n/**\n * Get item kind which is used for icon next to the suggestion.\n * @param type\n * @param monaco\n */\nfunction getMonacoCompletionItemKind(type: CompletionType, monaco: Monaco): monacoTypes.languages.CompletionItemKind {\n  switch (type) {\n    case 'TAG_NAME':\n      return monaco.languages.CompletionItemKind.Enum;\n    case 'KEYWORD':\n      return monaco.languages.CompletionItemKind.Keyword;\n    case 'OPERATOR':\n      return monaco.languages.CompletionItemKind.Operator;\n    case 'TAG_VALUE':\n      return monaco.languages.CompletionItemKind.EnumMember;\n    case 'SCOPE':\n      return monaco.languages.CompletionItemKind.Class;\n    case 'FUNCTION':\n      return monaco.languages.CompletionItemKind.Function;\n    default:\n      throw new Error(`Unexpected CompletionType: ${type}`);\n  }\n}\n\nexport type CompletionType = 'TAG_NAME' | 'TAG_VALUE' | 'KEYWORD' | 'OPERATOR' | 'SCOPE' | 'FUNCTION';\ntype Completion = {\n  type: CompletionType;\n  label: string;\n  insertText: string;\n  insertTextRules?: monacoTypes.languages.CompletionItemInsertTextRule; // we used it to position the cursor\n  documentation?: string | IMarkdownString;\n  detail?: string;\n};\n\nexport type Tag = {\n  name: string;\n  value: string;\n};\n\nfunction getRangeAndOffset(monaco: Monaco, model: monacoTypes.editor.ITextModel, position: monacoTypes.Position) {\n  const word = model.getWordAtPosition(position);\n  const range =\n    word != null\n      ? monaco.Range.lift({\n          startLineNumber: position.lineNumber,\n          endLineNumber: position.lineNumber,\n          startColumn: word.startColumn,\n          endColumn: word.endColumn,\n        })\n      : monaco.Range.fromPositions(position);\n\n  // documentation says `position` will be \"adjusted\" in `getOffsetAt` so we clone it here just for sure.\n  const positionClone = {\n    column: position.column,\n    lineNumber: position.lineNumber,\n  };\n\n  const offset = model.getOffsetAt(positionClone);\n  return { offset, range };\n}\n\n/**\n * Fix the suggestions range and insert text. For the range we have to adjust because monaco by default replaces just\n * the last word which stops at dot while traceQL tags contain dots themselves and we want to replace the whole tag\n * name when suggesting. The insert text needs to be adjusted for scope (leading dot) if scope is currently missing.\n * This may be doable also when creating the suggestions but for a particular situation this seems to be easier to do\n * here.\n */\nfunction fixSuggestion(\n  suggestion: monacoTypes.languages.CompletionItem,\n  itemType: CompletionType,\n  model: monacoTypes.editor.ITextModel,\n  offset: number\n) {\n  if (itemType === 'TAG_NAME') {\n    const match = model\n      .getValue()\n      .substring(0, offset)\n      .match(/(span\\.|resource\\.|\\.)?([\\w./-]*)$/);\n\n    if (match) {\n      const scope = match[1];\n      const tag = match[2];\n\n      if (tag) {\n        // Add the default scope if needed.\n        if (!scope && suggestion.insertText[0] !== '.') {\n          suggestion.insertText = '.' + suggestion.insertText;\n        }\n\n        // Adjust the range, so that we will replace the whole tag.\n        suggestion.range = {\n          ...suggestion.range,\n          startColumn: offset - tag.length + 1,\n        };\n      }\n    }\n  }\n}\n","import { SyntaxNode } from '@lezer/common';\n\nimport {\n  Aggregate,\n  And,\n  AttributeField,\n  ComparisonOp,\n  FieldExpression,\n  FieldOp,\n  GroupOperation,\n  Identifier,\n  IntrinsicField,\n  Or,\n  Parent,\n  parser,\n  Pipe,\n  Resource,\n  ScalarExpression,\n  ScalarFilter,\n  SelectOperation,\n  Span,\n  SpansetFilter,\n  SpansetPipelineExpression,\n} from '@grafana/lezer-traceql';\nimport { monacoTypes } from '@grafana/ui';\n\n/**\n * Given an error node, generate an error message to be displayed to the user.\n *\n * @param errorNode the error node, as returned by the TraceQL Lezer parser\n * @returns the error message\n */\nexport const computeErrorMessage = (errorNode: SyntaxNode) => {\n  switch (errorNode.parent?.type.id) {\n    case FieldExpression:\n      switch (errorNode.prevSibling?.type.id) {\n        case And:\n        case Or:\n          return 'Invalid value after logical operator.';\n        case FieldOp:\n          return 'Invalid value after comparison or arithmetic operator.';\n        default:\n          return 'Invalid operator after field expression.';\n      }\n    case SpansetFilter:\n      if (errorNode.prevSibling?.type.id === FieldExpression) {\n        return 'Invalid comparison operator after field expression.';\n      }\n      return 'Invalid expression for spanset.';\n    case SpansetPipelineExpression:\n      switch (errorNode.prevSibling?.type.id) {\n        case SpansetPipelineExpression:\n          return 'Invalid spanset combining operator after spanset expression.';\n        case Pipe:\n          return 'Invalid aggregation operator after pipepile operator.';\n        default:\n          return 'Invalid spanset expression after spanset combining operator.';\n      }\n    case IntrinsicField:\n    case Aggregate:\n      return 'Invalid expression for aggregator operator.';\n    case GroupOperation:\n      return 'Invalid expression for by operator.';\n    case SelectOperation:\n      return 'Invalid expression for select operator.';\n    case AttributeField:\n      return 'Invalid expression for spanset.';\n    case ScalarFilter:\n      switch (errorNode.prevSibling?.type.id) {\n        case ComparisonOp:\n          return 'Invalid value after comparison operator.';\n        case ScalarExpression:\n          if (errorNode.prevSibling?.firstChild?.type.id === Aggregate) {\n            return 'Invalid comparison operator after aggregator operator.';\n          }\n        default:\n          return 'Invalid value after comparison operator.';\n      }\n    default:\n      return 'Invalid query.';\n  }\n};\n\n/**\n * Parse the given query and find the error nodes, if any, in the resulting tree.\n *\n * @param query the TraceQL query of the user\n * @returns the error nodes\n */\nexport const getErrorNodes = (query: string): SyntaxNode[] => {\n  // Return immediately if the query is empty, to avoid raising exceptions in processing it\n  if (query.trim() === '') {\n    return [];\n  }\n\n  // Check whether this is a trace ID or traceQL query by checking if it only contains hex characters\n  const hexOnlyRegex = /^[0-9A-Fa-f]*$/;\n  if (query.trim().match(hexOnlyRegex)) {\n    return [];\n  }\n\n  const tree = parser.parse(query);\n\n  // Find all error nodes and compute the associated erro boundaries\n  const errorNodes: SyntaxNode[] = [];\n  tree.iterate({\n    enter: (nodeRef) => {\n      if (nodeRef.type.id === 0) {\n        errorNodes.push(nodeRef.node);\n      }\n    },\n  });\n\n  return errorNodes;\n};\n\n/**\n * Use red markers (squiggles) to highlight syntax errors in queries.\n *\n */\nexport const setMarkers = (\n  monaco: typeof monacoTypes,\n  model: monacoTypes.editor.ITextModel,\n  errorNodes: SyntaxNode[]\n) => {\n  const markers = [\n    ...getErrorMarkers(monaco.MarkerSeverity.Error, model, errorNodes),\n    ...getWarningMarkers(monaco.MarkerSeverity.Warning, model),\n  ];\n  monaco.editor.setModelMarkers(\n    model,\n    'owner', // default value\n    markers\n  );\n};\n\nexport const getErrorMarkers = (severity: number, model: monacoTypes.editor.ITextModel, errorNodes: SyntaxNode[]) => {\n  return errorNodes.map((errorNode) => {\n    const message = computeErrorMessage(errorNode);\n    return getMarker(severity, message, model, errorNode.from, errorNode.to);\n  });\n};\n\nexport const getWarningMarkers = (severity: number, model: monacoTypes.editor.ITextModel) => {\n  let markers = [];\n\n  // Check if there are issues that should result in a warning marker\n  const text = model.getValue();\n  const tree = parser.parse(text);\n  const indexOfDot = text.indexOf('.');\n  if (indexOfDot > -1) {\n    const cur = tree.cursorAt(0);\n    do {\n      const { node } = cur;\n      if (node.type.id === Identifier) {\n        // Make sure prevSibling is using the proper scope\n        if (\n          node.prevSibling?.type.id !== Parent &&\n          node.prevSibling?.type.id !== Resource &&\n          node.prevSibling?.type.id !== Span\n        ) {\n          const from = node.prevSibling ? node.prevSibling.from : node.from - 1;\n          const to = node.prevSibling ? node.prevSibling.to : node.from - 1;\n          const message = 'Add resource or span scope to attribute to improve query performance.';\n          markers.push(getMarker(severity, message, model, from, to));\n        }\n      }\n    } while (cur.next());\n  }\n\n  return markers;\n};\n\nexport const getMarker = (\n  severity: number,\n  message: string,\n  model: monacoTypes.editor.ITextModel,\n  from: number,\n  to: number\n) => {\n  let startLine = 0;\n  let endLine = 0;\n  let start = from;\n  let end = to;\n\n  while (start > 0) {\n    startLine++;\n    start -= model.getLineLength(startLine) + 1; // new lines don't count for getLineLength() but they still count as a character for the parser\n  }\n  while (end > 0) {\n    endLine++;\n    end -= model.getLineLength(endLine) + 1;\n  }\n\n  return {\n    message,\n    severity,\n\n    startLineNumber: startLine,\n    endLineNumber: endLine,\n\n    // `+ 2` because of the above computations\n    startColumn: start + model.getLineLength(startLine) + 2,\n    endColumn: end + model.getLineLength(endLine) + 2,\n  };\n};\n","import { css } from '@emotion/css';\nimport React, { useEffect, useRef, useState } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { TemporaryAlert } from '@grafana/o11y-ds-frontend';\nimport { reportInteraction } from '@grafana/runtime';\nimport { CodeEditor, Monaco, monacoTypes, useTheme2 } from '@grafana/ui';\n\nimport { TempoDatasource } from '../datasource';\nimport { TempoQuery } from '../types';\n\nimport { CompletionProvider, CompletionType } from './autocomplete';\nimport { getErrorNodes, setMarkers } from './highlighting';\nimport { languageDefinition } from './traceql';\n\ninterface Props {\n  placeholder: string;\n  query: TempoQuery;\n  onChange: (val: TempoQuery) => void;\n  onRunQuery: () => void;\n  datasource: TempoDatasource;\n  readOnly?: boolean;\n}\n\nexport function TraceQLEditor(props: Props) {\n  const [alertText, setAlertText] = useState<string>();\n\n  const { query, onChange, onRunQuery, placeholder } = props;\n  const setupAutocompleteFn = useAutocomplete(props.datasource, setAlertText);\n  const theme = useTheme2();\n  const styles = getStyles(theme, placeholder);\n\n  // The Monaco Editor uses the first version of props.onChange in handleOnMount i.e. always has the initial\n  // value of query because underlying Monaco editor is passed `query` below in the onEditorChange callback.\n  // handleOnMount is called only once when the editor is mounted and does not get updates to query.\n  // So we need useRef to get the latest version of query in the onEditorChange callback.\n  const queryRef = useRef(query);\n  queryRef.current = query;\n  const onEditorChange = (value: string) => {\n    onChange({ ...queryRef.current, query: value });\n  };\n\n  // work around the problem that `onEditorDidMount` is called once\n  // and wouldn't get new version of onRunQuery\n  const onRunQueryRef = useRef(onRunQuery);\n  onRunQueryRef.current = onRunQuery;\n\n  const errorTimeoutId = useRef<number>();\n\n  return (\n    <>\n      <CodeEditor\n        value={query.query || ''}\n        language={langId}\n        onBlur={onEditorChange}\n        onChange={onEditorChange}\n        containerStyles={styles.queryField}\n        readOnly={props.readOnly}\n        monacoOptions={{\n          folding: false,\n          fontSize: 14,\n          lineNumbers: 'off',\n          overviewRulerLanes: 0,\n          renderLineHighlight: 'none',\n          scrollbar: {\n            vertical: 'hidden',\n            verticalScrollbarSize: 8, // used as \"padding-right\"\n            horizontal: 'hidden',\n            horizontalScrollbarSize: 0,\n          },\n          scrollBeyondLastLine: false,\n          wordWrap: 'on',\n        }}\n        onBeforeEditorMount={ensureTraceQL}\n        onEditorDidMount={(editor, monaco) => {\n          if (!props.readOnly) {\n            setupAutocompleteFn(editor, monaco, setupRegisterInteractionCommand(editor));\n            setupActions(editor, monaco, () => onRunQueryRef.current());\n            setupPlaceholder(editor, monaco, styles);\n          }\n          setupAutoSize(editor);\n\n          // Parse query that might already exist (e.g., after a page refresh)\n          const model = editor.getModel();\n          if (model) {\n            const errorNodes = getErrorNodes(model.getValue());\n            setMarkers(monaco, model, errorNodes);\n          }\n\n          // Register callback for query changes\n          editor.onDidChangeModelContent((changeEvent) => {\n            const model = editor.getModel();\n\n            if (!model) {\n              return;\n            }\n\n            // Remove previous callback if existing, to prevent squiggles from been shown while the user is still typing\n            window.clearTimeout(errorTimeoutId.current);\n\n            const errorNodes = getErrorNodes(model.getValue());\n            const cursorPosition = changeEvent.changes[0].rangeOffset;\n\n            // Immediately updates the squiggles, in case the user fixed an error,\n            // excluding the error around the cursor position\n            setMarkers(\n              monaco,\n              model,\n              errorNodes.filter((errorNode) => !(errorNode.from <= cursorPosition && cursorPosition <= errorNode.to))\n            );\n\n            // Later on, show all errors\n            errorTimeoutId.current = window.setTimeout(() => {\n              setMarkers(monaco, model, errorNodes);\n            }, 500);\n          });\n        }}\n      />\n      {alertText && <TemporaryAlert severity=\"error\" text={alertText} />}\n    </>\n  );\n}\n\nfunction setupPlaceholder(editor: monacoTypes.editor.IStandaloneCodeEditor, monaco: Monaco, styles: EditorStyles) {\n  const placeholderDecorators = [\n    {\n      range: new monaco.Range(1, 1, 1, 1),\n      options: {\n        className: styles.placeholder, // The placeholder text is in styles.placeholder\n        isWholeLine: true,\n      },\n    },\n  ];\n\n  let decorators: string[] = [];\n\n  const checkDecorators = (): void => {\n    const model = editor.getModel();\n\n    if (!model) {\n      return;\n    }\n\n    const newDecorators = model.getValueLength() === 0 ? placeholderDecorators : [];\n    decorators = model.deltaDecorations(decorators, newDecorators);\n  };\n\n  checkDecorators();\n  editor.onDidChangeModelContent(checkDecorators);\n}\n\nfunction setupActions(editor: monacoTypes.editor.IStandaloneCodeEditor, monaco: Monaco, onRunQuery: () => void) {\n  editor.addAction({\n    id: 'run-query',\n    label: 'Run Query',\n    keybindings: [monaco.KeyMod.Shift | monaco.KeyCode.Enter],\n    contextMenuGroupId: 'navigation',\n    contextMenuOrder: 1.5,\n    run: function () {\n      onRunQuery();\n    },\n  });\n}\n\nfunction setupRegisterInteractionCommand(editor: monacoTypes.editor.IStandaloneCodeEditor): string | null {\n  return editor.addCommand(0, function (_, label, type: CompletionType) {\n    const properties: Record<string, unknown> = { datasourceType: 'tempo', type };\n    // Filter out the label for TAG_VALUE completions to avoid potentially exposing sensitive data\n    if (type !== 'TAG_VALUE') {\n      properties.label = label;\n    }\n    reportInteraction('grafana_traces_traceql_completion', properties);\n  });\n}\n\nfunction setupAutoSize(editor: monacoTypes.editor.IStandaloneCodeEditor) {\n  const container = editor.getDomNode();\n  const updateHeight = () => {\n    if (container) {\n      const contentHeight = Math.min(1000, editor.getContentHeight());\n      const width = parseInt(container.style.width, 10);\n      container.style.width = `${width}px`;\n      container.style.height = `${contentHeight}px`;\n      editor.layout({ width, height: contentHeight });\n    }\n  };\n  editor.onDidContentSizeChange(updateHeight);\n  updateHeight();\n}\n\n/**\n * Hook that returns function that will set up monaco autocomplete for the label selector\n * @param datasource the Tempo datasource instance\n * @param setAlertText setter for alert's text\n */\nfunction useAutocomplete(datasource: TempoDatasource, setAlertText: (text?: string) => void) {\n  // We need the provider ref so we can pass it the label/values data later. This is because we run the call for the\n  // values here but there is additional setup needed for the provider later on. We could run the getSeries() in the\n  // returned function but that is run after the monaco is mounted so would delay the request a bit when it does not\n  // need to.\n  const providerRef = useRef<CompletionProvider>(\n    new CompletionProvider({ languageProvider: datasource.languageProvider, setAlertText })\n  );\n\n  useEffect(() => {\n    const fetchTags = async () => {\n      try {\n        await datasource.languageProvider.start();\n        setAlertText(undefined);\n      } catch (error) {\n        if (error instanceof Error) {\n          setAlertText(`Error: ${error.message}`);\n        }\n      }\n    };\n    fetchTags();\n  }, [datasource, setAlertText]);\n\n  const autocompleteDisposeFun = useRef<(() => void) | null>(null);\n  useEffect(() => {\n    // when we unmount, we unregister the autocomplete-function, if it was registered\n    return () => {\n      autocompleteDisposeFun.current?.();\n    };\n  }, []);\n\n  // This should be run in monaco onEditorDidMount\n  return (\n    editor: monacoTypes.editor.IStandaloneCodeEditor,\n    monaco: Monaco,\n    registerInteractionCommandId: string | null\n  ) => {\n    providerRef.current.editor = editor;\n    providerRef.current.monaco = monaco;\n    providerRef.current.setRegisterInteractionCommandId(registerInteractionCommandId);\n\n    const { dispose } = monaco.languages.registerCompletionItemProvider(langId, providerRef.current);\n    autocompleteDisposeFun.current = dispose;\n  };\n}\n\n// we must only run the setup code once\nlet traceqlSetupDone = false;\nconst langId = 'traceql';\n\nfunction ensureTraceQL(monaco: Monaco) {\n  if (!traceqlSetupDone) {\n    traceqlSetupDone = true;\n    const { aliases, extensions, mimetypes, def } = languageDefinition;\n    monaco.languages.register({ id: langId, aliases, extensions, mimetypes });\n    monaco.languages.setMonarchTokensProvider(langId, def.language);\n    monaco.languages.setLanguageConfiguration(langId, def.languageConfiguration);\n  }\n}\n\ninterface EditorStyles {\n  placeholder: string;\n  queryField: string;\n}\n\nconst getStyles = (theme: GrafanaTheme2, placeholder: string): EditorStyles => {\n  return {\n    queryField: css({\n      borderRadius: theme.shape.radius.default,\n      border: `1px solid ${theme.components.input.borderColor}`,\n      flex: 1,\n    }),\n    placeholder: css({\n      '::after': {\n        content: `'${placeholder}'`,\n        fontFamily: theme.typography.fontFamilyMonospace,\n        opacity: 0.3,\n      },\n    }),\n  };\n};\n","import { css } from '@emotion/css';\nimport { defaults } from 'lodash';\nimport React, { useState } from 'react';\n\nimport { GrafanaTheme2, QueryEditorProps } from '@grafana/data';\nimport { config, reportInteraction } from '@grafana/runtime';\nimport { Button, InlineLabel, useStyles2 } from '@grafana/ui';\n\nimport { generateQueryFromFilters } from '../SearchTraceQLEditor/utils';\nimport { TempoDatasource } from '../datasource';\nimport { defaultQuery, MyDataSourceOptions, TempoQuery } from '../types';\n\nimport { TempoQueryBuilderOptions } from './TempoQueryBuilderOptions';\nimport { TraceQLEditor } from './TraceQLEditor';\n\ntype EditorProps = {\n  onClearResults: () => void;\n};\n\ntype Props = EditorProps & QueryEditorProps<TempoDatasource, TempoQuery, MyDataSourceOptions>;\n\nexport function QueryEditor(props: Props) {\n  const styles = useStyles2(getStyles);\n  const query = defaults(props.query, defaultQuery);\n  const [showCopyFromSearchButton, setShowCopyFromSearchButton] = useState(() => {\n    const genQuery = generateQueryFromFilters(query.filters || []);\n    return genQuery === query.query || genQuery === '{}';\n  });\n\n  return (\n    <>\n      <InlineLabel>\n        Build complex queries using TraceQL to select a list of traces.{' '}\n        <a rel=\"noreferrer\" target=\"_blank\" href=\"https://grafana.com/docs/tempo/latest/traceql/\">\n          Documentation\n        </a>\n      </InlineLabel>\n      {!showCopyFromSearchButton && (\n        <div className={styles.copyContainer}>\n          <span>Continue editing the query from the Search tab?</span>\n          <Button\n            variant=\"secondary\"\n            size=\"sm\"\n            onClick={() => {\n              reportInteraction('grafana_traces_copy_to_traceql_clicked', {\n                app: props.app ?? '',\n                grafana_version: config.buildInfo.version,\n                location: 'traceql_tab',\n              });\n\n              props.onClearResults();\n              props.onChange({\n                ...query,\n                query: generateQueryFromFilters(query.filters || []),\n              });\n              setShowCopyFromSearchButton(true);\n            }}\n            style={{ marginLeft: '10px' }}\n          >\n            Copy query from Search\n          </Button>\n        </div>\n      )}\n      <TraceQLEditor\n        placeholder=\"Enter a TraceQL query or trace ID (run with Shift+Enter)\"\n        query={query}\n        onChange={props.onChange}\n        datasource={props.datasource}\n        onRunQuery={props.onRunQuery}\n      />\n      <div className={styles.optionsContainer}>\n        <TempoQueryBuilderOptions query={query} onChange={props.onChange} />\n      </div>\n    </>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  optionsContainer: css({\n    marginTop: '10px',\n  }),\n  copyContainer: css({\n    backgroundColor: theme.colors.background.secondary,\n    padding: theme.spacing(0.5, 1),\n    fontSize: theme.typography.body.fontSize,\n  }),\n});\n","import { css } from '@emotion/css';\nimport React from 'react';\n\nimport { QueryEditorProps, SelectableValue } from '@grafana/data';\nimport { config, reportInteraction } from '@grafana/runtime';\nimport {\n  Button,\n  FileDropzone,\n  HorizontalGroup,\n  InlineField,\n  InlineFieldRow,\n  Modal,\n  RadioButtonGroup,\n  Themeable2,\n  withTheme2,\n} from '@grafana/ui';\n\nimport TraceQLSearch from './SearchTraceQLEditor/TraceQLSearch';\nimport { ServiceGraphSection } from './ServiceGraphSection';\nimport { TempoQueryType } from './dataquery.gen';\nimport { TempoDatasource } from './datasource';\nimport { QueryEditor } from './traceql/QueryEditor';\nimport { TempoQuery } from './types';\nimport { migrateFromSearchToTraceQLSearch } from './utils';\n\ninterface Props extends QueryEditorProps<TempoDatasource, TempoQuery>, Themeable2 {}\ninterface State {\n  uploadModalOpen: boolean;\n}\n\n// This needs to default to traceql for data sources like Splunk, where clicking on a\n// data link should open the traceql tab and run a search based on the configured query.\nconst DEFAULT_QUERY_TYPE: TempoQueryType = 'traceql';\n\nclass TempoQueryFieldComponent extends React.PureComponent<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      uploadModalOpen: false,\n    };\n  }\n\n  // Set the default query type when the component mounts.\n  // Also do this if queryType is 'clear' (which is the case when the user changes the query type)\n  // otherwise if the user changes the query type and refreshes the page, no query type will be selected\n  // which is inconsistent with how the UI was originally when they selected the Tempo data source.\n  async componentDidMount() {\n    if (!this.props.query.queryType || this.props.query.queryType === 'clear') {\n      this.props.onChange({\n        ...this.props.query,\n        queryType: DEFAULT_QUERY_TYPE,\n      });\n    }\n  }\n\n  onClearResults = () => {\n    // Run clear query to clear results\n    const { onChange, query, onRunQuery } = this.props;\n    onChange({\n      ...query,\n      queryType: 'clear',\n    });\n    onRunQuery();\n  };\n\n  render() {\n    const { query, onChange, datasource, app } = this.props;\n\n    const graphDatasourceUid = datasource.serviceMap?.datasourceUid;\n\n    let queryTypeOptions: Array<SelectableValue<TempoQueryType>> = [\n      { value: 'traceqlSearch', label: 'Search' },\n      { value: 'traceql', label: 'TraceQL' },\n      { value: 'serviceMap', label: 'Service Graph' },\n    ];\n\n    // Migrate user to new query type if they are using the old search query type\n    if (\n      query.spanName ||\n      query.serviceName ||\n      query.search ||\n      query.maxDuration ||\n      query.minDuration ||\n      query.queryType === 'nativeSearch'\n    ) {\n      onChange(migrateFromSearchToTraceQLSearch(query));\n    }\n\n    return (\n      <>\n        <Modal\n          title={'Upload trace'}\n          isOpen={this.state.uploadModalOpen}\n          onDismiss={() => this.setState({ uploadModalOpen: false })}\n        >\n          <div className={css({ padding: this.props.theme.spacing(2) })}>\n            <FileDropzone\n              options={{ multiple: false }}\n              onLoad={(result) => {\n                if (typeof result !== 'string' && result !== null) {\n                  throw Error(`Unexpected result type: ${typeof result}`);\n                }\n                this.props.datasource.uploadedJson = result;\n                onChange({\n                  ...query,\n                  queryType: 'upload',\n                });\n                this.setState({ uploadModalOpen: false });\n                this.props.onRunQuery();\n              }}\n            />\n          </div>\n        </Modal>\n        <InlineFieldRow>\n          <InlineField label=\"Query type\" grow={true}>\n            <HorizontalGroup spacing={'sm'} align={'center'} justify={'space-between'}>\n              <RadioButtonGroup<TempoQueryType>\n                options={queryTypeOptions}\n                value={query.queryType}\n                onChange={(v) => {\n                  reportInteraction('grafana_traces_query_type_changed', {\n                    datasourceType: 'tempo',\n                    app: app ?? '',\n                    grafana_version: config.buildInfo.version,\n                    newQueryType: v,\n                    previousQueryType: query.queryType ?? '',\n                  });\n\n                  this.onClearResults();\n                  onChange({\n                    ...query,\n                    queryType: v,\n                  });\n                }}\n                size=\"md\"\n              />\n              <Button\n                variant=\"secondary\"\n                size=\"sm\"\n                onClick={() => {\n                  this.setState({ uploadModalOpen: true });\n                }}\n              >\n                Import trace\n              </Button>\n            </HorizontalGroup>\n          </InlineField>\n        </InlineFieldRow>\n        {query.queryType === 'traceqlSearch' && (\n          <TraceQLSearch\n            datasource={this.props.datasource}\n            query={query}\n            onChange={onChange}\n            onBlur={this.props.onBlur}\n            app={app}\n            onClearResults={this.onClearResults}\n          />\n        )}\n        {query.queryType === 'serviceMap' && (\n          <ServiceGraphSection graphDatasourceUid={graphDatasourceUid} query={query} onChange={onChange} />\n        )}\n        {query.queryType === 'traceql' && (\n          <QueryEditor\n            datasource={this.props.datasource}\n            query={query}\n            onRunQuery={this.props.onRunQuery}\n            onChange={onChange}\n            app={app}\n            onClearResults={this.onClearResults}\n          />\n        )}\n      </>\n    );\n  }\n}\n\nexport const TempoQueryField = withTheme2(TempoQueryFieldComponent);\n","import React__default from 'react';\nimport { css, cx } from '@emotion/css';\nimport { useTheme2 } from '@grafana/ui';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst DataSourceDescription = ({ dataSourceName, docsLink, hasRequiredFields = true, className }) => {\n  const theme = useTheme2();\n  const styles = {\n    container: css({\n      p: {\n        margin: 0\n      },\n      \"p + p\": {\n        marginTop: theme.spacing(2)\n      }\n    }),\n    text: css(__spreadProps(__spreadValues({}, theme.typography.body), {\n      color: theme.colors.text.secondary,\n      a: css({\n        color: theme.colors.text.link,\n        textDecoration: \"underline\",\n        \"&:hover\": {\n          textDecoration: \"none\"\n        }\n      })\n    }))\n  };\n  return /* @__PURE__ */ React__default.createElement(\"div\", { className: cx(styles.container, className) }, /* @__PURE__ */ React__default.createElement(\"p\", { className: styles.text }, \"Before you can use the \", dataSourceName, \" data source, you must configure it below or in the config file. For detailed instructions,\", \" \", /* @__PURE__ */ React__default.createElement(\"a\", { href: docsLink, target: \"_blank\", rel: \"noreferrer\" }, \"view the documentation\"), \".\"), hasRequiredFields && /* @__PURE__ */ React__default.createElement(\"p\", { className: styles.text }, /* @__PURE__ */ React__default.createElement(\"i\", null, \"Fields marked with * are required\")));\n};\n\nexport { DataSourceDescription };\n//# sourceMappingURL=DataSourceDescription.js.map\n","import React__default, { useState } from 'react';\nimport { css } from '@emotion/css';\nimport { useTheme2, IconButton } from '@grafana/ui';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst GenericConfigSection = ({\n  children,\n  title,\n  description,\n  isCollapsible = false,\n  isInitiallyOpen = true,\n  kind = \"section\",\n  className\n}) => {\n  const { colors, typography, spacing } = useTheme2();\n  const [isOpen, setIsOpen] = useState(isCollapsible ? isInitiallyOpen : true);\n  const iconName = isOpen ? \"angle-up\" : \"angle-down\";\n  const isSubSection = kind === \"sub-section\";\n  const collapsibleButtonAriaLabel = `${isOpen ? \"Collapse\" : \"Expand\"} section ${title}`;\n  const styles = {\n    header: css({\n      display: \"flex\",\n      justifyContent: \"space-between\",\n      alignItems: \"center\"\n    }),\n    title: css({\n      margin: 0\n    }),\n    subtitle: css({\n      margin: 0,\n      fontWeight: typography.fontWeightRegular\n    }),\n    descriptionText: css(__spreadProps(__spreadValues({\n      marginTop: spacing(isSubSection ? 0.25 : 0.5),\n      marginBottom: 0\n    }, typography.bodySmall), {\n      color: colors.text.secondary\n    })),\n    content: css({\n      marginTop: spacing(2)\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(\"div\", { className }, /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.header }, kind === \"section\" ? /* @__PURE__ */ React__default.createElement(\"h3\", { className: styles.title }, title) : /* @__PURE__ */ React__default.createElement(\"h6\", { className: styles.subtitle }, title), isCollapsible && /* @__PURE__ */ React__default.createElement(\n    IconButton,\n    {\n      name: iconName,\n      onClick: () => setIsOpen(!isOpen),\n      type: \"button\",\n      size: \"xl\",\n      \"aria-label\": collapsibleButtonAriaLabel\n    }\n  )), description && /* @__PURE__ */ React__default.createElement(\"p\", { className: styles.descriptionText }, description), isOpen && /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.content }, children));\n};\n\nexport { GenericConfigSection };\n//# sourceMappingURL=GenericConfigSection.js.map\n","import React__default from 'react';\nimport { GenericConfigSection } from './GenericConfigSection.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nconst ConfigSection = (_a) => {\n  var _b = _a, { children } = _b, props = __objRest(_b, [\"children\"]);\n  return /* @__PURE__ */ React__default.createElement(GenericConfigSection, __spreadProps(__spreadValues({}, props), { kind: \"section\" }), children);\n};\n\nexport { ConfigSection };\n//# sourceMappingURL=ConfigSection.js.map\n","import React__default from 'react';\nimport { css, cx } from '@emotion/css';\nimport { InlineField, Input } from '@grafana/ui';\nimport { ConfigSection } from '../ConfigSection/ConfigSection.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst ConnectionSettings = ({\n  config,\n  onChange,\n  description,\n  urlPlaceholder,\n  urlTooltip,\n  urlLabel,\n  className\n}) => {\n  const isValidUrl = /^(ftp|http|https):\\/\\/(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(\\/|\\/([\\w#!:.?+=&%@!\\-\\/]))?$/.test(\n    config.url\n  );\n  const styles = {\n    container: css({\n      maxWidth: 578\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(React__default.Fragment, null, /* @__PURE__ */ React__default.createElement(ConfigSection, { title: \"Connection\", description, className: cx(styles.container, className) }, /* @__PURE__ */ React__default.createElement(\n    InlineField,\n    {\n      htmlFor: \"connection-url\",\n      label: urlLabel || \"URL\",\n      labelWidth: 24,\n      tooltip: urlTooltip || /* @__PURE__ */ React__default.createElement(React__default.Fragment, null, \"Specify a complete HTTP URL\", /* @__PURE__ */ React__default.createElement(\"br\", null), \"(for example https://example.com:8080)\"),\n      grow: true,\n      disabled: config.readOnly,\n      required: true,\n      invalid: !isValidUrl && !config.readOnly,\n      error: isValidUrl ? \"\" : \"Please enter a valid URL\",\n      interactive: true\n    },\n    /* @__PURE__ */ React__default.createElement(\n      Input,\n      {\n        id: \"connection-url\",\n        \"aria-label\": \"Data source connection URL\",\n        onChange: (event) => onChange(__spreadProps(__spreadValues({}, config), {\n          url: event.currentTarget.value\n        })),\n        value: config.url || \"\",\n        placeholder: urlPlaceholder || \"URL\"\n      }\n    )\n  )));\n};\n\nexport { ConnectionSettings };\n//# sourceMappingURL=ConnectionSettings.js.map\n","import * as React from 'react';\nimport { HorizontalGroup, Input, Button } from '@grafana/ui';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nconst CONFIGURED_TEXT = \"configured\";\nconst RESET_BUTTON_TEXT = \"Reset\";\nconst SecretInput = (_a) => {\n  var _b = _a, { isConfigured, onReset } = _b, props = __objRest(_b, [\"isConfigured\", \"onReset\"]);\n  return /* @__PURE__ */ React.createElement(HorizontalGroup, null, !isConfigured && /* @__PURE__ */ React.createElement(Input, __spreadProps(__spreadValues({}, props), { type: \"password\" })), isConfigured && /* @__PURE__ */ React.createElement(Input, __spreadProps(__spreadValues({}, props), { type: \"text\", disabled: true, value: CONFIGURED_TEXT })), isConfigured && /* @__PURE__ */ React.createElement(Button, { onClick: onReset, variant: \"secondary\" }, RESET_BUTTON_TEXT));\n};\n\nexport { CONFIGURED_TEXT, RESET_BUTTON_TEXT, SecretInput };\n//# sourceMappingURL=SecretInput.js.map\n","import { css } from '@emotion/css';\n\nconst useCommonStyles = () => {\n  return {\n    inlineFieldNoMarginRight: css({\n      marginRight: 0\n    }),\n    // This is dirty hack to make configured secret input grow\n    inlineFieldWithSecret: css({\n      '[class$=\"layoutChildrenWrapper\"]:first-child': {\n        flexGrow: 1\n      }\n    })\n  };\n};\n\nexport { useCommonStyles };\n//# sourceMappingURL=styles.js.map\n","import React__default from 'react';\nimport { css, cx } from '@emotion/css';\nimport { InlineField, Input } from '@grafana/ui';\nimport { SecretInput } from '../common/SecretInput.js';\nimport { useCommonStyles } from '../styles.js';\n\nconst BasicAuth = ({\n  user,\n  passwordConfigured,\n  userTooltip = \"The username of the data source account\",\n  passwordTooltip = \"The password of the data source account\",\n  onUserChange,\n  onPasswordChange,\n  onPasswordReset,\n  readOnly\n}) => {\n  const commonStyles = useCommonStyles();\n  const styles = {\n    lastInlineField: css({\n      marginBottom: 0\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(React__default.Fragment, null, /* @__PURE__ */ React__default.createElement(\n    InlineField,\n    {\n      className: commonStyles.inlineFieldNoMarginRight,\n      label: \"User\",\n      labelWidth: 24,\n      tooltip: userTooltip,\n      required: true,\n      htmlFor: \"basic-auth-user-input\",\n      interactive: true,\n      grow: true,\n      disabled: readOnly\n    },\n    /* @__PURE__ */ React__default.createElement(\n      Input,\n      {\n        id: \"basic-auth-user-input\",\n        placeholder: \"User\",\n        value: user,\n        onChange: (e) => onUserChange(e.currentTarget.value),\n        required: true\n      }\n    )\n  ), /* @__PURE__ */ React__default.createElement(\n    InlineField,\n    {\n      className: cx(\n        commonStyles.inlineFieldNoMarginRight,\n        commonStyles.inlineFieldWithSecret,\n        styles.lastInlineField\n      ),\n      label: \"Password\",\n      labelWidth: 24,\n      tooltip: passwordTooltip,\n      required: true,\n      htmlFor: \"basic-auth-password-input\",\n      interactive: true,\n      grow: true,\n      disabled: readOnly\n    },\n    /* @__PURE__ */ React__default.createElement(\n      SecretInput,\n      {\n        id: \"basic-auth-password-input\",\n        isConfigured: passwordConfigured,\n        onReset: readOnly ? () => {\n        } : onPasswordReset,\n        placeholder: \"Password\",\n        onChange: (e) => onPasswordChange(e.currentTarget.value),\n        required: true\n      }\n    )\n  ));\n};\n\nexport { BasicAuth };\n//# sourceMappingURL=BasicAuth.js.map\n","import React__default from 'react';\nimport { GenericConfigSection } from './GenericConfigSection.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nconst ConfigSubSection = (_a) => {\n  var _b = _a, { children } = _b, props = __objRest(_b, [\"children\"]);\n  return /* @__PURE__ */ React__default.createElement(GenericConfigSection, __spreadProps(__spreadValues({}, props), { kind: \"sub-section\" }), children);\n};\n\nexport { ConfigSubSection };\n//# sourceMappingURL=ConfigSubSection.js.map\n","var AuthMethod = /* @__PURE__ */ ((AuthMethod2) => {\n  AuthMethod2[\"NoAuth\"] = \"NoAuth\";\n  AuthMethod2[\"BasicAuth\"] = \"BasicAuth\";\n  AuthMethod2[\"OAuthForward\"] = \"OAuthForward\";\n  AuthMethod2[\"CrossSiteCredentials\"] = \"CrossSiteCredentials\";\n  return AuthMethod2;\n})(AuthMethod || {});\n\nexport { AuthMethod };\n//# sourceMappingURL=types.js.map\n","import React__default, { useState, useMemo } from 'react';\nimport { css } from '@emotion/css';\nimport { useTheme2, Select } from '@grafana/ui';\nimport { BasicAuth } from './BasicAuth.js';\nimport { ConfigSubSection } from '../../ConfigSection/ConfigSubSection.js';\nimport { AuthMethod } from '../types.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst defaultOptions = {\n  [AuthMethod.BasicAuth]: {\n    label: \"Basic authentication\",\n    value: AuthMethod.BasicAuth,\n    description: \"Authenticate with your data source username and password\"\n  },\n  [AuthMethod.CrossSiteCredentials]: {\n    label: \"Enable cross-site access control requests\",\n    value: AuthMethod.CrossSiteCredentials,\n    description: \"Allow cross-site Access-Control requests with your existing credentials and cookies. This enables the server to authenticate the user and perform authorized requests on their behalf on other domains.\"\n  },\n  [AuthMethod.OAuthForward]: {\n    label: \"Forward OAuth Identity\",\n    value: AuthMethod.OAuthForward,\n    description: \"Forward the OAuth access token (and if available: the OIDC ID token) of the user querying to the data source\"\n  },\n  [AuthMethod.NoAuth]: {\n    label: \"No Authentication\",\n    value: AuthMethod.NoAuth,\n    description: \"Data source is available without authentication\"\n  }\n};\nconst AuthMethodSettings = ({\n  selectedMethod,\n  mostCommonMethod,\n  visibleMethods: visibleMethodsFromProps,\n  extendedDefaultOptions,\n  customMethods,\n  onAuthMethodSelect,\n  basicAuth,\n  readOnly\n}) => {\n  var _a, _b, _c, _d;\n  const [authMethodChanged, setAuthMethodChanged] = useState(false);\n  const { colors, spacing } = useTheme2();\n  const visibleMethods = useMemo(\n    () => {\n      var _a2;\n      return visibleMethodsFromProps != null ? visibleMethodsFromProps : [\n        AuthMethod.BasicAuth,\n        AuthMethod.OAuthForward,\n        AuthMethod.NoAuth,\n        ...(_a2 = customMethods == null ? void 0 : customMethods.map((m) => m.id)) != null ? _a2 : []\n      ];\n    },\n    [customMethods, visibleMethodsFromProps]\n  );\n  const hasSelect = visibleMethods.length > 1;\n  const preparedOptions = useMemo(() => {\n    var _a2;\n    const customOptions = (_a2 = customMethods == null ? void 0 : customMethods.reduce((acc, method) => {\n      acc[method.id] = {\n        label: method.label,\n        value: method.id,\n        description: method.description\n      };\n      return acc;\n    }, {})) != null ? _a2 : {};\n    const preparedDefaultOptions = {};\n    let k;\n    for (k in defaultOptions) {\n      if (extendedDefaultOptions && extendedDefaultOptions[k]) {\n        preparedDefaultOptions[k] = __spreadValues(__spreadValues({}, defaultOptions[k]), extendedDefaultOptions[k]);\n      } else {\n        preparedDefaultOptions[k] = defaultOptions[k];\n      }\n    }\n    const allOptions = __spreadValues(__spreadValues({}, customOptions), preparedDefaultOptions);\n    return visibleMethods.filter((method) => Boolean(allOptions[method])).map((method) => {\n      const option = allOptions[method];\n      if (method === mostCommonMethod && hasSelect) {\n        return __spreadProps(__spreadValues({}, option), {\n          label: `${option.label} (most common)`\n        });\n      }\n      return option;\n    });\n  }, [visibleMethods, customMethods, extendedDefaultOptions, mostCommonMethod, hasSelect]);\n  let selected = selectedMethod;\n  if (!hasSelect) {\n    selected = visibleMethods[0];\n  } else if (selectedMethod === AuthMethod.NoAuth && mostCommonMethod && !authMethodChanged) {\n    selected = mostCommonMethod;\n  }\n  let AuthFieldsComponent = null;\n  if (selected === AuthMethod.BasicAuth && basicAuth) {\n    AuthFieldsComponent = /* @__PURE__ */ React__default.createElement(BasicAuth, __spreadProps(__spreadValues({}, basicAuth), { readOnly }));\n  } else if (selected.startsWith(\"custom-\")) {\n    AuthFieldsComponent = (_b = (_a = customMethods == null ? void 0 : customMethods.find((m) => m.id === selected)) == null ? void 0 : _a.component) != null ? _b : null;\n  }\n  const title = hasSelect ? \"Authentication methods\" : (_c = preparedOptions[0].label) != null ? _c : \"\";\n  const description = hasSelect ? \"Choose an authentication method to access the data source\" : (_d = preparedOptions[0].description) != null ? _d : \"\";\n  const styles = {\n    authMethods: css(__spreadValues({\n      marginTop: spacing(2.5)\n    }, hasSelect && {\n      padding: spacing(2),\n      border: `1px solid ${colors.border.weak}`\n    })),\n    selectedMethodFields: css({\n      marginTop: spacing(1.5)\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(ConfigSubSection, { title, description }, /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.authMethods }, hasSelect && /* @__PURE__ */ React__default.createElement(\n    Select,\n    {\n      options: preparedOptions,\n      value: selected,\n      onChange: (option) => {\n        setAuthMethodChanged(true);\n        onAuthMethodSelect(option.value);\n      },\n      disabled: readOnly\n    }\n  ), AuthFieldsComponent && /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.selectedMethodFields }, AuthFieldsComponent)));\n};\n\nexport { AuthMethodSettings };\n//# sourceMappingURL=AuthMethodSettings.js.map\n","import { cx, css } from '@emotion/css';\nimport * as React from 'react';\nimport { useStyles2, HorizontalGroup, TextArea, Button } from '@grafana/ui';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nconst CONFIGURED_TEXT = \"configured\";\nconst RESET_BUTTON_TEXT = \"Reset\";\nconst getStyles = (theme) => {\n  return {\n    configuredStyle: css`\n      min-height: ${theme.spacing(theme.components.height.md)};\n      padding-top: ${theme.spacing(0.5)};\n      resize: none;\n    `\n  };\n};\nconst SecretTextArea = (_a) => {\n  var _b = _a, { isConfigured, onReset } = _b, props = __objRest(_b, [\"isConfigured\", \"onReset\"]);\n  const styles = useStyles2(getStyles);\n  return /* @__PURE__ */ React.createElement(HorizontalGroup, null, !isConfigured && /* @__PURE__ */ React.createElement(TextArea, __spreadValues({}, props)), isConfigured && /* @__PURE__ */ React.createElement(TextArea, __spreadProps(__spreadValues({}, props), { rows: 1, disabled: true, value: CONFIGURED_TEXT, className: cx(styles.configuredStyle) })), isConfigured && /* @__PURE__ */ React.createElement(Button, { onClick: onReset, variant: \"secondary\" }, RESET_BUTTON_TEXT));\n};\n\nexport { CONFIGURED_TEXT, RESET_BUTTON_TEXT, SecretTextArea };\n//# sourceMappingURL=SecretTextarea.js.map\n","import React__default from 'react';\nimport { css } from '@emotion/css';\nimport { useTheme2, Checkbox, Tooltip, Icon } from '@grafana/ui';\n\nconst TLSSettingsSection = ({ children, enabled, label, tooltipText, onToggle, readOnly }) => {\n  const { colors, spacing } = useTheme2();\n  const styles = {\n    container: css({\n      marginTop: 3\n    }),\n    checkboxContainer: css({\n      display: \"flex\",\n      alignItems: \"center\"\n    }),\n    infoIcon: css({\n      marginTop: -2,\n      marginLeft: 5,\n      color: colors.text.secondary\n    }),\n    content: css({\n      margin: spacing(1, 0, 2, 3)\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.container }, /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.checkboxContainer }, /* @__PURE__ */ React__default.createElement(Checkbox, { value: enabled, label, onChange: () => onToggle(!enabled), disabled: readOnly }), /* @__PURE__ */ React__default.createElement(Tooltip, { placement: \"top\", content: tooltipText, interactive: true }, /* @__PURE__ */ React__default.createElement(Icon, { name: \"info-circle\", className: styles.infoIcon, size: \"sm\" }))), enabled && children && /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.content }, children));\n};\n\nexport { TLSSettingsSection };\n//# sourceMappingURL=TLSSettingsSection.js.map\n","import React__default from 'react';\nimport { cx } from '@emotion/css';\nimport { InlineField } from '@grafana/ui';\nimport { SecretTextArea } from '../common/SecretTextarea.js';\nimport { TLSSettingsSection } from './TLSSettingsSection.js';\nimport { useCommonStyles } from '../styles.js';\n\nconst SelfSignedCertificate = ({\n  enabled,\n  certificateConfigured,\n  onToggle,\n  onCertificateChange,\n  onCertificateReset,\n  tooltips,\n  readOnly\n}) => {\n  var _a;\n  const commonStyles = useCommonStyles();\n  return /* @__PURE__ */ React__default.createElement(\n    TLSSettingsSection,\n    {\n      enabled,\n      label: \"Add self-signed certificate\",\n      tooltipText: \"Add your own Certificate Authority (CA) certificate on top of one generated by the certificate authorities for additional security measures\",\n      onToggle: (newEnabled) => onToggle(newEnabled),\n      readOnly\n    },\n    /* @__PURE__ */ React__default.createElement(\n      InlineField,\n      {\n        label: \"CA Certificate\",\n        labelWidth: 24,\n        tooltip: (_a = tooltips == null ? void 0 : tooltips.certificateLabel) != null ? _a : \"Your self-signed certificate\",\n        required: true,\n        htmlFor: \"self-signed-certificate-input\",\n        interactive: true,\n        grow: true,\n        className: cx(commonStyles.inlineFieldNoMarginRight, commonStyles.inlineFieldWithSecret),\n        disabled: readOnly\n      },\n      /* @__PURE__ */ React__default.createElement(\n        SecretTextArea,\n        {\n          id: \"self-signed-certificate-input\",\n          isConfigured: certificateConfigured,\n          onChange: (e) => onCertificateChange(e.currentTarget.value),\n          onReset: readOnly ? () => {\n          } : onCertificateReset,\n          placeholder: \"Begins with --- BEGIN CERTIFICATE ---\",\n          rows: 6,\n          required: true\n        }\n      )\n    )\n  );\n};\n\nexport { SelfSignedCertificate };\n//# sourceMappingURL=SelfSignedCertificate.js.map\n","import React__default from 'react';\nimport { cx } from '@emotion/css';\nimport { InlineField, Input } from '@grafana/ui';\nimport { SecretTextArea } from '../common/SecretTextarea.js';\nimport { TLSSettingsSection } from './TLSSettingsSection.js';\nimport { useCommonStyles } from '../styles.js';\n\nconst TLSClientAuth = ({\n  enabled,\n  serverName,\n  clientCertificateConfigured,\n  clientKeyConfigured,\n  onToggle,\n  onServerNameChange,\n  onClientCertificateChange,\n  onClientKeyChange,\n  onClientCertificateReset,\n  onClientKeyReset,\n  tooltips,\n  readOnly\n}) => {\n  var _a, _b, _c;\n  const commonStyles = useCommonStyles();\n  return /* @__PURE__ */ React__default.createElement(\n    TLSSettingsSection,\n    {\n      enabled,\n      label: \"TLS Client Authentication\",\n      tooltipText: \"Validate using TLS client authentication, in which the server authenticates the client\",\n      onToggle: (newEnabled) => onToggle(newEnabled),\n      readOnly\n    },\n    /* @__PURE__ */ React__default.createElement(\n      InlineField,\n      {\n        label: \"ServerName\",\n        labelWidth: 24,\n        tooltip: (_a = tooltips == null ? void 0 : tooltips.serverNameLabel) != null ? _a : \"A Servername is used to verify the hostname on the returned certificate\",\n        required: true,\n        htmlFor: \"client-auth-servername-input\",\n        interactive: true,\n        grow: true,\n        className: commonStyles.inlineFieldNoMarginRight,\n        disabled: readOnly\n      },\n      /* @__PURE__ */ React__default.createElement(\n        Input,\n        {\n          id: \"client-auth-servername-input\",\n          placeholder: \"domain.example.com\",\n          value: serverName,\n          onChange: (e) => onServerNameChange(e.currentTarget.value),\n          required: true\n        }\n      )\n    ),\n    /* @__PURE__ */ React__default.createElement(\n      InlineField,\n      {\n        label: \"Client Certificate\",\n        labelWidth: 24,\n        tooltip: (_b = tooltips == null ? void 0 : tooltips.certificateLabel) != null ? _b : \"The client certificate can be generated from a Certificate Authority or be self-signed\",\n        required: true,\n        htmlFor: \"client-auth-client-certificate-input\",\n        interactive: true,\n        grow: true,\n        className: cx(commonStyles.inlineFieldNoMarginRight, commonStyles.inlineFieldWithSecret),\n        disabled: readOnly\n      },\n      /* @__PURE__ */ React__default.createElement(\n        SecretTextArea,\n        {\n          id: \"client-auth-client-certificate-input\",\n          isConfigured: clientCertificateConfigured,\n          onChange: (e) => onClientCertificateChange(e.currentTarget.value),\n          onReset: readOnly ? () => {\n          } : onClientCertificateReset,\n          placeholder: \"Begins with --- BEGIN CERTIFICATE ---\",\n          rows: 6,\n          required: true\n        }\n      )\n    ),\n    /* @__PURE__ */ React__default.createElement(\n      InlineField,\n      {\n        label: \"Client Key\",\n        labelWidth: 24,\n        tooltip: (_c = tooltips == null ? void 0 : tooltips.keyLabel) != null ? _c : \"The client key can be generated from a Certificate Authority or be self-signed\",\n        required: true,\n        htmlFor: \"client-auth-client-key-input\",\n        interactive: true,\n        grow: true,\n        className: cx(commonStyles.inlineFieldNoMarginRight, commonStyles.inlineFieldWithSecret),\n        disabled: readOnly\n      },\n      /* @__PURE__ */ React__default.createElement(\n        SecretTextArea,\n        {\n          id: \"client-auth-client-key-input\",\n          isConfigured: clientKeyConfigured,\n          onChange: (e) => onClientKeyChange(e.currentTarget.value),\n          onReset: readOnly ? () => {\n          } : onClientKeyReset,\n          placeholder: `Begins with --- RSA PRIVATE KEY CERTIFICATE ---`,\n          rows: 6,\n          required: true\n        }\n      )\n    )\n  );\n};\n\nexport { TLSClientAuth };\n//# sourceMappingURL=TLSClientAuth.js.map\n","import React__default from 'react';\nimport { TLSSettingsSection } from './TLSSettingsSection.js';\n\nconst SkipTLSVerification = ({ enabled, onToggle, readOnly }) => {\n  return /* @__PURE__ */ React__default.createElement(\n    TLSSettingsSection,\n    {\n      enabled,\n      label: \"Skip TLS certificate validation\",\n      tooltipText: \"Skipping TLS certificate validation is not recommended unless absolutely necessary or for testing\",\n      onToggle: (newEnabled) => onToggle(newEnabled),\n      readOnly\n    }\n  );\n};\n\nexport { SkipTLSVerification };\n//# sourceMappingURL=SkipTLSVerification.js.map\n","import React__default from 'react';\nimport { css } from '@emotion/css';\nimport { useTheme2 } from '@grafana/ui';\nimport { SelfSignedCertificate } from './SelfSignedCertificate.js';\nimport { TLSClientAuth } from './TLSClientAuth.js';\nimport { SkipTLSVerification } from './SkipTLSVerification.js';\nimport { ConfigSubSection } from '../../ConfigSection/ConfigSubSection.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst TLSSettings = ({\n  selfSignedCertificate,\n  TLSClientAuth: TLSClientAuth$1,\n  skipTLSVerification,\n  readOnly\n}) => {\n  const { spacing } = useTheme2();\n  const styles = {\n    container: css({\n      marginTop: spacing(3)\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(\n    ConfigSubSection,\n    {\n      className: styles.container,\n      title: \"TLS settings\",\n      description: \"Additional security measures that can be applied on top of authentication\"\n    },\n    /* @__PURE__ */ React__default.createElement(SelfSignedCertificate, __spreadProps(__spreadValues({}, selfSignedCertificate), { readOnly })),\n    /* @__PURE__ */ React__default.createElement(TLSClientAuth, __spreadProps(__spreadValues({}, TLSClientAuth$1), { readOnly })),\n    /* @__PURE__ */ React__default.createElement(SkipTLSVerification, __spreadProps(__spreadValues({}, skipTLSVerification), { readOnly }))\n  );\n};\n\nexport { TLSSettings };\n//# sourceMappingURL=TLSSettings.js.map\n","import React__default from 'react';\nimport { css, cx } from '@emotion/css';\nimport { useTheme2, InlineFieldRow, InlineField, Input, IconButton } from '@grafana/ui';\nimport { SecretInput } from '../common/SecretInput.js';\nimport { useCommonStyles } from '../styles.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst CustomHeader = ({ header, onChange, onBlur, onDelete, readOnly }) => {\n  const { spacing } = useTheme2();\n  const commonStyles = useCommonStyles();\n  const styles = {\n    container: css({\n      alignItems: \"center\"\n    }),\n    input: css({\n      minWidth: \"100%\"\n    }),\n    headerNameField: css({\n      width: \"40%\",\n      marginRight: 0,\n      paddingRight: spacing(1)\n    }),\n    headerValueField: css({\n      width: \"45%\",\n      marginRight: 0\n    }),\n    removeHeaderBtn: css({\n      margin: `0 0 3px 10px`\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(React__default.Fragment, null, /* @__PURE__ */ React__default.createElement(InlineFieldRow, { className: styles.container }, /* @__PURE__ */ React__default.createElement(\n    InlineField,\n    {\n      label: \"Header\",\n      labelWidth: 9,\n      grow: true,\n      className: styles.headerNameField,\n      htmlFor: `custom-header-${header.id}-name-input`,\n      disabled: readOnly\n    },\n    /* @__PURE__ */ React__default.createElement(\n      Input,\n      {\n        id: `custom-header-${header.id}-name-input`,\n        placeholder: \"X-Custom-Header\",\n        value: header.name,\n        width: 12,\n        onChange: (e) => onChange(__spreadProps(__spreadValues({}, header), { name: e.currentTarget.value })),\n        onBlur,\n        className: styles.input\n      }\n    )\n  ), /* @__PURE__ */ React__default.createElement(\n    InlineField,\n    {\n      label: \"Value\",\n      labelWidth: 9,\n      grow: true,\n      className: cx(commonStyles.inlineFieldWithSecret, styles.headerValueField),\n      htmlFor: `custom-header-${header.id}-value-input`,\n      disabled: readOnly\n    },\n    /* @__PURE__ */ React__default.createElement(\n      SecretInput,\n      {\n        id: `custom-header-${header.id}-value-input`,\n        isConfigured: header.configured,\n        placeholder: \"Header value\",\n        value: header.value,\n        width: 12,\n        onChange: (e) => onChange(__spreadProps(__spreadValues({}, header), { value: e.currentTarget.value })),\n        onReset: readOnly ? () => {\n        } : () => onChange(__spreadProps(__spreadValues({}, header), { configured: false, value: \"\" })),\n        onBlur,\n        className: styles.input\n      }\n    )\n  ), /* @__PURE__ */ React__default.createElement(\n    IconButton,\n    {\n      name: \"trash-alt\",\n      tooltip: \"Remove header\",\n      tooltipPlacement: \"top\",\n      className: styles.removeHeaderBtn,\n      onClick: onDelete,\n      type: \"button\",\n      disabled: readOnly\n    }\n  )));\n};\n\nexport { CustomHeader };\n//# sourceMappingURL=CustomHeader.js.map\n","import React__default, { useState, useEffect } from 'react';\nimport { css } from '@emotion/css';\nimport { useTheme2, Button } from '@grafana/ui';\nimport { CustomHeader } from './CustomHeader.js';\nimport { ConfigSubSection } from '../../ConfigSection/ConfigSubSection.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst CustomHeaders = ({ headers: headersFromProps, onChange, readOnly }) => {\n  const { spacing } = useTheme2();\n  const [headers, setHeaders] = useState(\n    headersFromProps.map((header) => __spreadProps(__spreadValues({}, header), {\n      id: uniqueId(),\n      value: \"\"\n    }))\n  );\n  useEffect(() => {\n    setHeaders((headers2) => {\n      let changed = false;\n      const newHeaders = headers2.map((header) => {\n        var _a;\n        const configured = (_a = headersFromProps.find((h) => h.name === header.name)) == null ? void 0 : _a.configured;\n        if (typeof configured !== \"undefined\" && header.configured !== configured) {\n          changed = true;\n          return __spreadProps(__spreadValues({}, header), { configured });\n        }\n        return header;\n      });\n      if (changed) {\n        return newHeaders;\n      }\n      return headers2;\n    });\n  }, [headersFromProps]);\n  const onHeaderAdd = () => {\n    setHeaders([...headers, { id: uniqueId(), name: \"\", value: \"\", configured: false }]);\n  };\n  const onHeaderChange = (id, header) => {\n    setHeaders(headers.map((h) => h.id === id ? __spreadValues({}, header) : h));\n  };\n  const onHeaderDelete = (id) => {\n    const index = headers.findIndex((h) => h.id === id);\n    if (index === -1) {\n      return;\n    }\n    const newHeaders = [...headers];\n    newHeaders.splice(index, 1);\n    setHeaders(newHeaders);\n    onChange(\n      newHeaders.map(({ name, value, configured }) => ({\n        name,\n        value,\n        configured\n      }))\n    );\n  };\n  const onBlur = () => {\n    onChange(\n      headers.map(({ name, value, configured }) => ({\n        name,\n        value,\n        configured\n      }))\n    );\n  };\n  const styles = {\n    container: css({\n      marginTop: spacing(3)\n    }),\n    addHeaderButton: css({\n      marginTop: spacing(1.5)\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.container }, /* @__PURE__ */ React__default.createElement(\n    ConfigSubSection,\n    {\n      title: \"HTTP headers\",\n      description: \"Pass along additional context and metadata about the request/response\",\n      isCollapsible: true,\n      isInitiallyOpen: headers.length > 0\n    },\n    /* @__PURE__ */ React__default.createElement(\"div\", null, headers.map((header) => /* @__PURE__ */ React__default.createElement(\n      CustomHeader,\n      {\n        key: header.id,\n        header,\n        onChange: (header2) => onHeaderChange(header2.id, header2),\n        onDelete: () => onHeaderDelete(header.id),\n        onBlur,\n        readOnly\n      }\n    ))),\n    /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.addHeaderButton }, /* @__PURE__ */ React__default.createElement(Button, { icon: \"plus\", variant: \"secondary\", fill: \"outline\", onClick: onHeaderAdd, disabled: readOnly }, headers.length === 0 ? \"Add header\" : \"Add another header\"))\n  ));\n};\nfunction uniqueId() {\n  return Math.random().toString(16).slice(2);\n}\n\nexport { CustomHeaders };\n//# sourceMappingURL=CustomHeaders.js.map\n","import React__default from 'react';\nimport { css } from '@emotion/css';\nimport { AuthMethodSettings } from './auth-method/AuthMethodSettings.js';\nimport { TLSSettings } from './tls/TLSSettings.js';\nimport { CustomHeaders } from './custom-headers/CustomHeaders.js';\nimport { ConfigSection } from '../ConfigSection/ConfigSection.js';\nimport '@grafana/ui';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst Auth = ({\n  selectedMethod,\n  mostCommonMethod,\n  visibleMethods,\n  extendedDefaultOptions,\n  customMethods,\n  onAuthMethodSelect,\n  basicAuth,\n  TLS,\n  customHeaders,\n  readOnly = false\n}) => {\n  const styles = {\n    container: css({\n      maxWidth: 578\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.container }, /* @__PURE__ */ React__default.createElement(ConfigSection, { title: \"Authentication\" }, /* @__PURE__ */ React__default.createElement(\n    AuthMethodSettings,\n    {\n      selectedMethod,\n      mostCommonMethod,\n      customMethods,\n      visibleMethods,\n      extendedDefaultOptions,\n      onAuthMethodSelect,\n      basicAuth,\n      readOnly\n    }\n  ), TLS && /* @__PURE__ */ React__default.createElement(TLSSettings, __spreadProps(__spreadValues({}, TLS), { readOnly })), customHeaders && /* @__PURE__ */ React__default.createElement(CustomHeaders, __spreadProps(__spreadValues({}, customHeaders), { readOnly }))));\n};\n\nexport { Auth };\n//# sourceMappingURL=Auth.js.map\n","import { AuthMethod } from './types.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst headerNamePrefix = \"httpHeaderName\";\nconst headerValuePrefix = \"httpHeaderValue\";\nfunction convertLegacyAuthProps({\n  config,\n  onChange\n}) {\n  const props = {\n    selectedMethod: getSelectedMethod(config),\n    onAuthMethodSelect: getOnAuthMethodSelectHandler(config, onChange),\n    basicAuth: getBasicAuthProps(config, onChange),\n    TLS: getTLSProps(config, onChange),\n    customHeaders: getCustomHeaders(config, onChange),\n    readOnly: config.readOnly\n  };\n  return props;\n}\nfunction getSelectedMethod(config) {\n  if (config.basicAuth) {\n    return AuthMethod.BasicAuth;\n  }\n  if (config.withCredentials) {\n    return AuthMethod.CrossSiteCredentials;\n  }\n  if (config.jsonData.oauthPassThru) {\n    return AuthMethod.OAuthForward;\n  }\n  return AuthMethod.NoAuth;\n}\nfunction getOnAuthMethodSelectHandler(config, onChange) {\n  return (method) => {\n    onChange(__spreadProps(__spreadValues({}, config), {\n      basicAuth: method === AuthMethod.BasicAuth,\n      withCredentials: method === AuthMethod.CrossSiteCredentials,\n      jsonData: __spreadProps(__spreadValues({}, config.jsonData), {\n        oauthPassThru: method === AuthMethod.OAuthForward\n      })\n    }));\n  };\n}\nfunction getBasicAuthProps(config, onChange) {\n  return {\n    user: config.basicAuthUser,\n    passwordConfigured: config.secureJsonFields.basicAuthPassword,\n    onUserChange: (user) => onChange(__spreadProps(__spreadValues({}, config), { basicAuthUser: user })),\n    onPasswordChange: (password) => onChange(__spreadProps(__spreadValues({}, config), {\n      secureJsonData: __spreadProps(__spreadValues({}, config.secureJsonData), {\n        basicAuthPassword: password\n      })\n    })),\n    onPasswordReset: () => onChange(__spreadProps(__spreadValues({}, config), {\n      secureJsonData: __spreadProps(__spreadValues({}, config.secureJsonData), { basicAuthPassword: \"\" }),\n      secureJsonFields: __spreadProps(__spreadValues({}, config.secureJsonFields), {\n        basicAuthPassword: false\n      })\n    }))\n  };\n}\nfunction getTLSProps(config, onChange) {\n  return {\n    selfSignedCertificate: {\n      enabled: Boolean(config.jsonData.tlsAuthWithCACert),\n      certificateConfigured: config.secureJsonFields.tlsCACert,\n      onToggle: (enabled) => onChange(__spreadProps(__spreadValues({}, config), {\n        jsonData: __spreadProps(__spreadValues({}, config.jsonData), { tlsAuthWithCACert: enabled })\n      })),\n      onCertificateChange: (certificate) => onChange(__spreadProps(__spreadValues({}, config), {\n        secureJsonData: __spreadProps(__spreadValues({}, config.secureJsonData), { tlsCACert: certificate })\n      })),\n      onCertificateReset: () => onChange(__spreadProps(__spreadValues({}, config), {\n        secureJsonData: __spreadProps(__spreadValues({}, config.secureJsonData), { tlsCACert: \"\" }),\n        secureJsonFields: __spreadProps(__spreadValues({}, config.secureJsonFields), { tlsCACert: false })\n      }))\n    },\n    TLSClientAuth: {\n      enabled: config.jsonData.tlsAuth,\n      serverName: config.jsonData.serverName,\n      clientCertificateConfigured: config.secureJsonFields.tlsClientCert,\n      clientKeyConfigured: config.secureJsonFields.tlsClientKey,\n      onToggle: (enabled) => onChange(__spreadProps(__spreadValues({}, config), {\n        jsonData: __spreadProps(__spreadValues({}, config.jsonData), { tlsAuth: enabled })\n      })),\n      onServerNameChange: (serverName) => onChange(__spreadProps(__spreadValues({}, config), {\n        jsonData: __spreadProps(__spreadValues({}, config.jsonData), { serverName })\n      })),\n      onClientCertificateChange: (clientCertificate) => onChange(__spreadProps(__spreadValues({}, config), {\n        secureJsonData: __spreadProps(__spreadValues({}, config.secureJsonData), {\n          tlsClientCert: clientCertificate\n        })\n      })),\n      onClientCertificateReset: () => onChange(__spreadProps(__spreadValues({}, config), {\n        secureJsonData: __spreadProps(__spreadValues({}, config.secureJsonData), {\n          tlsClientCert: \"\"\n        }),\n        secureJsonFields: __spreadProps(__spreadValues({}, config.secureJsonFields), {\n          tlsClientCert: false\n        })\n      })),\n      onClientKeyChange: (clientKey) => onChange(__spreadProps(__spreadValues({}, config), {\n        secureJsonData: __spreadProps(__spreadValues({}, config.secureJsonData), {\n          tlsClientKey: clientKey\n        })\n      })),\n      onClientKeyReset: () => onChange(__spreadProps(__spreadValues({}, config), {\n        secureJsonData: __spreadProps(__spreadValues({}, config.secureJsonData), {\n          tlsClientKey: \"\"\n        }),\n        secureJsonFields: __spreadProps(__spreadValues({}, config.secureJsonFields), {\n          tlsClientKey: false\n        })\n      }))\n    },\n    skipTLSVerification: {\n      enabled: config.jsonData.tlsSkipVerify,\n      onToggle: (enabled) => onChange(__spreadProps(__spreadValues({}, config), {\n        jsonData: __spreadProps(__spreadValues({}, config.jsonData), { tlsSkipVerify: enabled })\n      }))\n    }\n  };\n}\nfunction getCustomHeaders(config, onChange) {\n  const headers = Object.keys(config.jsonData).filter((key) => key.startsWith(headerNamePrefix)).sort().map((key) => {\n    var _a;\n    const index = key.slice(headerNamePrefix.length);\n    return {\n      name: config.jsonData[key],\n      configured: (_a = config.secureJsonFields[`${headerValuePrefix}${index}`]) != null ? _a : false\n    };\n  });\n  return {\n    headers,\n    onChange: (headers2) => {\n      const newJsonData = Object.fromEntries(\n        Object.entries(config.jsonData).filter(([key]) => !key.startsWith(headerNamePrefix))\n      );\n      const newSecureJsonData = Object.fromEntries(\n        Object.entries(config.secureJsonData || {}).filter(([key]) => !key.startsWith(headerValuePrefix))\n      );\n      const newSecureJsonFields = Object.fromEntries(\n        Object.entries(config.secureJsonFields).filter(([key]) => !key.startsWith(headerValuePrefix))\n      );\n      headers2.forEach((header, index) => {\n        newJsonData[`${headerNamePrefix}${index + 1}`] = header.name;\n        if (header.configured) {\n          newSecureJsonFields[`${headerValuePrefix}${index + 1}`] = true;\n        } else {\n          newSecureJsonData[`${headerValuePrefix}${index + 1}`] = header.value;\n        }\n      });\n      onChange(__spreadProps(__spreadValues({}, config), {\n        jsonData: newJsonData,\n        secureJsonData: newSecureJsonData,\n        secureJsonFields: newSecureJsonFields\n      }));\n    }\n  };\n}\n\nexport { convertLegacyAuthProps, getBasicAuthProps, getCustomHeaders, getOnAuthMethodSelectHandler, getSelectedMethod, getTLSProps };\n//# sourceMappingURL=utils.js.map\n","import React__default from 'react';\nimport { css, cx } from '@emotion/css';\nimport { InlineField, TagsInput, Input } from '@grafana/ui';\nimport { ConfigSubSection } from '../ConfigSection/ConfigSubSection.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst AdvancedHttpSettings = ({\n  config,\n  onChange,\n  className\n}) => {\n  const onCookiesChange = (cookies) => {\n    onChange(__spreadProps(__spreadValues({}, config), {\n      jsonData: __spreadProps(__spreadValues({}, config.jsonData), {\n        keepCookies: cookies\n      })\n    }));\n  };\n  const onTimeoutChange = (event) => {\n    onChange(__spreadProps(__spreadValues({}, config), {\n      jsonData: __spreadProps(__spreadValues({}, config.jsonData), {\n        timeout: parseInt(event.currentTarget.value, 10)\n      })\n    }));\n  };\n  const styles = {\n    container: css({\n      maxWidth: 578\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(ConfigSubSection, { title: \"Advanced HTTP settings\", className: cx(styles.container, className) }, /* @__PURE__ */ React__default.createElement(\n    InlineField,\n    {\n      htmlFor: \"advanced-http-cookies\",\n      label: \"Allowed cookies\",\n      labelWidth: 24,\n      tooltip: \"Grafana proxy deletes forwarded cookies by default. Specify cookies by name that should be forwarded to the data source.\",\n      disabled: config.readOnly,\n      grow: true\n    },\n    /* @__PURE__ */ React__default.createElement(\n      TagsInput,\n      {\n        id: \"advanced-http-cookies\",\n        placeholder: \"New cookie (hit enter to add)\",\n        tags: config.jsonData.keepCookies,\n        onChange: onCookiesChange\n      }\n    )\n  ), /* @__PURE__ */ React__default.createElement(\n    InlineField,\n    {\n      htmlFor: \"advanced-http-timeout\",\n      label: \"Timeout\",\n      labelWidth: 24,\n      tooltip: \"HTTP request timeout in seconds\",\n      disabled: config.readOnly,\n      grow: true\n    },\n    /* @__PURE__ */ React__default.createElement(\n      Input,\n      {\n        id: \"advanced-http-timeout\",\n        type: \"number\",\n        min: 0,\n        placeholder: \"Timeout in seconds\",\n        \"aria-label\": \"Timeout in seconds\",\n        value: config.jsonData.timeout,\n        onChange: onTimeoutChange\n      }\n    )\n  ));\n};\n\nexport { AdvancedHttpSettings };\n//# sourceMappingURL=AdvancedHttpSettings.js.map\n","import { css } from '@emotion/css';\nimport React__default from 'react';\nimport { useStyles2 } from '@grafana/ui';\n\nfunction ConfigDescriptionLink(props) {\n  const { description, suffix, feature } = props;\n  const text = `Learn more about ${feature}`;\n  const styles = useStyles2(getStyles);\n  return /* @__PURE__ */ React__default.createElement(\"span\", { className: styles.container }, description, /* @__PURE__ */ React__default.createElement(\n    \"a\",\n    {\n      \"aria-label\": text,\n      href: `https://grafana.com/docs/grafana/next/datasources/${suffix}`,\n      rel: \"noreferrer\",\n      target: \"_blank\"\n    },\n    text\n  ));\n}\nconst getStyles = (theme) => {\n  return {\n    container: css({\n      color: theme.colors.text.secondary,\n      a: css({\n        color: theme.colors.text.link,\n        textDecoration: \"underline\",\n        marginLeft: \"5px\",\n        \"&:hover\": {\n          textDecoration: \"none\"\n        }\n      })\n    })\n  };\n};\n\nexport { ConfigDescriptionLink };\n//# sourceMappingURL=ConfigDescriptionLink.js.map\n","export const validateIntervalRegex = /^(-?\\d+(?:\\.\\d+)?)(ms|[Mwdhmsy])$/;\n\nexport const validateInterval = (val: string, regex: RegExp) => {\n  const matches = val.match(regex);\n  return matches || !val ? false : true;\n};\n","import React, { useState } from 'react';\nimport { useDebounce } from 'react-use';\n\nimport { InlineField, Input } from '@grafana/ui';\n\nimport { validateInterval, validateIntervalRegex } from './validation';\n\ninterface Props {\n  value: string;\n  onChange: (val: string) => void;\n  isInvalidError: string;\n  placeholder?: string;\n  width?: number;\n  ariaLabel?: string;\n  label?: string;\n  tooltip?: string;\n  disabled?: boolean;\n  validationRegex?: RegExp;\n}\n\ninterface FieldProps {\n  labelWidth: number;\n  disabled: boolean;\n  invalid: boolean;\n  error: string;\n  label?: string;\n  tooltip?: string;\n}\n\nexport const IntervalInput = (props: Props) => {\n  const validationRegex = props.validationRegex || validateIntervalRegex;\n  const [intervalIsInvalid, setIntervalIsInvalid] = useState(() => {\n    return props.value ? validateInterval(props.value, validationRegex) : false;\n  });\n\n  useDebounce(\n    () => {\n      setIntervalIsInvalid(validateInterval(props.value, validationRegex));\n    },\n    500,\n    [props.value]\n  );\n\n  const fieldProps: FieldProps = {\n    labelWidth: 26,\n    disabled: props.disabled ?? false,\n    invalid: intervalIsInvalid,\n    error: props.isInvalidError,\n  };\n  if (props.label) {\n    fieldProps.label = props.label;\n    fieldProps.tooltip = props.tooltip || '';\n  }\n\n  return (\n    <InlineField {...fieldProps}>\n      <Input\n        type=\"text\"\n        placeholder={props.placeholder || '0'}\n        width={props.width || 40}\n        onChange={(e) => {\n          props.onChange(e.currentTarget.value);\n        }}\n        value={props.value}\n        aria-label={props.ariaLabel || 'interval input'}\n      />\n    </InlineField>\n  );\n};\n","import { useEffect } from 'react';\nimport useTimeoutFn from './useTimeoutFn';\nexport default function useDebounce(fn, ms, deps) {\n    if (ms === void 0) { ms = 0; }\n    if (deps === void 0) { deps = []; }\n    var _a = useTimeoutFn(fn, ms), isReady = _a[0], cancel = _a[1], reset = _a[2];\n    useEffect(reset, deps);\n    return [isReady, cancel];\n}\n","import { useCallback, useEffect, useRef } from 'react';\nexport default function useTimeoutFn(fn, ms) {\n    if (ms === void 0) { ms = 0; }\n    var ready = useRef(false);\n    var timeout = useRef();\n    var callback = useRef(fn);\n    var isReady = useCallback(function () { return ready.current; }, []);\n    var set = useCallback(function () {\n        ready.current = false;\n        timeout.current && clearTimeout(timeout.current);\n        timeout.current = setTimeout(function () {\n            ready.current = true;\n            callback.current();\n        }, ms);\n    }, [ms]);\n    var clear = useCallback(function () {\n        ready.current = null;\n        timeout.current && clearTimeout(timeout.current);\n    }, []);\n    // update ref when function changes\n    useEffect(function () {\n        callback.current = fn;\n    }, [fn]);\n    // set on mount, clear on unmount\n    useEffect(function () {\n        set();\n        return clear;\n    }, [ms]);\n    return [isReady, clear, set];\n}\n","import { css, cx } from '@emotion/css';\nimport React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { InlineLabel, SegmentInput, ToolbarButton, useStyles2 } from '@grafana/ui';\n\nimport { TraceToLogsTag } from './TraceToLogsSettings';\n\ninterface Props {\n  values: TraceToLogsTag[];\n  onChange: (values: TraceToLogsTag[]) => void;\n  id?: string;\n}\n\nexport const TagMappingInput = ({ values, onChange, id }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <div className={styles.wrapper}>\n      {values.length ? (\n        values.map((value, idx) => (\n          <div className={styles.pair} key={idx}>\n            <SegmentInput\n              id={`${id}-key-${idx}`}\n              placeholder={'Tag name'}\n              value={value.key}\n              onChange={(e) => {\n                onChange(\n                  values.map((v, i) => {\n                    if (i === idx) {\n                      return { ...v, key: String(e) };\n                    }\n                    return v;\n                  })\n                );\n              }}\n            />\n            <InlineLabel aria-label=\"equals\" className={styles.operator}>\n              as\n            </InlineLabel>\n            <SegmentInput\n              id={`${id}-value-${idx}`}\n              placeholder={'New name (optional)'}\n              value={value.value || ''}\n              onChange={(e) => {\n                onChange(\n                  values.map((v, i) => {\n                    if (i === idx) {\n                      return { ...v, value: String(e) };\n                    }\n                    return v;\n                  })\n                );\n              }}\n            />\n            <ToolbarButton\n              onClick={() => onChange([...values.slice(0, idx), ...values.slice(idx + 1)])}\n              className={cx(styles.removeTag, 'query-part')}\n              aria-label=\"Remove tag\"\n              type=\"button\"\n              icon=\"times\"\n            />\n\n            {idx === values.length - 1 ? (\n              <ToolbarButton\n                onClick={() => onChange([...values, { key: '', value: '' }])}\n                className=\"query-part\"\n                aria-label=\"Add tag\"\n                type=\"button\"\n                icon=\"plus\"\n              />\n            ) : null}\n          </div>\n        ))\n      ) : (\n        <ToolbarButton\n          icon=\"plus\"\n          onClick={() => onChange([...values, { key: '', value: '' }])}\n          className=\"query-part\"\n          aria-label=\"Add tag\"\n          type=\"button\"\n        />\n      )}\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    display: 'flex',\n    flexDirection: 'column',\n    gap: `${theme.spacing(0.5)} 0`,\n  }),\n  pair: css({\n    display: 'flex',\n    justifyContent: 'start',\n    alignItems: 'center',\n  }),\n  operator: css({\n    color: theme.v1.palette.orange,\n    width: 'auto',\n  }),\n  removeTag: css({\n    marginRight: theme.spacing(0.5),\n  }),\n});\n","import { css } from '@emotion/css';\nimport React, { useCallback, useMemo } from 'react';\n\nimport { DataSourceJsonData, DataSourceInstanceSettings, DataSourcePluginOptionsEditorProps } from '@grafana/data';\nimport { ConfigDescriptionLink, ConfigSection } from '@grafana/experimental';\nimport { DataSourcePicker } from '@grafana/runtime';\nimport { InlineField, InlineFieldRow, Input, InlineSwitch } from '@grafana/ui';\n\nimport { IntervalInput } from '../IntervalInput/IntervalInput';\n\nimport { TagMappingInput } from './TagMappingInput';\n\nexport interface TraceToLogsTag {\n  key: string;\n  value?: string;\n}\n\n// @deprecated use getTraceToLogsOptions to get the v2 version of this config from jsonData\nexport interface TraceToLogsOptions {\n  datasourceUid?: string;\n  tags?: string[];\n  mappedTags?: TraceToLogsTag[];\n  mapTagNamesEnabled?: boolean;\n  spanStartTimeShift?: string;\n  spanEndTimeShift?: string;\n  filterByTraceID?: boolean;\n  filterBySpanID?: boolean;\n  lokiSearch?: boolean; // legacy\n}\n\nexport interface TraceToLogsOptionsV2 {\n  datasourceUid?: string;\n  tags?: TraceToLogsTag[];\n  spanStartTimeShift?: string;\n  spanEndTimeShift?: string;\n  filterByTraceID?: boolean;\n  filterBySpanID?: boolean;\n  query?: string;\n  customQuery: boolean;\n}\n\nexport interface TraceToLogsData extends DataSourceJsonData {\n  tracesToLogs?: TraceToLogsOptions;\n  tracesToLogsV2?: TraceToLogsOptionsV2;\n}\n\n/**\n * Gets new version of the traceToLogs config from the json data either returning directly or transforming the old\n * version to new and returning that.\n */\nexport function getTraceToLogsOptions(data?: TraceToLogsData): TraceToLogsOptionsV2 | undefined {\n  if (data?.tracesToLogsV2) {\n    return data.tracesToLogsV2;\n  }\n  if (!data?.tracesToLogs) {\n    return undefined;\n  }\n  const traceToLogs: TraceToLogsOptionsV2 = {\n    customQuery: false,\n  };\n  traceToLogs.datasourceUid = data.tracesToLogs.datasourceUid;\n  traceToLogs.tags = data.tracesToLogs.mapTagNamesEnabled\n    ? data.tracesToLogs.mappedTags\n    : data.tracesToLogs.tags?.map((tag) => ({ key: tag }));\n  traceToLogs.filterByTraceID = data.tracesToLogs.filterByTraceID;\n  traceToLogs.filterBySpanID = data.tracesToLogs.filterBySpanID;\n  traceToLogs.spanStartTimeShift = data.tracesToLogs.spanStartTimeShift;\n  traceToLogs.spanEndTimeShift = data.tracesToLogs.spanEndTimeShift;\n  return traceToLogs;\n}\n\ninterface Props extends DataSourcePluginOptionsEditorProps<TraceToLogsData> {}\n\nexport function TraceToLogsSettings({ options, onOptionsChange }: Props) {\n  const supportedDataSourceTypes = [\n    'loki',\n    'elasticsearch',\n    'grafana-splunk-datasource', // external\n    'grafana-opensearch-datasource', // external\n    'grafana-falconlogscale-datasource', // external\n    'googlecloud-logging-datasource', // external\n  ];\n\n  const traceToLogs = useMemo(\n    (): TraceToLogsOptionsV2 => getTraceToLogsOptions(options.jsonData) || { customQuery: false },\n    [options.jsonData]\n  );\n  const { query = '', tags, customQuery } = traceToLogs;\n\n  const updateTracesToLogs = useCallback(\n    (value: Partial<TraceToLogsOptionsV2>) => {\n      // Cannot use updateDatasourcePluginJsonDataOption here as we need to update 2 keys, and they would overwrite each\n      // other as updateDatasourcePluginJsonDataOption isn't synchronized\n      onOptionsChange({\n        ...options,\n        jsonData: {\n          ...options.jsonData,\n          tracesToLogsV2: {\n            ...traceToLogs,\n            ...value,\n          },\n          tracesToLogs: undefined,\n        },\n      });\n    },\n    [onOptionsChange, options, traceToLogs]\n  );\n\n  return (\n    <div className={css({ width: '100%' })}>\n      <InlineFieldRow>\n        <InlineField\n          tooltip=\"The logs data source the trace is going to navigate to\"\n          label=\"Data source\"\n          labelWidth={26}\n        >\n          <DataSourcePicker\n            inputId=\"trace-to-logs-data-source-picker\"\n            filter={(ds) => supportedDataSourceTypes.includes(ds.type)}\n            current={traceToLogs.datasourceUid}\n            noDefault={true}\n            width={40}\n            onChange={(ds: DataSourceInstanceSettings) =>\n              updateTracesToLogs({\n                datasourceUid: ds.uid,\n              })\n            }\n          />\n        </InlineField>\n      </InlineFieldRow>\n\n      <InlineFieldRow>\n        <IntervalInput\n          label={getTimeShiftLabel('start')}\n          tooltip={getTimeShiftTooltip('start', '0')}\n          value={traceToLogs.spanStartTimeShift || ''}\n          onChange={(val) => {\n            updateTracesToLogs({ spanStartTimeShift: val });\n          }}\n          isInvalidError={invalidTimeShiftError}\n        />\n      </InlineFieldRow>\n\n      <InlineFieldRow>\n        <IntervalInput\n          label={getTimeShiftLabel('end')}\n          tooltip={getTimeShiftTooltip('end', '0')}\n          value={traceToLogs.spanEndTimeShift || ''}\n          onChange={(val) => {\n            updateTracesToLogs({ spanEndTimeShift: val });\n          }}\n          isInvalidError={invalidTimeShiftError}\n        />\n      </InlineFieldRow>\n\n      <InlineFieldRow>\n        <InlineField\n          tooltip=\"Tags that will be used in the query. Default tags: 'cluster', 'hostname', 'namespace', 'pod', 'service.name', 'service.namespace'\"\n          label=\"Tags\"\n          labelWidth={26}\n        >\n          <TagMappingInput values={tags ?? []} onChange={(v) => updateTracesToLogs({ tags: v })} />\n        </InlineField>\n      </InlineFieldRow>\n\n      <IdFilter\n        disabled={customQuery}\n        type={'trace'}\n        id={'filterByTraceID'}\n        value={Boolean(traceToLogs.filterByTraceID)}\n        onChange={(val) => updateTracesToLogs({ filterByTraceID: val })}\n      />\n      <IdFilter\n        disabled={customQuery}\n        type={'span'}\n        id={'filterBySpanID'}\n        value={Boolean(traceToLogs.filterBySpanID)}\n        onChange={(val) => updateTracesToLogs({ filterBySpanID: val })}\n      />\n\n      <InlineFieldRow>\n        <InlineField\n          tooltip=\"Use a custom query with the possibility to interpolate variables from the trace or span\"\n          label=\"Use custom query\"\n          labelWidth={26}\n        >\n          <InlineSwitch\n            id={'customQuerySwitch'}\n            value={customQuery}\n            onChange={(event: React.SyntheticEvent<HTMLInputElement>) =>\n              updateTracesToLogs({ customQuery: event.currentTarget.checked })\n            }\n          />\n        </InlineField>\n      </InlineFieldRow>\n\n      {customQuery && (\n        <InlineField\n          label=\"Query\"\n          labelWidth={26}\n          tooltip=\"The query that will run when navigating from a trace to logs data source. Interpolate tags using the `$__tags` keyword\"\n          grow\n        >\n          <Input\n            label=\"Query\"\n            type=\"text\"\n            allowFullScreen\n            value={query}\n            onChange={(e) => updateTracesToLogs({ query: e.currentTarget.value })}\n          />\n        </InlineField>\n      )}\n    </div>\n  );\n}\n\ninterface IdFilterProps {\n  type: 'trace' | 'span';\n  id: string;\n  value: boolean;\n  onChange: (val: boolean) => void;\n  disabled: boolean;\n}\nfunction IdFilter(props: IdFilterProps) {\n  return (\n    <InlineFieldRow>\n      <InlineField\n        disabled={props.disabled}\n        label={`Filter by ${props.type} ID`}\n        labelWidth={26}\n        grow\n        tooltip={`Filters logs by ${props.type} ID, where the ${props.type} ID should be part of the log line`}\n      >\n        <InlineSwitch\n          id={props.id}\n          value={props.value}\n          onChange={(event: React.SyntheticEvent<HTMLInputElement>) => props.onChange(event.currentTarget.checked)}\n        />\n      </InlineField>\n    </InlineFieldRow>\n  );\n}\n\nexport const getTimeShiftLabel = (type: 'start' | 'end') => {\n  return `Span ${type} time shift`;\n};\n\nexport const getTimeShiftTooltip = (type: 'start' | 'end', defaultVal: string) => {\n  return `Shifts the ${type} time of the span. Default: ${defaultVal} (Time units can be used here, for example: 5s, -1m, 3h)`;\n};\n\nexport const invalidTimeShiftError = 'Invalid time shift. See tooltip for examples.';\n\nexport const TraceToLogsSection = ({ options, onOptionsChange }: DataSourcePluginOptionsEditorProps) => {\n  let suffix = options.type;\n  suffix += options.type === 'tempo' ? '/configure-tempo-data-source/#trace-to-logs' : '/#trace-to-logs';\n\n  return (\n    <ConfigSection\n      title=\"Trace to logs\"\n      description={\n        <ConfigDescriptionLink\n          description=\"Navigate from a trace span to the selected data source's logs.\"\n          suffix={suffix}\n          feature=\"trace to logs\"\n        />\n      }\n      isCollapsible={true}\n      isInitiallyOpen={true}\n    >\n      <TraceToLogsSettings options={options} onOptionsChange={onOptionsChange} />\n    </ConfigSection>\n  );\n};\n","import { css } from '@emotion/css';\nimport React from 'react';\n\nimport {\n  DataSourceInstanceSettings,\n  DataSourceJsonData,\n  DataSourcePluginOptionsEditorProps,\n  GrafanaTheme2,\n  updateDatasourcePluginJsonDataOption,\n} from '@grafana/data';\nimport { ConfigDescriptionLink, ConfigSection } from '@grafana/experimental';\nimport { DataSourcePicker } from '@grafana/runtime';\nimport { Button, InlineField, InlineFieldRow, Input, useStyles2 } from '@grafana/ui';\n\nimport { IntervalInput } from '../IntervalInput/IntervalInput';\nimport { TagMappingInput } from '../TraceToLogs/TagMappingInput';\nimport { getTimeShiftLabel, getTimeShiftTooltip, invalidTimeShiftError } from '../TraceToLogs/TraceToLogsSettings';\n\nexport interface TraceToMetricsOptions {\n  datasourceUid?: string;\n  tags?: Array<{ key: string; value: string }>;\n  queries: TraceToMetricQuery[];\n  spanStartTimeShift?: string;\n  spanEndTimeShift?: string;\n}\n\nexport interface TraceToMetricQuery {\n  name?: string;\n  query?: string;\n}\n\nexport interface TraceToMetricsData extends DataSourceJsonData {\n  tracesToMetrics?: TraceToMetricsOptions;\n}\n\ninterface Props extends DataSourcePluginOptionsEditorProps<TraceToMetricsData> {}\n\nexport function TraceToMetricsSettings({ options, onOptionsChange }: Props) {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <div className={css({ width: '100%' })}>\n      <InlineFieldRow className={styles.row}>\n        <InlineField\n          tooltip=\"The Prometheus data source the trace is going to navigate to\"\n          label=\"Data source\"\n          labelWidth={26}\n        >\n          <DataSourcePicker\n            inputId=\"trace-to-metrics-data-source-picker\"\n            pluginId=\"prometheus\"\n            current={options.jsonData.tracesToMetrics?.datasourceUid}\n            noDefault={true}\n            width={40}\n            onChange={(ds: DataSourceInstanceSettings) =>\n              updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'tracesToMetrics', {\n                ...options.jsonData.tracesToMetrics,\n                datasourceUid: ds.uid,\n              })\n            }\n          />\n        </InlineField>\n        {options.jsonData.tracesToMetrics?.datasourceUid ? (\n          <Button\n            type=\"button\"\n            variant=\"secondary\"\n            size=\"sm\"\n            fill=\"text\"\n            onClick={() => {\n              updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'tracesToMetrics', {\n                ...options.jsonData.tracesToMetrics,\n                datasourceUid: undefined,\n              });\n            }}\n          >\n            Clear\n          </Button>\n        ) : null}\n      </InlineFieldRow>\n\n      <InlineFieldRow>\n        <IntervalInput\n          label={getTimeShiftLabel('start')}\n          tooltip={getTimeShiftTooltip('start', '-2m')}\n          value={options.jsonData.tracesToMetrics?.spanStartTimeShift || ''}\n          onChange={(val) => {\n            updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'tracesToMetrics', {\n              ...options.jsonData.tracesToMetrics,\n              spanStartTimeShift: val,\n            });\n          }}\n          placeholder={'-2m'}\n          isInvalidError={invalidTimeShiftError}\n        />\n      </InlineFieldRow>\n\n      <InlineFieldRow>\n        <IntervalInput\n          label={getTimeShiftLabel('end')}\n          tooltip={getTimeShiftTooltip('end', '2m')}\n          value={options.jsonData.tracesToMetrics?.spanEndTimeShift || ''}\n          onChange={(val) => {\n            updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'tracesToMetrics', {\n              ...options.jsonData.tracesToMetrics,\n              spanEndTimeShift: val,\n            });\n          }}\n          placeholder={'2m'}\n          isInvalidError={invalidTimeShiftError}\n        />\n      </InlineFieldRow>\n\n      <InlineFieldRow>\n        <InlineField tooltip=\"Tags that will be used in the metrics query\" label=\"Tags\" labelWidth={26}>\n          <TagMappingInput\n            values={options.jsonData.tracesToMetrics?.tags ?? []}\n            onChange={(v) =>\n              updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'tracesToMetrics', {\n                ...options.jsonData.tracesToMetrics,\n                tags: v,\n              })\n            }\n          />\n        </InlineField>\n      </InlineFieldRow>\n\n      {options.jsonData.tracesToMetrics?.queries?.map((query, i) => (\n        <div key={i} className={styles.queryRow}>\n          <InlineField label=\"Link Label\" labelWidth={26} tooltip=\"Descriptive label for the linked query\">\n            <Input\n              label=\"Link Label\"\n              type=\"text\"\n              allowFullScreen\n              value={query.name}\n              width={40}\n              onChange={(e) => {\n                const newQueries = (options.jsonData.tracesToMetrics?.queries ?? []).map(\n                  (traceToMetricQuery, index) => {\n                    return index === i ? { ...traceToMetricQuery, name: e.currentTarget.value } : traceToMetricQuery;\n                  }\n                );\n                updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'tracesToMetrics', {\n                  ...options.jsonData.tracesToMetrics,\n                  queries: newQueries,\n                });\n              }}\n            />\n          </InlineField>\n          <InlineField\n            label=\"Query\"\n            labelWidth={10}\n            tooltip=\"The Prometheus query that will run when navigating from a trace to metrics. Interpolate tags using the `$__tags` keyword\"\n            grow\n          >\n            <Input\n              label=\"Query\"\n              type=\"text\"\n              allowFullScreen\n              value={query.query}\n              onChange={(e) => {\n                const updatedQueries = (options.jsonData.tracesToMetrics?.queries ?? []).map(\n                  (traceToMetricQuery, index) => {\n                    return index === i ? { ...traceToMetricQuery, query: e.currentTarget.value } : traceToMetricQuery;\n                  }\n                );\n                updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'tracesToMetrics', {\n                  ...options.jsonData.tracesToMetrics,\n                  queries: updatedQueries,\n                });\n              }}\n            />\n          </InlineField>\n\n          <Button\n            variant=\"destructive\"\n            title=\"Remove query\"\n            icon=\"times\"\n            type=\"button\"\n            onClick={() => {\n              const newQueries = options.jsonData.tracesToMetrics?.queries.filter((_, index) => index !== i);\n              updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'tracesToMetrics', {\n                ...options.jsonData.tracesToMetrics,\n                queries: newQueries,\n              });\n            }}\n          />\n        </div>\n      ))}\n\n      <Button\n        variant=\"secondary\"\n        title=\"Add query\"\n        icon=\"plus\"\n        type=\"button\"\n        onClick={() => {\n          updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'tracesToMetrics', {\n            ...options.jsonData.tracesToMetrics,\n            queries: [...(options.jsonData.tracesToMetrics?.queries ?? []), { query: '' }],\n          });\n        }}\n      >\n        Add query\n      </Button>\n    </div>\n  );\n}\n\nexport const TraceToMetricsSection = ({ options, onOptionsChange }: DataSourcePluginOptionsEditorProps) => {\n  let suffix = options.type;\n  suffix += options.type === 'tempo' ? '/configure-tempo-data-source/#trace-to-metrics' : '/#trace-to-metrics';\n\n  return (\n    <ConfigSection\n      title=\"Trace to metrics\"\n      description={\n        <ConfigDescriptionLink\n          description=\"Navigate from a trace span to the selected data source's metrics.\"\n          suffix={suffix}\n          feature=\"trace to metrics\"\n        />\n      }\n      isCollapsible={true}\n      isInitiallyOpen={true}\n    >\n      <TraceToMetricsSettings options={options} onOptionsChange={onOptionsChange} />\n    </ConfigSection>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  infoText: {\n    paddingBottom: theme.spacing(2),\n    color: theme.colors.text.secondary,\n  },\n  row: css({\n    label: 'row',\n    alignItems: 'baseline',\n  }),\n  queryRow: css({\n    label: 'queryRow',\n    display: 'flex',\n    flexFlow: 'wrap',\n  }),\n});\n","import { useEffect } from 'react';\nimport useAsyncFn from './useAsyncFn';\nexport default function useAsync(fn, deps) {\n    if (deps === void 0) { deps = []; }\n    var _a = useAsyncFn(fn, deps, {\n        loading: true,\n    }), state = _a[0], callback = _a[1];\n    useEffect(function () {\n        callback();\n    }, [callback]);\n    return state;\n}\n","import { __assign } from \"tslib\";\nimport { useCallback, useRef, useState } from 'react';\nimport useMountedState from './useMountedState';\nexport default function useAsyncFn(fn, deps, initialState) {\n    if (deps === void 0) { deps = []; }\n    if (initialState === void 0) { initialState = { loading: false }; }\n    var lastCallId = useRef(0);\n    var isMounted = useMountedState();\n    var _a = useState(initialState), state = _a[0], set = _a[1];\n    var callback = useCallback(function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var callId = ++lastCallId.current;\n        if (!state.loading) {\n            set(function (prevState) { return (__assign(__assign({}, prevState), { loading: true })); });\n        }\n        return fn.apply(void 0, args).then(function (value) {\n            isMounted() && callId === lastCallId.current && set({ value: value, loading: false });\n            return value;\n        }, function (error) {\n            isMounted() && callId === lastCallId.current && set({ error: error, loading: false });\n            return error;\n        });\n    }, deps);\n    return [state, callback];\n}\n","import { useCallback, useEffect, useRef } from 'react';\nexport default function useMountedState() {\n    var mountedRef = useRef(false);\n    var get = useCallback(function () { return mountedRef.current; }, []);\n    useEffect(function () {\n        mountedRef.current = true;\n        return function () {\n            mountedRef.current = false;\n        };\n    }, []);\n    return get;\n}\n","import React, { useEffect, useMemo, useState } from 'react';\n\nimport { Cascader, CascaderOption } from '@grafana/ui';\n\nimport { PyroscopeDataSource } from './datasource';\nimport { ProfileTypeMessage } from './types';\n\ntype Props = {\n  initialProfileTypeId?: string;\n  profileTypes?: ProfileTypeMessage[];\n  onChange: (value: string) => void;\n  placeholder?: string;\n  width?: number;\n};\n\nexport function ProfileTypesCascader(props: Props) {\n  const cascaderOptions = useCascaderOptions(props.profileTypes);\n\n  return (\n    <Cascader\n      placeholder={props.placeholder}\n      separator={'-'}\n      displayAllSelectedLevels={true}\n      initialValue={props.initialProfileTypeId}\n      allowCustomValue={true}\n      onSelect={props.onChange}\n      options={cascaderOptions}\n      changeOnSelect={false}\n      width={props.width ?? 26}\n    />\n  );\n}\n\n// Turn profileTypes into cascader options\nfunction useCascaderOptions(profileTypes?: ProfileTypeMessage[]): CascaderOption[] {\n  return useMemo(() => {\n    if (!profileTypes) {\n      return [];\n    }\n    let mainTypes = new Map<string, CascaderOption>();\n    // Classify profile types by name then sample type.\n    // The profileTypes are something like cpu:sample:nanoseconds:sample:count or app.something.something\n    for (let profileType of profileTypes) {\n      let parts: string[] = [];\n      if (profileType.id.indexOf(':') > -1) {\n        parts = profileType.id.split(':');\n      }\n\n      const [name, type] = parts;\n\n      if (!mainTypes.has(name)) {\n        mainTypes.set(name, {\n          label: name,\n          value: name,\n          items: [],\n        });\n      }\n      mainTypes.get(name)?.items!.push({\n        label: type,\n        value: profileType.id,\n      });\n    }\n    return Array.from(mainTypes.values());\n  }, [profileTypes]);\n}\n\n/**\n * Loads the profile types.\n *\n * This is exported and not used directly in the ProfileTypesCascader component because in some case we need to know\n * the profileTypes before rendering the cascader.\n * @param datasource\n */\nexport function useProfileTypes(datasource: PyroscopeDataSource) {\n  const [profileTypes, setProfileTypes] = useState<ProfileTypeMessage[]>();\n\n  useEffect(() => {\n    (async () => {\n      const profileTypes = await datasource.getProfileTypes();\n      setProfileTypes(profileTypes);\n    })();\n  }, [datasource]);\n\n  return profileTypes;\n}\n","import { css } from '@emotion/css';\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { useAsync } from 'react-use';\n\nimport {\n  DataSourceJsonData,\n  DataSourceInstanceSettings,\n  DataSourcePluginOptionsEditorProps,\n  updateDatasourcePluginJsonDataOption,\n} from '@grafana/data';\nimport { ConfigDescriptionLink, ConfigSection } from '@grafana/experimental';\nimport { DataSourcePicker, DataSourceWithBackend, getDataSourceSrv } from '@grafana/runtime';\nimport { InlineField, InlineFieldRow, Input, InlineSwitch } from '@grafana/ui';\n\nimport { TagMappingInput } from '../TraceToLogs/TagMappingInput';\nimport { ProfileTypesCascader } from '../pyroscope/ProfileTypesCascader';\nimport { ProfileTypeMessage } from '../pyroscope/types';\n\nexport interface TraceToProfilesOptions {\n  datasourceUid?: string;\n  tags?: Array<{ key: string; value?: string }>;\n  query?: string;\n  profileTypeId?: string;\n  customQuery: boolean;\n}\n\nexport interface TraceToProfilesData extends DataSourceJsonData {\n  tracesToProfiles?: TraceToProfilesOptions;\n}\n\ninterface Props extends DataSourcePluginOptionsEditorProps<TraceToProfilesData> {}\n\nexport function TraceToProfilesSettings({ options, onOptionsChange }: Props) {\n  const supportedDataSourceTypes = useMemo(() => ['grafana-pyroscope-datasource'], []);\n\n  const [profileTypes, setProfileTypes] = useState<ProfileTypeMessage[]>([]);\n  const profileTypesPlaceholder = useMemo(() => {\n    let placeholder = profileTypes.length === 0 ? 'No profile types found' : 'Select profile type';\n    if (!options.jsonData.tracesToProfiles?.datasourceUid) {\n      placeholder = 'Please select profiling data source';\n    }\n    return placeholder;\n  }, [options.jsonData.tracesToProfiles?.datasourceUid, profileTypes]);\n\n  const { value: dataSource } = useAsync(async () => {\n    return await getDataSourceSrv().get(options.jsonData.tracesToProfiles?.datasourceUid);\n  }, [options.jsonData.tracesToProfiles?.datasourceUid]);\n\n  const { value: pTypes } = useAsync(async () => {\n    if (\n      dataSource instanceof DataSourceWithBackend &&\n      supportedDataSourceTypes.includes(dataSource.type) &&\n      dataSource.uid === options.jsonData.tracesToProfiles?.datasourceUid\n    ) {\n      return await dataSource?.getResource('profileTypes');\n    }\n  }, [dataSource]);\n\n  useEffect(() => {\n    setProfileTypes(pTypes ?? []);\n  }, [pTypes]);\n\n  return (\n    <div className={css({ width: '100%' })}>\n      <InlineFieldRow>\n        <InlineField\n          tooltip=\"The profiles data source the trace is going to navigate to\"\n          label=\"Data source\"\n          labelWidth={26}\n        >\n          <DataSourcePicker\n            inputId=\"trace-to-profiles-data-source-picker\"\n            filter={(ds) => supportedDataSourceTypes.includes(ds.type)}\n            current={options.jsonData.tracesToProfiles?.datasourceUid}\n            noDefault={true}\n            width={40}\n            onChange={(ds: DataSourceInstanceSettings) => {\n              updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'tracesToProfiles', {\n                ...options.jsonData.tracesToProfiles,\n                datasourceUid: ds.uid,\n              });\n            }}\n          />\n        </InlineField>\n      </InlineFieldRow>\n\n      <InlineFieldRow>\n        <InlineField\n          tooltip=\"Tags that will be used in the query. Default tags: 'service.name', 'service.namespace'\"\n          label=\"Tags\"\n          labelWidth={26}\n        >\n          <TagMappingInput\n            values={options.jsonData.tracesToProfiles?.tags ?? []}\n            onChange={(v) => {\n              updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'tracesToProfiles', {\n                ...options.jsonData.tracesToProfiles,\n                tags: v,\n              });\n            }}\n          />\n        </InlineField>\n      </InlineFieldRow>\n\n      <InlineFieldRow>\n        <InlineField tooltip=\"Profile type that will be used in the query\" label=\"Profile type\" labelWidth={26}>\n          <ProfileTypesCascader\n            profileTypes={profileTypes}\n            placeholder={profileTypesPlaceholder}\n            initialProfileTypeId={options.jsonData.tracesToProfiles?.profileTypeId}\n            onChange={(val) => {\n              updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'tracesToProfiles', {\n                ...options.jsonData.tracesToProfiles,\n                profileTypeId: val,\n              });\n            }}\n            width={40}\n          />\n        </InlineField>\n      </InlineFieldRow>\n\n      <InlineFieldRow>\n        <InlineField\n          tooltip=\"Use a custom query with the possibility to interpolate variables from the trace or span\"\n          label=\"Use custom query\"\n          labelWidth={26}\n        >\n          <InlineSwitch\n            id={'profilesCustomQuerySwitch'}\n            value={options.jsonData.tracesToProfiles?.customQuery}\n            onChange={(event: React.SyntheticEvent<HTMLInputElement>) =>\n              updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'tracesToProfiles', {\n                ...options.jsonData.tracesToProfiles,\n                customQuery: event.currentTarget.checked,\n              })\n            }\n          />\n        </InlineField>\n      </InlineFieldRow>\n\n      {options.jsonData.tracesToProfiles?.customQuery && (\n        <InlineField\n          label=\"Query\"\n          labelWidth={26}\n          tooltip=\"The query that will run when navigating from a trace to profiles data source. Interpolate tags using the `$__tags` keyword\"\n          grow\n        >\n          <Input\n            label=\"Query\"\n            type=\"text\"\n            allowFullScreen\n            value={options.jsonData.tracesToProfiles?.query || ''}\n            onChange={(e) =>\n              updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'tracesToProfiles', {\n                ...options.jsonData.tracesToProfiles,\n                query: e.currentTarget.value,\n              })\n            }\n          />\n        </InlineField>\n      )}\n    </div>\n  );\n}\n\nexport const TraceToProfilesSection = ({ options, onOptionsChange }: DataSourcePluginOptionsEditorProps) => {\n  return (\n    <ConfigSection\n      title=\"Trace to profiles\"\n      description={\n        <ConfigDescriptionLink\n          description=\"Navigate from a trace span to the selected data source's profiles.\"\n          suffix={`${options.type}/configure-tempo-data-source/#trace-to-profiles`}\n          feature=\"trace to profiles\"\n        />\n      }\n      isCollapsible={true}\n      isInitiallyOpen={true}\n    >\n      <TraceToProfilesSettings options={options} onOptionsChange={onOptionsChange} />\n    </ConfigSection>\n  );\n};\n","import { css } from '@emotion/css';\nimport React from 'react';\n\nimport {\n  DataSourceJsonData,\n  DataSourcePluginOptionsEditorProps,\n  GrafanaTheme2,\n  updateDatasourcePluginJsonDataOption,\n} from '@grafana/data';\nimport { ConfigDescriptionLink, ConfigSubSection } from '@grafana/experimental';\nimport { InlineField, InlineFieldRow, InlineSwitch, useStyles2 } from '@grafana/ui';\n\nexport interface NodeGraphOptions {\n  enabled?: boolean;\n}\n\nexport interface NodeGraphData extends DataSourceJsonData {\n  nodeGraph?: NodeGraphOptions;\n}\n\ninterface Props extends DataSourcePluginOptionsEditorProps<NodeGraphData> {}\n\nexport function NodeGraphSettings({ options, onOptionsChange }: Props) {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <div className={styles.container}>\n      <InlineFieldRow className={styles.row}>\n        <InlineField\n          tooltip=\"Displays the node graph above the trace view. Default: disabled\"\n          label=\"Enable node graph\"\n          labelWidth={26}\n        >\n          <InlineSwitch\n            id=\"enableNodeGraph\"\n            value={options.jsonData.nodeGraph?.enabled}\n            onChange={(event: React.SyntheticEvent<HTMLInputElement>) =>\n              updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'nodeGraph', {\n                ...options.jsonData.nodeGraph,\n                enabled: event.currentTarget.checked,\n              })\n            }\n          />\n        </InlineField>\n      </InlineFieldRow>\n    </div>\n  );\n}\n\nexport const NodeGraphSection = ({ options, onOptionsChange }: DataSourcePluginOptionsEditorProps) => {\n  let suffix = options.type;\n  suffix += options.type === 'tempo' ? '/configure-tempo-data-source/#node-graph' : '/#node-graph';\n\n  return (\n    <ConfigSubSection\n      title=\"Node graph\"\n      description={\n        <ConfigDescriptionLink\n          description=\"Show or hide the node graph visualization.\"\n          suffix={suffix}\n          feature=\"the node graph\"\n        />\n      }\n    >\n      <NodeGraphSettings options={options} onOptionsChange={onOptionsChange} />\n    </ConfigSubSection>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  infoText: css({\n    label: 'infoText',\n    paddingBottom: theme.spacing(2),\n    color: theme.colors.text.secondary,\n  }),\n  container: css({\n    label: 'container',\n    width: '100%',\n  }),\n  row: css({\n    label: 'row',\n    alignItems: 'baseline',\n  }),\n});\n","import { css } from '@emotion/css';\nimport React from 'react';\n\nimport {\n  DataSourceJsonData,\n  DataSourcePluginOptionsEditorProps,\n  GrafanaTheme2,\n  toOption,\n  updateDatasourcePluginJsonDataOption,\n} from '@grafana/data';\nimport { ConfigDescriptionLink, ConfigSubSection } from '@grafana/experimental';\nimport { InlineField, InlineFieldRow, Input, Select, useStyles2 } from '@grafana/ui';\n\nexport interface SpanBarOptions {\n  type?: string;\n  tag?: string;\n}\n\nexport interface SpanBarOptionsData extends DataSourceJsonData {\n  spanBar?: SpanBarOptions;\n}\n\nexport const NONE = 'None';\nexport const DURATION = 'Duration';\nexport const TAG = 'Tag';\n\ninterface Props extends DataSourcePluginOptionsEditorProps<SpanBarOptionsData> {}\n\nexport default function SpanBarSettings({ options, onOptionsChange }: Props) {\n  const styles = useStyles2(getStyles);\n  const selectOptions = [NONE, DURATION, TAG].map(toOption);\n\n  return (\n    <div className={css({ width: '100%' })}>\n      <InlineFieldRow className={styles.row}>\n        <InlineField label=\"Label\" labelWidth={26} tooltip=\"Default: duration\" grow>\n          <Select\n            inputId=\"label\"\n            options={selectOptions}\n            value={options.jsonData.spanBar?.type || ''}\n            onChange={(v) => {\n              updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'spanBar', {\n                ...options.jsonData.spanBar,\n                type: v?.value ?? '',\n              });\n            }}\n            placeholder=\"Duration\"\n            isClearable\n            aria-label={'select-label-name'}\n            width={40}\n          />\n        </InlineField>\n      </InlineFieldRow>\n      {options.jsonData.spanBar?.type === TAG && (\n        <InlineFieldRow className={styles.row}>\n          <InlineField\n            label=\"Tag key\"\n            labelWidth={26}\n            tooltip=\"Tag key which will be used to get the tag value. A span's attributes and resources will be searched for the tag key\"\n          >\n            <Input\n              type=\"text\"\n              placeholder=\"Enter tag key\"\n              onChange={(v) =>\n                updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'spanBar', {\n                  ...options.jsonData.spanBar,\n                  tag: v.currentTarget.value,\n                })\n              }\n              value={options.jsonData.spanBar?.tag || ''}\n              width={40}\n            />\n          </InlineField>\n        </InlineFieldRow>\n      )}\n    </div>\n  );\n}\n\nexport const SpanBarSection = ({ options, onOptionsChange }: DataSourcePluginOptionsEditorProps) => {\n  let suffix = options.type;\n  suffix += options.type === 'tempo' ? '/configure-tempo-data-source/#span-bar' : '/#span-bar';\n\n  return (\n    <ConfigSubSection\n      title=\"Span bar\"\n      description={\n        <ConfigDescriptionLink\n          description=\"Add additional info next to the service and operation on a span bar row in the trace view.\"\n          suffix={suffix}\n          feature=\"the span bar\"\n        />\n      }\n    >\n      <SpanBarSettings options={options} onOptionsChange={onOptionsChange} />\n    </ConfigSubSection>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  infoText: css({\n    label: 'infoText',\n    paddingBottom: theme.spacing(2),\n    color: theme.colors.text.secondary,\n  }),\n  row: css({\n    label: 'row',\n    alignItems: 'baseline',\n  }),\n});\n","import { css } from '@emotion/css';\nimport React from 'react';\n\nimport { DataSourcePluginOptionsEditorProps, GrafanaTheme2, updateDatasourcePluginJsonDataOption } from '@grafana/data';\nimport { IntervalInput, invalidTimeShiftError } from '@grafana/o11y-ds-frontend';\nimport { InlineField, InlineSwitch, useStyles2 } from '@grafana/ui';\n\nimport { TempoJsonData } from '../types';\n\ninterface Props extends DataSourcePluginOptionsEditorProps<TempoJsonData> {}\n\nexport function QuerySettings({ options, onOptionsChange }: Props) {\n  const styles = useStyles2(getStyles);\n\n  const getLabel = (type: 'start' | 'end') => {\n    return `Time shift for ${type} of search`;\n  };\n\n  const getTooltip = (type: 'start' | 'end') => {\n    return `Shifts the ${type} of the time range when searching by TraceID. Searching can return traces that do not fully fall into the search time range, so we recommend using higher time shifts for longer traces. Default: 30m (Time units can be used here, for example: 5s, 1m, 3h`;\n  };\n\n  return (\n    <div className={styles.container}>\n      <InlineField\n        label=\"Use time range in query\"\n        tooltip=\"The time range can be used when there are performance issues or timeouts since it will narrow down the search to the defined range. Default: disabled\"\n        labelWidth={26}\n      >\n        <InlineSwitch\n          id=\"enable-time-shift\"\n          value={options.jsonData.traceQuery?.timeShiftEnabled || false}\n          onChange={(event) => {\n            updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'traceQuery', {\n              ...options.jsonData.traceQuery,\n              timeShiftEnabled: event.currentTarget.checked,\n            });\n          }}\n        />\n      </InlineField>\n\n      <IntervalInput\n        label={getLabel('start')}\n        tooltip={getTooltip('start')}\n        value={options.jsonData.traceQuery?.spanStartTimeShift || ''}\n        disabled={!options.jsonData.traceQuery?.timeShiftEnabled}\n        onChange={(val) => {\n          updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'traceQuery', {\n            ...options.jsonData.traceQuery,\n            spanStartTimeShift: val,\n          });\n        }}\n        isInvalidError={invalidTimeShiftError}\n      />\n\n      <IntervalInput\n        label={getLabel('end')}\n        tooltip={getTooltip('end')}\n        value={options.jsonData.traceQuery?.spanEndTimeShift || ''}\n        disabled={!options.jsonData.traceQuery?.timeShiftEnabled}\n        onChange={(val) => {\n          updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'traceQuery', {\n            ...options.jsonData.traceQuery,\n            spanEndTimeShift: val,\n          });\n        }}\n        isInvalidError={invalidTimeShiftError}\n      />\n    </div>\n  );\n}\n\nexport const getStyles = (theme: GrafanaTheme2) => ({\n  infoText: css({\n    paddingBottom: theme.spacing(2),\n    color: theme.colors.text.secondary,\n  }),\n  container: css({\n    width: '100%',\n  }),\n  row: css({\n    alignItems: 'baseline',\n  }),\n});\n","import React from 'react';\n\nimport {\n  DataSourceInstanceSettings,\n  DataSourcePluginOptionsEditorProps,\n  updateDatasourcePluginJsonDataOption,\n} from '@grafana/data';\nimport { DataSourcePicker } from '@grafana/runtime';\nimport { Button, InlineField, InlineFieldRow, useStyles2 } from '@grafana/ui';\n\nimport { TempoJsonData } from '../types';\n\nimport { getStyles } from './QuerySettings';\n\ninterface Props extends DataSourcePluginOptionsEditorProps<TempoJsonData> {}\n\nexport function ServiceGraphSettings({ options, onOptionsChange }: Props) {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <div className={styles.container}>\n      <InlineFieldRow className={styles.row}>\n        <InlineField\n          tooltip=\"The Prometheus data source with the service graph data\"\n          label=\"Data source\"\n          labelWidth={26}\n        >\n          <DataSourcePicker\n            inputId=\"service-graph-data-source-picker\"\n            pluginId=\"prometheus\"\n            current={options.jsonData.serviceMap?.datasourceUid}\n            noDefault={true}\n            width={40}\n            onChange={(ds: DataSourceInstanceSettings) =>\n              updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'serviceMap', {\n                datasourceUid: ds.uid,\n              })\n            }\n          />\n        </InlineField>\n        {options.jsonData.serviceMap?.datasourceUid ? (\n          <Button\n            type={'button'}\n            variant={'secondary'}\n            size={'sm'}\n            fill={'text'}\n            onClick={() => {\n              updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'serviceMap', {\n                datasourceUid: undefined,\n              });\n            }}\n          >\n            Clear\n          </Button>\n        ) : null}\n      </InlineFieldRow>\n    </div>\n  );\n}\n","import React, { useCallback, useEffect } from 'react';\nimport useAsync from 'react-use/lib/useAsync';\n\nimport { DataSourcePluginOptionsEditorProps, updateDatasourcePluginJsonDataOption } from '@grafana/data';\nimport { Alert } from '@grafana/ui';\n\nimport TagsInput from '../SearchTraceQLEditor/TagsInput';\nimport { replaceAt } from '../SearchTraceQLEditor/utils';\nimport { TraceqlFilter, TraceqlSearchScope } from '../dataquery.gen';\nimport { TempoDatasource } from '../datasource';\nimport { TempoJsonData } from '../types';\nimport { getErrorMessage } from '../utils';\n\ninterface Props extends DataSourcePluginOptionsEditorProps<TempoJsonData> {\n  datasource?: TempoDatasource;\n}\n\nexport function TraceQLSearchTags({ options, onOptionsChange, datasource }: Props) {\n  const fetchTags = async () => {\n    if (!datasource) {\n      throw new Error('Unable to retrieve datasource');\n    }\n\n    try {\n      await datasource.languageProvider.start();\n    } catch (err) {\n      // @ts-ignore\n      throw new Error(getErrorMessage(err.data.message, 'Unable to query Tempo'));\n    }\n  };\n\n  const { error, loading } = useAsync(fetchTags, [datasource, options]);\n\n  const updateFilter = useCallback(\n    (s: TraceqlFilter) => {\n      let copy = options.jsonData.search?.filters;\n      copy ||= [];\n      const indexOfFilter = copy.findIndex((f) => f.id === s.id);\n      if (indexOfFilter >= 0) {\n        // update in place if the filter already exists, for consistency and to avoid UI bugs\n        copy = replaceAt(copy, indexOfFilter, s);\n      } else {\n        copy.push(s);\n      }\n      updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'search', {\n        ...options.jsonData.search,\n        filters: copy,\n      });\n    },\n    [onOptionsChange, options]\n  );\n\n  const deleteFilter = (s: TraceqlFilter) => {\n    updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'search', {\n      ...options.jsonData.search,\n      filters: options.jsonData.search?.filters?.filter((f) => f.id !== s.id),\n    });\n  };\n\n  useEffect(() => {\n    if (!options.jsonData.search?.filters) {\n      updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'search', {\n        ...options.jsonData.search,\n        filters: [\n          {\n            id: 'service-name',\n            tag: 'service.name',\n            operator: '=',\n            scope: TraceqlSearchScope.Resource,\n          },\n          { id: 'span-name', tag: 'name', operator: '=', scope: TraceqlSearchScope.Span },\n        ],\n      });\n    }\n  }, [onOptionsChange, options]);\n\n  // filter out tags that already exist in TraceQLSearch editor\n  const staticTags = ['duration'];\n\n  const missingTag = options.jsonData.search?.filters?.find((f) => !f.tag);\n\n  return (\n    <>\n      {datasource ? (\n        <TagsInput\n          updateFilter={updateFilter}\n          deleteFilter={deleteFilter}\n          filters={options.jsonData.search?.filters || []}\n          datasource={datasource}\n          setError={() => {}}\n          staticTags={staticTags}\n          isTagsLoading={loading}\n          hideValues={true}\n          query={'{}'}\n        />\n      ) : (\n        <div>Invalid data source, please create a valid data source and try again</div>\n      )}\n      {error && (\n        <Alert title={'Unable to fetch TraceQL tags'} severity={'error'} topSpacing={1}>\n          {error.message}\n        </Alert>\n      )}\n      {missingTag && (\n        <Alert title={'Please ensure each filter has a selected tag'} severity={'warning'} topSpacing={1}></Alert>\n      )}\n    </>\n  );\n}\n","import React from 'react';\nimport useAsync from 'react-use/lib/useAsync';\n\nimport { DataSourcePluginOptionsEditorProps, updateDatasourcePluginJsonDataOption } from '@grafana/data';\nimport { getDataSourceSrv } from '@grafana/runtime';\nimport { InlineField, InlineFieldRow, InlineSwitch, useStyles2 } from '@grafana/ui';\n\nimport { TempoDatasource } from '../datasource';\nimport { TempoJsonData } from '../types';\n\nimport { getStyles } from './QuerySettings';\nimport { TraceQLSearchTags } from './TraceQLSearchTags';\n\ninterface Props extends DataSourcePluginOptionsEditorProps<TempoJsonData> {}\n\nexport function TraceQLSearchSettings({ options, onOptionsChange }: Props) {\n  const styles = useStyles2(getStyles);\n  const dataSourceSrv = getDataSourceSrv();\n  const fetchDatasource = async () => {\n    return (await dataSourceSrv.get({ type: options.type, uid: options.uid })) as TempoDatasource;\n  };\n\n  const { value: datasource } = useAsync(fetchDatasource, [dataSourceSrv, options]);\n\n  return (\n    <div className={styles.container}>\n      <InlineFieldRow className={styles.row}>\n        <InlineField tooltip=\"Removes the search tab from the query editor\" label=\"Hide search\" labelWidth={26}>\n          <InlineSwitch\n            id=\"hideSearch\"\n            value={options.jsonData.search?.hide}\n            onChange={(event: React.SyntheticEvent<HTMLInputElement>) =>\n              updateDatasourcePluginJsonDataOption({ onOptionsChange, options }, 'search', {\n                ...options.jsonData.search,\n                hide: event.currentTarget.checked,\n              })\n            }\n          />\n        </InlineField>\n      </InlineFieldRow>\n      <InlineFieldRow className={styles.row}>\n        <InlineField tooltip=\"Configures which fields are available in the UI\" label=\"Static filters\" labelWidth={26}>\n          <TraceQLSearchTags datasource={datasource} options={options} onOptionsChange={onOptionsChange} />\n        </InlineField>\n      </InlineFieldRow>\n    </div>\n  );\n}\n","import { css } from '@emotion/css';\nimport React from 'react';\n\nimport { DataSourcePluginOptionsEditorProps, GrafanaTheme2 } from '@grafana/data';\nimport {\n  AdvancedHttpSettings,\n  Auth,\n  ConfigSection,\n  ConfigDescriptionLink,\n  ConfigSubSection,\n  ConnectionSettings,\n  convertLegacyAuthProps,\n  DataSourceDescription,\n} from '@grafana/experimental';\nimport {\n  NodeGraphSection,\n  SpanBarSection,\n  TraceToLogsSection,\n  TraceToMetricsSection,\n  TraceToProfilesSection,\n} from '@grafana/o11y-ds-frontend';\nimport { config } from '@grafana/runtime';\nimport { SecureSocksProxySettings, useStyles2, Divider, Stack } from '@grafana/ui';\n\nimport { QuerySettings } from './QuerySettings';\nimport { ServiceGraphSettings } from './ServiceGraphSettings';\nimport { TraceQLSearchSettings } from './TraceQLSearchSettings';\n\nexport type Props = DataSourcePluginOptionsEditorProps;\n\nexport const ConfigEditor = ({ options, onOptionsChange }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <div className={styles.container}>\n      <DataSourceDescription\n        dataSourceName=\"Tempo\"\n        docsLink=\"https://grafana.com/docs/grafana/latest/datasources/tempo\"\n        hasRequiredFields={false}\n      />\n\n      <Divider spacing={4} />\n      <ConnectionSettings config={options} onChange={onOptionsChange} urlPlaceholder=\"http://localhost:3200\" />\n\n      <Divider spacing={4} />\n      <Auth\n        {...convertLegacyAuthProps({\n          config: options,\n          onChange: onOptionsChange,\n        })}\n      />\n\n      <Divider spacing={4} />\n      <TraceToLogsSection options={options} onOptionsChange={onOptionsChange} />\n      <Divider spacing={4} />\n\n      <TraceToMetricsSection options={options} onOptionsChange={onOptionsChange} />\n      <Divider spacing={4} />\n\n      <TraceToProfilesSection options={options} onOptionsChange={onOptionsChange} />\n      <Divider spacing={4} />\n\n      <ConfigSection\n        title=\"Additional settings\"\n        description=\"Additional settings are optional settings that can be configured for more control over your data source.\"\n        isCollapsible={true}\n        isInitiallyOpen={false}\n      >\n        <Stack gap={5} direction=\"column\">\n          <AdvancedHttpSettings config={options} onChange={onOptionsChange} />\n\n          {config.secureSocksDSProxyEnabled && (\n            <>\n              <SecureSocksProxySettings options={options} onOptionsChange={onOptionsChange} />\n            </>\n          )}\n\n          <ConfigSubSection\n            title=\"Service graph\"\n            description={\n              <ConfigDescriptionLink\n                description=\"Select a Prometheus data source that contains the service graph data.\"\n                suffix=\"tempo/configure-tempo-data-source/#service-graph\"\n                feature=\"the service graph\"\n              />\n            }\n          >\n            <ServiceGraphSettings options={options} onOptionsChange={onOptionsChange} />\n          </ConfigSubSection>\n\n          <NodeGraphSection options={options} onOptionsChange={onOptionsChange} />\n\n          <ConfigSubSection\n            title=\"Tempo search\"\n            description={\n              <ConfigDescriptionLink\n                description=\"Modify how traces are searched.\"\n                suffix=\"tempo/configure-tempo-data-source/#tempo-search\"\n                feature=\"Tempo search\"\n              />\n            }\n          >\n            <TraceQLSearchSettings options={options} onOptionsChange={onOptionsChange} />\n          </ConfigSubSection>\n\n          <ConfigSubSection\n            title=\"TraceID query\"\n            description={\n              <ConfigDescriptionLink\n                description=\"Modify how TraceID queries are run.\"\n                suffix=\"tempo/configure-tempo-data-source/#traceid-query\"\n                feature=\"the TraceID query\"\n              />\n            }\n          >\n            <QuerySettings options={options} onOptionsChange={onOptionsChange} />\n          </ConfigSubSection>\n\n          <SpanBarSection options={options} onOptionsChange={onOptionsChange} />\n        </Stack>\n      </ConfigSection>\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  container: css({\n    label: 'container',\n    marginBottom: theme.spacing(2),\n    maxWidth: '900px',\n  }),\n});\n","import { DashboardLoadedEvent } from '@grafana/data';\nimport { getTemplateSrv, reportInteraction } from '@grafana/runtime';\n\nimport pluginJson from './plugin.json';\nimport { TempoQuery } from './types';\n\ntype TempoOnDashboardLoadedTrackingEvent = {\n  grafana_version?: string;\n  dashboard_id?: string;\n  org_id?: number;\n  service_map_query_count: number;\n  traceql_query_count: number;\n  upload_query_count: number;\n  service_map_queries_with_template_variables_count: number;\n  traceql_queries_with_template_variables_count: number;\n};\n\nexport const onDashboardLoadedHandler = ({\n  payload: { dashboardId, orgId, grafanaVersion, queries },\n}: DashboardLoadedEvent<TempoQuery>) => {\n  try {\n    const tempoQueries = queries[pluginJson.id];\n\n    if (!tempoQueries?.length) {\n      return;\n    }\n\n    let stats: TempoOnDashboardLoadedTrackingEvent = {\n      grafana_version: grafanaVersion,\n      dashboard_id: dashboardId,\n      org_id: orgId,\n      service_map_query_count: 0,\n      traceql_query_count: 0,\n      upload_query_count: 0,\n      service_map_queries_with_template_variables_count: 0,\n      traceql_queries_with_template_variables_count: 0,\n    };\n\n    for (const query of tempoQueries) {\n      if (query.hide) {\n        continue;\n      }\n\n      if (query.queryType === 'serviceMap') {\n        stats.service_map_query_count++;\n        if (query.serviceMapQuery && hasTemplateVariables(query.serviceMapQuery)) {\n          stats.service_map_queries_with_template_variables_count++;\n        }\n      } else if (query.queryType === 'traceql') {\n        stats.traceql_query_count++;\n        if (hasTemplateVariables(query.query)) {\n          stats.traceql_queries_with_template_variables_count++;\n        }\n      } else if (query.queryType === 'upload') {\n        stats.upload_query_count++;\n      }\n    }\n\n    reportInteraction('grafana_tempo_dashboard_loaded', stats);\n  } catch (error) {\n    console.error('error in tempo tracking handler', error);\n  }\n};\n\nconst hasTemplateVariables = (val?: string | string[]): boolean => {\n  return (Array.isArray(val) ? val : [val]).some((v) => getTemplateSrv().containsTemplate(v));\n};\n","import { DataSourcePlugin, DashboardLoadedEvent } from '@grafana/data';\nimport { getAppEvents } from '@grafana/runtime';\n\nimport CheatSheet from './CheatSheet';\nimport { TempoQueryField } from './QueryField';\nimport { ConfigEditor } from './configuration/ConfigEditor';\nimport { TempoDatasource } from './datasource';\nimport { onDashboardLoadedHandler } from './tracking';\nimport { TempoQuery } from './types';\n\nexport const plugin = new DataSourcePlugin(TempoDatasource)\n  .setQueryEditor(TempoQueryField)\n  .setConfigEditor(ConfigEditor)\n  .setQueryEditorHelp(CheatSheet);\n\n// Subscribe to on dashboard loaded event so that we can track plugin adoption\ngetAppEvents().subscribe<DashboardLoadedEvent<TempoQuery>>(DashboardLoadedEvent, onDashboardLoadedHandler);\n","import React from 'react';\n\nimport { config, reportInteraction } from '@grafana/runtime';\nimport { TextLink } from '@grafana/ui';\n\nexport default function CheatSheet() {\n  reportInteraction('grafana_traces_cheatsheet_clicked', {\n    datasourceType: 'tempo',\n    grafana_version: config.buildInfo.version,\n  });\n\n  return (\n    <>\n      <h2>Tempo Cheat Sheet</h2>\n      <p>\n        <TextLink href={'https://grafana.com/docs/tempo/latest/'} external={true}>\n          Grafana Tempo\n        </TextLink>{' '}\n        is an open source, easy-to-use, and high-volume distributed tracing backend.\n      </p>\n      <p>\n        Tempo implements{' '}\n        <TextLink href={'https://grafana.com/docs/tempo/latest/traceql'} external={true}>\n          TraceQL\n        </TextLink>\n        , a traces-first query language inspired by LogQL and PromQL. This query language allows users to precisely and\n        easily select spans and jump directly to the spans fulfilling the specified conditions.\n      </p>\n      <p>\n        You can compose TraceQL queries using either the Search tab (the TraceQL query builder) or the TraceQL tab (the\n        TraceQL query editor). Both of these methods let you build queries and drill-down into result sets. (\n        <TextLink href={'https://grafana.com/docs/grafana/latest/datasources/tempo/query-editor/'} external={true}>\n          Learn more\n        </TextLink>\n        )\n      </p>\n    </>\n  );\n}\n"],"names":["reactIs","REACT_STATICS","childContextTypes","contextType","contextTypes","defaultProps","displayName","getDefaultProps","getDerivedStateFromError","getDerivedStateFromProps","mixins","propTypes","type","KNOWN_STATICS","name","length","prototype","caller","callee","arguments","arity","MEMO_STATICS","compare","TYPE_STATICS","getStatics","component","isMemo","ForwardRef","render","Memo","defineProperty","Object","getOwnPropertyNames","getOwnPropertySymbols","getOwnPropertyDescriptor","getPrototypeOf","objectPrototype","module","exports","hoistNonReactStatics","targetComponent","sourceComponent","blacklist","inheritedComponent","keys","concat","targetStatics","sourceStatics","i","key","descriptor","e","b","Symbol","for","c","d","f","g","h","k","l","m","n","p","q","r","t","v","w","x","y","z","a","u","$$typeof","A","AsyncMode","ConcurrentMode","ContextConsumer","ContextProvider","Element","Fragment","Lazy","Portal","Profiler","StrictMode","Suspense","isAsyncMode","isConcurrentMode","isContextConsumer","isContextProvider","isElement","isForwardRef","isFragment","isLazy","isPortal","isProfiler","isStrictMode","isSuspense","isValidElementType","typeOf","tslib_1","react_1","useAsyncFn_1","__importDefault","fn","deps","_a","default","loading","state","callback","useEffect","value","useMountedState_1","initialState","lastCallId","useRef","isMounted","useState","set","useCallback","args","_i","callId","current","prevState","__assign","apply","then","error","mountedRef","get","ANY","Comparator","constructor","comp","options","parseOptions","loose","trim","split","join","debug","this","parse","semver","operator","version","re","COMPARATORLOOSE","COMPARATOR","match","TypeError","undefined","SemVer","toString","test","er","cmp","intersects","Range","includePrerelease","startsWith","includes","safeRe","range","raw","format","map","parseRange","filter","first","isNullSet","isAny","comps","memoKey","FLAG_INCLUDE_PRERELEASE","FLAG_LOOSE","cached","cache","hr","HYPHENRANGELOOSE","HYPHENRANGE","replace","hyphenReplace","COMPARATORTRIM","comparatorTrimReplace","TILDETRIM","tildeTrimReplace","CARETTRIM","caretTrimReplace","rangeList","parseComparator","replaceGTE0","rangeMap","Map","comparators","size","has","delete","result","values","some","thisComparators","isSatisfiable","rangeComparators","every","thisComparator","rangeComparator","testSet","max","remainingComparators","slice","testComparator","pop","otherComparator","replaceCarets","replaceTildes","replaceXRanges","replaceStars","isX","id","toLowerCase","replaceTilde","TILDELOOSE","TILDE","_","M","pr","ret","replaceCaret","CARETLOOSE","CARET","replaceXRange","XRANGELOOSE","XRANGE","gtlt","xM","xm","xp","anyX","STAR","GTE0PRE","GTE0","incPr","$0","from","fM","fm","fp","fpr","fb","to","tM","tm","tp","tpr","tb","prerelease","allowed","major","minor","patch","MAX_LENGTH","MAX_SAFE_INTEGER","compareIdentifiers","LOOSE","FULL","num","build","other","compareMain","comparePre","compareBuild","inc","release","identifier","identifierBase","base","Number","Error","push","isNaN","s","eq","neq","gt","gte","lt","lte","op","String","rtl","coerceRtlRegex","COERCERTLFULL","COERCERTL","next","exec","index","lastIndex","COERCEFULL","COERCE","versionA","versionB","version1","version2","v1","v2","comparison","v1Higher","highVersion","lowVersion","highHasPre","prefix","throwErrors","parsed","list","sort","internalRe","constants","identifiers","valid","clean","diff","rcompare","compareLoose","rsort","coerce","satisfies","toComparators","maxSatisfying","minSatisfying","minVersion","validRange","outside","gtr","ltr","simplifyRange","subset","src","tokens","SEMVER_SPEC_VERSION","RELEASE_TYPES","rcompareIdentifiers","MAX_SAFE_COMPONENT_LENGTH","MAX_SAFE_BUILD_LENGTH","process","env","NODE_DEBUG","console","numeric","anum","bnum","looseOption","freeze","emptyOpts","R","LETTERDASHNUMBER","safeRegexReplacements","createToken","isGlobal","safe","token","makeSafeRegex","RegExp","NUMERICIDENTIFIER","NUMERICIDENTIFIERLOOSE","NONNUMERICIDENTIFIER","PRERELEASEIDENTIFIER","PRERELEASEIDENTIFIERLOOSE","BUILDIDENTIFIER","MAINVERSION","PRERELEASE","BUILD","FULLPLAIN","MAINVERSIONLOOSE","PRERELEASELOOSE","LOOSEPLAIN","XRANGEIDENTIFIER","XRANGEIDENTIFIERLOOSE","GTLT","XRANGEPLAIN","XRANGEPLAINLOOSE","COERCEPLAIN","LONETILDE","LONECARET","Yallist","MAX","LENGTH","LENGTH_CALCULATOR","ALLOW_STALE","MAX_AGE","DISPOSE","NO_DISPOSE_ON_SET","LRU_LIST","CACHE","UPDATE_AGE_ON_GET","naiveLength","self","doUse","node","hit","isStale","del","now","Date","unshiftNode","maxAge","walker","tail","prev","removeNode","Entry","forEachStep","thisp","call","Infinity","lc","stale","dispose","noDisposeOnSet","updateAgeOnGet","reset","mL","allowStale","mA","lengthCalculator","lC","forEach","itemCount","rforEach","head","toArray","dump","dumpLru","len","item","unshift","peek","load","arr","expiresAt","prune","r1","r2","versions","maxSV","rangeObj","min","minSV","minver","setMin","comparator","compver","hilo","gtfn","ltefn","ltfn","ecomp","high","low","ranges","simplified","original","minimumVersionWithPreRelease","minimumVersion","simpleSubset","sub","dom","eqSet","Set","gtltComp","higher","lower","hasDomLT","hasDomGT","higherGT","lowerLT","add","needDomLTPre","needDomGTPre","sawNonNull","OUTER","simpleSub","simpleDom","isSub","iterator","Node","create","pushNode","res","shift","forEachReverse","getReverse","mapReverse","reduce","initial","acc","reduceReverse","Array","toArrayReverse","sliceReverse","splice","start","deleteCount","nodes","inserted","reverse","__WEBPACK_EXTERNAL_MODULE__6089__","__WEBPACK_EXTERNAL_MODULE__7781__","__WEBPACK_EXTERNAL_MODULE__8531__","__WEBPACK_EXTERNAL_MODULE__2007__","__WEBPACK_EXTERNAL_MODULE__3241__","__WEBPACK_EXTERNAL_MODULE__8146__","__WEBPACK_EXTERNAL_MODULE__5959__","__WEBPACK_EXTERNAL_MODULE__1269__","extendStatics","setPrototypeOf","__proto__","hasOwnProperty","__extends","__","assign","__rest","indexOf","propertyIsEnumerable","__decorate","decorators","target","desc","Reflect","decorate","__param","paramIndex","decorator","__esDecorate","ctor","descriptorIn","contextIn","initializers","extraInitializers","accept","kind","done","context","access","addInitializer","init","__runInitializers","thisArg","useValue","__propKey","__setFunctionName","description","configurable","__metadata","metadataKey","metadataValue","metadata","__awaiter","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","rejected","__generator","body","label","sent","trys","ops","verb","__createBinding","o","k2","__esModule","writable","enumerable","__exportStar","__values","__read","ar","__spread","__spreadArrays","il","j","jl","__spreadArray","pack","__await","__asyncGenerator","asyncIterator","resume","fulfill","settle","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","__setModuleDefault","__importStar","mod","__classPrivateFieldGet","receiver","__classPrivateFieldSet","__classPrivateFieldIn","__addDisposableResource","async","asyncDispose","stack","_SuppressedError","SuppressedError","suppressed","message","__disposeResources","fail","hasError","rec","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","definition","obj","prop","toStringTag","AlertTimeout","timeoutMap","TemporaryAlert","props","style","theme","useTheme2","css","position","zIndex","portal","top","right","visible","setVisible","timer","setTimer","clearTimeout","text","setTimeout","severity","Alert","className","elevated","onRemove","title","ThemeContextMock","RawQuery","query","lang","useContext","ThemeContext","styles","getStyles","highlighted","Prism","grammar","div","cx","editorField","aria-label","dangerouslySetInnerHTML","__html","WeakMap","fontFamily","typography","fontFamilyMonospace","fontSize","bodySmall","SearchStreamingState","SearchTableType","TraceqlSearchScope","__getOwnPropSymbols","__hasOwnProp","__propIsEnum","Stack","_b","children","source","exclude","__objRest","useStyles2","root","_c","display","flexDirection","direction","flexWrap","wrap","alignItems","gap","spacing","flexGrow","EditorRow","padding","backgroundColor","colors","background","secondary","borderRadius","shape","Space","wrapper","layout","paddingRight","paddingBottom","__defProp","__defNormalProp","EditorField","optional","tooltip","tooltipInteractive","width","fieldProps","childInputId","htmlFor","ReactUtils","getChildId","labelEl","Tooltip","placement","content","interactive","Icon","tabIndex","icon","Field","__spreadValues","field","minWidth","fontWeight","fontWeightMedium","fontStyle","color","marginBottom","marginLeft","primary","toggleReducer","nextValue","QueryOptionGroup","collapsedInfo","queryStats","isOpen","toggleOpen","initialValue","useReducer","Collapse","collapse","collapsible","onToggle","h6","span","config","featureToggles","lokiQuerySplitting","stats","generateQueryStats","border","justifyContent","overflow","margin","paddingLeft","marginRight","convertUnits","suffix","getValueFormat","bytes","isFunction","operate","lift","hasLift","liftedSource","err","ctorFunc","UnsubscriptionError","errors","instance","_super","arrRemove","Subscription","initialTeardown","closed","_parentage","_finalizers","empty","unsubscribe","e_1","e_2","isArray","_parentage_1","_parentage_1_1","remove","e_1_1","return","initialFinalizer","_finalizers_1","_finalizers_1_1","finalizer","execFinalizer","e_2_1","teardown","_hasParent","_addParent","parent","_removeParent","EMPTY","isSubscription","onUnhandledError","onStoppedNotification","useDeprecatedSynchronousErrorHandling","useDeprecatedNextContext","timeoutProvider","handler","timeout","delegate","handle","reportUnhandledError","noop","COMPLETE_NOTIFICATION","createNotification","Subscriber","destination","_this","isStopped","EMPTY_OBSERVER","complete","SafeSubscriber","handleStoppedNotification","nextNotification","_next","_error","_complete","_bind","Function","bind","ConsumerObserver","partialObserver","handleUnhandledError","observerOrNext","context_1","errorThrown","notification","subscriber","createOperatorSubscriber","onNext","onComplete","onError","onFinalize","OperatorSubscriber","shouldUnsubscribe","closed_1","project","subscribe","isArrayLike","observable","identity","Observable","_subscribe","isObserver","cb","isRoot","errorContext","_trySubscribe","sink","promiseCtor","getPromiseCtor","pipe","operations","fns","input","toPromise","innerFrom","isInteropObservable","obs","array","promise","isAsyncIterable","fromAsyncIterable","isIterable","iterable","iterable_1","iterable_1_1","getReader","isReadableStreamLike","readableStream","reader","read","releaseLock","readableStreamLikeToAsyncGenerator","createInvalidObservableTypeError","asyncIterable","asyncIterable_1","asyncIterable_1_1","catch","catchError","selector","handledResult","innerSub","syncUnsub","mergeMap","resultSelector","concurrent","ii","onBeforeNext","expand","innerSubScheduler","additionalFinalizer","buffer","active","isComplete","checkComplete","outerNext","doInnerSub","innerComplete","innerValue","_loop_1","bufferedValue","mergeInternals","concatMap","arrReducer","accumulator","seed","hasSeed","emitOnNext","emitBeforeComplete","hasState","scanInternals","DataTopic","ScaleDimensionMode","ScalarDimensionMode","TextDimensionMode","ResourceDimensionMode","FrameGeometrySourceMode","HeatmapCalculationMode","HeatmapCellLayout","LogsSortOrder","AxisPlacement","AxisColorMode","VisibilityMode","GraphDrawStyle","GraphTransform","LineInterpolation","ScaleDistribution","GraphGradientMode","StackingMode","BarAlignment","ScaleOrientation","ScaleDirection","GraphThresholdsStyleMode","LegendDisplayMode","VizOrientation","BigValueColorMode","BigValueGraphMode","BigValueJustifyMode","BigValueTextMode","TooltipDisplayMode","SortOrder","BarGaugeDisplayMode","BarGaugeValueMode","BarGaugeNamePlacement","BarGaugeSizing","TableCellDisplayMode","TableCellBackgroundDisplayMode","TableCellHeight","VariableFormatID","LogsDedupStrategy","ComparisonOperation","operators","keywordOperators","stringOperators","numberOperators","intrinsics","scopes","keywords","languageDefinition","extensions","aliases","mimetypes","def","language","ignoreCase","defaultToken","tokenPostfix","statusValues","functions","symbols","escapes","digits","octaldigits","binarydigits","tokenizer","cases","string_double","string_single","string_back","languageConfiguration","wordPattern","brackets","autoClosingPairs","open","close","surroundingPairs","folding","traceqlGrammar","comment","pattern","inside","alias","punctuation","number","generateQueryFromFilters","filters","tag","scopeHelper","tagHelper","valueHelper","valueType","find","scope","Resource","Span","durationType","filterScopedTag","filterTitle","startCase","getUnscopedTags","uniq","tags","flat","getTagsByScope","replaceAt","operatorSelectableValue","TempoVariableQueryType","variableOptions","refId","TempoVariableQueryEditor","onChange","datasource","setLabel","setType","labelOptions","setLabelOptions","labelNamesQuery","labelNames","handleBlur","InlineFieldRow","InlineField","labelWidth","Select","newType","onBlur","newLabel","newLabelValue","allowCustomValue","getStats","duration","traceDuration","selfDuration","main","toFixedNoTrailingZeros","parseFloat","toFixed","createGraphFrames","data","edges","view","DataFrameView","traceEndTime","traceStartTime","row","startTime","findTraceDuration","spanMap","getSpan","parentId","parentIds","makeSpanMap","spanID","parentSpanID","childrenDuration","prevStart","prevEnd","end","Fields","serviceName","subTitle","operationName","mainStat","secondaryStat","convertTraceToGraph","nodesFrame","edgesFrame","MutableDataFrame","fields","FieldType","string","mode","meta","preferredVisualisationType","edge","secondsMetric","totalsMetric","failedMetric","histogramMetric","rateMetric","expr","topk","params","errorRateMetric","durationMetric","defaultTableFilter","serviceMapMetrics","collectMetricData","frame","stat","metric","nodesMap","edgesMap","valueName","serverId","server_service_namespace","server","clientId","client_service_namespace","client","edgeId","targetName","targetNamespace","sourceName","sourceNamespace","namespace","AdditionalEdgeFields","TempoLanguageProvider","LanguageProvider","fetchTags","v1Resp","v2Resp","request","setV2Tags","setV1Tags","tagNames","getOptionsV1","encodedTag","encodeTag","response","tagValues","getOptionsV2","initialValues","super","tagsV1","tagsV2","url","metadataRequest","startTask","getTags","Unscoped","getMetricsSummaryTags","getTraceqlAutocompleteTags","getAutocompleteTags","getAllTags","encodeURIComponent","createTableFrameFromMetricsSummaryQuery","targetQuery","instanceSettings","emptyResponse","dynamicMetrics","configQuery","getConfigQuery","series","getConfig","createDataFrame","localeCompare","displayNameFromDS","custom","unit","getPercentileRow","metricsData","transformToMetricsData","trace","sortDataFrame","errorPercentage","errorSpanCount","getNumberForMetric","spanCount","p50","p90","p95","p99","getMetricValue","queryParts","isNumber","isIntrinsic","surround","closingBracketIndex","queryAfterClosingBracket","substring","commonConfig","noValue","links","internal","datasourceUid","uid","datasourceName","queryType","getSpanStatusCode","status","getSpanKind","statusCode","parseInt","SemanticResourceAttributes","getAttributeValue","stringValue","boolValue","Boolean","intValue","doubleValue","arrayValue","arValue","resourceToProcess","resource","serviceTags","attribute","attributes","getSpanTags","spanTags","getReferences","references","link","traceId","spanId","traceID","getLogs","logs","events","event","timestamp","timeUnixNano","transformTrace","nodeGraph","emptyDataQueryResponse","traceToProfilesData","jsonData","traceToProfilesOptions","tracesToProfiles","profilesDataSourceSettings","getDataSourceSrv","getInstanceSettings","customQuery","dataLink","labelSelector","groupBy","profileTypeId","spanSelector","origin","DataLinkConfigOrigin","Datasource","toDataFrame","metricsValueToString","formatTraceQLResponse","tableType","Spans","spanDynamicAttrs","hasNameAttribute","getSpanSets","ss","attr","spans","hidden","panelsState","time","startTimeUnixNano","spanSet","transformSpanToTraceData","createTableFrameFromTraceQlQueryAsSpans","nestedFrames","uniqueRowIdFields","traceData","durationMs","traceService","rootServiceName","traceName","rootTraceName","transformToTraceData","spanSets","traceSubFrame","createTableFrameFromTraceQlQuery","subFrame","createTheme","getDisplayProcessor","spanStartTimeUnixMs","traceIdHidden","durationNanos","attrs","Value","bool_value","double_value","int_value","string_value","traceFormat","randomUUID","crypto","getRandomValues","rnds8","Uint8Array","rng","byteToHex","buf","offset","rnds","random","unsafeStringify","metricsDataFrame","metrics","elapsedTime","progressThresholds","steps","ThresholdsMode","Absolute","capitalize","totalBlocks","completedJobs","totalJobs","Done","cellOptions","thresholds","__defProps","defineProperties","__getOwnPropDescs","getOwnPropertyDescriptors","AccessoryButton","getButtonStyles","Button","button","dropdown","boxShadow","updateFilter","isTagsLoading","setError","hideScope","hideTag","hideValue","isMulti","alertText","setAlertText","scopedTag","useMemo","prevOperator","setPrevOperator","prevValue","setPrevValue","updateOptions","languageProvider","isFetchError","isLoadingValues","useAsync","scopeOptions","Intrinsic","optionsOfFirstType","uniqueOptionType","operatorList","allOperators","withTemplateVariableOptions","getTemplateSrv","getVariables","HorizontalGroup","inputId","placeholder","isLoading","isClearable","val","allowCreateWhileLoading","vertical","horizontal","addTag","deleteFilter","staticTags","hideValues","requireTagAndValue","handleOnAdd","generateId","getFilteredTags","validInput","SearchField","variant","onClick","uuidv4","getErrorMessage","getDS","dsSrv","migrateFromSearchToTraceQLSearch","spanName","minDuration","maxDuration","search","endsWith","limit","TempoVariableSupport","CustomVariableSupport","executeVariableQuery","targets","editor","DEFAULT_LIMIT","FeatureName","featuresToTempoVersion","TempoDatasource","DataSourceWithBackend","LabelNames","LabelValues","labelValuesQuery","labelName","flatMap","tagV2","scopeAndTag","option","getTagKeys","getTagValues","isFeatureAvailable","featureName","actualVersion","tempoVersion","subQueries","filteredTargets","hide","clear","of","LoadingState","nativeSearch","migratedQuery","traceqlSearch","traceql","appliedQuery","applyVariables","scopedVars","queryValue","isTraceIdQuery","reportInteraction","datasourceType","app","grafana_version","buildInfo","hasQuery","handleTraceIdQuery","isTraceQlMetricsQuery","handleTraceQlMetricsQuery","streaming","traceQLStreaming","handleTraceQlQuery","metricsSummary","hasGroupBy","handleMetricsSummary","traceqlSearchTargets","queryValueFromFilters","liveEnabled","handleStreamingSearch","_request","spss","unix","traces","upload","uploadedJson","JSON","isTraceData","batches","isServiceGraphData","df","librarySpan","instrumentationLibrarySpans","parentSpanId","code","statusMessage","instrumentationLibraryName","instrumentationLibrary","instrumentationLibraryVersion","traceState","endTimeUnixNano","transformFromOTEL","enabled","serviceMap","hasServiceMapQuery","serviceMapQuery","dsId","tempoDsUid","tempoDatasourceUid","queryPrometheus","makePromServiceMapRequest","responses","errorRes","frames","frameDTO","getMetricFrames","createDF","arc","fixedColor","FieldColorModeId","Fixed","createServiceMapDataFrames","nodeId","total","seconds","NaN","Math","round","failed","convertToDataFrames","mapPromMetricsToServiceMap","nodeLength","edgeLength","serviceMapIncludeNamespace","getFieldConfig","serviceMapResponse","serviceMapRequest","makeServiceGraphViewRequest","buildExpr","rates","rateQuery","rateResponse","serviceGraphViewMetrics","errorRateBySpanName","durationsBySpanName","labels","CoreApp","Explore","spanNameField","spanNameLabels","spanNames","errorAndDurationResponse","serviceGraphView","secondResponse","rate","errorRate","filterable","makePromLink","buildLinkExpr","decimals","Lcd","Gauge","errorRateNames","errorRateValues","errorRateObj","getRateAlignedValues","durationObj","delimiter","makeTempoLink","getServiceGraphView","errorAndDurationQuery","merge","applyTemplateVariables","interpolateVariablesInQueries","queries","getRef","expandedQuery","updatedFilter","templateSrv","Pipe","validTargets","traceRequest","traceIdQueryRequest","traceQuery","timeShiftEnabled","subtract","rangeUtil","intervalToMs","spanStartTimeShift","spanEndTimeShift","dateTime","ds","NotStarted","requestTime","performance","getGrafanaLiveSrv","getStream","LiveChannelScope","DataSource","path","SpansPerSpanSet","timeRange","toISOString","takeWhile","evt","frameState","Streaming","doTempoChannelStream","lastValueFrom","method","hideFromInspector","apiUrl","urlUtil","serializeParams","req","getBackendSrv","fetch","testDatasource","headers","getQueryDisplayText","tracesToLogs","spanBar","formatGroupBy","filterCount","summaries","summary","gb","samples","sample","timestampMs","variables","instant","exemplar","targetField","tempoField","sourceField","namespaceFields","serverSumBy","serviceNamespace","extraSumByFields","subExprs","extraParams","serviceMapQueryMatch","rateResp","objToAlign","rateNames","parseIntWithFallback","fallback","TempoQueryBuilderOptions","React","Traces","collapsedInfoList","AutoSizeInput","defaultValue","onCommitChange","currentTarget","RadioButtonGroup","validationRegex","noBoxShadow","invalid","Input","grow","GroupByField","copy","indexOfFilter","findIndex","InlineSearchField","removeFilter","hardCodedFilterIds","onClearResults","findFilter","setIsTagsLoading","traceQlQuery","setTraceQlQuery","dynamicFilters","sf","container","DurationInput","TagsInput","rawQueryContainer","location","alert","href","maxWidth","marginTop","consoleLogger","log","output","warn","Logger","concreteLogger","logger","_len","_key","forward","_len2","_key2","_len3","_key3","deprecate","_len4","_key4","lvl","debugOnly","moduleName","clone","baseLogger","EventEmitter","observers","on","listener","numListeners","off","emit","entries","_ref","observer","numTimesAdded","_ref2","defer","rej","makeString","object","lastOfPathSeparatorRegExp","getLastOfPath","Empty","cleanKey","canNotTraverseDeeper","stackIndex","setPath","newValue","last","getPath","deepExtend","overwrite","regexEscape","str","_entityMap","chars","looksLikeObjectPathRegExpCache","capacity","regExpMap","regExpQueue","getRegExp","regExpFromCache","regExpNew","deepFind","keySeparator","nextPath","getCleanedCode","ResourceStore","ns","defaultNS","ignoreJSONStructure","addNamespaces","removeNamespaces","getResource","lng","addResource","silent","addResources","resources","addResourceBundle","deep","skipCopy","stringify","removeResourceBundle","hasResourceBundle","getResourceBundle","compatibilityAPI","getDataByLanguage","hasLanguageSomeTranslations","toJSON","postProcessor","processors","addPostProcessor","translator","processor","checkedLoadedFor","Translator","services","changeLanguage","exists","interpolation","resolved","extractFromKey","nsSeparator","namespaces","wouldCheckForNsInKey","seemsNaturalLanguage","userDefinedKeySeparator","userDefinedNsSeparator","possibleChars","matched","ki","looksLikeObjectPath","interpolator","nestingRegexp","parts","translate","lastKey","overloadTranslationOptionHandler","returnDetails","appendNamespaceToCIMode","usedKey","exactUsedKey","usedLng","usedNS","usedParams","getUsedParamsDetails","resUsedKey","resExactUsedKey","resType","joinArrays","handleAsObjectInI18nFormat","i18nFormat","handleAsObject","returnObjects","returnedObjectHandler","resTypeIsArray","newKeyToUse","deepKey","extendTranslation","usedDefault","needsPluralHandling","count","hasDefaultValue","defaultValueSuffix","pluralResolver","getSuffix","defaultValueSuffixOrdinalFallback","ordinal","needsZeroSuffixLookup","shouldUseIntlApi","pluralSeparator","isValidLookup","resForMissing","missingKeyNoValueFallbackToKey","updateMissing","fk","lngs","fallbackLngs","languageUtils","getFallbackCodes","fallbackLng","saveMissingTo","toResolveHierarchy","send","specificDefaultValue","defaultForMissing","missingKeyHandler","backendConnector","saveMissing","saveMissingPlurals","suffixes","getSuffixes","appendNamespaceToMissingKey","parseMissingKeyHandler","defaultVariables","skipInterpolation","skipOnVariables","nestBef","nb","interpolate","na","nest","postProcess","postProcessorNames","applyPostProcessor","postProcessPassResolved","i18nResolved","found","extracted","fallbackNS","needsContextHandling","codes","utils","hasLoadedNamespace","finalKeys","addLookupKeys","pluralSuffix","zeroSuffix","ordinalPrefix","contextKey","contextSeparator","possibleKey","returnNull","returnEmptyString","resourceStore","optionsKeys","useOptionsReplaceForData","charAt","toUpperCase","LanguageUtil","supportedLngs","getScriptPartFromCode","formatLanguageCode","getLanguagePartFromCode","specialCases","lowerCaseLng","part","cleanCode","isSupportedCode","nonExplicitSupportedLngs","getBestMatchFromCodes","cleanedLng","lngOnly","supportedLng","fallbacks","fallbackCode","fallbackCodes","addCode","fc","sets","nr","_rulesPluralsTypes","nonIntlVersions","intlVersions","suffixesOrder","zero","one","two","few","many","PluralResolver","compatibilityJSON","Intl","PluralRules","rules","numbers","plurals","createRules","addRule","getRule","needsPlural","rule","resolvedOptions","pluralCategories","getPluralFormsOfKey","pluralCategory1","pluralCategory2","pluralCategory","prepend","select","getSuffixRetroCompatible","idx","noAbs","abs","simplifyPluralSuffix","returnSuffix","deepFindWithDefaults","defaultData","getPathWithDefaults","Interpolator","escapeValue","iOpts","escape","useRawValueToEscape","prefixEscaped","suffixEscaped","formatSeparator","unescapePrefix","unescapeSuffix","nestingPrefix","nestingPrefixEscaped","nestingSuffix","nestingSuffixEscaped","nestingOptionsSeparator","maxReplaces","alwaysFormat","resetRegExp","getOrResetRegExp","existingRegExp","regexp","regexpUnescape","replaces","regexSafe","handleFormat","interpolationkey","missingInterpolationHandler","regex","safeValue","todo","matchedVar","temp","clonedOptions","handleHasOptions","inheritedOptions","sep","optionsString","matchedSingleQuotes","matchedDoubleQuotes","formatters","doReduce","elem","createCachedFormatter","formatter","Formatter","formats","opt","NumberFormat","currency","datetime","DateTimeFormat","relativetime","RelativeTimeFormat","ListFormat","addCached","mem","formatName","formatOptions","formatStr","optStr","rest","parseFormatStr","formatted","valOptions","formatParams","locale","Connector","backend","store","waitingReads","maxParallelReads","readingCalls","maxRetries","retryTimeout","queue","queueLoad","languages","toLoad","pending","toLoadLanguages","toLoadNamespaces","hasAllNamespaces","reload","pendingCount","loaded","pushPath","removePending","loadedKeys","fcName","tried","wait","resolver","prepareLoading","loadOne","fallbackValue","isUpdate","clb","opts","initImmediate","preload","partialBundledLanguages","tDescription","transformOptions","I18n","inst","modules","external","isInitialized","isClone","isInitializing","defOpts","createClassOnDemand","ClassOrObject","lu","languageDetector","detection","deferred","finish","initializedStoreOnce","loadResources","usedCallback","append","resolvedLanguage","setResolvedLanguage","reloadResources","use","li","lngInLngs","_this2","isLanguageChangingTo","setLngProps","setLng","cacheUserLanguage","detect","getFixedT","keyPrefix","_this3","fixedT","resultKey","setDefaultNamespace","lastLng","loadNotPending","loadState","precheck","preResult","loadNamespaces","loadLanguages","preloaded","newLngs","dir","createInstance","cloneInstance","forkResourceStore","mergedOptions","AdHocFilterKey","disabled","filterKey","allFilters","data-testid","SegmentAsync","Component","plusSegment","loadOptions","fetchFilterKeys","inputMinWidth","fetchFilterKeysWithRemove","REMOVE_FILTER_KEY","REMOVE_VALUE","currentKey","otherFilters","AdHocFilterValue","filterValue","placeHolder","fetchFilterValues","getDefaultTimeRange","OperatorSegment","Segment","AdHocFilterRenderer","onKeyChange","onOperatorChange","onValueChange","tFunc","i18n","AdHocFilterBuilder","appendBefore","onCompleted","setKey","setOperator","onKeyChanged","onOperatorChanged","onValueChanged","defaultMessage","ConditionSegment","AdHocFilter","PureComponent","renderFilters","appendFilterToVariable","getAllFilters","baseFilters","segments","renderFilterSegments","changeFilter","addFilter","ServiceGraphSection","graphDatasourceUid","dsState","hasKeys","setHasKeys","condition","getWarning","queryToFilter","filtersToQuery","newFilters","rel","textDecoration","defaultQuery","SpanKind","DefaultBufferLength","nextPropID","NodeProp","perNode","deserialize","RangeError","NodeType","closedBy","openedBy","group","isolate","contextHash","lookAhead","mounted","MountedTree","tree","overlay","parser","noProps","flags","define","spec","skipped","isTop","isSkipped","isError","isAnonymous","is","direct","groups","none","NodeSet","types","extend","newTypes","newProps","CachedNode","CachedInnerNode","IterMode","Tree","positions","ch","cursor","TreeCursor","topNode","cursorAt","pos","side","moveTo","_tree","TreeNode","resolveNode","resolveInner","resolveStack","inner","layers","scan","mount","iterStack","stackIterator","iterate","enter","leave","anon","IncludeAnonymous","entered","firstChild","nextSibling","propValues","balance","balanceRange","makeTree","nodeSet","maxBufferLength","reused","minRepeatType","FlatBufferCursor","takeNode","parentStart","minPos","inRepeat","depth","lookAheadAtStart","startPos","maxSize","fork","skip","minStart","nodeSize","localSkipped","nodeStart","findBufferSize","Uint16Array","endPos","copyToBuffer","TreeBuffer","localChildren","localPositions","localInRepeat","lastGroup","lastEnd","makeRepeatLeaf","takeFlatNode","make","lookAheadProp","lastI","makeBalanced","nodeCount","stopAt","pair","bufferStart","startIndex","topID","buildTree","childString","endIndex","findChild","pick","checkSide","startI","endI","overlays","IgnoreOverlays","BaseNode","getChild","before","after","getChildren","matchContext","matchNodeContext","enterUnfinishedNodesBefore","childBefore","lastChild","prevSibling","_parent","nextChild","ExcludeBuffers","BufferNode","BufferContext","hasChild","IgnoreMounts","childAfter","rPos","nextSignificantParent","toTree","cur","child","externalSibling","heads","picked","newHeads","StackIterator","bufferNode","yieldNode","yieldBuf","yield","enterChild","sibling","atLastNode","move","mustLeave","nodeSizeCache","balanceType","mkTop","mkTree","maxChild","ceil","divide","groupFrom","groupStart","groupSize","nextSize","only","Parser","startParse","fragments","StringInput","createParse","advance","chunk","lineChunks","reducePos","score","bufferBase","curContext","StackContext","pushState","action","dPrec","dynamicPrecedence","getGoto","minRepeatTerm","storeNode","reduceContext","lastBigReductionStart","bigReductionCount","lastBigReductionSize","stateFlag","baseStateID","term","isReduce","nextEnd","shiftContext","maxNode","nextState","useNode","updateContext","tracker","reuse","stream","recoverByDelete","isNode","canShift","sim","SimulatedStack","stateSlot","hasAction","recoverByInsert","nextStates","best","forceReduce","validAction","forceAll","deadEnd","restart","sameState","dialectEnabled","dialectID","dialect","emitContext","hash","emitLookAhead","newCx","setLookAhead","strict","Recover","goto","StackBufferCursor","maybeNext","decodeArray","Type","out","charCodeAt","stop","digit","CachedToken","extended","mask","nullToken","InputStream","chunkOff","chunk2","chunk2Pos","rangeIndex","chunkPos","readNext","resolveOffset","assoc","clipPos","acceptToken","endOffset","getChunk","nextChunk","setDone","TokenGroup","readToken","tokenPrecTable","contextual","LocalTokenGroup","precTable","elseToken","precOffset","groupMask","accEnd","allows","overrides","mid","findOffset","tableData","tableOffset","iPrev","verbose","LOG","stackIDs","Safety","Rec","cutAt","fragment","safeFrom","safeTo","trees","nextFragment","fr","openStart","openEnd","nextStart","nodeAt","TokenCache","mainToken","actions","tokenizers","getActions","actionIndex","updateCachedToken","addActions","eofTerm","getMainToken","specialized","specializers","putAction","Parse","recovering","nextStackID","minStackPos","stoppedAt","topTerm","stacks","bufferLength","parsedPos","stopped","stoppedTokens","newStacks","advanceStack","tok","finished","findFinished","stackToTree","getName","SyntaxError","runRecovery","maxRemaining","outer","stackID","strictCx","cxHash","defaultReduce","localStack","advanceFully","pushStackDedup","restarted","tokenEnd","force","forceBase","insert","fromCodePoint","Dialect","LRParser","wrappers","nodeNames","repeatNodeCount","topTerms","topRules","nodeProps","setProp","nodeID","propSpec","skippedNodes","propSources","tokenArray","tokenData","specializerSpecs","getSpecializer","states","Uint32Array","stateData","maxTerm","dialects","dynamicPrecedences","tokenPrec","termNames","parseDialect","table","groupTag","terminal","slot","flag","configure","info","contextTracker","hasWrappers","prec","FieldExpression","IntrinsicField","Aggregate","GroupOperation","SelectOperation","SelectArgs","getErrorNode","cursorPos","walk","expectedNodeIDs","getNodeText","isPathMatch","resolverPath","cursorPath","RESOLVERS","fun","attributeFieldParent","attributeFieldParentText","indexOfDot","attributeFieldUpToDot","resolveExpression","originalPos","situation","resolveAttributeCompletion","resolveAttributeForFunction","_1","_2","_0","resolveSpanset","resolveNewSpansetExpression","getAttributeFieldUpToDot","endOfPathNode","endOfPathNode2","attributeField","tagName","betweenQuotes","previousNode","CompletionProvider","provideCompletionItems","model","monaco","getModel","suggestions","word","getWordAtPosition","startLineNumber","lineNumber","endLineNumber","startColumn","endColumn","fromPositions","positionClone","column","getOffsetAt","getRangeAndOffset","shiftedOffset","maybeErrorNode","currentNode","ids","situationType","getSituation","getValue","getCompletions","items","maxIndexDigits","suggestion","getMonacoCompletionItemKind","insertText","insertTextRules","detail","documentation","sortText","padStart","command","registerInteractionCommandId","itemType","fixSuggestion","setRegisterInteractionCommandId","cacheKey","cachedValues","getScopesCompletions","getIntrinsicsCompletions","getTagsCompletions","comparisonOps","logicalOps","arithmeticOps","spansetOps","CompletionItemInsertTextRule","InsertAsSnippet","getInsertionText","sensitivity","triggerCharacters","CompletionItemKind","Enum","Keyword","Operator","EnumMember","Class","structuralOps","spansetAggregatorOps","getErrorNodes","errorNodes","nodeRef","setMarkers","markers","getErrorMarkers","MarkerSeverity","getWarningMarkers","Warning","setModelMarkers","errorNode","computeErrorMessage","getMarker","startLine","endLine","getLineLength","TraceQLEditor","onRunQuery","setupAutocompleteFn","providerRef","autocompleteDisposeFun","registerCompletionItemProvider","langId","useAutocomplete","queryRef","onEditorChange","onRunQueryRef","errorTimeoutId","CodeEditor","containerStyles","queryField","readOnly","monacoOptions","lineNumbers","overviewRulerLanes","renderLineHighlight","scrollbar","verticalScrollbarSize","horizontalScrollbarSize","scrollBeyondLastLine","wordWrap","onBeforeEditorMount","ensureTraceQL","onEditorDidMount","addCommand","properties","setupRegisterInteractionCommand","addAction","keybindings","KeyMod","Shift","KeyCode","Enter","contextMenuGroupId","contextMenuOrder","run","setupActions","placeholderDecorators","isWholeLine","checkDecorators","newDecorators","getValueLength","deltaDecorations","onDidChangeModelContent","setupPlaceholder","getDomNode","updateHeight","contentHeight","getContentHeight","height","onDidContentSizeChange","setupAutoSize","changeEvent","window","cursorPosition","changes","rangeOffset","traceqlSetupDone","register","setMonarchTokensProvider","setLanguageConfiguration","radius","components","borderColor","flex","opacity","QueryEditor","defaults","showCopyFromSearchButton","setShowCopyFromSearchButton","genQuery","InlineLabel","copyContainer","optionsContainer","TempoQueryFieldComponent","componentDidMount","Modal","uploadModalOpen","onDismiss","setState","FileDropzone","multiple","onLoad","align","justify","newQueryType","previousQueryType","TraceQLSearch","TempoQueryField","withTheme2","DataSourceDescription","dataSourceName","docsLink","hasRequiredFields","GenericConfigSection","isCollapsible","isInitiallyOpen","setIsOpen","iconName","isSubSection","collapsibleButtonAriaLabel","header","subtitle","fontWeightRegular","descriptionText","IconButton","ConfigSection","ConnectionSettings","urlPlaceholder","urlTooltip","urlLabel","isValidUrl","required","SecretInput","isConfigured","onReset","useCommonStyles","inlineFieldNoMarginRight","inlineFieldWithSecret","BasicAuth","user","passwordConfigured","userTooltip","passwordTooltip","onUserChange","onPasswordChange","onPasswordReset","commonStyles","lastInlineField","ConfigSubSection","AuthMethod","AuthMethod2","defaultOptions","CrossSiteCredentials","OAuthForward","NoAuth","AuthMethodSettings","selectedMethod","mostCommonMethod","visibleMethods","visibleMethodsFromProps","extendedDefaultOptions","customMethods","onAuthMethodSelect","basicAuth","_d","authMethodChanged","setAuthMethodChanged","_a2","hasSelect","preparedOptions","customOptions","preparedDefaultOptions","allOptions","selected","AuthFieldsComponent","authMethods","weak","selectedMethodFields","configuredStyle","md","SecretTextArea","TextArea","rows","TLSSettingsSection","tooltipText","checkboxContainer","infoIcon","Checkbox","SelfSignedCertificate","certificateConfigured","onCertificateChange","onCertificateReset","tooltips","newEnabled","certificateLabel","TLSClientAuth","serverName","clientCertificateConfigured","clientKeyConfigured","onServerNameChange","onClientCertificateChange","onClientKeyChange","onClientCertificateReset","onClientKeyReset","serverNameLabel","keyLabel","SkipTLSVerification","TLSSettings","selfSignedCertificate","TLSClientAuth$1","skipTLSVerification","CustomHeader","onDelete","headerNameField","headerValueField","removeHeaderBtn","configured","tooltipPlacement","CustomHeaders","headersFromProps","setHeaders","uniqueId","headers2","changed","newHeaders","addHeaderButton","header2","onHeaderChange","onHeaderDelete","fill","Auth","TLS","customHeaders","headerNamePrefix","headerValuePrefix","getSelectedMethod","withCredentials","oauthPassThru","getOnAuthMethodSelectHandler","getBasicAuthProps","basicAuthUser","secureJsonFields","basicAuthPassword","password","secureJsonData","getTLSProps","tlsAuthWithCACert","tlsCACert","certificate","tlsAuth","tlsClientCert","tlsClientKey","clientCertificate","clientKey","tlsSkipVerify","getCustomHeaders","newJsonData","fromEntries","newSecureJsonData","newSecureJsonFields","AdvancedHttpSettings","keepCookies","cookies","ConfigDescriptionLink","feature","validateIntervalRegex","validateInterval","IntervalInput","intervalIsInvalid","setIntervalIsInvalid","ms","ready","isReady","useTimeoutFn","cancel","useDebounce","isInvalidError","ariaLabel","TagMappingInput","SegmentInput","ToolbarButton","removeTag","palette","orange","TraceToLogsSettings","onOptionsChange","supportedDataSourceTypes","traceToLogs","tracesToLogsV2","mapTagNamesEnabled","mappedTags","filterByTraceID","filterBySpanID","getTraceToLogsOptions","updateTracesToLogs","DataSourcePicker","noDefault","getTimeShiftLabel","getTimeShiftTooltip","invalidTimeShiftError","IdFilter","InlineSwitch","checked","allowFullScreen","defaultVal","TraceToLogsSection","TraceToMetricsSettings","pluginId","tracesToMetrics","updateDatasourcePluginJsonDataOption","queryRow","newQueries","traceToMetricQuery","updatedQueries","TraceToMetricsSection","infoText","flexFlow","useMountedState","useAsyncFn","ProfileTypesCascader","cascaderOptions","profileTypes","mainTypes","profileType","Cascader","separator","displayAllSelectedLevels","initialProfileTypeId","onSelect","changeOnSelect","TraceToProfilesSettings","setProfileTypes","profileTypesPlaceholder","dataSource","pTypes","TraceToProfilesSection","NodeGraphSettings","NodeGraphSection","NONE","DURATION","TAG","SpanBarSettings","selectOptions","toOption","SpanBarSection","QuerySettings","getLabel","getTooltip","ServiceGraphSettings","TraceQLSearchTags","missingTag","topSpacing","TraceQLSearchSettings","dataSourceSrv","fetchDatasource","hasTemplateVariables","containsTemplate","plugin","DataSourcePlugin","setQueryEditor","setConfigEditor","Divider","convertLegacyAuthProps","secureSocksDSProxyEnabled","SecureSocksProxySettings","setQueryEditorHelp","h2","TextLink","getAppEvents","DashboardLoadedEvent","payload","dashboardId","orgId","grafanaVersion","tempoQueries","dashboard_id","org_id","service_map_query_count","traceql_query_count","upload_query_count","service_map_queries_with_template_variables_count","traceql_queries_with_template_variables_count"],"sourceRoot":""}